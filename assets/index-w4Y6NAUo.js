var TE=Object.defineProperty;var CE=(e,t,o)=>t in e?TE(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o;var gx=(e,t,o)=>(CE(e,typeof t!="symbol"?t+"":t,o),o);function v_(e,t){for(var o=0;o<t.length;o++){const l=t[o];if(typeof l!="string"&&!Array.isArray(l)){for(const c in l)if(c!=="default"&&!(c in e)){const m=Object.getOwnPropertyDescriptor(l,c);m&&Object.defineProperty(e,c,m.get?m:{enumerable:!0,get:()=>l[c]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))l(c);new MutationObserver(c=>{for(const m of c)if(m.type==="childList")for(const x of m.addedNodes)x.tagName==="LINK"&&x.rel==="modulepreload"&&l(x)}).observe(document,{childList:!0,subtree:!0});function o(c){const m={};return c.integrity&&(m.integrity=c.integrity),c.referrerPolicy&&(m.referrerPolicy=c.referrerPolicy),c.crossOrigin==="use-credentials"?m.credentials="include":c.crossOrigin==="anonymous"?m.credentials="omit":m.credentials="same-origin",m}function l(c){if(c.ep)return;c.ep=!0;const m=o(c);fetch(c.href,m)}})();var EE=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function x_(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Nw={exports:{}},Rf={},Uw={exports:{}},Yt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Wh=Symbol.for("react.element"),IE=Symbol.for("react.portal"),kE=Symbol.for("react.fragment"),ME=Symbol.for("react.strict_mode"),PE=Symbol.for("react.profiler"),AE=Symbol.for("react.provider"),zE=Symbol.for("react.context"),DE=Symbol.for("react.forward_ref"),LE=Symbol.for("react.suspense"),RE=Symbol.for("react.memo"),FE=Symbol.for("react.lazy"),yx=Symbol.iterator;function OE(e){return e===null||typeof e!="object"?null:(e=yx&&e[yx]||e["@@iterator"],typeof e=="function"?e:null)}var $w={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},jw=Object.assign,Zw={};function Ou(e,t,o){this.props=e,this.context=t,this.refs=Zw,this.updater=o||$w}Ou.prototype.isReactComponent={};Ou.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Ou.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function qw(){}qw.prototype=Ou.prototype;function w_(e,t,o){this.props=e,this.context=t,this.refs=Zw,this.updater=o||$w}var b_=w_.prototype=new qw;b_.constructor=w_;jw(b_,Ou.prototype);b_.isPureReactComponent=!0;var _x=Array.isArray,Gw=Object.prototype.hasOwnProperty,S_={current:null},Hw={key:!0,ref:!0,__self:!0,__source:!0};function Ww(e,t,o){var l,c={},m=null,x=null;if(t!=null)for(l in t.ref!==void 0&&(x=t.ref),t.key!==void 0&&(m=""+t.key),t)Gw.call(t,l)&&!Hw.hasOwnProperty(l)&&(c[l]=t[l]);var u=arguments.length-2;if(u===1)c.children=o;else if(1<u){for(var C=Array(u),I=0;I<u;I++)C[I]=arguments[I+2];c.children=C}if(e&&e.defaultProps)for(l in u=e.defaultProps,u)c[l]===void 0&&(c[l]=u[l]);return{$$typeof:Wh,type:e,key:m,ref:x,props:c,_owner:S_.current}}function BE(e,t){return{$$typeof:Wh,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function T_(e){return typeof e=="object"&&e!==null&&e.$$typeof===Wh}function VE(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(o){return t[o]})}var vx=/\/+/g;function xg(e,t){return typeof e=="object"&&e!==null&&e.key!=null?VE(""+e.key):t.toString(36)}function zp(e,t,o,l,c){var m=typeof e;(m==="undefined"||m==="boolean")&&(e=null);var x=!1;if(e===null)x=!0;else switch(m){case"string":case"number":x=!0;break;case"object":switch(e.$$typeof){case Wh:case IE:x=!0}}if(x)return x=e,c=c(x),e=l===""?"."+xg(x,0):l,_x(c)?(o="",e!=null&&(o=e.replace(vx,"$&/")+"/"),zp(c,t,o,"",function(I){return I})):c!=null&&(T_(c)&&(c=BE(c,o+(!c.key||x&&x.key===c.key?"":(""+c.key).replace(vx,"$&/")+"/")+e)),t.push(c)),1;if(x=0,l=l===""?".":l+":",_x(e))for(var u=0;u<e.length;u++){m=e[u];var C=l+xg(m,u);x+=zp(m,t,o,C,c)}else if(C=OE(e),typeof C=="function")for(e=C.call(e),u=0;!(m=e.next()).done;)m=m.value,C=l+xg(m,u++),x+=zp(m,t,o,C,c);else if(m==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return x}function cp(e,t,o){if(e==null)return e;var l=[],c=0;return zp(e,l,"","",function(m){return t.call(o,m,c++)}),l}function NE(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(o){(e._status===0||e._status===-1)&&(e._status=1,e._result=o)},function(o){(e._status===0||e._status===-1)&&(e._status=2,e._result=o)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var vi={current:null},Dp={transition:null},UE={ReactCurrentDispatcher:vi,ReactCurrentBatchConfig:Dp,ReactCurrentOwner:S_};Yt.Children={map:cp,forEach:function(e,t,o){cp(e,function(){t.apply(this,arguments)},o)},count:function(e){var t=0;return cp(e,function(){t++}),t},toArray:function(e){return cp(e,function(t){return t})||[]},only:function(e){if(!T_(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Yt.Component=Ou;Yt.Fragment=kE;Yt.Profiler=PE;Yt.PureComponent=w_;Yt.StrictMode=ME;Yt.Suspense=LE;Yt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=UE;Yt.cloneElement=function(e,t,o){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var l=jw({},e.props),c=e.key,m=e.ref,x=e._owner;if(t!=null){if(t.ref!==void 0&&(m=t.ref,x=S_.current),t.key!==void 0&&(c=""+t.key),e.type&&e.type.defaultProps)var u=e.type.defaultProps;for(C in t)Gw.call(t,C)&&!Hw.hasOwnProperty(C)&&(l[C]=t[C]===void 0&&u!==void 0?u[C]:t[C])}var C=arguments.length-2;if(C===1)l.children=o;else if(1<C){u=Array(C);for(var I=0;I<C;I++)u[I]=arguments[I+2];l.children=u}return{$$typeof:Wh,type:e.type,key:c,ref:m,props:l,_owner:x}};Yt.createContext=function(e){return e={$$typeof:zE,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:AE,_context:e},e.Consumer=e};Yt.createElement=Ww;Yt.createFactory=function(e){var t=Ww.bind(null,e);return t.type=e,t};Yt.createRef=function(){return{current:null}};Yt.forwardRef=function(e){return{$$typeof:DE,render:e}};Yt.isValidElement=T_;Yt.lazy=function(e){return{$$typeof:FE,_payload:{_status:-1,_result:e},_init:NE}};Yt.memo=function(e,t){return{$$typeof:RE,type:e,compare:t===void 0?null:t}};Yt.startTransition=function(e){var t=Dp.transition;Dp.transition={};try{e()}finally{Dp.transition=t}};Yt.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};Yt.useCallback=function(e,t){return vi.current.useCallback(e,t)};Yt.useContext=function(e){return vi.current.useContext(e)};Yt.useDebugValue=function(){};Yt.useDeferredValue=function(e){return vi.current.useDeferredValue(e)};Yt.useEffect=function(e,t){return vi.current.useEffect(e,t)};Yt.useId=function(){return vi.current.useId()};Yt.useImperativeHandle=function(e,t,o){return vi.current.useImperativeHandle(e,t,o)};Yt.useInsertionEffect=function(e,t){return vi.current.useInsertionEffect(e,t)};Yt.useLayoutEffect=function(e,t){return vi.current.useLayoutEffect(e,t)};Yt.useMemo=function(e,t){return vi.current.useMemo(e,t)};Yt.useReducer=function(e,t,o){return vi.current.useReducer(e,t,o)};Yt.useRef=function(e){return vi.current.useRef(e)};Yt.useState=function(e){return vi.current.useState(e)};Yt.useSyncExternalStore=function(e,t,o){return vi.current.useSyncExternalStore(e,t,o)};Yt.useTransition=function(){return vi.current.useTransition()};Yt.version="18.2.0";Uw.exports=Yt;var he=Uw.exports;const sy=x_(he),ly=v_({__proto__:null,default:sy},[he]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $E=he,jE=Symbol.for("react.element"),ZE=Symbol.for("react.fragment"),qE=Object.prototype.hasOwnProperty,GE=$E.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,HE={key:!0,ref:!0,__self:!0,__source:!0};function Kw(e,t,o){var l,c={},m=null,x=null;o!==void 0&&(m=""+o),t.key!==void 0&&(m=""+t.key),t.ref!==void 0&&(x=t.ref);for(l in t)qE.call(t,l)&&!HE.hasOwnProperty(l)&&(c[l]=t[l]);if(e&&e.defaultProps)for(l in t=e.defaultProps,t)c[l]===void 0&&(c[l]=t[l]);return{$$typeof:jE,type:e,key:m,ref:x,props:c,_owner:GE.current}}Rf.Fragment=ZE;Rf.jsx=Kw;Rf.jsxs=Kw;Nw.exports=Rf;var Qe=Nw.exports,Xw={exports:{}},Ji={},Yw={exports:{}},Jw={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(Be,lt){var dt=Be.length;Be.push(lt);e:for(;0<dt;){var kt=dt-1>>>1,ht=Be[kt];if(0<c(ht,lt))Be[kt]=lt,Be[dt]=ht,dt=kt;else break e}}function o(Be){return Be.length===0?null:Be[0]}function l(Be){if(Be.length===0)return null;var lt=Be[0],dt=Be.pop();if(dt!==lt){Be[0]=dt;e:for(var kt=0,ht=Be.length,_t=ht>>>1;kt<_t;){var Tt=2*(kt+1)-1,tn=Be[Tt],Zt=Tt+1,hn=Be[Zt];if(0>c(tn,dt))Zt<ht&&0>c(hn,tn)?(Be[kt]=hn,Be[Zt]=dt,kt=Zt):(Be[kt]=tn,Be[Tt]=dt,kt=Tt);else if(Zt<ht&&0>c(hn,dt))Be[kt]=hn,Be[Zt]=dt,kt=Zt;else break e}}return lt}function c(Be,lt){var dt=Be.sortIndex-lt.sortIndex;return dt!==0?dt:Be.id-lt.id}if(typeof performance=="object"&&typeof performance.now=="function"){var m=performance;e.unstable_now=function(){return m.now()}}else{var x=Date,u=x.now();e.unstable_now=function(){return x.now()-u}}var C=[],I=[],D=1,O=null,U=3,le=!1,ue=!1,ae=!1,oe=typeof setTimeout=="function"?setTimeout:null,$=typeof clearTimeout=="function"?clearTimeout:null,G=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function ee(Be){for(var lt=o(I);lt!==null;){if(lt.callback===null)l(I);else if(lt.startTime<=Be)l(I),lt.sortIndex=lt.expirationTime,t(C,lt);else break;lt=o(I)}}function _e(Be){if(ae=!1,ee(Be),!ue)if(o(C)!==null)ue=!0,zt(Ce);else{var lt=o(I);lt!==null&&xt(_e,lt.startTime-Be)}}function Ce(Be,lt){ue=!1,ae&&(ae=!1,$(Me),Me=-1),le=!0;var dt=U;try{for(ee(lt),O=o(C);O!==null&&(!(O.expirationTime>lt)||Be&&!ft());){var kt=O.callback;if(typeof kt=="function"){O.callback=null,U=O.priorityLevel;var ht=kt(O.expirationTime<=lt);lt=e.unstable_now(),typeof ht=="function"?O.callback=ht:O===o(C)&&l(C),ee(lt)}else l(C);O=o(C)}if(O!==null)var _t=!0;else{var Tt=o(I);Tt!==null&&xt(_e,Tt.startTime-lt),_t=!1}return _t}finally{O=null,U=dt,le=!1}}var de=!1,be=null,Me=-1,Ze=5,Oe=-1;function ft(){return!(e.unstable_now()-Oe<Ze)}function bt(){if(be!==null){var Be=e.unstable_now();Oe=Be;var lt=!0;try{lt=be(!0,Be)}finally{lt?Rt():(de=!1,be=null)}}else de=!1}var Rt;if(typeof G=="function")Rt=function(){G(bt)};else if(typeof MessageChannel<"u"){var Ft=new MessageChannel,It=Ft.port2;Ft.port1.onmessage=bt,Rt=function(){It.postMessage(null)}}else Rt=function(){oe(bt,0)};function zt(Be){be=Be,de||(de=!0,Rt())}function xt(Be,lt){Me=oe(function(){Be(e.unstable_now())},lt)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(Be){Be.callback=null},e.unstable_continueExecution=function(){ue||le||(ue=!0,zt(Ce))},e.unstable_forceFrameRate=function(Be){0>Be||125<Be?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Ze=0<Be?Math.floor(1e3/Be):5},e.unstable_getCurrentPriorityLevel=function(){return U},e.unstable_getFirstCallbackNode=function(){return o(C)},e.unstable_next=function(Be){switch(U){case 1:case 2:case 3:var lt=3;break;default:lt=U}var dt=U;U=lt;try{return Be()}finally{U=dt}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(Be,lt){switch(Be){case 1:case 2:case 3:case 4:case 5:break;default:Be=3}var dt=U;U=Be;try{return lt()}finally{U=dt}},e.unstable_scheduleCallback=function(Be,lt,dt){var kt=e.unstable_now();switch(typeof dt=="object"&&dt!==null?(dt=dt.delay,dt=typeof dt=="number"&&0<dt?kt+dt:kt):dt=kt,Be){case 1:var ht=-1;break;case 2:ht=250;break;case 5:ht=1073741823;break;case 4:ht=1e4;break;default:ht=5e3}return ht=dt+ht,Be={id:D++,callback:lt,priorityLevel:Be,startTime:dt,expirationTime:ht,sortIndex:-1},dt>kt?(Be.sortIndex=dt,t(I,Be),o(C)===null&&Be===o(I)&&(ae?($(Me),Me=-1):ae=!0,xt(_e,dt-kt))):(Be.sortIndex=ht,t(C,Be),ue||le||(ue=!0,zt(Ce))),Be},e.unstable_shouldYield=ft,e.unstable_wrapCallback=function(Be){var lt=U;return function(){var dt=U;U=lt;try{return Be.apply(this,arguments)}finally{U=dt}}}})(Jw);Yw.exports=Jw;var WE=Yw.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Qw=he,Yi=WE;function je(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,o=1;o<arguments.length;o++)t+="&args[]="+encodeURIComponent(arguments[o]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var eb=new Set,Ih={};function cl(e,t){Iu(e,t),Iu(e+"Capture",t)}function Iu(e,t){for(Ih[e]=t,e=0;e<t.length;e++)eb.add(t[e])}var za=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),uy=Object.prototype.hasOwnProperty,KE=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,xx={},wx={};function XE(e){return uy.call(wx,e)?!0:uy.call(xx,e)?!1:KE.test(e)?wx[e]=!0:(xx[e]=!0,!1)}function YE(e,t,o,l){if(o!==null&&o.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return l?!1:o!==null?!o.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function JE(e,t,o,l){if(t===null||typeof t>"u"||YE(e,t,o,l))return!0;if(l)return!1;if(o!==null)switch(o.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function xi(e,t,o,l,c,m,x){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=l,this.attributeNamespace=c,this.mustUseProperty=o,this.propertyName=e,this.type=t,this.sanitizeURL=m,this.removeEmptyString=x}var $r={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){$r[e]=new xi(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];$r[t]=new xi(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){$r[e]=new xi(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){$r[e]=new xi(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){$r[e]=new xi(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){$r[e]=new xi(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){$r[e]=new xi(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){$r[e]=new xi(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){$r[e]=new xi(e,5,!1,e.toLowerCase(),null,!1,!1)});var C_=/[\-:]([a-z])/g;function E_(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(C_,E_);$r[t]=new xi(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(C_,E_);$r[t]=new xi(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(C_,E_);$r[t]=new xi(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){$r[e]=new xi(e,1,!1,e.toLowerCase(),null,!1,!1)});$r.xlinkHref=new xi("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){$r[e]=new xi(e,1,!1,e.toLowerCase(),null,!0,!0)});function I_(e,t,o,l){var c=$r.hasOwnProperty(t)?$r[t]:null;(c!==null?c.type!==0:l||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(JE(t,o,c,l)&&(o=null),l||c===null?XE(t)&&(o===null?e.removeAttribute(t):e.setAttribute(t,""+o)):c.mustUseProperty?e[c.propertyName]=o===null?c.type===3?!1:"":o:(t=c.attributeName,l=c.attributeNamespace,o===null?e.removeAttribute(t):(c=c.type,o=c===3||c===4&&o===!0?"":""+o,l?e.setAttributeNS(l,t,o):e.setAttribute(t,o))))}var Fa=Qw.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,hp=Symbol.for("react.element"),nu=Symbol.for("react.portal"),ru=Symbol.for("react.fragment"),k_=Symbol.for("react.strict_mode"),cy=Symbol.for("react.profiler"),tb=Symbol.for("react.provider"),nb=Symbol.for("react.context"),M_=Symbol.for("react.forward_ref"),hy=Symbol.for("react.suspense"),dy=Symbol.for("react.suspense_list"),P_=Symbol.for("react.memo"),as=Symbol.for("react.lazy"),rb=Symbol.for("react.offscreen"),bx=Symbol.iterator;function Wc(e){return e===null||typeof e!="object"?null:(e=bx&&e[bx]||e["@@iterator"],typeof e=="function"?e:null)}var Zn=Object.assign,wg;function hh(e){if(wg===void 0)try{throw Error()}catch(o){var t=o.stack.trim().match(/\n( *(at )?)/);wg=t&&t[1]||""}return`
`+wg+e}var bg=!1;function Sg(e,t){if(!e||bg)return"";bg=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(I){var l=I}Reflect.construct(e,[],t)}else{try{t.call()}catch(I){l=I}e.call(t.prototype)}else{try{throw Error()}catch(I){l=I}e()}}catch(I){if(I&&l&&typeof I.stack=="string"){for(var c=I.stack.split(`
`),m=l.stack.split(`
`),x=c.length-1,u=m.length-1;1<=x&&0<=u&&c[x]!==m[u];)u--;for(;1<=x&&0<=u;x--,u--)if(c[x]!==m[u]){if(x!==1||u!==1)do if(x--,u--,0>u||c[x]!==m[u]){var C=`
`+c[x].replace(" at new "," at ");return e.displayName&&C.includes("<anonymous>")&&(C=C.replace("<anonymous>",e.displayName)),C}while(1<=x&&0<=u);break}}}finally{bg=!1,Error.prepareStackTrace=o}return(e=e?e.displayName||e.name:"")?hh(e):""}function QE(e){switch(e.tag){case 5:return hh(e.type);case 16:return hh("Lazy");case 13:return hh("Suspense");case 19:return hh("SuspenseList");case 0:case 2:case 15:return e=Sg(e.type,!1),e;case 11:return e=Sg(e.type.render,!1),e;case 1:return e=Sg(e.type,!0),e;default:return""}}function py(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case ru:return"Fragment";case nu:return"Portal";case cy:return"Profiler";case k_:return"StrictMode";case hy:return"Suspense";case dy:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case nb:return(e.displayName||"Context")+".Consumer";case tb:return(e._context.displayName||"Context")+".Provider";case M_:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case P_:return t=e.displayName||null,t!==null?t:py(e.type)||"Memo";case as:t=e._payload,e=e._init;try{return py(e(t))}catch{}}return null}function eI(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return py(t);case 8:return t===k_?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function ws(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function ib(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function tI(e){var t=ib(e)?"checked":"value",o=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),l=""+e[t];if(!e.hasOwnProperty(t)&&typeof o<"u"&&typeof o.get=="function"&&typeof o.set=="function"){var c=o.get,m=o.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return c.call(this)},set:function(x){l=""+x,m.call(this,x)}}),Object.defineProperty(e,t,{enumerable:o.enumerable}),{getValue:function(){return l},setValue:function(x){l=""+x},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function dp(e){e._valueTracker||(e._valueTracker=tI(e))}function ob(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var o=t.getValue(),l="";return e&&(l=ib(e)?e.checked?"true":"false":e.value),e=l,e!==o?(t.setValue(e),!0):!1}function Wp(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function fy(e,t){var o=t.checked;return Zn({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:o??e._wrapperState.initialChecked})}function Sx(e,t){var o=t.defaultValue==null?"":t.defaultValue,l=t.checked!=null?t.checked:t.defaultChecked;o=ws(t.value!=null?t.value:o),e._wrapperState={initialChecked:l,initialValue:o,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function ab(e,t){t=t.checked,t!=null&&I_(e,"checked",t,!1)}function my(e,t){ab(e,t);var o=ws(t.value),l=t.type;if(o!=null)l==="number"?(o===0&&e.value===""||e.value!=o)&&(e.value=""+o):e.value!==""+o&&(e.value=""+o);else if(l==="submit"||l==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?gy(e,t.type,o):t.hasOwnProperty("defaultValue")&&gy(e,t.type,ws(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Tx(e,t,o){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var l=t.type;if(!(l!=="submit"&&l!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,o||t===e.value||(e.value=t),e.defaultValue=t}o=e.name,o!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,o!==""&&(e.name=o)}function gy(e,t,o){(t!=="number"||Wp(e.ownerDocument)!==e)&&(o==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+o&&(e.defaultValue=""+o))}var dh=Array.isArray;function xu(e,t,o,l){if(e=e.options,t){t={};for(var c=0;c<o.length;c++)t["$"+o[c]]=!0;for(o=0;o<e.length;o++)c=t.hasOwnProperty("$"+e[o].value),e[o].selected!==c&&(e[o].selected=c),c&&l&&(e[o].defaultSelected=!0)}else{for(o=""+ws(o),t=null,c=0;c<e.length;c++){if(e[c].value===o){e[c].selected=!0,l&&(e[c].defaultSelected=!0);return}t!==null||e[c].disabled||(t=e[c])}t!==null&&(t.selected=!0)}}function yy(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(je(91));return Zn({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Cx(e,t){var o=t.value;if(o==null){if(o=t.children,t=t.defaultValue,o!=null){if(t!=null)throw Error(je(92));if(dh(o)){if(1<o.length)throw Error(je(93));o=o[0]}t=o}t==null&&(t=""),o=t}e._wrapperState={initialValue:ws(o)}}function sb(e,t){var o=ws(t.value),l=ws(t.defaultValue);o!=null&&(o=""+o,o!==e.value&&(e.value=o),t.defaultValue==null&&e.defaultValue!==o&&(e.defaultValue=o)),l!=null&&(e.defaultValue=""+l)}function Ex(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function lb(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function _y(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?lb(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var pp,ub=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,o,l,c){MSApp.execUnsafeLocalFunction(function(){return e(t,o,l,c)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(pp=pp||document.createElement("div"),pp.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=pp.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function kh(e,t){if(t){var o=e.firstChild;if(o&&o===e.lastChild&&o.nodeType===3){o.nodeValue=t;return}}e.textContent=t}var gh={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},nI=["Webkit","ms","Moz","O"];Object.keys(gh).forEach(function(e){nI.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),gh[t]=gh[e]})});function cb(e,t,o){return t==null||typeof t=="boolean"||t===""?"":o||typeof t!="number"||t===0||gh.hasOwnProperty(e)&&gh[e]?(""+t).trim():t+"px"}function hb(e,t){e=e.style;for(var o in t)if(t.hasOwnProperty(o)){var l=o.indexOf("--")===0,c=cb(o,t[o],l);o==="float"&&(o="cssFloat"),l?e.setProperty(o,c):e[o]=c}}var rI=Zn({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function vy(e,t){if(t){if(rI[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(je(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(je(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(je(61))}if(t.style!=null&&typeof t.style!="object")throw Error(je(62))}}function xy(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var wy=null;function A_(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var by=null,wu=null,bu=null;function Ix(e){if(e=Yh(e)){if(typeof by!="function")throw Error(je(280));var t=e.stateNode;t&&(t=Nf(t),by(e.stateNode,e.type,t))}}function db(e){wu?bu?bu.push(e):bu=[e]:wu=e}function pb(){if(wu){var e=wu,t=bu;if(bu=wu=null,Ix(e),t)for(e=0;e<t.length;e++)Ix(t[e])}}function fb(e,t){return e(t)}function mb(){}var Tg=!1;function gb(e,t,o){if(Tg)return e(t,o);Tg=!0;try{return fb(e,t,o)}finally{Tg=!1,(wu!==null||bu!==null)&&(mb(),pb())}}function Mh(e,t){var o=e.stateNode;if(o===null)return null;var l=Nf(o);if(l===null)return null;o=l[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(l=!l.disabled)||(e=e.type,l=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!l;break e;default:e=!1}if(e)return null;if(o&&typeof o!="function")throw Error(je(231,t,typeof o));return o}var Sy=!1;if(za)try{var Kc={};Object.defineProperty(Kc,"passive",{get:function(){Sy=!0}}),window.addEventListener("test",Kc,Kc),window.removeEventListener("test",Kc,Kc)}catch{Sy=!1}function iI(e,t,o,l,c,m,x,u,C){var I=Array.prototype.slice.call(arguments,3);try{t.apply(o,I)}catch(D){this.onError(D)}}var yh=!1,Kp=null,Xp=!1,Ty=null,oI={onError:function(e){yh=!0,Kp=e}};function aI(e,t,o,l,c,m,x,u,C){yh=!1,Kp=null,iI.apply(oI,arguments)}function sI(e,t,o,l,c,m,x,u,C){if(aI.apply(this,arguments),yh){if(yh){var I=Kp;yh=!1,Kp=null}else throw Error(je(198));Xp||(Xp=!0,Ty=I)}}function hl(e){var t=e,o=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(o=t.return),e=t.return;while(e)}return t.tag===3?o:null}function yb(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function kx(e){if(hl(e)!==e)throw Error(je(188))}function lI(e){var t=e.alternate;if(!t){if(t=hl(e),t===null)throw Error(je(188));return t!==e?null:e}for(var o=e,l=t;;){var c=o.return;if(c===null)break;var m=c.alternate;if(m===null){if(l=c.return,l!==null){o=l;continue}break}if(c.child===m.child){for(m=c.child;m;){if(m===o)return kx(c),e;if(m===l)return kx(c),t;m=m.sibling}throw Error(je(188))}if(o.return!==l.return)o=c,l=m;else{for(var x=!1,u=c.child;u;){if(u===o){x=!0,o=c,l=m;break}if(u===l){x=!0,l=c,o=m;break}u=u.sibling}if(!x){for(u=m.child;u;){if(u===o){x=!0,o=m,l=c;break}if(u===l){x=!0,l=m,o=c;break}u=u.sibling}if(!x)throw Error(je(189))}}if(o.alternate!==l)throw Error(je(190))}if(o.tag!==3)throw Error(je(188));return o.stateNode.current===o?e:t}function _b(e){return e=lI(e),e!==null?vb(e):null}function vb(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=vb(e);if(t!==null)return t;e=e.sibling}return null}var xb=Yi.unstable_scheduleCallback,Mx=Yi.unstable_cancelCallback,uI=Yi.unstable_shouldYield,cI=Yi.unstable_requestPaint,hr=Yi.unstable_now,hI=Yi.unstable_getCurrentPriorityLevel,z_=Yi.unstable_ImmediatePriority,wb=Yi.unstable_UserBlockingPriority,Yp=Yi.unstable_NormalPriority,dI=Yi.unstable_LowPriority,bb=Yi.unstable_IdlePriority,Ff=null,aa=null;function pI(e){if(aa&&typeof aa.onCommitFiberRoot=="function")try{aa.onCommitFiberRoot(Ff,e,void 0,(e.current.flags&128)===128)}catch{}}var Uo=Math.clz32?Math.clz32:gI,fI=Math.log,mI=Math.LN2;function gI(e){return e>>>=0,e===0?32:31-(fI(e)/mI|0)|0}var fp=64,mp=4194304;function ph(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Jp(e,t){var o=e.pendingLanes;if(o===0)return 0;var l=0,c=e.suspendedLanes,m=e.pingedLanes,x=o&268435455;if(x!==0){var u=x&~c;u!==0?l=ph(u):(m&=x,m!==0&&(l=ph(m)))}else x=o&~c,x!==0?l=ph(x):m!==0&&(l=ph(m));if(l===0)return 0;if(t!==0&&t!==l&&!(t&c)&&(c=l&-l,m=t&-t,c>=m||c===16&&(m&4194240)!==0))return t;if(l&4&&(l|=o&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=l;0<t;)o=31-Uo(t),c=1<<o,l|=e[o],t&=~c;return l}function yI(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function _I(e,t){for(var o=e.suspendedLanes,l=e.pingedLanes,c=e.expirationTimes,m=e.pendingLanes;0<m;){var x=31-Uo(m),u=1<<x,C=c[x];C===-1?(!(u&o)||u&l)&&(c[x]=yI(u,t)):C<=t&&(e.expiredLanes|=u),m&=~u}}function Cy(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Sb(){var e=fp;return fp<<=1,!(fp&4194240)&&(fp=64),e}function Cg(e){for(var t=[],o=0;31>o;o++)t.push(e);return t}function Kh(e,t,o){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Uo(t),e[t]=o}function vI(e,t){var o=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var l=e.eventTimes;for(e=e.expirationTimes;0<o;){var c=31-Uo(o),m=1<<c;t[c]=0,l[c]=-1,e[c]=-1,o&=~m}}function D_(e,t){var o=e.entangledLanes|=t;for(e=e.entanglements;o;){var l=31-Uo(o),c=1<<l;c&t|e[l]&t&&(e[l]|=t),o&=~c}}var fn=0;function Tb(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var Cb,L_,Eb,Ib,kb,Ey=!1,gp=[],ps=null,fs=null,ms=null,Ph=new Map,Ah=new Map,us=[],xI="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Px(e,t){switch(e){case"focusin":case"focusout":ps=null;break;case"dragenter":case"dragleave":fs=null;break;case"mouseover":case"mouseout":ms=null;break;case"pointerover":case"pointerout":Ph.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ah.delete(t.pointerId)}}function Xc(e,t,o,l,c,m){return e===null||e.nativeEvent!==m?(e={blockedOn:t,domEventName:o,eventSystemFlags:l,nativeEvent:m,targetContainers:[c]},t!==null&&(t=Yh(t),t!==null&&L_(t)),e):(e.eventSystemFlags|=l,t=e.targetContainers,c!==null&&t.indexOf(c)===-1&&t.push(c),e)}function wI(e,t,o,l,c){switch(t){case"focusin":return ps=Xc(ps,e,t,o,l,c),!0;case"dragenter":return fs=Xc(fs,e,t,o,l,c),!0;case"mouseover":return ms=Xc(ms,e,t,o,l,c),!0;case"pointerover":var m=c.pointerId;return Ph.set(m,Xc(Ph.get(m)||null,e,t,o,l,c)),!0;case"gotpointercapture":return m=c.pointerId,Ah.set(m,Xc(Ah.get(m)||null,e,t,o,l,c)),!0}return!1}function Mb(e){var t=Ks(e.target);if(t!==null){var o=hl(t);if(o!==null){if(t=o.tag,t===13){if(t=yb(o),t!==null){e.blockedOn=t,kb(e.priority,function(){Eb(o)});return}}else if(t===3&&o.stateNode.current.memoizedState.isDehydrated){e.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Lp(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var o=Iy(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(o===null){o=e.nativeEvent;var l=new o.constructor(o.type,o);wy=l,o.target.dispatchEvent(l),wy=null}else return t=Yh(o),t!==null&&L_(t),e.blockedOn=o,!1;t.shift()}return!0}function Ax(e,t,o){Lp(e)&&o.delete(t)}function bI(){Ey=!1,ps!==null&&Lp(ps)&&(ps=null),fs!==null&&Lp(fs)&&(fs=null),ms!==null&&Lp(ms)&&(ms=null),Ph.forEach(Ax),Ah.forEach(Ax)}function Yc(e,t){e.blockedOn===t&&(e.blockedOn=null,Ey||(Ey=!0,Yi.unstable_scheduleCallback(Yi.unstable_NormalPriority,bI)))}function zh(e){function t(c){return Yc(c,e)}if(0<gp.length){Yc(gp[0],e);for(var o=1;o<gp.length;o++){var l=gp[o];l.blockedOn===e&&(l.blockedOn=null)}}for(ps!==null&&Yc(ps,e),fs!==null&&Yc(fs,e),ms!==null&&Yc(ms,e),Ph.forEach(t),Ah.forEach(t),o=0;o<us.length;o++)l=us[o],l.blockedOn===e&&(l.blockedOn=null);for(;0<us.length&&(o=us[0],o.blockedOn===null);)Mb(o),o.blockedOn===null&&us.shift()}var Su=Fa.ReactCurrentBatchConfig,Qp=!0;function SI(e,t,o,l){var c=fn,m=Su.transition;Su.transition=null;try{fn=1,R_(e,t,o,l)}finally{fn=c,Su.transition=m}}function TI(e,t,o,l){var c=fn,m=Su.transition;Su.transition=null;try{fn=4,R_(e,t,o,l)}finally{fn=c,Su.transition=m}}function R_(e,t,o,l){if(Qp){var c=Iy(e,t,o,l);if(c===null)Rg(e,t,l,ef,o),Px(e,l);else if(wI(c,e,t,o,l))l.stopPropagation();else if(Px(e,l),t&4&&-1<xI.indexOf(e)){for(;c!==null;){var m=Yh(c);if(m!==null&&Cb(m),m=Iy(e,t,o,l),m===null&&Rg(e,t,l,ef,o),m===c)break;c=m}c!==null&&l.stopPropagation()}else Rg(e,t,l,null,o)}}var ef=null;function Iy(e,t,o,l){if(ef=null,e=A_(l),e=Ks(e),e!==null)if(t=hl(e),t===null)e=null;else if(o=t.tag,o===13){if(e=yb(t),e!==null)return e;e=null}else if(o===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return ef=e,null}function Pb(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(hI()){case z_:return 1;case wb:return 4;case Yp:case dI:return 16;case bb:return 536870912;default:return 16}default:return 16}}var hs=null,F_=null,Rp=null;function Ab(){if(Rp)return Rp;var e,t=F_,o=t.length,l,c="value"in hs?hs.value:hs.textContent,m=c.length;for(e=0;e<o&&t[e]===c[e];e++);var x=o-e;for(l=1;l<=x&&t[o-l]===c[m-l];l++);return Rp=c.slice(e,1<l?1-l:void 0)}function Fp(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function yp(){return!0}function zx(){return!1}function Qi(e){function t(o,l,c,m,x){this._reactName=o,this._targetInst=c,this.type=l,this.nativeEvent=m,this.target=x,this.currentTarget=null;for(var u in e)e.hasOwnProperty(u)&&(o=e[u],this[u]=o?o(m):m[u]);return this.isDefaultPrevented=(m.defaultPrevented!=null?m.defaultPrevented:m.returnValue===!1)?yp:zx,this.isPropagationStopped=zx,this}return Zn(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=yp)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=yp)},persist:function(){},isPersistent:yp}),t}var Bu={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},O_=Qi(Bu),Xh=Zn({},Bu,{view:0,detail:0}),CI=Qi(Xh),Eg,Ig,Jc,Of=Zn({},Xh,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:B_,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Jc&&(Jc&&e.type==="mousemove"?(Eg=e.screenX-Jc.screenX,Ig=e.screenY-Jc.screenY):Ig=Eg=0,Jc=e),Eg)},movementY:function(e){return"movementY"in e?e.movementY:Ig}}),Dx=Qi(Of),EI=Zn({},Of,{dataTransfer:0}),II=Qi(EI),kI=Zn({},Xh,{relatedTarget:0}),kg=Qi(kI),MI=Zn({},Bu,{animationName:0,elapsedTime:0,pseudoElement:0}),PI=Qi(MI),AI=Zn({},Bu,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),zI=Qi(AI),DI=Zn({},Bu,{data:0}),Lx=Qi(DI),LI={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},RI={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},FI={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function OI(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=FI[e])?!!t[e]:!1}function B_(){return OI}var BI=Zn({},Xh,{key:function(e){if(e.key){var t=LI[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Fp(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?RI[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:B_,charCode:function(e){return e.type==="keypress"?Fp(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Fp(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),VI=Qi(BI),NI=Zn({},Of,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Rx=Qi(NI),UI=Zn({},Xh,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:B_}),$I=Qi(UI),jI=Zn({},Bu,{propertyName:0,elapsedTime:0,pseudoElement:0}),ZI=Qi(jI),qI=Zn({},Of,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),GI=Qi(qI),HI=[9,13,27,32],V_=za&&"CompositionEvent"in window,_h=null;za&&"documentMode"in document&&(_h=document.documentMode);var WI=za&&"TextEvent"in window&&!_h,zb=za&&(!V_||_h&&8<_h&&11>=_h),Fx=" ",Ox=!1;function Db(e,t){switch(e){case"keyup":return HI.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Lb(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var iu=!1;function KI(e,t){switch(e){case"compositionend":return Lb(t);case"keypress":return t.which!==32?null:(Ox=!0,Fx);case"textInput":return e=t.data,e===Fx&&Ox?null:e;default:return null}}function XI(e,t){if(iu)return e==="compositionend"||!V_&&Db(e,t)?(e=Ab(),Rp=F_=hs=null,iu=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return zb&&t.locale!=="ko"?null:t.data;default:return null}}var YI={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Bx(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!YI[e.type]:t==="textarea"}function Rb(e,t,o,l){db(l),t=tf(t,"onChange"),0<t.length&&(o=new O_("onChange","change",null,o,l),e.push({event:o,listeners:t}))}var vh=null,Dh=null;function JI(e){Gb(e,0)}function Bf(e){var t=su(e);if(ob(t))return e}function QI(e,t){if(e==="change")return t}var Fb=!1;if(za){var Mg;if(za){var Pg="oninput"in document;if(!Pg){var Vx=document.createElement("div");Vx.setAttribute("oninput","return;"),Pg=typeof Vx.oninput=="function"}Mg=Pg}else Mg=!1;Fb=Mg&&(!document.documentMode||9<document.documentMode)}function Nx(){vh&&(vh.detachEvent("onpropertychange",Ob),Dh=vh=null)}function Ob(e){if(e.propertyName==="value"&&Bf(Dh)){var t=[];Rb(t,Dh,e,A_(e)),gb(JI,t)}}function ek(e,t,o){e==="focusin"?(Nx(),vh=t,Dh=o,vh.attachEvent("onpropertychange",Ob)):e==="focusout"&&Nx()}function tk(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Bf(Dh)}function nk(e,t){if(e==="click")return Bf(t)}function rk(e,t){if(e==="input"||e==="change")return Bf(t)}function ik(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Zo=typeof Object.is=="function"?Object.is:ik;function Lh(e,t){if(Zo(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var o=Object.keys(e),l=Object.keys(t);if(o.length!==l.length)return!1;for(l=0;l<o.length;l++){var c=o[l];if(!uy.call(t,c)||!Zo(e[c],t[c]))return!1}return!0}function Ux(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function $x(e,t){var o=Ux(e);e=0;for(var l;o;){if(o.nodeType===3){if(l=e+o.textContent.length,e<=t&&l>=t)return{node:o,offset:t-e};e=l}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=Ux(o)}}function Bb(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Bb(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Vb(){for(var e=window,t=Wp();t instanceof e.HTMLIFrameElement;){try{var o=typeof t.contentWindow.location.href=="string"}catch{o=!1}if(o)e=t.contentWindow;else break;t=Wp(e.document)}return t}function N_(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function ok(e){var t=Vb(),o=e.focusedElem,l=e.selectionRange;if(t!==o&&o&&o.ownerDocument&&Bb(o.ownerDocument.documentElement,o)){if(l!==null&&N_(o)){if(t=l.start,e=l.end,e===void 0&&(e=t),"selectionStart"in o)o.selectionStart=t,o.selectionEnd=Math.min(e,o.value.length);else if(e=(t=o.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var c=o.textContent.length,m=Math.min(l.start,c);l=l.end===void 0?m:Math.min(l.end,c),!e.extend&&m>l&&(c=l,l=m,m=c),c=$x(o,m);var x=$x(o,l);c&&x&&(e.rangeCount!==1||e.anchorNode!==c.node||e.anchorOffset!==c.offset||e.focusNode!==x.node||e.focusOffset!==x.offset)&&(t=t.createRange(),t.setStart(c.node,c.offset),e.removeAllRanges(),m>l?(e.addRange(t),e.extend(x.node,x.offset)):(t.setEnd(x.node,x.offset),e.addRange(t)))}}for(t=[],e=o;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof o.focus=="function"&&o.focus(),o=0;o<t.length;o++)e=t[o],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var ak=za&&"documentMode"in document&&11>=document.documentMode,ou=null,ky=null,xh=null,My=!1;function jx(e,t,o){var l=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;My||ou==null||ou!==Wp(l)||(l=ou,"selectionStart"in l&&N_(l)?l={start:l.selectionStart,end:l.selectionEnd}:(l=(l.ownerDocument&&l.ownerDocument.defaultView||window).getSelection(),l={anchorNode:l.anchorNode,anchorOffset:l.anchorOffset,focusNode:l.focusNode,focusOffset:l.focusOffset}),xh&&Lh(xh,l)||(xh=l,l=tf(ky,"onSelect"),0<l.length&&(t=new O_("onSelect","select",null,t,o),e.push({event:t,listeners:l}),t.target=ou)))}function _p(e,t){var o={};return o[e.toLowerCase()]=t.toLowerCase(),o["Webkit"+e]="webkit"+t,o["Moz"+e]="moz"+t,o}var au={animationend:_p("Animation","AnimationEnd"),animationiteration:_p("Animation","AnimationIteration"),animationstart:_p("Animation","AnimationStart"),transitionend:_p("Transition","TransitionEnd")},Ag={},Nb={};za&&(Nb=document.createElement("div").style,"AnimationEvent"in window||(delete au.animationend.animation,delete au.animationiteration.animation,delete au.animationstart.animation),"TransitionEvent"in window||delete au.transitionend.transition);function Vf(e){if(Ag[e])return Ag[e];if(!au[e])return e;var t=au[e],o;for(o in t)if(t.hasOwnProperty(o)&&o in Nb)return Ag[e]=t[o];return e}var Ub=Vf("animationend"),$b=Vf("animationiteration"),jb=Vf("animationstart"),Zb=Vf("transitionend"),qb=new Map,Zx="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ss(e,t){qb.set(e,t),cl(t,[e])}for(var zg=0;zg<Zx.length;zg++){var Dg=Zx[zg],sk=Dg.toLowerCase(),lk=Dg[0].toUpperCase()+Dg.slice(1);Ss(sk,"on"+lk)}Ss(Ub,"onAnimationEnd");Ss($b,"onAnimationIteration");Ss(jb,"onAnimationStart");Ss("dblclick","onDoubleClick");Ss("focusin","onFocus");Ss("focusout","onBlur");Ss(Zb,"onTransitionEnd");Iu("onMouseEnter",["mouseout","mouseover"]);Iu("onMouseLeave",["mouseout","mouseover"]);Iu("onPointerEnter",["pointerout","pointerover"]);Iu("onPointerLeave",["pointerout","pointerover"]);cl("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));cl("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));cl("onBeforeInput",["compositionend","keypress","textInput","paste"]);cl("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));cl("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));cl("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var fh="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),uk=new Set("cancel close invalid load scroll toggle".split(" ").concat(fh));function qx(e,t,o){var l=e.type||"unknown-event";e.currentTarget=o,sI(l,t,void 0,e),e.currentTarget=null}function Gb(e,t){t=(t&4)!==0;for(var o=0;o<e.length;o++){var l=e[o],c=l.event;l=l.listeners;e:{var m=void 0;if(t)for(var x=l.length-1;0<=x;x--){var u=l[x],C=u.instance,I=u.currentTarget;if(u=u.listener,C!==m&&c.isPropagationStopped())break e;qx(c,u,I),m=C}else for(x=0;x<l.length;x++){if(u=l[x],C=u.instance,I=u.currentTarget,u=u.listener,C!==m&&c.isPropagationStopped())break e;qx(c,u,I),m=C}}}if(Xp)throw e=Ty,Xp=!1,Ty=null,e}function Dn(e,t){var o=t[Ly];o===void 0&&(o=t[Ly]=new Set);var l=e+"__bubble";o.has(l)||(Hb(t,e,2,!1),o.add(l))}function Lg(e,t,o){var l=0;t&&(l|=4),Hb(o,e,l,t)}var vp="_reactListening"+Math.random().toString(36).slice(2);function Rh(e){if(!e[vp]){e[vp]=!0,eb.forEach(function(o){o!=="selectionchange"&&(uk.has(o)||Lg(o,!1,e),Lg(o,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[vp]||(t[vp]=!0,Lg("selectionchange",!1,t))}}function Hb(e,t,o,l){switch(Pb(t)){case 1:var c=SI;break;case 4:c=TI;break;default:c=R_}o=c.bind(null,t,o,e),c=void 0,!Sy||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(c=!0),l?c!==void 0?e.addEventListener(t,o,{capture:!0,passive:c}):e.addEventListener(t,o,!0):c!==void 0?e.addEventListener(t,o,{passive:c}):e.addEventListener(t,o,!1)}function Rg(e,t,o,l,c){var m=l;if(!(t&1)&&!(t&2)&&l!==null)e:for(;;){if(l===null)return;var x=l.tag;if(x===3||x===4){var u=l.stateNode.containerInfo;if(u===c||u.nodeType===8&&u.parentNode===c)break;if(x===4)for(x=l.return;x!==null;){var C=x.tag;if((C===3||C===4)&&(C=x.stateNode.containerInfo,C===c||C.nodeType===8&&C.parentNode===c))return;x=x.return}for(;u!==null;){if(x=Ks(u),x===null)return;if(C=x.tag,C===5||C===6){l=m=x;continue e}u=u.parentNode}}l=l.return}gb(function(){var I=m,D=A_(o),O=[];e:{var U=qb.get(e);if(U!==void 0){var le=O_,ue=e;switch(e){case"keypress":if(Fp(o)===0)break e;case"keydown":case"keyup":le=VI;break;case"focusin":ue="focus",le=kg;break;case"focusout":ue="blur",le=kg;break;case"beforeblur":case"afterblur":le=kg;break;case"click":if(o.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":le=Dx;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":le=II;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":le=$I;break;case Ub:case $b:case jb:le=PI;break;case Zb:le=ZI;break;case"scroll":le=CI;break;case"wheel":le=GI;break;case"copy":case"cut":case"paste":le=zI;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":le=Rx}var ae=(t&4)!==0,oe=!ae&&e==="scroll",$=ae?U!==null?U+"Capture":null:U;ae=[];for(var G=I,ee;G!==null;){ee=G;var _e=ee.stateNode;if(ee.tag===5&&_e!==null&&(ee=_e,$!==null&&(_e=Mh(G,$),_e!=null&&ae.push(Fh(G,_e,ee)))),oe)break;G=G.return}0<ae.length&&(U=new le(U,ue,null,o,D),O.push({event:U,listeners:ae}))}}if(!(t&7)){e:{if(U=e==="mouseover"||e==="pointerover",le=e==="mouseout"||e==="pointerout",U&&o!==wy&&(ue=o.relatedTarget||o.fromElement)&&(Ks(ue)||ue[Da]))break e;if((le||U)&&(U=D.window===D?D:(U=D.ownerDocument)?U.defaultView||U.parentWindow:window,le?(ue=o.relatedTarget||o.toElement,le=I,ue=ue?Ks(ue):null,ue!==null&&(oe=hl(ue),ue!==oe||ue.tag!==5&&ue.tag!==6)&&(ue=null)):(le=null,ue=I),le!==ue)){if(ae=Dx,_e="onMouseLeave",$="onMouseEnter",G="mouse",(e==="pointerout"||e==="pointerover")&&(ae=Rx,_e="onPointerLeave",$="onPointerEnter",G="pointer"),oe=le==null?U:su(le),ee=ue==null?U:su(ue),U=new ae(_e,G+"leave",le,o,D),U.target=oe,U.relatedTarget=ee,_e=null,Ks(D)===I&&(ae=new ae($,G+"enter",ue,o,D),ae.target=ee,ae.relatedTarget=oe,_e=ae),oe=_e,le&&ue)t:{for(ae=le,$=ue,G=0,ee=ae;ee;ee=Ql(ee))G++;for(ee=0,_e=$;_e;_e=Ql(_e))ee++;for(;0<G-ee;)ae=Ql(ae),G--;for(;0<ee-G;)$=Ql($),ee--;for(;G--;){if(ae===$||$!==null&&ae===$.alternate)break t;ae=Ql(ae),$=Ql($)}ae=null}else ae=null;le!==null&&Gx(O,U,le,ae,!1),ue!==null&&oe!==null&&Gx(O,oe,ue,ae,!0)}}e:{if(U=I?su(I):window,le=U.nodeName&&U.nodeName.toLowerCase(),le==="select"||le==="input"&&U.type==="file")var Ce=QI;else if(Bx(U))if(Fb)Ce=rk;else{Ce=tk;var de=ek}else(le=U.nodeName)&&le.toLowerCase()==="input"&&(U.type==="checkbox"||U.type==="radio")&&(Ce=nk);if(Ce&&(Ce=Ce(e,I))){Rb(O,Ce,o,D);break e}de&&de(e,U,I),e==="focusout"&&(de=U._wrapperState)&&de.controlled&&U.type==="number"&&gy(U,"number",U.value)}switch(de=I?su(I):window,e){case"focusin":(Bx(de)||de.contentEditable==="true")&&(ou=de,ky=I,xh=null);break;case"focusout":xh=ky=ou=null;break;case"mousedown":My=!0;break;case"contextmenu":case"mouseup":case"dragend":My=!1,jx(O,o,D);break;case"selectionchange":if(ak)break;case"keydown":case"keyup":jx(O,o,D)}var be;if(V_)e:{switch(e){case"compositionstart":var Me="onCompositionStart";break e;case"compositionend":Me="onCompositionEnd";break e;case"compositionupdate":Me="onCompositionUpdate";break e}Me=void 0}else iu?Db(e,o)&&(Me="onCompositionEnd"):e==="keydown"&&o.keyCode===229&&(Me="onCompositionStart");Me&&(zb&&o.locale!=="ko"&&(iu||Me!=="onCompositionStart"?Me==="onCompositionEnd"&&iu&&(be=Ab()):(hs=D,F_="value"in hs?hs.value:hs.textContent,iu=!0)),de=tf(I,Me),0<de.length&&(Me=new Lx(Me,e,null,o,D),O.push({event:Me,listeners:de}),be?Me.data=be:(be=Lb(o),be!==null&&(Me.data=be)))),(be=WI?KI(e,o):XI(e,o))&&(I=tf(I,"onBeforeInput"),0<I.length&&(D=new Lx("onBeforeInput","beforeinput",null,o,D),O.push({event:D,listeners:I}),D.data=be))}Gb(O,t)})}function Fh(e,t,o){return{instance:e,listener:t,currentTarget:o}}function tf(e,t){for(var o=t+"Capture",l=[];e!==null;){var c=e,m=c.stateNode;c.tag===5&&m!==null&&(c=m,m=Mh(e,o),m!=null&&l.unshift(Fh(e,m,c)),m=Mh(e,t),m!=null&&l.push(Fh(e,m,c))),e=e.return}return l}function Ql(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Gx(e,t,o,l,c){for(var m=t._reactName,x=[];o!==null&&o!==l;){var u=o,C=u.alternate,I=u.stateNode;if(C!==null&&C===l)break;u.tag===5&&I!==null&&(u=I,c?(C=Mh(o,m),C!=null&&x.unshift(Fh(o,C,u))):c||(C=Mh(o,m),C!=null&&x.push(Fh(o,C,u)))),o=o.return}x.length!==0&&e.push({event:t,listeners:x})}var ck=/\r\n?/g,hk=/\u0000|\uFFFD/g;function Hx(e){return(typeof e=="string"?e:""+e).replace(ck,`
`).replace(hk,"")}function xp(e,t,o){if(t=Hx(t),Hx(e)!==t&&o)throw Error(je(425))}function nf(){}var Py=null,Ay=null;function zy(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Dy=typeof setTimeout=="function"?setTimeout:void 0,dk=typeof clearTimeout=="function"?clearTimeout:void 0,Wx=typeof Promise=="function"?Promise:void 0,pk=typeof queueMicrotask=="function"?queueMicrotask:typeof Wx<"u"?function(e){return Wx.resolve(null).then(e).catch(fk)}:Dy;function fk(e){setTimeout(function(){throw e})}function Fg(e,t){var o=t,l=0;do{var c=o.nextSibling;if(e.removeChild(o),c&&c.nodeType===8)if(o=c.data,o==="/$"){if(l===0){e.removeChild(c),zh(t);return}l--}else o!=="$"&&o!=="$?"&&o!=="$!"||l++;o=c}while(o);zh(t)}function gs(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Kx(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var o=e.data;if(o==="$"||o==="$!"||o==="$?"){if(t===0)return e;t--}else o==="/$"&&t++}e=e.previousSibling}return null}var Vu=Math.random().toString(36).slice(2),oa="__reactFiber$"+Vu,Oh="__reactProps$"+Vu,Da="__reactContainer$"+Vu,Ly="__reactEvents$"+Vu,mk="__reactListeners$"+Vu,gk="__reactHandles$"+Vu;function Ks(e){var t=e[oa];if(t)return t;for(var o=e.parentNode;o;){if(t=o[Da]||o[oa]){if(o=t.alternate,t.child!==null||o!==null&&o.child!==null)for(e=Kx(e);e!==null;){if(o=e[oa])return o;e=Kx(e)}return t}e=o,o=e.parentNode}return null}function Yh(e){return e=e[oa]||e[Da],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function su(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(je(33))}function Nf(e){return e[Oh]||null}var Ry=[],lu=-1;function Ts(e){return{current:e}}function Ln(e){0>lu||(e.current=Ry[lu],Ry[lu]=null,lu--)}function kn(e,t){lu++,Ry[lu]=e.current,e.current=t}var bs={},ri=Ts(bs),Li=Ts(!1),rl=bs;function ku(e,t){var o=e.type.contextTypes;if(!o)return bs;var l=e.stateNode;if(l&&l.__reactInternalMemoizedUnmaskedChildContext===t)return l.__reactInternalMemoizedMaskedChildContext;var c={},m;for(m in o)c[m]=t[m];return l&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=c),c}function Ri(e){return e=e.childContextTypes,e!=null}function rf(){Ln(Li),Ln(ri)}function Xx(e,t,o){if(ri.current!==bs)throw Error(je(168));kn(ri,t),kn(Li,o)}function Wb(e,t,o){var l=e.stateNode;if(t=t.childContextTypes,typeof l.getChildContext!="function")return o;l=l.getChildContext();for(var c in l)if(!(c in t))throw Error(je(108,eI(e)||"Unknown",c));return Zn({},o,l)}function of(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||bs,rl=ri.current,kn(ri,e),kn(Li,Li.current),!0}function Yx(e,t,o){var l=e.stateNode;if(!l)throw Error(je(169));o?(e=Wb(e,t,rl),l.__reactInternalMemoizedMergedChildContext=e,Ln(Li),Ln(ri),kn(ri,e)):Ln(Li),kn(Li,o)}var Ia=null,Uf=!1,Og=!1;function Kb(e){Ia===null?Ia=[e]:Ia.push(e)}function yk(e){Uf=!0,Kb(e)}function Cs(){if(!Og&&Ia!==null){Og=!0;var e=0,t=fn;try{var o=Ia;for(fn=1;e<o.length;e++){var l=o[e];do l=l(!0);while(l!==null)}Ia=null,Uf=!1}catch(c){throw Ia!==null&&(Ia=Ia.slice(e+1)),xb(z_,Cs),c}finally{fn=t,Og=!1}}return null}var uu=[],cu=0,af=null,sf=0,mo=[],go=0,il=null,ka=1,Ma="";function Hs(e,t){uu[cu++]=sf,uu[cu++]=af,af=e,sf=t}function Xb(e,t,o){mo[go++]=ka,mo[go++]=Ma,mo[go++]=il,il=e;var l=ka;e=Ma;var c=32-Uo(l)-1;l&=~(1<<c),o+=1;var m=32-Uo(t)+c;if(30<m){var x=c-c%5;m=(l&(1<<x)-1).toString(32),l>>=x,c-=x,ka=1<<32-Uo(t)+c|o<<c|l,Ma=m+e}else ka=1<<m|o<<c|l,Ma=e}function U_(e){e.return!==null&&(Hs(e,1),Xb(e,1,0))}function $_(e){for(;e===af;)af=uu[--cu],uu[cu]=null,sf=uu[--cu],uu[cu]=null;for(;e===il;)il=mo[--go],mo[go]=null,Ma=mo[--go],mo[go]=null,ka=mo[--go],mo[go]=null}var Ki=null,Wi=null,Bn=!1,No=null;function Yb(e,t){var o=yo(5,null,null,0);o.elementType="DELETED",o.stateNode=t,o.return=e,t=e.deletions,t===null?(e.deletions=[o],e.flags|=16):t.push(o)}function Jx(e,t){switch(e.tag){case 5:var o=e.type;return t=t.nodeType!==1||o.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Ki=e,Wi=gs(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Ki=e,Wi=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(o=il!==null?{id:ka,overflow:Ma}:null,e.memoizedState={dehydrated:t,treeContext:o,retryLane:1073741824},o=yo(18,null,null,0),o.stateNode=t,o.return=e,e.child=o,Ki=e,Wi=null,!0):!1;default:return!1}}function Fy(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Oy(e){if(Bn){var t=Wi;if(t){var o=t;if(!Jx(e,t)){if(Fy(e))throw Error(je(418));t=gs(o.nextSibling);var l=Ki;t&&Jx(e,t)?Yb(l,o):(e.flags=e.flags&-4097|2,Bn=!1,Ki=e)}}else{if(Fy(e))throw Error(je(418));e.flags=e.flags&-4097|2,Bn=!1,Ki=e}}}function Qx(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Ki=e}function wp(e){if(e!==Ki)return!1;if(!Bn)return Qx(e),Bn=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!zy(e.type,e.memoizedProps)),t&&(t=Wi)){if(Fy(e))throw Jb(),Error(je(418));for(;t;)Yb(e,t),t=gs(t.nextSibling)}if(Qx(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(je(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var o=e.data;if(o==="/$"){if(t===0){Wi=gs(e.nextSibling);break e}t--}else o!=="$"&&o!=="$!"&&o!=="$?"||t++}e=e.nextSibling}Wi=null}}else Wi=Ki?gs(e.stateNode.nextSibling):null;return!0}function Jb(){for(var e=Wi;e;)e=gs(e.nextSibling)}function Mu(){Wi=Ki=null,Bn=!1}function j_(e){No===null?No=[e]:No.push(e)}var _k=Fa.ReactCurrentBatchConfig;function Oo(e,t){if(e&&e.defaultProps){t=Zn({},t),e=e.defaultProps;for(var o in e)t[o]===void 0&&(t[o]=e[o]);return t}return t}var lf=Ts(null),uf=null,hu=null,Z_=null;function q_(){Z_=hu=uf=null}function G_(e){var t=lf.current;Ln(lf),e._currentValue=t}function By(e,t,o){for(;e!==null;){var l=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,l!==null&&(l.childLanes|=t)):l!==null&&(l.childLanes&t)!==t&&(l.childLanes|=t),e===o)break;e=e.return}}function Tu(e,t){uf=e,Z_=hu=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Di=!0),e.firstContext=null)}function vo(e){var t=e._currentValue;if(Z_!==e)if(e={context:e,memoizedValue:t,next:null},hu===null){if(uf===null)throw Error(je(308));hu=e,uf.dependencies={lanes:0,firstContext:e}}else hu=hu.next=e;return t}var Xs=null;function H_(e){Xs===null?Xs=[e]:Xs.push(e)}function Qb(e,t,o,l){var c=t.interleaved;return c===null?(o.next=o,H_(t)):(o.next=c.next,c.next=o),t.interleaved=o,La(e,l)}function La(e,t){e.lanes|=t;var o=e.alternate;for(o!==null&&(o.lanes|=t),o=e,e=e.return;e!==null;)e.childLanes|=t,o=e.alternate,o!==null&&(o.childLanes|=t),o=e,e=e.return;return o.tag===3?o.stateNode:null}var ss=!1;function W_(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function e2(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Pa(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function ys(e,t,o){var l=e.updateQueue;if(l===null)return null;if(l=l.shared,rn&2){var c=l.pending;return c===null?t.next=t:(t.next=c.next,c.next=t),l.pending=t,La(e,o)}return c=l.interleaved,c===null?(t.next=t,H_(l)):(t.next=c.next,c.next=t),l.interleaved=t,La(e,o)}function Op(e,t,o){if(t=t.updateQueue,t!==null&&(t=t.shared,(o&4194240)!==0)){var l=t.lanes;l&=e.pendingLanes,o|=l,t.lanes=o,D_(e,o)}}function e1(e,t){var o=e.updateQueue,l=e.alternate;if(l!==null&&(l=l.updateQueue,o===l)){var c=null,m=null;if(o=o.firstBaseUpdate,o!==null){do{var x={eventTime:o.eventTime,lane:o.lane,tag:o.tag,payload:o.payload,callback:o.callback,next:null};m===null?c=m=x:m=m.next=x,o=o.next}while(o!==null);m===null?c=m=t:m=m.next=t}else c=m=t;o={baseState:l.baseState,firstBaseUpdate:c,lastBaseUpdate:m,shared:l.shared,effects:l.effects},e.updateQueue=o;return}e=o.lastBaseUpdate,e===null?o.firstBaseUpdate=t:e.next=t,o.lastBaseUpdate=t}function cf(e,t,o,l){var c=e.updateQueue;ss=!1;var m=c.firstBaseUpdate,x=c.lastBaseUpdate,u=c.shared.pending;if(u!==null){c.shared.pending=null;var C=u,I=C.next;C.next=null,x===null?m=I:x.next=I,x=C;var D=e.alternate;D!==null&&(D=D.updateQueue,u=D.lastBaseUpdate,u!==x&&(u===null?D.firstBaseUpdate=I:u.next=I,D.lastBaseUpdate=C))}if(m!==null){var O=c.baseState;x=0,D=I=C=null,u=m;do{var U=u.lane,le=u.eventTime;if((l&U)===U){D!==null&&(D=D.next={eventTime:le,lane:0,tag:u.tag,payload:u.payload,callback:u.callback,next:null});e:{var ue=e,ae=u;switch(U=t,le=o,ae.tag){case 1:if(ue=ae.payload,typeof ue=="function"){O=ue.call(le,O,U);break e}O=ue;break e;case 3:ue.flags=ue.flags&-65537|128;case 0:if(ue=ae.payload,U=typeof ue=="function"?ue.call(le,O,U):ue,U==null)break e;O=Zn({},O,U);break e;case 2:ss=!0}}u.callback!==null&&u.lane!==0&&(e.flags|=64,U=c.effects,U===null?c.effects=[u]:U.push(u))}else le={eventTime:le,lane:U,tag:u.tag,payload:u.payload,callback:u.callback,next:null},D===null?(I=D=le,C=O):D=D.next=le,x|=U;if(u=u.next,u===null){if(u=c.shared.pending,u===null)break;U=u,u=U.next,U.next=null,c.lastBaseUpdate=U,c.shared.pending=null}}while(!0);if(D===null&&(C=O),c.baseState=C,c.firstBaseUpdate=I,c.lastBaseUpdate=D,t=c.shared.interleaved,t!==null){c=t;do x|=c.lane,c=c.next;while(c!==t)}else m===null&&(c.shared.lanes=0);al|=x,e.lanes=x,e.memoizedState=O}}function t1(e,t,o){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var l=e[t],c=l.callback;if(c!==null){if(l.callback=null,l=o,typeof c!="function")throw Error(je(191,c));c.call(l)}}}var t2=new Qw.Component().refs;function Vy(e,t,o,l){t=e.memoizedState,o=o(l,t),o=o==null?t:Zn({},t,o),e.memoizedState=o,e.lanes===0&&(e.updateQueue.baseState=o)}var $f={isMounted:function(e){return(e=e._reactInternals)?hl(e)===e:!1},enqueueSetState:function(e,t,o){e=e._reactInternals;var l=_i(),c=vs(e),m=Pa(l,c);m.payload=t,o!=null&&(m.callback=o),t=ys(e,m,c),t!==null&&($o(t,e,c,l),Op(t,e,c))},enqueueReplaceState:function(e,t,o){e=e._reactInternals;var l=_i(),c=vs(e),m=Pa(l,c);m.tag=1,m.payload=t,o!=null&&(m.callback=o),t=ys(e,m,c),t!==null&&($o(t,e,c,l),Op(t,e,c))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var o=_i(),l=vs(e),c=Pa(o,l);c.tag=2,t!=null&&(c.callback=t),t=ys(e,c,l),t!==null&&($o(t,e,l,o),Op(t,e,l))}};function n1(e,t,o,l,c,m,x){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(l,m,x):t.prototype&&t.prototype.isPureReactComponent?!Lh(o,l)||!Lh(c,m):!0}function n2(e,t,o){var l=!1,c=bs,m=t.contextType;return typeof m=="object"&&m!==null?m=vo(m):(c=Ri(t)?rl:ri.current,l=t.contextTypes,m=(l=l!=null)?ku(e,c):bs),t=new t(o,m),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=$f,e.stateNode=t,t._reactInternals=e,l&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=c,e.__reactInternalMemoizedMaskedChildContext=m),t}function r1(e,t,o,l){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(o,l),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(o,l),t.state!==e&&$f.enqueueReplaceState(t,t.state,null)}function Ny(e,t,o,l){var c=e.stateNode;c.props=o,c.state=e.memoizedState,c.refs=t2,W_(e);var m=t.contextType;typeof m=="object"&&m!==null?c.context=vo(m):(m=Ri(t)?rl:ri.current,c.context=ku(e,m)),c.state=e.memoizedState,m=t.getDerivedStateFromProps,typeof m=="function"&&(Vy(e,t,m,o),c.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof c.getSnapshotBeforeUpdate=="function"||typeof c.UNSAFE_componentWillMount!="function"&&typeof c.componentWillMount!="function"||(t=c.state,typeof c.componentWillMount=="function"&&c.componentWillMount(),typeof c.UNSAFE_componentWillMount=="function"&&c.UNSAFE_componentWillMount(),t!==c.state&&$f.enqueueReplaceState(c,c.state,null),cf(e,o,c,l),c.state=e.memoizedState),typeof c.componentDidMount=="function"&&(e.flags|=4194308)}function Qc(e,t,o){if(e=o.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(o._owner){if(o=o._owner,o){if(o.tag!==1)throw Error(je(309));var l=o.stateNode}if(!l)throw Error(je(147,e));var c=l,m=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===m?t.ref:(t=function(x){var u=c.refs;u===t2&&(u=c.refs={}),x===null?delete u[m]:u[m]=x},t._stringRef=m,t)}if(typeof e!="string")throw Error(je(284));if(!o._owner)throw Error(je(290,e))}return e}function bp(e,t){throw e=Object.prototype.toString.call(t),Error(je(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function i1(e){var t=e._init;return t(e._payload)}function r2(e){function t($,G){if(e){var ee=$.deletions;ee===null?($.deletions=[G],$.flags|=16):ee.push(G)}}function o($,G){if(!e)return null;for(;G!==null;)t($,G),G=G.sibling;return null}function l($,G){for($=new Map;G!==null;)G.key!==null?$.set(G.key,G):$.set(G.index,G),G=G.sibling;return $}function c($,G){return $=xs($,G),$.index=0,$.sibling=null,$}function m($,G,ee){return $.index=ee,e?(ee=$.alternate,ee!==null?(ee=ee.index,ee<G?($.flags|=2,G):ee):($.flags|=2,G)):($.flags|=1048576,G)}function x($){return e&&$.alternate===null&&($.flags|=2),$}function u($,G,ee,_e){return G===null||G.tag!==6?(G=Zg(ee,$.mode,_e),G.return=$,G):(G=c(G,ee),G.return=$,G)}function C($,G,ee,_e){var Ce=ee.type;return Ce===ru?D($,G,ee.props.children,_e,ee.key):G!==null&&(G.elementType===Ce||typeof Ce=="object"&&Ce!==null&&Ce.$$typeof===as&&i1(Ce)===G.type)?(_e=c(G,ee.props),_e.ref=Qc($,G,ee),_e.return=$,_e):(_e=jp(ee.type,ee.key,ee.props,null,$.mode,_e),_e.ref=Qc($,G,ee),_e.return=$,_e)}function I($,G,ee,_e){return G===null||G.tag!==4||G.stateNode.containerInfo!==ee.containerInfo||G.stateNode.implementation!==ee.implementation?(G=qg(ee,$.mode,_e),G.return=$,G):(G=c(G,ee.children||[]),G.return=$,G)}function D($,G,ee,_e,Ce){return G===null||G.tag!==7?(G=tl(ee,$.mode,_e,Ce),G.return=$,G):(G=c(G,ee),G.return=$,G)}function O($,G,ee){if(typeof G=="string"&&G!==""||typeof G=="number")return G=Zg(""+G,$.mode,ee),G.return=$,G;if(typeof G=="object"&&G!==null){switch(G.$$typeof){case hp:return ee=jp(G.type,G.key,G.props,null,$.mode,ee),ee.ref=Qc($,null,G),ee.return=$,ee;case nu:return G=qg(G,$.mode,ee),G.return=$,G;case as:var _e=G._init;return O($,_e(G._payload),ee)}if(dh(G)||Wc(G))return G=tl(G,$.mode,ee,null),G.return=$,G;bp($,G)}return null}function U($,G,ee,_e){var Ce=G!==null?G.key:null;if(typeof ee=="string"&&ee!==""||typeof ee=="number")return Ce!==null?null:u($,G,""+ee,_e);if(typeof ee=="object"&&ee!==null){switch(ee.$$typeof){case hp:return ee.key===Ce?C($,G,ee,_e):null;case nu:return ee.key===Ce?I($,G,ee,_e):null;case as:return Ce=ee._init,U($,G,Ce(ee._payload),_e)}if(dh(ee)||Wc(ee))return Ce!==null?null:D($,G,ee,_e,null);bp($,ee)}return null}function le($,G,ee,_e,Ce){if(typeof _e=="string"&&_e!==""||typeof _e=="number")return $=$.get(ee)||null,u(G,$,""+_e,Ce);if(typeof _e=="object"&&_e!==null){switch(_e.$$typeof){case hp:return $=$.get(_e.key===null?ee:_e.key)||null,C(G,$,_e,Ce);case nu:return $=$.get(_e.key===null?ee:_e.key)||null,I(G,$,_e,Ce);case as:var de=_e._init;return le($,G,ee,de(_e._payload),Ce)}if(dh(_e)||Wc(_e))return $=$.get(ee)||null,D(G,$,_e,Ce,null);bp(G,_e)}return null}function ue($,G,ee,_e){for(var Ce=null,de=null,be=G,Me=G=0,Ze=null;be!==null&&Me<ee.length;Me++){be.index>Me?(Ze=be,be=null):Ze=be.sibling;var Oe=U($,be,ee[Me],_e);if(Oe===null){be===null&&(be=Ze);break}e&&be&&Oe.alternate===null&&t($,be),G=m(Oe,G,Me),de===null?Ce=Oe:de.sibling=Oe,de=Oe,be=Ze}if(Me===ee.length)return o($,be),Bn&&Hs($,Me),Ce;if(be===null){for(;Me<ee.length;Me++)be=O($,ee[Me],_e),be!==null&&(G=m(be,G,Me),de===null?Ce=be:de.sibling=be,de=be);return Bn&&Hs($,Me),Ce}for(be=l($,be);Me<ee.length;Me++)Ze=le(be,$,Me,ee[Me],_e),Ze!==null&&(e&&Ze.alternate!==null&&be.delete(Ze.key===null?Me:Ze.key),G=m(Ze,G,Me),de===null?Ce=Ze:de.sibling=Ze,de=Ze);return e&&be.forEach(function(ft){return t($,ft)}),Bn&&Hs($,Me),Ce}function ae($,G,ee,_e){var Ce=Wc(ee);if(typeof Ce!="function")throw Error(je(150));if(ee=Ce.call(ee),ee==null)throw Error(je(151));for(var de=Ce=null,be=G,Me=G=0,Ze=null,Oe=ee.next();be!==null&&!Oe.done;Me++,Oe=ee.next()){be.index>Me?(Ze=be,be=null):Ze=be.sibling;var ft=U($,be,Oe.value,_e);if(ft===null){be===null&&(be=Ze);break}e&&be&&ft.alternate===null&&t($,be),G=m(ft,G,Me),de===null?Ce=ft:de.sibling=ft,de=ft,be=Ze}if(Oe.done)return o($,be),Bn&&Hs($,Me),Ce;if(be===null){for(;!Oe.done;Me++,Oe=ee.next())Oe=O($,Oe.value,_e),Oe!==null&&(G=m(Oe,G,Me),de===null?Ce=Oe:de.sibling=Oe,de=Oe);return Bn&&Hs($,Me),Ce}for(be=l($,be);!Oe.done;Me++,Oe=ee.next())Oe=le(be,$,Me,Oe.value,_e),Oe!==null&&(e&&Oe.alternate!==null&&be.delete(Oe.key===null?Me:Oe.key),G=m(Oe,G,Me),de===null?Ce=Oe:de.sibling=Oe,de=Oe);return e&&be.forEach(function(bt){return t($,bt)}),Bn&&Hs($,Me),Ce}function oe($,G,ee,_e){if(typeof ee=="object"&&ee!==null&&ee.type===ru&&ee.key===null&&(ee=ee.props.children),typeof ee=="object"&&ee!==null){switch(ee.$$typeof){case hp:e:{for(var Ce=ee.key,de=G;de!==null;){if(de.key===Ce){if(Ce=ee.type,Ce===ru){if(de.tag===7){o($,de.sibling),G=c(de,ee.props.children),G.return=$,$=G;break e}}else if(de.elementType===Ce||typeof Ce=="object"&&Ce!==null&&Ce.$$typeof===as&&i1(Ce)===de.type){o($,de.sibling),G=c(de,ee.props),G.ref=Qc($,de,ee),G.return=$,$=G;break e}o($,de);break}else t($,de);de=de.sibling}ee.type===ru?(G=tl(ee.props.children,$.mode,_e,ee.key),G.return=$,$=G):(_e=jp(ee.type,ee.key,ee.props,null,$.mode,_e),_e.ref=Qc($,G,ee),_e.return=$,$=_e)}return x($);case nu:e:{for(de=ee.key;G!==null;){if(G.key===de)if(G.tag===4&&G.stateNode.containerInfo===ee.containerInfo&&G.stateNode.implementation===ee.implementation){o($,G.sibling),G=c(G,ee.children||[]),G.return=$,$=G;break e}else{o($,G);break}else t($,G);G=G.sibling}G=qg(ee,$.mode,_e),G.return=$,$=G}return x($);case as:return de=ee._init,oe($,G,de(ee._payload),_e)}if(dh(ee))return ue($,G,ee,_e);if(Wc(ee))return ae($,G,ee,_e);bp($,ee)}return typeof ee=="string"&&ee!==""||typeof ee=="number"?(ee=""+ee,G!==null&&G.tag===6?(o($,G.sibling),G=c(G,ee),G.return=$,$=G):(o($,G),G=Zg(ee,$.mode,_e),G.return=$,$=G),x($)):o($,G)}return oe}var Pu=r2(!0),i2=r2(!1),Jh={},sa=Ts(Jh),Bh=Ts(Jh),Vh=Ts(Jh);function Ys(e){if(e===Jh)throw Error(je(174));return e}function K_(e,t){switch(kn(Vh,t),kn(Bh,e),kn(sa,Jh),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:_y(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=_y(t,e)}Ln(sa),kn(sa,t)}function Au(){Ln(sa),Ln(Bh),Ln(Vh)}function o2(e){Ys(Vh.current);var t=Ys(sa.current),o=_y(t,e.type);t!==o&&(kn(Bh,e),kn(sa,o))}function X_(e){Bh.current===e&&(Ln(sa),Ln(Bh))}var $n=Ts(0);function hf(e){for(var t=e;t!==null;){if(t.tag===13){var o=t.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||o.data==="$?"||o.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Bg=[];function Y_(){for(var e=0;e<Bg.length;e++)Bg[e]._workInProgressVersionPrimary=null;Bg.length=0}var Bp=Fa.ReactCurrentDispatcher,Vg=Fa.ReactCurrentBatchConfig,ol=0,jn=null,vr=null,kr=null,df=!1,wh=!1,Nh=0,vk=0;function Qr(){throw Error(je(321))}function J_(e,t){if(t===null)return!1;for(var o=0;o<t.length&&o<e.length;o++)if(!Zo(e[o],t[o]))return!1;return!0}function Q_(e,t,o,l,c,m){if(ol=m,jn=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Bp.current=e===null||e.memoizedState===null?Sk:Tk,e=o(l,c),wh){m=0;do{if(wh=!1,Nh=0,25<=m)throw Error(je(301));m+=1,kr=vr=null,t.updateQueue=null,Bp.current=Ck,e=o(l,c)}while(wh)}if(Bp.current=pf,t=vr!==null&&vr.next!==null,ol=0,kr=vr=jn=null,df=!1,t)throw Error(je(300));return e}function ev(){var e=Nh!==0;return Nh=0,e}function na(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return kr===null?jn.memoizedState=kr=e:kr=kr.next=e,kr}function xo(){if(vr===null){var e=jn.alternate;e=e!==null?e.memoizedState:null}else e=vr.next;var t=kr===null?jn.memoizedState:kr.next;if(t!==null)kr=t,vr=e;else{if(e===null)throw Error(je(310));vr=e,e={memoizedState:vr.memoizedState,baseState:vr.baseState,baseQueue:vr.baseQueue,queue:vr.queue,next:null},kr===null?jn.memoizedState=kr=e:kr=kr.next=e}return kr}function Uh(e,t){return typeof t=="function"?t(e):t}function Ng(e){var t=xo(),o=t.queue;if(o===null)throw Error(je(311));o.lastRenderedReducer=e;var l=vr,c=l.baseQueue,m=o.pending;if(m!==null){if(c!==null){var x=c.next;c.next=m.next,m.next=x}l.baseQueue=c=m,o.pending=null}if(c!==null){m=c.next,l=l.baseState;var u=x=null,C=null,I=m;do{var D=I.lane;if((ol&D)===D)C!==null&&(C=C.next={lane:0,action:I.action,hasEagerState:I.hasEagerState,eagerState:I.eagerState,next:null}),l=I.hasEagerState?I.eagerState:e(l,I.action);else{var O={lane:D,action:I.action,hasEagerState:I.hasEagerState,eagerState:I.eagerState,next:null};C===null?(u=C=O,x=l):C=C.next=O,jn.lanes|=D,al|=D}I=I.next}while(I!==null&&I!==m);C===null?x=l:C.next=u,Zo(l,t.memoizedState)||(Di=!0),t.memoizedState=l,t.baseState=x,t.baseQueue=C,o.lastRenderedState=l}if(e=o.interleaved,e!==null){c=e;do m=c.lane,jn.lanes|=m,al|=m,c=c.next;while(c!==e)}else c===null&&(o.lanes=0);return[t.memoizedState,o.dispatch]}function Ug(e){var t=xo(),o=t.queue;if(o===null)throw Error(je(311));o.lastRenderedReducer=e;var l=o.dispatch,c=o.pending,m=t.memoizedState;if(c!==null){o.pending=null;var x=c=c.next;do m=e(m,x.action),x=x.next;while(x!==c);Zo(m,t.memoizedState)||(Di=!0),t.memoizedState=m,t.baseQueue===null&&(t.baseState=m),o.lastRenderedState=m}return[m,l]}function a2(){}function s2(e,t){var o=jn,l=xo(),c=t(),m=!Zo(l.memoizedState,c);if(m&&(l.memoizedState=c,Di=!0),l=l.queue,tv(c2.bind(null,o,l,e),[e]),l.getSnapshot!==t||m||kr!==null&&kr.memoizedState.tag&1){if(o.flags|=2048,$h(9,u2.bind(null,o,l,c,t),void 0,null),Mr===null)throw Error(je(349));ol&30||l2(o,t,c)}return c}function l2(e,t,o){e.flags|=16384,e={getSnapshot:t,value:o},t=jn.updateQueue,t===null?(t={lastEffect:null,stores:null},jn.updateQueue=t,t.stores=[e]):(o=t.stores,o===null?t.stores=[e]:o.push(e))}function u2(e,t,o,l){t.value=o,t.getSnapshot=l,h2(t)&&d2(e)}function c2(e,t,o){return o(function(){h2(t)&&d2(e)})}function h2(e){var t=e.getSnapshot;e=e.value;try{var o=t();return!Zo(e,o)}catch{return!0}}function d2(e){var t=La(e,1);t!==null&&$o(t,e,1,-1)}function o1(e){var t=na();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Uh,lastRenderedState:e},t.queue=e,e=e.dispatch=bk.bind(null,jn,e),[t.memoizedState,e]}function $h(e,t,o,l){return e={tag:e,create:t,destroy:o,deps:l,next:null},t=jn.updateQueue,t===null?(t={lastEffect:null,stores:null},jn.updateQueue=t,t.lastEffect=e.next=e):(o=t.lastEffect,o===null?t.lastEffect=e.next=e:(l=o.next,o.next=e,e.next=l,t.lastEffect=e)),e}function p2(){return xo().memoizedState}function Vp(e,t,o,l){var c=na();jn.flags|=e,c.memoizedState=$h(1|t,o,void 0,l===void 0?null:l)}function jf(e,t,o,l){var c=xo();l=l===void 0?null:l;var m=void 0;if(vr!==null){var x=vr.memoizedState;if(m=x.destroy,l!==null&&J_(l,x.deps)){c.memoizedState=$h(t,o,m,l);return}}jn.flags|=e,c.memoizedState=$h(1|t,o,m,l)}function a1(e,t){return Vp(8390656,8,e,t)}function tv(e,t){return jf(2048,8,e,t)}function f2(e,t){return jf(4,2,e,t)}function m2(e,t){return jf(4,4,e,t)}function g2(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function y2(e,t,o){return o=o!=null?o.concat([e]):null,jf(4,4,g2.bind(null,t,e),o)}function nv(){}function _2(e,t){var o=xo();t=t===void 0?null:t;var l=o.memoizedState;return l!==null&&t!==null&&J_(t,l[1])?l[0]:(o.memoizedState=[e,t],e)}function v2(e,t){var o=xo();t=t===void 0?null:t;var l=o.memoizedState;return l!==null&&t!==null&&J_(t,l[1])?l[0]:(e=e(),o.memoizedState=[e,t],e)}function x2(e,t,o){return ol&21?(Zo(o,t)||(o=Sb(),jn.lanes|=o,al|=o,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Di=!0),e.memoizedState=o)}function xk(e,t){var o=fn;fn=o!==0&&4>o?o:4,e(!0);var l=Vg.transition;Vg.transition={};try{e(!1),t()}finally{fn=o,Vg.transition=l}}function w2(){return xo().memoizedState}function wk(e,t,o){var l=vs(e);if(o={lane:l,action:o,hasEagerState:!1,eagerState:null,next:null},b2(e))S2(t,o);else if(o=Qb(e,t,o,l),o!==null){var c=_i();$o(o,e,l,c),T2(o,t,l)}}function bk(e,t,o){var l=vs(e),c={lane:l,action:o,hasEagerState:!1,eagerState:null,next:null};if(b2(e))S2(t,c);else{var m=e.alternate;if(e.lanes===0&&(m===null||m.lanes===0)&&(m=t.lastRenderedReducer,m!==null))try{var x=t.lastRenderedState,u=m(x,o);if(c.hasEagerState=!0,c.eagerState=u,Zo(u,x)){var C=t.interleaved;C===null?(c.next=c,H_(t)):(c.next=C.next,C.next=c),t.interleaved=c;return}}catch{}finally{}o=Qb(e,t,c,l),o!==null&&(c=_i(),$o(o,e,l,c),T2(o,t,l))}}function b2(e){var t=e.alternate;return e===jn||t!==null&&t===jn}function S2(e,t){wh=df=!0;var o=e.pending;o===null?t.next=t:(t.next=o.next,o.next=t),e.pending=t}function T2(e,t,o){if(o&4194240){var l=t.lanes;l&=e.pendingLanes,o|=l,t.lanes=o,D_(e,o)}}var pf={readContext:vo,useCallback:Qr,useContext:Qr,useEffect:Qr,useImperativeHandle:Qr,useInsertionEffect:Qr,useLayoutEffect:Qr,useMemo:Qr,useReducer:Qr,useRef:Qr,useState:Qr,useDebugValue:Qr,useDeferredValue:Qr,useTransition:Qr,useMutableSource:Qr,useSyncExternalStore:Qr,useId:Qr,unstable_isNewReconciler:!1},Sk={readContext:vo,useCallback:function(e,t){return na().memoizedState=[e,t===void 0?null:t],e},useContext:vo,useEffect:a1,useImperativeHandle:function(e,t,o){return o=o!=null?o.concat([e]):null,Vp(4194308,4,g2.bind(null,t,e),o)},useLayoutEffect:function(e,t){return Vp(4194308,4,e,t)},useInsertionEffect:function(e,t){return Vp(4,2,e,t)},useMemo:function(e,t){var o=na();return t=t===void 0?null:t,e=e(),o.memoizedState=[e,t],e},useReducer:function(e,t,o){var l=na();return t=o!==void 0?o(t):t,l.memoizedState=l.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},l.queue=e,e=e.dispatch=wk.bind(null,jn,e),[l.memoizedState,e]},useRef:function(e){var t=na();return e={current:e},t.memoizedState=e},useState:o1,useDebugValue:nv,useDeferredValue:function(e){return na().memoizedState=e},useTransition:function(){var e=o1(!1),t=e[0];return e=xk.bind(null,e[1]),na().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,o){var l=jn,c=na();if(Bn){if(o===void 0)throw Error(je(407));o=o()}else{if(o=t(),Mr===null)throw Error(je(349));ol&30||l2(l,t,o)}c.memoizedState=o;var m={value:o,getSnapshot:t};return c.queue=m,a1(c2.bind(null,l,m,e),[e]),l.flags|=2048,$h(9,u2.bind(null,l,m,o,t),void 0,null),o},useId:function(){var e=na(),t=Mr.identifierPrefix;if(Bn){var o=Ma,l=ka;o=(l&~(1<<32-Uo(l)-1)).toString(32)+o,t=":"+t+"R"+o,o=Nh++,0<o&&(t+="H"+o.toString(32)),t+=":"}else o=vk++,t=":"+t+"r"+o.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Tk={readContext:vo,useCallback:_2,useContext:vo,useEffect:tv,useImperativeHandle:y2,useInsertionEffect:f2,useLayoutEffect:m2,useMemo:v2,useReducer:Ng,useRef:p2,useState:function(){return Ng(Uh)},useDebugValue:nv,useDeferredValue:function(e){var t=xo();return x2(t,vr.memoizedState,e)},useTransition:function(){var e=Ng(Uh)[0],t=xo().memoizedState;return[e,t]},useMutableSource:a2,useSyncExternalStore:s2,useId:w2,unstable_isNewReconciler:!1},Ck={readContext:vo,useCallback:_2,useContext:vo,useEffect:tv,useImperativeHandle:y2,useInsertionEffect:f2,useLayoutEffect:m2,useMemo:v2,useReducer:Ug,useRef:p2,useState:function(){return Ug(Uh)},useDebugValue:nv,useDeferredValue:function(e){var t=xo();return vr===null?t.memoizedState=e:x2(t,vr.memoizedState,e)},useTransition:function(){var e=Ug(Uh)[0],t=xo().memoizedState;return[e,t]},useMutableSource:a2,useSyncExternalStore:s2,useId:w2,unstable_isNewReconciler:!1};function zu(e,t){try{var o="",l=t;do o+=QE(l),l=l.return;while(l);var c=o}catch(m){c=`
Error generating stack: `+m.message+`
`+m.stack}return{value:e,source:t,stack:c,digest:null}}function $g(e,t,o){return{value:e,source:null,stack:o??null,digest:t??null}}function Uy(e,t){try{console.error(t.value)}catch(o){setTimeout(function(){throw o})}}var Ek=typeof WeakMap=="function"?WeakMap:Map;function C2(e,t,o){o=Pa(-1,o),o.tag=3,o.payload={element:null};var l=t.value;return o.callback=function(){mf||(mf=!0,Yy=l),Uy(e,t)},o}function E2(e,t,o){o=Pa(-1,o),o.tag=3;var l=e.type.getDerivedStateFromError;if(typeof l=="function"){var c=t.value;o.payload=function(){return l(c)},o.callback=function(){Uy(e,t)}}var m=e.stateNode;return m!==null&&typeof m.componentDidCatch=="function"&&(o.callback=function(){Uy(e,t),typeof l!="function"&&(_s===null?_s=new Set([this]):_s.add(this));var x=t.stack;this.componentDidCatch(t.value,{componentStack:x!==null?x:""})}),o}function s1(e,t,o){var l=e.pingCache;if(l===null){l=e.pingCache=new Ek;var c=new Set;l.set(t,c)}else c=l.get(t),c===void 0&&(c=new Set,l.set(t,c));c.has(o)||(c.add(o),e=Nk.bind(null,e,t,o),t.then(e,e))}function l1(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function u1(e,t,o,l,c){return e.mode&1?(e.flags|=65536,e.lanes=c,e):(e===t?e.flags|=65536:(e.flags|=128,o.flags|=131072,o.flags&=-52805,o.tag===1&&(o.alternate===null?o.tag=17:(t=Pa(-1,1),t.tag=2,ys(o,t,1))),o.lanes|=1),e)}var Ik=Fa.ReactCurrentOwner,Di=!1;function gi(e,t,o,l){t.child=e===null?i2(t,null,o,l):Pu(t,e.child,o,l)}function c1(e,t,o,l,c){o=o.render;var m=t.ref;return Tu(t,c),l=Q_(e,t,o,l,m,c),o=ev(),e!==null&&!Di?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~c,Ra(e,t,c)):(Bn&&o&&U_(t),t.flags|=1,gi(e,t,l,c),t.child)}function h1(e,t,o,l,c){if(e===null){var m=o.type;return typeof m=="function"&&!cv(m)&&m.defaultProps===void 0&&o.compare===null&&o.defaultProps===void 0?(t.tag=15,t.type=m,I2(e,t,m,l,c)):(e=jp(o.type,null,l,t,t.mode,c),e.ref=t.ref,e.return=t,t.child=e)}if(m=e.child,!(e.lanes&c)){var x=m.memoizedProps;if(o=o.compare,o=o!==null?o:Lh,o(x,l)&&e.ref===t.ref)return Ra(e,t,c)}return t.flags|=1,e=xs(m,l),e.ref=t.ref,e.return=t,t.child=e}function I2(e,t,o,l,c){if(e!==null){var m=e.memoizedProps;if(Lh(m,l)&&e.ref===t.ref)if(Di=!1,t.pendingProps=l=m,(e.lanes&c)!==0)e.flags&131072&&(Di=!0);else return t.lanes=e.lanes,Ra(e,t,c)}return $y(e,t,o,l,c)}function k2(e,t,o){var l=t.pendingProps,c=l.children,m=e!==null?e.memoizedState:null;if(l.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},kn(pu,Zi),Zi|=o;else{if(!(o&1073741824))return e=m!==null?m.baseLanes|o:o,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,kn(pu,Zi),Zi|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},l=m!==null?m.baseLanes:o,kn(pu,Zi),Zi|=l}else m!==null?(l=m.baseLanes|o,t.memoizedState=null):l=o,kn(pu,Zi),Zi|=l;return gi(e,t,c,o),t.child}function M2(e,t){var o=t.ref;(e===null&&o!==null||e!==null&&e.ref!==o)&&(t.flags|=512,t.flags|=2097152)}function $y(e,t,o,l,c){var m=Ri(o)?rl:ri.current;return m=ku(t,m),Tu(t,c),o=Q_(e,t,o,l,m,c),l=ev(),e!==null&&!Di?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~c,Ra(e,t,c)):(Bn&&l&&U_(t),t.flags|=1,gi(e,t,o,c),t.child)}function d1(e,t,o,l,c){if(Ri(o)){var m=!0;of(t)}else m=!1;if(Tu(t,c),t.stateNode===null)Np(e,t),n2(t,o,l),Ny(t,o,l,c),l=!0;else if(e===null){var x=t.stateNode,u=t.memoizedProps;x.props=u;var C=x.context,I=o.contextType;typeof I=="object"&&I!==null?I=vo(I):(I=Ri(o)?rl:ri.current,I=ku(t,I));var D=o.getDerivedStateFromProps,O=typeof D=="function"||typeof x.getSnapshotBeforeUpdate=="function";O||typeof x.UNSAFE_componentWillReceiveProps!="function"&&typeof x.componentWillReceiveProps!="function"||(u!==l||C!==I)&&r1(t,x,l,I),ss=!1;var U=t.memoizedState;x.state=U,cf(t,l,x,c),C=t.memoizedState,u!==l||U!==C||Li.current||ss?(typeof D=="function"&&(Vy(t,o,D,l),C=t.memoizedState),(u=ss||n1(t,o,u,l,U,C,I))?(O||typeof x.UNSAFE_componentWillMount!="function"&&typeof x.componentWillMount!="function"||(typeof x.componentWillMount=="function"&&x.componentWillMount(),typeof x.UNSAFE_componentWillMount=="function"&&x.UNSAFE_componentWillMount()),typeof x.componentDidMount=="function"&&(t.flags|=4194308)):(typeof x.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=l,t.memoizedState=C),x.props=l,x.state=C,x.context=I,l=u):(typeof x.componentDidMount=="function"&&(t.flags|=4194308),l=!1)}else{x=t.stateNode,e2(e,t),u=t.memoizedProps,I=t.type===t.elementType?u:Oo(t.type,u),x.props=I,O=t.pendingProps,U=x.context,C=o.contextType,typeof C=="object"&&C!==null?C=vo(C):(C=Ri(o)?rl:ri.current,C=ku(t,C));var le=o.getDerivedStateFromProps;(D=typeof le=="function"||typeof x.getSnapshotBeforeUpdate=="function")||typeof x.UNSAFE_componentWillReceiveProps!="function"&&typeof x.componentWillReceiveProps!="function"||(u!==O||U!==C)&&r1(t,x,l,C),ss=!1,U=t.memoizedState,x.state=U,cf(t,l,x,c);var ue=t.memoizedState;u!==O||U!==ue||Li.current||ss?(typeof le=="function"&&(Vy(t,o,le,l),ue=t.memoizedState),(I=ss||n1(t,o,I,l,U,ue,C)||!1)?(D||typeof x.UNSAFE_componentWillUpdate!="function"&&typeof x.componentWillUpdate!="function"||(typeof x.componentWillUpdate=="function"&&x.componentWillUpdate(l,ue,C),typeof x.UNSAFE_componentWillUpdate=="function"&&x.UNSAFE_componentWillUpdate(l,ue,C)),typeof x.componentDidUpdate=="function"&&(t.flags|=4),typeof x.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof x.componentDidUpdate!="function"||u===e.memoizedProps&&U===e.memoizedState||(t.flags|=4),typeof x.getSnapshotBeforeUpdate!="function"||u===e.memoizedProps&&U===e.memoizedState||(t.flags|=1024),t.memoizedProps=l,t.memoizedState=ue),x.props=l,x.state=ue,x.context=C,l=I):(typeof x.componentDidUpdate!="function"||u===e.memoizedProps&&U===e.memoizedState||(t.flags|=4),typeof x.getSnapshotBeforeUpdate!="function"||u===e.memoizedProps&&U===e.memoizedState||(t.flags|=1024),l=!1)}return jy(e,t,o,l,m,c)}function jy(e,t,o,l,c,m){M2(e,t);var x=(t.flags&128)!==0;if(!l&&!x)return c&&Yx(t,o,!1),Ra(e,t,m);l=t.stateNode,Ik.current=t;var u=x&&typeof o.getDerivedStateFromError!="function"?null:l.render();return t.flags|=1,e!==null&&x?(t.child=Pu(t,e.child,null,m),t.child=Pu(t,null,u,m)):gi(e,t,u,m),t.memoizedState=l.state,c&&Yx(t,o,!0),t.child}function P2(e){var t=e.stateNode;t.pendingContext?Xx(e,t.pendingContext,t.pendingContext!==t.context):t.context&&Xx(e,t.context,!1),K_(e,t.containerInfo)}function p1(e,t,o,l,c){return Mu(),j_(c),t.flags|=256,gi(e,t,o,l),t.child}var Zy={dehydrated:null,treeContext:null,retryLane:0};function qy(e){return{baseLanes:e,cachePool:null,transitions:null}}function A2(e,t,o){var l=t.pendingProps,c=$n.current,m=!1,x=(t.flags&128)!==0,u;if((u=x)||(u=e!==null&&e.memoizedState===null?!1:(c&2)!==0),u?(m=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(c|=1),kn($n,c&1),e===null)return Oy(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(x=l.children,e=l.fallback,m?(l=t.mode,m=t.child,x={mode:"hidden",children:x},!(l&1)&&m!==null?(m.childLanes=0,m.pendingProps=x):m=Gf(x,l,0,null),e=tl(e,l,o,null),m.return=t,e.return=t,m.sibling=e,t.child=m,t.child.memoizedState=qy(o),t.memoizedState=Zy,e):rv(t,x));if(c=e.memoizedState,c!==null&&(u=c.dehydrated,u!==null))return kk(e,t,x,l,u,c,o);if(m){m=l.fallback,x=t.mode,c=e.child,u=c.sibling;var C={mode:"hidden",children:l.children};return!(x&1)&&t.child!==c?(l=t.child,l.childLanes=0,l.pendingProps=C,t.deletions=null):(l=xs(c,C),l.subtreeFlags=c.subtreeFlags&14680064),u!==null?m=xs(u,m):(m=tl(m,x,o,null),m.flags|=2),m.return=t,l.return=t,l.sibling=m,t.child=l,l=m,m=t.child,x=e.child.memoizedState,x=x===null?qy(o):{baseLanes:x.baseLanes|o,cachePool:null,transitions:x.transitions},m.memoizedState=x,m.childLanes=e.childLanes&~o,t.memoizedState=Zy,l}return m=e.child,e=m.sibling,l=xs(m,{mode:"visible",children:l.children}),!(t.mode&1)&&(l.lanes=o),l.return=t,l.sibling=null,e!==null&&(o=t.deletions,o===null?(t.deletions=[e],t.flags|=16):o.push(e)),t.child=l,t.memoizedState=null,l}function rv(e,t){return t=Gf({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Sp(e,t,o,l){return l!==null&&j_(l),Pu(t,e.child,null,o),e=rv(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function kk(e,t,o,l,c,m,x){if(o)return t.flags&256?(t.flags&=-257,l=$g(Error(je(422))),Sp(e,t,x,l)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(m=l.fallback,c=t.mode,l=Gf({mode:"visible",children:l.children},c,0,null),m=tl(m,c,x,null),m.flags|=2,l.return=t,m.return=t,l.sibling=m,t.child=l,t.mode&1&&Pu(t,e.child,null,x),t.child.memoizedState=qy(x),t.memoizedState=Zy,m);if(!(t.mode&1))return Sp(e,t,x,null);if(c.data==="$!"){if(l=c.nextSibling&&c.nextSibling.dataset,l)var u=l.dgst;return l=u,m=Error(je(419)),l=$g(m,l,void 0),Sp(e,t,x,l)}if(u=(x&e.childLanes)!==0,Di||u){if(l=Mr,l!==null){switch(x&-x){case 4:c=2;break;case 16:c=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:c=32;break;case 536870912:c=268435456;break;default:c=0}c=c&(l.suspendedLanes|x)?0:c,c!==0&&c!==m.retryLane&&(m.retryLane=c,La(e,c),$o(l,e,c,-1))}return uv(),l=$g(Error(je(421))),Sp(e,t,x,l)}return c.data==="$?"?(t.flags|=128,t.child=e.child,t=Uk.bind(null,e),c._reactRetry=t,null):(e=m.treeContext,Wi=gs(c.nextSibling),Ki=t,Bn=!0,No=null,e!==null&&(mo[go++]=ka,mo[go++]=Ma,mo[go++]=il,ka=e.id,Ma=e.overflow,il=t),t=rv(t,l.children),t.flags|=4096,t)}function f1(e,t,o){e.lanes|=t;var l=e.alternate;l!==null&&(l.lanes|=t),By(e.return,t,o)}function jg(e,t,o,l,c){var m=e.memoizedState;m===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:l,tail:o,tailMode:c}:(m.isBackwards=t,m.rendering=null,m.renderingStartTime=0,m.last=l,m.tail=o,m.tailMode=c)}function z2(e,t,o){var l=t.pendingProps,c=l.revealOrder,m=l.tail;if(gi(e,t,l.children,o),l=$n.current,l&2)l=l&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&f1(e,o,t);else if(e.tag===19)f1(e,o,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}l&=1}if(kn($n,l),!(t.mode&1))t.memoizedState=null;else switch(c){case"forwards":for(o=t.child,c=null;o!==null;)e=o.alternate,e!==null&&hf(e)===null&&(c=o),o=o.sibling;o=c,o===null?(c=t.child,t.child=null):(c=o.sibling,o.sibling=null),jg(t,!1,c,o,m);break;case"backwards":for(o=null,c=t.child,t.child=null;c!==null;){if(e=c.alternate,e!==null&&hf(e)===null){t.child=c;break}e=c.sibling,c.sibling=o,o=c,c=e}jg(t,!0,o,null,m);break;case"together":jg(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Np(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Ra(e,t,o){if(e!==null&&(t.dependencies=e.dependencies),al|=t.lanes,!(o&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(je(153));if(t.child!==null){for(e=t.child,o=xs(e,e.pendingProps),t.child=o,o.return=t;e.sibling!==null;)e=e.sibling,o=o.sibling=xs(e,e.pendingProps),o.return=t;o.sibling=null}return t.child}function Mk(e,t,o){switch(t.tag){case 3:P2(t),Mu();break;case 5:o2(t);break;case 1:Ri(t.type)&&of(t);break;case 4:K_(t,t.stateNode.containerInfo);break;case 10:var l=t.type._context,c=t.memoizedProps.value;kn(lf,l._currentValue),l._currentValue=c;break;case 13:if(l=t.memoizedState,l!==null)return l.dehydrated!==null?(kn($n,$n.current&1),t.flags|=128,null):o&t.child.childLanes?A2(e,t,o):(kn($n,$n.current&1),e=Ra(e,t,o),e!==null?e.sibling:null);kn($n,$n.current&1);break;case 19:if(l=(o&t.childLanes)!==0,e.flags&128){if(l)return z2(e,t,o);t.flags|=128}if(c=t.memoizedState,c!==null&&(c.rendering=null,c.tail=null,c.lastEffect=null),kn($n,$n.current),l)break;return null;case 22:case 23:return t.lanes=0,k2(e,t,o)}return Ra(e,t,o)}var D2,Gy,L2,R2;D2=function(e,t){for(var o=t.child;o!==null;){if(o.tag===5||o.tag===6)e.appendChild(o.stateNode);else if(o.tag!==4&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===t)break;for(;o.sibling===null;){if(o.return===null||o.return===t)return;o=o.return}o.sibling.return=o.return,o=o.sibling}};Gy=function(){};L2=function(e,t,o,l){var c=e.memoizedProps;if(c!==l){e=t.stateNode,Ys(sa.current);var m=null;switch(o){case"input":c=fy(e,c),l=fy(e,l),m=[];break;case"select":c=Zn({},c,{value:void 0}),l=Zn({},l,{value:void 0}),m=[];break;case"textarea":c=yy(e,c),l=yy(e,l),m=[];break;default:typeof c.onClick!="function"&&typeof l.onClick=="function"&&(e.onclick=nf)}vy(o,l);var x;o=null;for(I in c)if(!l.hasOwnProperty(I)&&c.hasOwnProperty(I)&&c[I]!=null)if(I==="style"){var u=c[I];for(x in u)u.hasOwnProperty(x)&&(o||(o={}),o[x]="")}else I!=="dangerouslySetInnerHTML"&&I!=="children"&&I!=="suppressContentEditableWarning"&&I!=="suppressHydrationWarning"&&I!=="autoFocus"&&(Ih.hasOwnProperty(I)?m||(m=[]):(m=m||[]).push(I,null));for(I in l){var C=l[I];if(u=c!=null?c[I]:void 0,l.hasOwnProperty(I)&&C!==u&&(C!=null||u!=null))if(I==="style")if(u){for(x in u)!u.hasOwnProperty(x)||C&&C.hasOwnProperty(x)||(o||(o={}),o[x]="");for(x in C)C.hasOwnProperty(x)&&u[x]!==C[x]&&(o||(o={}),o[x]=C[x])}else o||(m||(m=[]),m.push(I,o)),o=C;else I==="dangerouslySetInnerHTML"?(C=C?C.__html:void 0,u=u?u.__html:void 0,C!=null&&u!==C&&(m=m||[]).push(I,C)):I==="children"?typeof C!="string"&&typeof C!="number"||(m=m||[]).push(I,""+C):I!=="suppressContentEditableWarning"&&I!=="suppressHydrationWarning"&&(Ih.hasOwnProperty(I)?(C!=null&&I==="onScroll"&&Dn("scroll",e),m||u===C||(m=[])):(m=m||[]).push(I,C))}o&&(m=m||[]).push("style",o);var I=m;(t.updateQueue=I)&&(t.flags|=4)}};R2=function(e,t,o,l){o!==l&&(t.flags|=4)};function eh(e,t){if(!Bn)switch(e.tailMode){case"hidden":t=e.tail;for(var o=null;t!==null;)t.alternate!==null&&(o=t),t=t.sibling;o===null?e.tail=null:o.sibling=null;break;case"collapsed":o=e.tail;for(var l=null;o!==null;)o.alternate!==null&&(l=o),o=o.sibling;l===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:l.sibling=null}}function ei(e){var t=e.alternate!==null&&e.alternate.child===e.child,o=0,l=0;if(t)for(var c=e.child;c!==null;)o|=c.lanes|c.childLanes,l|=c.subtreeFlags&14680064,l|=c.flags&14680064,c.return=e,c=c.sibling;else for(c=e.child;c!==null;)o|=c.lanes|c.childLanes,l|=c.subtreeFlags,l|=c.flags,c.return=e,c=c.sibling;return e.subtreeFlags|=l,e.childLanes=o,t}function Pk(e,t,o){var l=t.pendingProps;switch($_(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ei(t),null;case 1:return Ri(t.type)&&rf(),ei(t),null;case 3:return l=t.stateNode,Au(),Ln(Li),Ln(ri),Y_(),l.pendingContext&&(l.context=l.pendingContext,l.pendingContext=null),(e===null||e.child===null)&&(wp(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,No!==null&&(e_(No),No=null))),Gy(e,t),ei(t),null;case 5:X_(t);var c=Ys(Vh.current);if(o=t.type,e!==null&&t.stateNode!=null)L2(e,t,o,l,c),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!l){if(t.stateNode===null)throw Error(je(166));return ei(t),null}if(e=Ys(sa.current),wp(t)){l=t.stateNode,o=t.type;var m=t.memoizedProps;switch(l[oa]=t,l[Oh]=m,e=(t.mode&1)!==0,o){case"dialog":Dn("cancel",l),Dn("close",l);break;case"iframe":case"object":case"embed":Dn("load",l);break;case"video":case"audio":for(c=0;c<fh.length;c++)Dn(fh[c],l);break;case"source":Dn("error",l);break;case"img":case"image":case"link":Dn("error",l),Dn("load",l);break;case"details":Dn("toggle",l);break;case"input":Sx(l,m),Dn("invalid",l);break;case"select":l._wrapperState={wasMultiple:!!m.multiple},Dn("invalid",l);break;case"textarea":Cx(l,m),Dn("invalid",l)}vy(o,m),c=null;for(var x in m)if(m.hasOwnProperty(x)){var u=m[x];x==="children"?typeof u=="string"?l.textContent!==u&&(m.suppressHydrationWarning!==!0&&xp(l.textContent,u,e),c=["children",u]):typeof u=="number"&&l.textContent!==""+u&&(m.suppressHydrationWarning!==!0&&xp(l.textContent,u,e),c=["children",""+u]):Ih.hasOwnProperty(x)&&u!=null&&x==="onScroll"&&Dn("scroll",l)}switch(o){case"input":dp(l),Tx(l,m,!0);break;case"textarea":dp(l),Ex(l);break;case"select":case"option":break;default:typeof m.onClick=="function"&&(l.onclick=nf)}l=c,t.updateQueue=l,l!==null&&(t.flags|=4)}else{x=c.nodeType===9?c:c.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=lb(o)),e==="http://www.w3.org/1999/xhtml"?o==="script"?(e=x.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof l.is=="string"?e=x.createElement(o,{is:l.is}):(e=x.createElement(o),o==="select"&&(x=e,l.multiple?x.multiple=!0:l.size&&(x.size=l.size))):e=x.createElementNS(e,o),e[oa]=t,e[Oh]=l,D2(e,t,!1,!1),t.stateNode=e;e:{switch(x=xy(o,l),o){case"dialog":Dn("cancel",e),Dn("close",e),c=l;break;case"iframe":case"object":case"embed":Dn("load",e),c=l;break;case"video":case"audio":for(c=0;c<fh.length;c++)Dn(fh[c],e);c=l;break;case"source":Dn("error",e),c=l;break;case"img":case"image":case"link":Dn("error",e),Dn("load",e),c=l;break;case"details":Dn("toggle",e),c=l;break;case"input":Sx(e,l),c=fy(e,l),Dn("invalid",e);break;case"option":c=l;break;case"select":e._wrapperState={wasMultiple:!!l.multiple},c=Zn({},l,{value:void 0}),Dn("invalid",e);break;case"textarea":Cx(e,l),c=yy(e,l),Dn("invalid",e);break;default:c=l}vy(o,c),u=c;for(m in u)if(u.hasOwnProperty(m)){var C=u[m];m==="style"?hb(e,C):m==="dangerouslySetInnerHTML"?(C=C?C.__html:void 0,C!=null&&ub(e,C)):m==="children"?typeof C=="string"?(o!=="textarea"||C!=="")&&kh(e,C):typeof C=="number"&&kh(e,""+C):m!=="suppressContentEditableWarning"&&m!=="suppressHydrationWarning"&&m!=="autoFocus"&&(Ih.hasOwnProperty(m)?C!=null&&m==="onScroll"&&Dn("scroll",e):C!=null&&I_(e,m,C,x))}switch(o){case"input":dp(e),Tx(e,l,!1);break;case"textarea":dp(e),Ex(e);break;case"option":l.value!=null&&e.setAttribute("value",""+ws(l.value));break;case"select":e.multiple=!!l.multiple,m=l.value,m!=null?xu(e,!!l.multiple,m,!1):l.defaultValue!=null&&xu(e,!!l.multiple,l.defaultValue,!0);break;default:typeof c.onClick=="function"&&(e.onclick=nf)}switch(o){case"button":case"input":case"select":case"textarea":l=!!l.autoFocus;break e;case"img":l=!0;break e;default:l=!1}}l&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return ei(t),null;case 6:if(e&&t.stateNode!=null)R2(e,t,e.memoizedProps,l);else{if(typeof l!="string"&&t.stateNode===null)throw Error(je(166));if(o=Ys(Vh.current),Ys(sa.current),wp(t)){if(l=t.stateNode,o=t.memoizedProps,l[oa]=t,(m=l.nodeValue!==o)&&(e=Ki,e!==null))switch(e.tag){case 3:xp(l.nodeValue,o,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&xp(l.nodeValue,o,(e.mode&1)!==0)}m&&(t.flags|=4)}else l=(o.nodeType===9?o:o.ownerDocument).createTextNode(l),l[oa]=t,t.stateNode=l}return ei(t),null;case 13:if(Ln($n),l=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Bn&&Wi!==null&&t.mode&1&&!(t.flags&128))Jb(),Mu(),t.flags|=98560,m=!1;else if(m=wp(t),l!==null&&l.dehydrated!==null){if(e===null){if(!m)throw Error(je(318));if(m=t.memoizedState,m=m!==null?m.dehydrated:null,!m)throw Error(je(317));m[oa]=t}else Mu(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;ei(t),m=!1}else No!==null&&(e_(No),No=null),m=!0;if(!m)return t.flags&65536?t:null}return t.flags&128?(t.lanes=o,t):(l=l!==null,l!==(e!==null&&e.memoizedState!==null)&&l&&(t.child.flags|=8192,t.mode&1&&(e===null||$n.current&1?xr===0&&(xr=3):uv())),t.updateQueue!==null&&(t.flags|=4),ei(t),null);case 4:return Au(),Gy(e,t),e===null&&Rh(t.stateNode.containerInfo),ei(t),null;case 10:return G_(t.type._context),ei(t),null;case 17:return Ri(t.type)&&rf(),ei(t),null;case 19:if(Ln($n),m=t.memoizedState,m===null)return ei(t),null;if(l=(t.flags&128)!==0,x=m.rendering,x===null)if(l)eh(m,!1);else{if(xr!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(x=hf(e),x!==null){for(t.flags|=128,eh(m,!1),l=x.updateQueue,l!==null&&(t.updateQueue=l,t.flags|=4),t.subtreeFlags=0,l=o,o=t.child;o!==null;)m=o,e=l,m.flags&=14680066,x=m.alternate,x===null?(m.childLanes=0,m.lanes=e,m.child=null,m.subtreeFlags=0,m.memoizedProps=null,m.memoizedState=null,m.updateQueue=null,m.dependencies=null,m.stateNode=null):(m.childLanes=x.childLanes,m.lanes=x.lanes,m.child=x.child,m.subtreeFlags=0,m.deletions=null,m.memoizedProps=x.memoizedProps,m.memoizedState=x.memoizedState,m.updateQueue=x.updateQueue,m.type=x.type,e=x.dependencies,m.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),o=o.sibling;return kn($n,$n.current&1|2),t.child}e=e.sibling}m.tail!==null&&hr()>Du&&(t.flags|=128,l=!0,eh(m,!1),t.lanes=4194304)}else{if(!l)if(e=hf(x),e!==null){if(t.flags|=128,l=!0,o=e.updateQueue,o!==null&&(t.updateQueue=o,t.flags|=4),eh(m,!0),m.tail===null&&m.tailMode==="hidden"&&!x.alternate&&!Bn)return ei(t),null}else 2*hr()-m.renderingStartTime>Du&&o!==1073741824&&(t.flags|=128,l=!0,eh(m,!1),t.lanes=4194304);m.isBackwards?(x.sibling=t.child,t.child=x):(o=m.last,o!==null?o.sibling=x:t.child=x,m.last=x)}return m.tail!==null?(t=m.tail,m.rendering=t,m.tail=t.sibling,m.renderingStartTime=hr(),t.sibling=null,o=$n.current,kn($n,l?o&1|2:o&1),t):(ei(t),null);case 22:case 23:return lv(),l=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==l&&(t.flags|=8192),l&&t.mode&1?Zi&1073741824&&(ei(t),t.subtreeFlags&6&&(t.flags|=8192)):ei(t),null;case 24:return null;case 25:return null}throw Error(je(156,t.tag))}function Ak(e,t){switch($_(t),t.tag){case 1:return Ri(t.type)&&rf(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Au(),Ln(Li),Ln(ri),Y_(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return X_(t),null;case 13:if(Ln($n),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(je(340));Mu()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Ln($n),null;case 4:return Au(),null;case 10:return G_(t.type._context),null;case 22:case 23:return lv(),null;case 24:return null;default:return null}}var Tp=!1,ni=!1,zk=typeof WeakSet=="function"?WeakSet:Set,ct=null;function du(e,t){var o=e.ref;if(o!==null)if(typeof o=="function")try{o(null)}catch(l){Jn(e,t,l)}else o.current=null}function Hy(e,t,o){try{o()}catch(l){Jn(e,t,l)}}var m1=!1;function Dk(e,t){if(Py=Qp,e=Vb(),N_(e)){if("selectionStart"in e)var o={start:e.selectionStart,end:e.selectionEnd};else e:{o=(o=e.ownerDocument)&&o.defaultView||window;var l=o.getSelection&&o.getSelection();if(l&&l.rangeCount!==0){o=l.anchorNode;var c=l.anchorOffset,m=l.focusNode;l=l.focusOffset;try{o.nodeType,m.nodeType}catch{o=null;break e}var x=0,u=-1,C=-1,I=0,D=0,O=e,U=null;t:for(;;){for(var le;O!==o||c!==0&&O.nodeType!==3||(u=x+c),O!==m||l!==0&&O.nodeType!==3||(C=x+l),O.nodeType===3&&(x+=O.nodeValue.length),(le=O.firstChild)!==null;)U=O,O=le;for(;;){if(O===e)break t;if(U===o&&++I===c&&(u=x),U===m&&++D===l&&(C=x),(le=O.nextSibling)!==null)break;O=U,U=O.parentNode}O=le}o=u===-1||C===-1?null:{start:u,end:C}}else o=null}o=o||{start:0,end:0}}else o=null;for(Ay={focusedElem:e,selectionRange:o},Qp=!1,ct=t;ct!==null;)if(t=ct,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,ct=e;else for(;ct!==null;){t=ct;try{var ue=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(ue!==null){var ae=ue.memoizedProps,oe=ue.memoizedState,$=t.stateNode,G=$.getSnapshotBeforeUpdate(t.elementType===t.type?ae:Oo(t.type,ae),oe);$.__reactInternalSnapshotBeforeUpdate=G}break;case 3:var ee=t.stateNode.containerInfo;ee.nodeType===1?ee.textContent="":ee.nodeType===9&&ee.documentElement&&ee.removeChild(ee.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(je(163))}}catch(_e){Jn(t,t.return,_e)}if(e=t.sibling,e!==null){e.return=t.return,ct=e;break}ct=t.return}return ue=m1,m1=!1,ue}function bh(e,t,o){var l=t.updateQueue;if(l=l!==null?l.lastEffect:null,l!==null){var c=l=l.next;do{if((c.tag&e)===e){var m=c.destroy;c.destroy=void 0,m!==void 0&&Hy(t,o,m)}c=c.next}while(c!==l)}}function Zf(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var o=t=t.next;do{if((o.tag&e)===e){var l=o.create;o.destroy=l()}o=o.next}while(o!==t)}}function Wy(e){var t=e.ref;if(t!==null){var o=e.stateNode;switch(e.tag){case 5:e=o;break;default:e=o}typeof t=="function"?t(e):t.current=e}}function F2(e){var t=e.alternate;t!==null&&(e.alternate=null,F2(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[oa],delete t[Oh],delete t[Ly],delete t[mk],delete t[gk])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function O2(e){return e.tag===5||e.tag===3||e.tag===4}function g1(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||O2(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Ky(e,t,o){var l=e.tag;if(l===5||l===6)e=e.stateNode,t?o.nodeType===8?o.parentNode.insertBefore(e,t):o.insertBefore(e,t):(o.nodeType===8?(t=o.parentNode,t.insertBefore(e,o)):(t=o,t.appendChild(e)),o=o._reactRootContainer,o!=null||t.onclick!==null||(t.onclick=nf));else if(l!==4&&(e=e.child,e!==null))for(Ky(e,t,o),e=e.sibling;e!==null;)Ky(e,t,o),e=e.sibling}function Xy(e,t,o){var l=e.tag;if(l===5||l===6)e=e.stateNode,t?o.insertBefore(e,t):o.appendChild(e);else if(l!==4&&(e=e.child,e!==null))for(Xy(e,t,o),e=e.sibling;e!==null;)Xy(e,t,o),e=e.sibling}var Vr=null,Bo=!1;function is(e,t,o){for(o=o.child;o!==null;)B2(e,t,o),o=o.sibling}function B2(e,t,o){if(aa&&typeof aa.onCommitFiberUnmount=="function")try{aa.onCommitFiberUnmount(Ff,o)}catch{}switch(o.tag){case 5:ni||du(o,t);case 6:var l=Vr,c=Bo;Vr=null,is(e,t,o),Vr=l,Bo=c,Vr!==null&&(Bo?(e=Vr,o=o.stateNode,e.nodeType===8?e.parentNode.removeChild(o):e.removeChild(o)):Vr.removeChild(o.stateNode));break;case 18:Vr!==null&&(Bo?(e=Vr,o=o.stateNode,e.nodeType===8?Fg(e.parentNode,o):e.nodeType===1&&Fg(e,o),zh(e)):Fg(Vr,o.stateNode));break;case 4:l=Vr,c=Bo,Vr=o.stateNode.containerInfo,Bo=!0,is(e,t,o),Vr=l,Bo=c;break;case 0:case 11:case 14:case 15:if(!ni&&(l=o.updateQueue,l!==null&&(l=l.lastEffect,l!==null))){c=l=l.next;do{var m=c,x=m.destroy;m=m.tag,x!==void 0&&(m&2||m&4)&&Hy(o,t,x),c=c.next}while(c!==l)}is(e,t,o);break;case 1:if(!ni&&(du(o,t),l=o.stateNode,typeof l.componentWillUnmount=="function"))try{l.props=o.memoizedProps,l.state=o.memoizedState,l.componentWillUnmount()}catch(u){Jn(o,t,u)}is(e,t,o);break;case 21:is(e,t,o);break;case 22:o.mode&1?(ni=(l=ni)||o.memoizedState!==null,is(e,t,o),ni=l):is(e,t,o);break;default:is(e,t,o)}}function y1(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var o=e.stateNode;o===null&&(o=e.stateNode=new zk),t.forEach(function(l){var c=$k.bind(null,e,l);o.has(l)||(o.add(l),l.then(c,c))})}}function Lo(e,t){var o=t.deletions;if(o!==null)for(var l=0;l<o.length;l++){var c=o[l];try{var m=e,x=t,u=x;e:for(;u!==null;){switch(u.tag){case 5:Vr=u.stateNode,Bo=!1;break e;case 3:Vr=u.stateNode.containerInfo,Bo=!0;break e;case 4:Vr=u.stateNode.containerInfo,Bo=!0;break e}u=u.return}if(Vr===null)throw Error(je(160));B2(m,x,c),Vr=null,Bo=!1;var C=c.alternate;C!==null&&(C.return=null),c.return=null}catch(I){Jn(c,t,I)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)V2(t,e),t=t.sibling}function V2(e,t){var o=e.alternate,l=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Lo(t,e),ta(e),l&4){try{bh(3,e,e.return),Zf(3,e)}catch(ae){Jn(e,e.return,ae)}try{bh(5,e,e.return)}catch(ae){Jn(e,e.return,ae)}}break;case 1:Lo(t,e),ta(e),l&512&&o!==null&&du(o,o.return);break;case 5:if(Lo(t,e),ta(e),l&512&&o!==null&&du(o,o.return),e.flags&32){var c=e.stateNode;try{kh(c,"")}catch(ae){Jn(e,e.return,ae)}}if(l&4&&(c=e.stateNode,c!=null)){var m=e.memoizedProps,x=o!==null?o.memoizedProps:m,u=e.type,C=e.updateQueue;if(e.updateQueue=null,C!==null)try{u==="input"&&m.type==="radio"&&m.name!=null&&ab(c,m),xy(u,x);var I=xy(u,m);for(x=0;x<C.length;x+=2){var D=C[x],O=C[x+1];D==="style"?hb(c,O):D==="dangerouslySetInnerHTML"?ub(c,O):D==="children"?kh(c,O):I_(c,D,O,I)}switch(u){case"input":my(c,m);break;case"textarea":sb(c,m);break;case"select":var U=c._wrapperState.wasMultiple;c._wrapperState.wasMultiple=!!m.multiple;var le=m.value;le!=null?xu(c,!!m.multiple,le,!1):U!==!!m.multiple&&(m.defaultValue!=null?xu(c,!!m.multiple,m.defaultValue,!0):xu(c,!!m.multiple,m.multiple?[]:"",!1))}c[Oh]=m}catch(ae){Jn(e,e.return,ae)}}break;case 6:if(Lo(t,e),ta(e),l&4){if(e.stateNode===null)throw Error(je(162));c=e.stateNode,m=e.memoizedProps;try{c.nodeValue=m}catch(ae){Jn(e,e.return,ae)}}break;case 3:if(Lo(t,e),ta(e),l&4&&o!==null&&o.memoizedState.isDehydrated)try{zh(t.containerInfo)}catch(ae){Jn(e,e.return,ae)}break;case 4:Lo(t,e),ta(e);break;case 13:Lo(t,e),ta(e),c=e.child,c.flags&8192&&(m=c.memoizedState!==null,c.stateNode.isHidden=m,!m||c.alternate!==null&&c.alternate.memoizedState!==null||(av=hr())),l&4&&y1(e);break;case 22:if(D=o!==null&&o.memoizedState!==null,e.mode&1?(ni=(I=ni)||D,Lo(t,e),ni=I):Lo(t,e),ta(e),l&8192){if(I=e.memoizedState!==null,(e.stateNode.isHidden=I)&&!D&&e.mode&1)for(ct=e,D=e.child;D!==null;){for(O=ct=D;ct!==null;){switch(U=ct,le=U.child,U.tag){case 0:case 11:case 14:case 15:bh(4,U,U.return);break;case 1:du(U,U.return);var ue=U.stateNode;if(typeof ue.componentWillUnmount=="function"){l=U,o=U.return;try{t=l,ue.props=t.memoizedProps,ue.state=t.memoizedState,ue.componentWillUnmount()}catch(ae){Jn(l,o,ae)}}break;case 5:du(U,U.return);break;case 22:if(U.memoizedState!==null){v1(O);continue}}le!==null?(le.return=U,ct=le):v1(O)}D=D.sibling}e:for(D=null,O=e;;){if(O.tag===5){if(D===null){D=O;try{c=O.stateNode,I?(m=c.style,typeof m.setProperty=="function"?m.setProperty("display","none","important"):m.display="none"):(u=O.stateNode,C=O.memoizedProps.style,x=C!=null&&C.hasOwnProperty("display")?C.display:null,u.style.display=cb("display",x))}catch(ae){Jn(e,e.return,ae)}}}else if(O.tag===6){if(D===null)try{O.stateNode.nodeValue=I?"":O.memoizedProps}catch(ae){Jn(e,e.return,ae)}}else if((O.tag!==22&&O.tag!==23||O.memoizedState===null||O===e)&&O.child!==null){O.child.return=O,O=O.child;continue}if(O===e)break e;for(;O.sibling===null;){if(O.return===null||O.return===e)break e;D===O&&(D=null),O=O.return}D===O&&(D=null),O.sibling.return=O.return,O=O.sibling}}break;case 19:Lo(t,e),ta(e),l&4&&y1(e);break;case 21:break;default:Lo(t,e),ta(e)}}function ta(e){var t=e.flags;if(t&2){try{e:{for(var o=e.return;o!==null;){if(O2(o)){var l=o;break e}o=o.return}throw Error(je(160))}switch(l.tag){case 5:var c=l.stateNode;l.flags&32&&(kh(c,""),l.flags&=-33);var m=g1(e);Xy(e,m,c);break;case 3:case 4:var x=l.stateNode.containerInfo,u=g1(e);Ky(e,u,x);break;default:throw Error(je(161))}}catch(C){Jn(e,e.return,C)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function Lk(e,t,o){ct=e,N2(e)}function N2(e,t,o){for(var l=(e.mode&1)!==0;ct!==null;){var c=ct,m=c.child;if(c.tag===22&&l){var x=c.memoizedState!==null||Tp;if(!x){var u=c.alternate,C=u!==null&&u.memoizedState!==null||ni;u=Tp;var I=ni;if(Tp=x,(ni=C)&&!I)for(ct=c;ct!==null;)x=ct,C=x.child,x.tag===22&&x.memoizedState!==null?x1(c):C!==null?(C.return=x,ct=C):x1(c);for(;m!==null;)ct=m,N2(m),m=m.sibling;ct=c,Tp=u,ni=I}_1(e)}else c.subtreeFlags&8772&&m!==null?(m.return=c,ct=m):_1(e)}}function _1(e){for(;ct!==null;){var t=ct;if(t.flags&8772){var o=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:ni||Zf(5,t);break;case 1:var l=t.stateNode;if(t.flags&4&&!ni)if(o===null)l.componentDidMount();else{var c=t.elementType===t.type?o.memoizedProps:Oo(t.type,o.memoizedProps);l.componentDidUpdate(c,o.memoizedState,l.__reactInternalSnapshotBeforeUpdate)}var m=t.updateQueue;m!==null&&t1(t,m,l);break;case 3:var x=t.updateQueue;if(x!==null){if(o=null,t.child!==null)switch(t.child.tag){case 5:o=t.child.stateNode;break;case 1:o=t.child.stateNode}t1(t,x,o)}break;case 5:var u=t.stateNode;if(o===null&&t.flags&4){o=u;var C=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":C.autoFocus&&o.focus();break;case"img":C.src&&(o.src=C.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var I=t.alternate;if(I!==null){var D=I.memoizedState;if(D!==null){var O=D.dehydrated;O!==null&&zh(O)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(je(163))}ni||t.flags&512&&Wy(t)}catch(U){Jn(t,t.return,U)}}if(t===e){ct=null;break}if(o=t.sibling,o!==null){o.return=t.return,ct=o;break}ct=t.return}}function v1(e){for(;ct!==null;){var t=ct;if(t===e){ct=null;break}var o=t.sibling;if(o!==null){o.return=t.return,ct=o;break}ct=t.return}}function x1(e){for(;ct!==null;){var t=ct;try{switch(t.tag){case 0:case 11:case 15:var o=t.return;try{Zf(4,t)}catch(C){Jn(t,o,C)}break;case 1:var l=t.stateNode;if(typeof l.componentDidMount=="function"){var c=t.return;try{l.componentDidMount()}catch(C){Jn(t,c,C)}}var m=t.return;try{Wy(t)}catch(C){Jn(t,m,C)}break;case 5:var x=t.return;try{Wy(t)}catch(C){Jn(t,x,C)}}}catch(C){Jn(t,t.return,C)}if(t===e){ct=null;break}var u=t.sibling;if(u!==null){u.return=t.return,ct=u;break}ct=t.return}}var Rk=Math.ceil,ff=Fa.ReactCurrentDispatcher,iv=Fa.ReactCurrentOwner,_o=Fa.ReactCurrentBatchConfig,rn=0,Mr=null,pr=null,Ur=0,Zi=0,pu=Ts(0),xr=0,jh=null,al=0,qf=0,ov=0,Sh=null,zi=null,av=0,Du=1/0,Ea=null,mf=!1,Yy=null,_s=null,Cp=!1,ds=null,gf=0,Th=0,Jy=null,Up=-1,$p=0;function _i(){return rn&6?hr():Up!==-1?Up:Up=hr()}function vs(e){return e.mode&1?rn&2&&Ur!==0?Ur&-Ur:_k.transition!==null?($p===0&&($p=Sb()),$p):(e=fn,e!==0||(e=window.event,e=e===void 0?16:Pb(e.type)),e):1}function $o(e,t,o,l){if(50<Th)throw Th=0,Jy=null,Error(je(185));Kh(e,o,l),(!(rn&2)||e!==Mr)&&(e===Mr&&(!(rn&2)&&(qf|=o),xr===4&&cs(e,Ur)),Fi(e,l),o===1&&rn===0&&!(t.mode&1)&&(Du=hr()+500,Uf&&Cs()))}function Fi(e,t){var o=e.callbackNode;_I(e,t);var l=Jp(e,e===Mr?Ur:0);if(l===0)o!==null&&Mx(o),e.callbackNode=null,e.callbackPriority=0;else if(t=l&-l,e.callbackPriority!==t){if(o!=null&&Mx(o),t===1)e.tag===0?yk(w1.bind(null,e)):Kb(w1.bind(null,e)),pk(function(){!(rn&6)&&Cs()}),o=null;else{switch(Tb(l)){case 1:o=z_;break;case 4:o=wb;break;case 16:o=Yp;break;case 536870912:o=bb;break;default:o=Yp}o=W2(o,U2.bind(null,e))}e.callbackPriority=t,e.callbackNode=o}}function U2(e,t){if(Up=-1,$p=0,rn&6)throw Error(je(327));var o=e.callbackNode;if(Cu()&&e.callbackNode!==o)return null;var l=Jp(e,e===Mr?Ur:0);if(l===0)return null;if(l&30||l&e.expiredLanes||t)t=yf(e,l);else{t=l;var c=rn;rn|=2;var m=j2();(Mr!==e||Ur!==t)&&(Ea=null,Du=hr()+500,el(e,t));do try{Bk();break}catch(u){$2(e,u)}while(!0);q_(),ff.current=m,rn=c,pr!==null?t=0:(Mr=null,Ur=0,t=xr)}if(t!==0){if(t===2&&(c=Cy(e),c!==0&&(l=c,t=Qy(e,c))),t===1)throw o=jh,el(e,0),cs(e,l),Fi(e,hr()),o;if(t===6)cs(e,l);else{if(c=e.current.alternate,!(l&30)&&!Fk(c)&&(t=yf(e,l),t===2&&(m=Cy(e),m!==0&&(l=m,t=Qy(e,m))),t===1))throw o=jh,el(e,0),cs(e,l),Fi(e,hr()),o;switch(e.finishedWork=c,e.finishedLanes=l,t){case 0:case 1:throw Error(je(345));case 2:Ws(e,zi,Ea);break;case 3:if(cs(e,l),(l&130023424)===l&&(t=av+500-hr(),10<t)){if(Jp(e,0)!==0)break;if(c=e.suspendedLanes,(c&l)!==l){_i(),e.pingedLanes|=e.suspendedLanes&c;break}e.timeoutHandle=Dy(Ws.bind(null,e,zi,Ea),t);break}Ws(e,zi,Ea);break;case 4:if(cs(e,l),(l&4194240)===l)break;for(t=e.eventTimes,c=-1;0<l;){var x=31-Uo(l);m=1<<x,x=t[x],x>c&&(c=x),l&=~m}if(l=c,l=hr()-l,l=(120>l?120:480>l?480:1080>l?1080:1920>l?1920:3e3>l?3e3:4320>l?4320:1960*Rk(l/1960))-l,10<l){e.timeoutHandle=Dy(Ws.bind(null,e,zi,Ea),l);break}Ws(e,zi,Ea);break;case 5:Ws(e,zi,Ea);break;default:throw Error(je(329))}}}return Fi(e,hr()),e.callbackNode===o?U2.bind(null,e):null}function Qy(e,t){var o=Sh;return e.current.memoizedState.isDehydrated&&(el(e,t).flags|=256),e=yf(e,t),e!==2&&(t=zi,zi=o,t!==null&&e_(t)),e}function e_(e){zi===null?zi=e:zi.push.apply(zi,e)}function Fk(e){for(var t=e;;){if(t.flags&16384){var o=t.updateQueue;if(o!==null&&(o=o.stores,o!==null))for(var l=0;l<o.length;l++){var c=o[l],m=c.getSnapshot;c=c.value;try{if(!Zo(m(),c))return!1}catch{return!1}}}if(o=t.child,t.subtreeFlags&16384&&o!==null)o.return=t,t=o;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function cs(e,t){for(t&=~ov,t&=~qf,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var o=31-Uo(t),l=1<<o;e[o]=-1,t&=~l}}function w1(e){if(rn&6)throw Error(je(327));Cu();var t=Jp(e,0);if(!(t&1))return Fi(e,hr()),null;var o=yf(e,t);if(e.tag!==0&&o===2){var l=Cy(e);l!==0&&(t=l,o=Qy(e,l))}if(o===1)throw o=jh,el(e,0),cs(e,t),Fi(e,hr()),o;if(o===6)throw Error(je(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Ws(e,zi,Ea),Fi(e,hr()),null}function sv(e,t){var o=rn;rn|=1;try{return e(t)}finally{rn=o,rn===0&&(Du=hr()+500,Uf&&Cs())}}function sl(e){ds!==null&&ds.tag===0&&!(rn&6)&&Cu();var t=rn;rn|=1;var o=_o.transition,l=fn;try{if(_o.transition=null,fn=1,e)return e()}finally{fn=l,_o.transition=o,rn=t,!(rn&6)&&Cs()}}function lv(){Zi=pu.current,Ln(pu)}function el(e,t){e.finishedWork=null,e.finishedLanes=0;var o=e.timeoutHandle;if(o!==-1&&(e.timeoutHandle=-1,dk(o)),pr!==null)for(o=pr.return;o!==null;){var l=o;switch($_(l),l.tag){case 1:l=l.type.childContextTypes,l!=null&&rf();break;case 3:Au(),Ln(Li),Ln(ri),Y_();break;case 5:X_(l);break;case 4:Au();break;case 13:Ln($n);break;case 19:Ln($n);break;case 10:G_(l.type._context);break;case 22:case 23:lv()}o=o.return}if(Mr=e,pr=e=xs(e.current,null),Ur=Zi=t,xr=0,jh=null,ov=qf=al=0,zi=Sh=null,Xs!==null){for(t=0;t<Xs.length;t++)if(o=Xs[t],l=o.interleaved,l!==null){o.interleaved=null;var c=l.next,m=o.pending;if(m!==null){var x=m.next;m.next=c,l.next=x}o.pending=l}Xs=null}return e}function $2(e,t){do{var o=pr;try{if(q_(),Bp.current=pf,df){for(var l=jn.memoizedState;l!==null;){var c=l.queue;c!==null&&(c.pending=null),l=l.next}df=!1}if(ol=0,kr=vr=jn=null,wh=!1,Nh=0,iv.current=null,o===null||o.return===null){xr=1,jh=t,pr=null;break}e:{var m=e,x=o.return,u=o,C=t;if(t=Ur,u.flags|=32768,C!==null&&typeof C=="object"&&typeof C.then=="function"){var I=C,D=u,O=D.tag;if(!(D.mode&1)&&(O===0||O===11||O===15)){var U=D.alternate;U?(D.updateQueue=U.updateQueue,D.memoizedState=U.memoizedState,D.lanes=U.lanes):(D.updateQueue=null,D.memoizedState=null)}var le=l1(x);if(le!==null){le.flags&=-257,u1(le,x,u,m,t),le.mode&1&&s1(m,I,t),t=le,C=I;var ue=t.updateQueue;if(ue===null){var ae=new Set;ae.add(C),t.updateQueue=ae}else ue.add(C);break e}else{if(!(t&1)){s1(m,I,t),uv();break e}C=Error(je(426))}}else if(Bn&&u.mode&1){var oe=l1(x);if(oe!==null){!(oe.flags&65536)&&(oe.flags|=256),u1(oe,x,u,m,t),j_(zu(C,u));break e}}m=C=zu(C,u),xr!==4&&(xr=2),Sh===null?Sh=[m]:Sh.push(m),m=x;do{switch(m.tag){case 3:m.flags|=65536,t&=-t,m.lanes|=t;var $=C2(m,C,t);e1(m,$);break e;case 1:u=C;var G=m.type,ee=m.stateNode;if(!(m.flags&128)&&(typeof G.getDerivedStateFromError=="function"||ee!==null&&typeof ee.componentDidCatch=="function"&&(_s===null||!_s.has(ee)))){m.flags|=65536,t&=-t,m.lanes|=t;var _e=E2(m,u,t);e1(m,_e);break e}}m=m.return}while(m!==null)}q2(o)}catch(Ce){t=Ce,pr===o&&o!==null&&(pr=o=o.return);continue}break}while(!0)}function j2(){var e=ff.current;return ff.current=pf,e===null?pf:e}function uv(){(xr===0||xr===3||xr===2)&&(xr=4),Mr===null||!(al&268435455)&&!(qf&268435455)||cs(Mr,Ur)}function yf(e,t){var o=rn;rn|=2;var l=j2();(Mr!==e||Ur!==t)&&(Ea=null,el(e,t));do try{Ok();break}catch(c){$2(e,c)}while(!0);if(q_(),rn=o,ff.current=l,pr!==null)throw Error(je(261));return Mr=null,Ur=0,xr}function Ok(){for(;pr!==null;)Z2(pr)}function Bk(){for(;pr!==null&&!uI();)Z2(pr)}function Z2(e){var t=H2(e.alternate,e,Zi);e.memoizedProps=e.pendingProps,t===null?q2(e):pr=t,iv.current=null}function q2(e){var t=e;do{var o=t.alternate;if(e=t.return,t.flags&32768){if(o=Ak(o,t),o!==null){o.flags&=32767,pr=o;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{xr=6,pr=null;return}}else if(o=Pk(o,t,Zi),o!==null){pr=o;return}if(t=t.sibling,t!==null){pr=t;return}pr=t=e}while(t!==null);xr===0&&(xr=5)}function Ws(e,t,o){var l=fn,c=_o.transition;try{_o.transition=null,fn=1,Vk(e,t,o,l)}finally{_o.transition=c,fn=l}return null}function Vk(e,t,o,l){do Cu();while(ds!==null);if(rn&6)throw Error(je(327));o=e.finishedWork;var c=e.finishedLanes;if(o===null)return null;if(e.finishedWork=null,e.finishedLanes=0,o===e.current)throw Error(je(177));e.callbackNode=null,e.callbackPriority=0;var m=o.lanes|o.childLanes;if(vI(e,m),e===Mr&&(pr=Mr=null,Ur=0),!(o.subtreeFlags&2064)&&!(o.flags&2064)||Cp||(Cp=!0,W2(Yp,function(){return Cu(),null})),m=(o.flags&15990)!==0,o.subtreeFlags&15990||m){m=_o.transition,_o.transition=null;var x=fn;fn=1;var u=rn;rn|=4,iv.current=null,Dk(e,o),V2(o,e),ok(Ay),Qp=!!Py,Ay=Py=null,e.current=o,Lk(o),cI(),rn=u,fn=x,_o.transition=m}else e.current=o;if(Cp&&(Cp=!1,ds=e,gf=c),m=e.pendingLanes,m===0&&(_s=null),pI(o.stateNode),Fi(e,hr()),t!==null)for(l=e.onRecoverableError,o=0;o<t.length;o++)c=t[o],l(c.value,{componentStack:c.stack,digest:c.digest});if(mf)throw mf=!1,e=Yy,Yy=null,e;return gf&1&&e.tag!==0&&Cu(),m=e.pendingLanes,m&1?e===Jy?Th++:(Th=0,Jy=e):Th=0,Cs(),null}function Cu(){if(ds!==null){var e=Tb(gf),t=_o.transition,o=fn;try{if(_o.transition=null,fn=16>e?16:e,ds===null)var l=!1;else{if(e=ds,ds=null,gf=0,rn&6)throw Error(je(331));var c=rn;for(rn|=4,ct=e.current;ct!==null;){var m=ct,x=m.child;if(ct.flags&16){var u=m.deletions;if(u!==null){for(var C=0;C<u.length;C++){var I=u[C];for(ct=I;ct!==null;){var D=ct;switch(D.tag){case 0:case 11:case 15:bh(8,D,m)}var O=D.child;if(O!==null)O.return=D,ct=O;else for(;ct!==null;){D=ct;var U=D.sibling,le=D.return;if(F2(D),D===I){ct=null;break}if(U!==null){U.return=le,ct=U;break}ct=le}}}var ue=m.alternate;if(ue!==null){var ae=ue.child;if(ae!==null){ue.child=null;do{var oe=ae.sibling;ae.sibling=null,ae=oe}while(ae!==null)}}ct=m}}if(m.subtreeFlags&2064&&x!==null)x.return=m,ct=x;else e:for(;ct!==null;){if(m=ct,m.flags&2048)switch(m.tag){case 0:case 11:case 15:bh(9,m,m.return)}var $=m.sibling;if($!==null){$.return=m.return,ct=$;break e}ct=m.return}}var G=e.current;for(ct=G;ct!==null;){x=ct;var ee=x.child;if(x.subtreeFlags&2064&&ee!==null)ee.return=x,ct=ee;else e:for(x=G;ct!==null;){if(u=ct,u.flags&2048)try{switch(u.tag){case 0:case 11:case 15:Zf(9,u)}}catch(Ce){Jn(u,u.return,Ce)}if(u===x){ct=null;break e}var _e=u.sibling;if(_e!==null){_e.return=u.return,ct=_e;break e}ct=u.return}}if(rn=c,Cs(),aa&&typeof aa.onPostCommitFiberRoot=="function")try{aa.onPostCommitFiberRoot(Ff,e)}catch{}l=!0}return l}finally{fn=o,_o.transition=t}}return!1}function b1(e,t,o){t=zu(o,t),t=C2(e,t,1),e=ys(e,t,1),t=_i(),e!==null&&(Kh(e,1,t),Fi(e,t))}function Jn(e,t,o){if(e.tag===3)b1(e,e,o);else for(;t!==null;){if(t.tag===3){b1(t,e,o);break}else if(t.tag===1){var l=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof l.componentDidCatch=="function"&&(_s===null||!_s.has(l))){e=zu(o,e),e=E2(t,e,1),t=ys(t,e,1),e=_i(),t!==null&&(Kh(t,1,e),Fi(t,e));break}}t=t.return}}function Nk(e,t,o){var l=e.pingCache;l!==null&&l.delete(t),t=_i(),e.pingedLanes|=e.suspendedLanes&o,Mr===e&&(Ur&o)===o&&(xr===4||xr===3&&(Ur&130023424)===Ur&&500>hr()-av?el(e,0):ov|=o),Fi(e,t)}function G2(e,t){t===0&&(e.mode&1?(t=mp,mp<<=1,!(mp&130023424)&&(mp=4194304)):t=1);var o=_i();e=La(e,t),e!==null&&(Kh(e,t,o),Fi(e,o))}function Uk(e){var t=e.memoizedState,o=0;t!==null&&(o=t.retryLane),G2(e,o)}function $k(e,t){var o=0;switch(e.tag){case 13:var l=e.stateNode,c=e.memoizedState;c!==null&&(o=c.retryLane);break;case 19:l=e.stateNode;break;default:throw Error(je(314))}l!==null&&l.delete(t),G2(e,o)}var H2;H2=function(e,t,o){if(e!==null)if(e.memoizedProps!==t.pendingProps||Li.current)Di=!0;else{if(!(e.lanes&o)&&!(t.flags&128))return Di=!1,Mk(e,t,o);Di=!!(e.flags&131072)}else Di=!1,Bn&&t.flags&1048576&&Xb(t,sf,t.index);switch(t.lanes=0,t.tag){case 2:var l=t.type;Np(e,t),e=t.pendingProps;var c=ku(t,ri.current);Tu(t,o),c=Q_(null,t,l,e,c,o);var m=ev();return t.flags|=1,typeof c=="object"&&c!==null&&typeof c.render=="function"&&c.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Ri(l)?(m=!0,of(t)):m=!1,t.memoizedState=c.state!==null&&c.state!==void 0?c.state:null,W_(t),c.updater=$f,t.stateNode=c,c._reactInternals=t,Ny(t,l,e,o),t=jy(null,t,l,!0,m,o)):(t.tag=0,Bn&&m&&U_(t),gi(null,t,c,o),t=t.child),t;case 16:l=t.elementType;e:{switch(Np(e,t),e=t.pendingProps,c=l._init,l=c(l._payload),t.type=l,c=t.tag=Zk(l),e=Oo(l,e),c){case 0:t=$y(null,t,l,e,o);break e;case 1:t=d1(null,t,l,e,o);break e;case 11:t=c1(null,t,l,e,o);break e;case 14:t=h1(null,t,l,Oo(l.type,e),o);break e}throw Error(je(306,l,""))}return t;case 0:return l=t.type,c=t.pendingProps,c=t.elementType===l?c:Oo(l,c),$y(e,t,l,c,o);case 1:return l=t.type,c=t.pendingProps,c=t.elementType===l?c:Oo(l,c),d1(e,t,l,c,o);case 3:e:{if(P2(t),e===null)throw Error(je(387));l=t.pendingProps,m=t.memoizedState,c=m.element,e2(e,t),cf(t,l,null,o);var x=t.memoizedState;if(l=x.element,m.isDehydrated)if(m={element:l,isDehydrated:!1,cache:x.cache,pendingSuspenseBoundaries:x.pendingSuspenseBoundaries,transitions:x.transitions},t.updateQueue.baseState=m,t.memoizedState=m,t.flags&256){c=zu(Error(je(423)),t),t=p1(e,t,l,o,c);break e}else if(l!==c){c=zu(Error(je(424)),t),t=p1(e,t,l,o,c);break e}else for(Wi=gs(t.stateNode.containerInfo.firstChild),Ki=t,Bn=!0,No=null,o=i2(t,null,l,o),t.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling;else{if(Mu(),l===c){t=Ra(e,t,o);break e}gi(e,t,l,o)}t=t.child}return t;case 5:return o2(t),e===null&&Oy(t),l=t.type,c=t.pendingProps,m=e!==null?e.memoizedProps:null,x=c.children,zy(l,c)?x=null:m!==null&&zy(l,m)&&(t.flags|=32),M2(e,t),gi(e,t,x,o),t.child;case 6:return e===null&&Oy(t),null;case 13:return A2(e,t,o);case 4:return K_(t,t.stateNode.containerInfo),l=t.pendingProps,e===null?t.child=Pu(t,null,l,o):gi(e,t,l,o),t.child;case 11:return l=t.type,c=t.pendingProps,c=t.elementType===l?c:Oo(l,c),c1(e,t,l,c,o);case 7:return gi(e,t,t.pendingProps,o),t.child;case 8:return gi(e,t,t.pendingProps.children,o),t.child;case 12:return gi(e,t,t.pendingProps.children,o),t.child;case 10:e:{if(l=t.type._context,c=t.pendingProps,m=t.memoizedProps,x=c.value,kn(lf,l._currentValue),l._currentValue=x,m!==null)if(Zo(m.value,x)){if(m.children===c.children&&!Li.current){t=Ra(e,t,o);break e}}else for(m=t.child,m!==null&&(m.return=t);m!==null;){var u=m.dependencies;if(u!==null){x=m.child;for(var C=u.firstContext;C!==null;){if(C.context===l){if(m.tag===1){C=Pa(-1,o&-o),C.tag=2;var I=m.updateQueue;if(I!==null){I=I.shared;var D=I.pending;D===null?C.next=C:(C.next=D.next,D.next=C),I.pending=C}}m.lanes|=o,C=m.alternate,C!==null&&(C.lanes|=o),By(m.return,o,t),u.lanes|=o;break}C=C.next}}else if(m.tag===10)x=m.type===t.type?null:m.child;else if(m.tag===18){if(x=m.return,x===null)throw Error(je(341));x.lanes|=o,u=x.alternate,u!==null&&(u.lanes|=o),By(x,o,t),x=m.sibling}else x=m.child;if(x!==null)x.return=m;else for(x=m;x!==null;){if(x===t){x=null;break}if(m=x.sibling,m!==null){m.return=x.return,x=m;break}x=x.return}m=x}gi(e,t,c.children,o),t=t.child}return t;case 9:return c=t.type,l=t.pendingProps.children,Tu(t,o),c=vo(c),l=l(c),t.flags|=1,gi(e,t,l,o),t.child;case 14:return l=t.type,c=Oo(l,t.pendingProps),c=Oo(l.type,c),h1(e,t,l,c,o);case 15:return I2(e,t,t.type,t.pendingProps,o);case 17:return l=t.type,c=t.pendingProps,c=t.elementType===l?c:Oo(l,c),Np(e,t),t.tag=1,Ri(l)?(e=!0,of(t)):e=!1,Tu(t,o),n2(t,l,c),Ny(t,l,c,o),jy(null,t,l,!0,e,o);case 19:return z2(e,t,o);case 22:return k2(e,t,o)}throw Error(je(156,t.tag))};function W2(e,t){return xb(e,t)}function jk(e,t,o,l){this.tag=e,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=l,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function yo(e,t,o,l){return new jk(e,t,o,l)}function cv(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Zk(e){if(typeof e=="function")return cv(e)?1:0;if(e!=null){if(e=e.$$typeof,e===M_)return 11;if(e===P_)return 14}return 2}function xs(e,t){var o=e.alternate;return o===null?(o=yo(e.tag,t,e.key,e.mode),o.elementType=e.elementType,o.type=e.type,o.stateNode=e.stateNode,o.alternate=e,e.alternate=o):(o.pendingProps=t,o.type=e.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=e.flags&14680064,o.childLanes=e.childLanes,o.lanes=e.lanes,o.child=e.child,o.memoizedProps=e.memoizedProps,o.memoizedState=e.memoizedState,o.updateQueue=e.updateQueue,t=e.dependencies,o.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},o.sibling=e.sibling,o.index=e.index,o.ref=e.ref,o}function jp(e,t,o,l,c,m){var x=2;if(l=e,typeof e=="function")cv(e)&&(x=1);else if(typeof e=="string")x=5;else e:switch(e){case ru:return tl(o.children,c,m,t);case k_:x=8,c|=8;break;case cy:return e=yo(12,o,t,c|2),e.elementType=cy,e.lanes=m,e;case hy:return e=yo(13,o,t,c),e.elementType=hy,e.lanes=m,e;case dy:return e=yo(19,o,t,c),e.elementType=dy,e.lanes=m,e;case rb:return Gf(o,c,m,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case tb:x=10;break e;case nb:x=9;break e;case M_:x=11;break e;case P_:x=14;break e;case as:x=16,l=null;break e}throw Error(je(130,e==null?e:typeof e,""))}return t=yo(x,o,t,c),t.elementType=e,t.type=l,t.lanes=m,t}function tl(e,t,o,l){return e=yo(7,e,l,t),e.lanes=o,e}function Gf(e,t,o,l){return e=yo(22,e,l,t),e.elementType=rb,e.lanes=o,e.stateNode={isHidden:!1},e}function Zg(e,t,o){return e=yo(6,e,null,t),e.lanes=o,e}function qg(e,t,o){return t=yo(4,e.children!==null?e.children:[],e.key,t),t.lanes=o,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function qk(e,t,o,l,c){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Cg(0),this.expirationTimes=Cg(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Cg(0),this.identifierPrefix=l,this.onRecoverableError=c,this.mutableSourceEagerHydrationData=null}function hv(e,t,o,l,c,m,x,u,C){return e=new qk(e,t,o,u,C),t===1?(t=1,m===!0&&(t|=8)):t=0,m=yo(3,null,null,t),e.current=m,m.stateNode=e,m.memoizedState={element:l,isDehydrated:o,cache:null,transitions:null,pendingSuspenseBoundaries:null},W_(m),e}function Gk(e,t,o){var l=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:nu,key:l==null?null:""+l,children:e,containerInfo:t,implementation:o}}function K2(e){if(!e)return bs;e=e._reactInternals;e:{if(hl(e)!==e||e.tag!==1)throw Error(je(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Ri(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(je(171))}if(e.tag===1){var o=e.type;if(Ri(o))return Wb(e,o,t)}return t}function X2(e,t,o,l,c,m,x,u,C){return e=hv(o,l,!0,e,c,m,x,u,C),e.context=K2(null),o=e.current,l=_i(),c=vs(o),m=Pa(l,c),m.callback=t??null,ys(o,m,c),e.current.lanes=c,Kh(e,c,l),Fi(e,l),e}function Hf(e,t,o,l){var c=t.current,m=_i(),x=vs(c);return o=K2(o),t.context===null?t.context=o:t.pendingContext=o,t=Pa(m,x),t.payload={element:e},l=l===void 0?null:l,l!==null&&(t.callback=l),e=ys(c,t,x),e!==null&&($o(e,c,x,m),Op(e,c,x)),x}function _f(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function S1(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var o=e.retryLane;e.retryLane=o!==0&&o<t?o:t}}function dv(e,t){S1(e,t),(e=e.alternate)&&S1(e,t)}function Hk(){return null}var Y2=typeof reportError=="function"?reportError:function(e){console.error(e)};function pv(e){this._internalRoot=e}Wf.prototype.render=pv.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(je(409));Hf(e,t,null,null)};Wf.prototype.unmount=pv.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;sl(function(){Hf(null,e,null,null)}),t[Da]=null}};function Wf(e){this._internalRoot=e}Wf.prototype.unstable_scheduleHydration=function(e){if(e){var t=Ib();e={blockedOn:null,target:e,priority:t};for(var o=0;o<us.length&&t!==0&&t<us[o].priority;o++);us.splice(o,0,e),o===0&&Mb(e)}};function fv(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Kf(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function T1(){}function Wk(e,t,o,l,c){if(c){if(typeof l=="function"){var m=l;l=function(){var I=_f(x);m.call(I)}}var x=X2(t,l,e,0,null,!1,!1,"",T1);return e._reactRootContainer=x,e[Da]=x.current,Rh(e.nodeType===8?e.parentNode:e),sl(),x}for(;c=e.lastChild;)e.removeChild(c);if(typeof l=="function"){var u=l;l=function(){var I=_f(C);u.call(I)}}var C=hv(e,0,!1,null,null,!1,!1,"",T1);return e._reactRootContainer=C,e[Da]=C.current,Rh(e.nodeType===8?e.parentNode:e),sl(function(){Hf(t,C,o,l)}),C}function Xf(e,t,o,l,c){var m=o._reactRootContainer;if(m){var x=m;if(typeof c=="function"){var u=c;c=function(){var C=_f(x);u.call(C)}}Hf(t,x,e,c)}else x=Wk(o,t,e,c,l);return _f(x)}Cb=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var o=ph(t.pendingLanes);o!==0&&(D_(t,o|1),Fi(t,hr()),!(rn&6)&&(Du=hr()+500,Cs()))}break;case 13:sl(function(){var l=La(e,1);if(l!==null){var c=_i();$o(l,e,1,c)}}),dv(e,1)}};L_=function(e){if(e.tag===13){var t=La(e,134217728);if(t!==null){var o=_i();$o(t,e,134217728,o)}dv(e,134217728)}};Eb=function(e){if(e.tag===13){var t=vs(e),o=La(e,t);if(o!==null){var l=_i();$o(o,e,t,l)}dv(e,t)}};Ib=function(){return fn};kb=function(e,t){var o=fn;try{return fn=e,t()}finally{fn=o}};by=function(e,t,o){switch(t){case"input":if(my(e,o),t=o.name,o.type==="radio"&&t!=null){for(o=e;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<o.length;t++){var l=o[t];if(l!==e&&l.form===e.form){var c=Nf(l);if(!c)throw Error(je(90));ob(l),my(l,c)}}}break;case"textarea":sb(e,o);break;case"select":t=o.value,t!=null&&xu(e,!!o.multiple,t,!1)}};fb=sv;mb=sl;var Kk={usingClientEntryPoint:!1,Events:[Yh,su,Nf,db,pb,sv]},th={findFiberByHostInstance:Ks,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},Xk={bundleType:th.bundleType,version:th.version,rendererPackageName:th.rendererPackageName,rendererConfig:th.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Fa.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=_b(e),e===null?null:e.stateNode},findFiberByHostInstance:th.findFiberByHostInstance||Hk,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ep=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ep.isDisabled&&Ep.supportsFiber)try{Ff=Ep.inject(Xk),aa=Ep}catch{}}Ji.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Kk;Ji.createPortal=function(e,t){var o=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!fv(t))throw Error(je(200));return Gk(e,t,null,o)};Ji.createRoot=function(e,t){if(!fv(e))throw Error(je(299));var o=!1,l="",c=Y2;return t!=null&&(t.unstable_strictMode===!0&&(o=!0),t.identifierPrefix!==void 0&&(l=t.identifierPrefix),t.onRecoverableError!==void 0&&(c=t.onRecoverableError)),t=hv(e,1,!1,null,null,o,!1,l,c),e[Da]=t.current,Rh(e.nodeType===8?e.parentNode:e),new pv(t)};Ji.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(je(188)):(e=Object.keys(e).join(","),Error(je(268,e)));return e=_b(t),e=e===null?null:e.stateNode,e};Ji.flushSync=function(e){return sl(e)};Ji.hydrate=function(e,t,o){if(!Kf(t))throw Error(je(200));return Xf(null,e,t,!0,o)};Ji.hydrateRoot=function(e,t,o){if(!fv(e))throw Error(je(405));var l=o!=null&&o.hydratedSources||null,c=!1,m="",x=Y2;if(o!=null&&(o.unstable_strictMode===!0&&(c=!0),o.identifierPrefix!==void 0&&(m=o.identifierPrefix),o.onRecoverableError!==void 0&&(x=o.onRecoverableError)),t=X2(t,null,e,1,o??null,c,!1,m,x),e[Da]=t.current,Rh(e),l)for(e=0;e<l.length;e++)o=l[e],c=o._getVersion,c=c(o._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[o,c]:t.mutableSourceEagerHydrationData.push(o,c);return new Wf(t)};Ji.render=function(e,t,o){if(!Kf(t))throw Error(je(200));return Xf(null,e,t,!1,o)};Ji.unmountComponentAtNode=function(e){if(!Kf(e))throw Error(je(40));return e._reactRootContainer?(sl(function(){Xf(null,null,e,!1,function(){e._reactRootContainer=null,e[Da]=null})}),!0):!1};Ji.unstable_batchedUpdates=sv;Ji.unstable_renderSubtreeIntoContainer=function(e,t,o,l){if(!Kf(o))throw Error(je(200));if(e==null||e._reactInternals===void 0)throw Error(je(38));return Xf(e,t,o,!1,l)};Ji.version="18.2.0-next-9e3b772b8-20220608";function J2(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(J2)}catch(e){console.error(e)}}J2(),Xw.exports=Ji;var Nu=Xw.exports;const Yk=x_(Nu),Jk=v_({__proto__:null,default:Yk},[Nu]);var Q2,C1=Nu;Q2=C1.createRoot,C1.hydrateRoot;/**
 * @remix-run/router v1.14.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Qn(){return Qn=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])}return e},Qn.apply(this,arguments)}var cr;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(cr||(cr={}));const E1="popstate";function Qk(e){e===void 0&&(e={});function t(l,c){let{pathname:m,search:x,hash:u}=l.location;return Zh("",{pathname:m,search:x,hash:u},c.state&&c.state.usr||null,c.state&&c.state.key||"default")}function o(l,c){return typeof c=="string"?c:Qh(c)}return tM(t,o,null,e)}function Kt(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function ll(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function eM(){return Math.random().toString(36).substr(2,8)}function I1(e,t){return{usr:e.state,key:e.key,idx:t}}function Zh(e,t,o,l){return o===void 0&&(o=null),Qn({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?Oa(t):t,{state:o,key:t&&t.key||l||eM()})}function Qh(e){let{pathname:t="/",search:o="",hash:l=""}=e;return o&&o!=="?"&&(t+=o.charAt(0)==="?"?o:"?"+o),l&&l!=="#"&&(t+=l.charAt(0)==="#"?l:"#"+l),t}function Oa(e){let t={};if(e){let o=e.indexOf("#");o>=0&&(t.hash=e.substr(o),e=e.substr(0,o));let l=e.indexOf("?");l>=0&&(t.search=e.substr(l),e=e.substr(0,l)),e&&(t.pathname=e)}return t}function tM(e,t,o,l){l===void 0&&(l={});let{window:c=document.defaultView,v5Compat:m=!1}=l,x=c.history,u=cr.Pop,C=null,I=D();I==null&&(I=0,x.replaceState(Qn({},x.state,{idx:I}),""));function D(){return(x.state||{idx:null}).idx}function O(){u=cr.Pop;let oe=D(),$=oe==null?null:oe-I;I=oe,C&&C({action:u,location:ae.location,delta:$})}function U(oe,$){u=cr.Push;let G=Zh(ae.location,oe,$);o&&o(G,oe),I=D()+1;let ee=I1(G,I),_e=ae.createHref(G);try{x.pushState(ee,"",_e)}catch(Ce){if(Ce instanceof DOMException&&Ce.name==="DataCloneError")throw Ce;c.location.assign(_e)}m&&C&&C({action:u,location:ae.location,delta:1})}function le(oe,$){u=cr.Replace;let G=Zh(ae.location,oe,$);o&&o(G,oe),I=D();let ee=I1(G,I),_e=ae.createHref(G);x.replaceState(ee,"",_e),m&&C&&C({action:u,location:ae.location,delta:0})}function ue(oe){let $=c.location.origin!=="null"?c.location.origin:c.location.href,G=typeof oe=="string"?oe:Qh(oe);return Kt($,"No window.location.(origin|href) available to create URL for href: "+G),new URL(G,$)}let ae={get action(){return u},get location(){return e(c,x)},listen(oe){if(C)throw new Error("A history only accepts one active listener");return c.addEventListener(E1,O),C=oe,()=>{c.removeEventListener(E1,O),C=null}},createHref(oe){return t(c,oe)},createURL:ue,encodeLocation(oe){let $=ue(oe);return{pathname:$.pathname,search:$.search,hash:$.hash}},push:U,replace:le,go(oe){return x.go(oe)}};return ae}var Yn;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(Yn||(Yn={}));const nM=new Set(["lazy","caseSensitive","path","id","index","children"]);function rM(e){return e.index===!0}function t_(e,t,o,l){return o===void 0&&(o=[]),l===void 0&&(l={}),e.map((c,m)=>{let x=[...o,m],u=typeof c.id=="string"?c.id:x.join("-");if(Kt(c.index!==!0||!c.children,"Cannot specify children on an index route"),Kt(!l[u],'Found a route id collision on id "'+u+`".  Route id's must be globally unique within Data Router usages`),rM(c)){let C=Qn({},c,t(c),{id:u});return l[u]=C,C}else{let C=Qn({},c,t(c),{id:u,children:void 0});return l[u]=C,c.children&&(C.children=t_(c.children,t,x,l)),C}})}function fu(e,t,o){o===void 0&&(o="/");let l=typeof t=="string"?Oa(t):t,c=ed(l.pathname||"/",o);if(c==null)return null;let m=eS(e);oM(m);let x=null;for(let u=0;x==null&&u<m.length;++u)x=fM(m[u],yM(c));return x}function iM(e,t){let{route:o,pathname:l,params:c}=e;return{id:o.id,pathname:l,params:c,data:t[o.id],handle:o.handle}}function eS(e,t,o,l){t===void 0&&(t=[]),o===void 0&&(o=[]),l===void 0&&(l="");let c=(m,x,u)=>{let C={relativePath:u===void 0?m.path||"":u,caseSensitive:m.caseSensitive===!0,childrenIndex:x,route:m};C.relativePath.startsWith("/")&&(Kt(C.relativePath.startsWith(l),'Absolute route path "'+C.relativePath+'" nested under path '+('"'+l+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),C.relativePath=C.relativePath.slice(l.length));let I=nl([l,C.relativePath]),D=o.concat(C);m.children&&m.children.length>0&&(Kt(m.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+I+'".')),eS(m.children,t,D,I)),!(m.path==null&&!m.index)&&t.push({path:I,score:dM(I,m.index),routesMeta:D})};return e.forEach((m,x)=>{var u;if(m.path===""||!((u=m.path)!=null&&u.includes("?")))c(m,x);else for(let C of tS(m.path))c(m,x,C)}),t}function tS(e){let t=e.split("/");if(t.length===0)return[];let[o,...l]=t,c=o.endsWith("?"),m=o.replace(/\?$/,"");if(l.length===0)return c?[m,""]:[m];let x=tS(l.join("/")),u=[];return u.push(...x.map(C=>C===""?m:[m,C].join("/"))),c&&u.push(...x),u.map(C=>e.startsWith("/")&&C===""?"/":C)}function oM(e){e.sort((t,o)=>t.score!==o.score?o.score-t.score:pM(t.routesMeta.map(l=>l.childrenIndex),o.routesMeta.map(l=>l.childrenIndex)))}const aM=/^:[\w-]+$/,sM=3,lM=2,uM=1,cM=10,hM=-2,k1=e=>e==="*";function dM(e,t){let o=e.split("/"),l=o.length;return o.some(k1)&&(l+=hM),t&&(l+=lM),o.filter(c=>!k1(c)).reduce((c,m)=>c+(aM.test(m)?sM:m===""?uM:cM),l)}function pM(e,t){return e.length===t.length&&e.slice(0,-1).every((l,c)=>l===t[c])?e[e.length-1]-t[t.length-1]:0}function fM(e,t){let{routesMeta:o}=e,l={},c="/",m=[];for(let x=0;x<o.length;++x){let u=o[x],C=x===o.length-1,I=c==="/"?t:t.slice(c.length)||"/",D=mM({path:u.relativePath,caseSensitive:u.caseSensitive,end:C},I);if(!D)return null;Object.assign(l,D.params);let O=u.route;m.push({params:l,pathname:nl([c,D.pathname]),pathnameBase:SM(nl([c,D.pathnameBase])),route:O}),D.pathnameBase!=="/"&&(c=nl([c,D.pathnameBase]))}return m}function mM(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[o,l]=gM(e.path,e.caseSensitive,e.end),c=t.match(o);if(!c)return null;let m=c[0],x=m.replace(/(.)\/+$/,"$1"),u=c.slice(1);return{params:l.reduce((I,D,O)=>{let{paramName:U,isOptional:le}=D;if(U==="*"){let ae=u[O]||"";x=m.slice(0,m.length-ae.length).replace(/(.)\/+$/,"$1")}const ue=u[O];return le&&!ue?I[U]=void 0:I[U]=_M(ue||"",U),I},{}),pathname:m,pathnameBase:x,pattern:e}}function gM(e,t,o){t===void 0&&(t=!1),o===void 0&&(o=!0),ll(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let l=[],c="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(x,u,C)=>(l.push({paramName:u,isOptional:C!=null}),C?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(l.push({paramName:"*"}),c+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):o?c+="\\/*$":e!==""&&e!=="/"&&(c+="(?:(?=\\/|$))"),[new RegExp(c,t?void 0:"i"),l]}function yM(e){try{return decodeURI(e)}catch(t){return ll(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function _M(e,t){try{return decodeURIComponent(e)}catch(o){return ll(!1,'The value for the URL param "'+t+'" will not be decoded because'+(' the string "'+e+'" is a malformed URL segment. This is probably')+(" due to a bad percent encoding ("+o+").")),e}}function ed(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let o=t.endsWith("/")?t.length-1:t.length,l=e.charAt(o);return l&&l!=="/"?null:e.slice(o)||"/"}function vM(e,t){t===void 0&&(t="/");let{pathname:o,search:l="",hash:c=""}=typeof e=="string"?Oa(e):e;return{pathname:o?o.startsWith("/")?o:xM(o,t):t,search:TM(l),hash:CM(c)}}function xM(e,t){let o=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(c=>{c===".."?o.length>1&&o.pop():c!=="."&&o.push(c)}),o.length>1?o.join("/"):"/"}function Gg(e,t,o,l){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(l)+"].  Please separate it out to the ")+("`to."+o+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function nS(e){return e.filter((t,o)=>o===0||t.route.path&&t.route.path.length>0)}function wM(e,t){let o=nS(e);return t?o.map((l,c)=>c===e.length-1?l.pathname:l.pathnameBase):o.map(l=>l.pathnameBase)}function bM(e,t,o,l){l===void 0&&(l=!1);let c;typeof e=="string"?c=Oa(e):(c=Qn({},e),Kt(!c.pathname||!c.pathname.includes("?"),Gg("?","pathname","search",c)),Kt(!c.pathname||!c.pathname.includes("#"),Gg("#","pathname","hash",c)),Kt(!c.search||!c.search.includes("#"),Gg("#","search","hash",c)));let m=e===""||c.pathname==="",x=m?"/":c.pathname,u;if(x==null)u=o;else{let O=t.length-1;if(!l&&x.startsWith("..")){let U=x.split("/");for(;U[0]==="..";)U.shift(),O-=1;c.pathname=U.join("/")}u=O>=0?t[O]:"/"}let C=vM(c,u),I=x&&x!=="/"&&x.endsWith("/"),D=(m||x===".")&&o.endsWith("/");return!C.pathname.endsWith("/")&&(I||D)&&(C.pathname+="/"),C}const nl=e=>e.join("/").replace(/\/\/+/g,"/"),SM=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),TM=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,CM=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;class mv{constructor(t,o,l,c){c===void 0&&(c=!1),this.status=t,this.statusText=o||"",this.internal=c,l instanceof Error?(this.data=l.toString(),this.error=l):this.data=l}}function rS(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const iS=["post","put","patch","delete"],EM=new Set(iS),IM=["get",...iS],kM=new Set(IM),MM=new Set([301,302,303,307,308]),PM=new Set([307,308]),Hg={state:"idle",location:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},AM={state:"idle",data:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},nh={state:"unblocked",proceed:void 0,reset:void 0,location:void 0},oS=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,zM=e=>({hasErrorBoundary:!!e.hasErrorBoundary}),aS="remix-router-transitions";function DM(e){const t=e.window?e.window:typeof window<"u"?window:void 0,o=typeof t<"u"&&typeof t.document<"u"&&typeof t.document.createElement<"u",l=!o;Kt(e.routes.length>0,"You must provide a non-empty routes array to createRouter");let c;if(e.mapRouteProperties)c=e.mapRouteProperties;else if(e.detectErrorBoundary){let xe=e.detectErrorBoundary;c=B=>({hasErrorBoundary:xe(B)})}else c=zM;let m={},x=t_(e.routes,c,void 0,m),u,C=e.basename||"/",I=Qn({v7_fetcherPersist:!1,v7_normalizeFormMethod:!1,v7_partialHydration:!1,v7_prependBasename:!1,v7_relativeSplatPath:!1},e.future),D=null,O=new Set,U=null,le=null,ue=null,ae=e.hydrationData!=null,oe=fu(x,e.history.location,C),$=null;if(oe==null){let xe=fo(404,{pathname:e.history.location.pathname}),{matches:B,route:P}=F1(x);oe=B,$={[P.id]:xe}}let G,ee=oe.some(xe=>xe.route.lazy),_e=oe.some(xe=>xe.route.loader);if(ee)G=!1;else if(!_e)G=!0;else if(I.v7_partialHydration){let xe=e.hydrationData?e.hydrationData.loaderData:null,B=e.hydrationData?e.hydrationData.errors:null;G=oe.every(P=>P.route.loader&&P.route.loader.hydrate!==!0&&(xe&&xe[P.route.id]!==void 0||B&&B[P.route.id]!==void 0))}else G=e.hydrationData!=null;let Ce,de={historyAction:e.history.action,location:e.history.location,matches:oe,initialized:G,navigation:Hg,restoreScrollPosition:e.hydrationData!=null?!1:null,preventScrollReset:!1,revalidation:"idle",loaderData:e.hydrationData&&e.hydrationData.loaderData||{},actionData:e.hydrationData&&e.hydrationData.actionData||null,errors:e.hydrationData&&e.hydrationData.errors||$,fetchers:new Map,blockers:new Map},be=cr.Pop,Me=!1,Ze,Oe=!1,ft=new Map,bt=null,Rt=!1,Ft=!1,It=[],zt=[],xt=new Map,Be=0,lt=-1,dt=new Map,kt=new Set,ht=new Map,_t=new Map,Tt=new Set,tn=new Map,Zt=new Map,hn=!1;function Mn(){if(D=e.history.listen(xe=>{let{action:B,location:P,delta:F}=xe;if(hn){hn=!1;return}ll(Zt.size===0||F!=null,"You are trying to use a blocker on a POP navigation to a location that was not created by @remix-run/router. This will fail silently in production. This can happen if you are navigating outside the router via `window.history.pushState`/`window.location.hash` instead of using router navigation APIs.  This can also happen if you are using createHashRouter and the user manually changes the URL.");let Z=Si({currentLocation:de.location,nextLocation:P,historyAction:B});if(Z&&F!=null){hn=!0,e.history.go(F*-1),bi(Z,{state:"blocked",location:P,proceed(){bi(Z,{state:"proceeding",proceed:void 0,reset:void 0,location:P}),e.history.go(F)},reset(){let H=new Map(de.blockers);H.set(Z,nh),xn({blockers:H})}});return}return wr(B,P)}),o){ZM(t,ft);let xe=()=>qM(t,ft);t.addEventListener("pagehide",xe),bt=()=>t.removeEventListener("pagehide",xe)}return de.initialized||wr(cr.Pop,de.location,{initialHydration:!0}),Ce}function qn(){D&&D(),bt&&bt(),O.clear(),Ze&&Ze.abort(),de.fetchers.forEach((xe,B)=>Zr(B)),de.blockers.forEach((xe,B)=>gn(B))}function tr(xe){return O.add(xe),()=>O.delete(xe)}function xn(xe,B){B===void 0&&(B={}),de=Qn({},de,xe);let P=[],F=[];I.v7_fetcherPersist&&de.fetchers.forEach((Z,H)=>{Z.state==="idle"&&(Tt.has(H)?F.push(H):P.push(H))}),[...O].forEach(Z=>Z(de,{deletedFetchers:F,unstable_viewTransitionOpts:B.viewTransitionOpts,unstable_flushSync:B.flushSync===!0})),I.v7_fetcherPersist&&(P.forEach(Z=>de.fetchers.delete(Z)),F.forEach(Z=>Zr(Z)))}function Gn(xe,B,P){var F,Z;let{flushSync:H}=P===void 0?{}:P,W=de.actionData!=null&&de.navigation.formMethod!=null&&Vo(de.navigation.formMethod)&&de.navigation.state==="loading"&&((F=xe.state)==null?void 0:F._isRedirect)!==!0,ce;B.actionData?Object.keys(B.actionData).length>0?ce=B.actionData:ce=null:W?ce=de.actionData:ce=null;let ne=B.loaderData?R1(de.loaderData,B.loaderData,B.matches||[],B.errors):de.loaderData,Q=de.blockers;Q.size>0&&(Q=new Map(Q),Q.forEach((ke,Pe)=>Q.set(Pe,nh)));let fe=Me===!0||de.navigation.formMethod!=null&&Vo(de.navigation.formMethod)&&((Z=xe.state)==null?void 0:Z._isRedirect)!==!0;u&&(x=u,u=void 0),Rt||be===cr.Pop||(be===cr.Push?e.history.push(xe,xe.state):be===cr.Replace&&e.history.replace(xe,xe.state));let we;if(be===cr.Pop){let ke=ft.get(de.location.pathname);ke&&ke.has(xe.pathname)?we={currentLocation:de.location,nextLocation:xe}:ft.has(xe.pathname)&&(we={currentLocation:xe,nextLocation:de.location})}else if(Oe){let ke=ft.get(de.location.pathname);ke?ke.add(xe.pathname):(ke=new Set([xe.pathname]),ft.set(de.location.pathname,ke)),we={currentLocation:de.location,nextLocation:xe}}xn(Qn({},B,{actionData:ce,loaderData:ne,historyAction:be,location:xe,initialized:!0,navigation:Hg,revalidation:"idle",restoreScrollPosition:ii(xe,B.matches||de.matches),preventScrollReset:fe,blockers:Q}),{viewTransitionOpts:we,flushSync:H===!0}),be=cr.Pop,Me=!1,Oe=!1,Rt=!1,Ft=!1,It=[],zt=[]}async function to(xe,B){if(typeof xe=="number"){e.history.go(xe);return}let P=n_(de.location,de.matches,C,I.v7_prependBasename,xe,I.v7_relativeSplatPath,B==null?void 0:B.fromRouteId,B==null?void 0:B.relative),{path:F,submission:Z,error:H}=M1(I.v7_normalizeFormMethod,!1,P,B),W=de.location,ce=Zh(de.location,F,B&&B.state);ce=Qn({},ce,e.history.encodeLocation(ce));let ne=B&&B.replace!=null?B.replace:void 0,Q=cr.Push;ne===!0?Q=cr.Replace:ne===!1||Z!=null&&Vo(Z.formMethod)&&Z.formAction===de.location.pathname+de.location.search&&(Q=cr.Replace);let fe=B&&"preventScrollReset"in B?B.preventScrollReset===!0:void 0,we=(B&&B.unstable_flushSync)===!0,ke=Si({currentLocation:W,nextLocation:ce,historyAction:Q});if(ke){bi(ke,{state:"blocked",location:ce,proceed(){bi(ke,{state:"proceeding",proceed:void 0,reset:void 0,location:ce}),to(xe,B)},reset(){let Pe=new Map(de.blockers);Pe.set(ke,nh),xn({blockers:Pe})}});return}return await wr(Q,ce,{submission:Z,pendingError:H,preventScrollReset:fe,replace:B&&B.replace,enableViewTransition:B&&B.unstable_viewTransition,flushSync:we})}function jr(){if(nn(),xn({revalidation:"loading"}),de.navigation.state!=="submitting"){if(de.navigation.state==="idle"){wr(de.historyAction,de.location,{startUninterruptedRevalidation:!0});return}wr(be||de.historyAction,de.navigation.location,{overrideNavigation:de.navigation})}}async function wr(xe,B,P){Ze&&Ze.abort(),Ze=null,be=xe,Rt=(P&&P.startUninterruptedRevalidation)===!0,fr(de.location,de.matches),Me=(P&&P.preventScrollReset)===!0,Oe=(P&&P.enableViewTransition)===!0;let F=u||x,Z=P&&P.overrideNavigation,H=fu(F,B,C),W=(P&&P.flushSync)===!0;if(!H){let Pe=fo(404,{pathname:B.pathname}),{matches:et,route:nt}=F1(F);Ue(),Gn(B,{matches:et,loaderData:{},errors:{[nt.id]:Pe}},{flushSync:W});return}if(de.initialized&&!Ft&&BM(de.location,B)&&!(P&&P.submission&&Vo(P.submission.formMethod))){Gn(B,{matches:H},{flushSync:W});return}Ze=new AbortController;let ce=ih(e.history,B,Ze.signal,P&&P.submission),ne,Q;if(P&&P.pendingError)Q={[Ch(H).route.id]:P.pendingError};else if(P&&P.submission&&Vo(P.submission.formMethod)){let Pe=await wo(ce,B,P.submission,H,{replace:P.replace,flushSync:W});if(Pe.shortCircuited)return;ne=Pe.pendingActionData,Q=Pe.pendingActionError,Z=Wg(B,P.submission),W=!1,ce=new Request(ce.url,{signal:ce.signal})}let{shortCircuited:fe,loaderData:we,errors:ke}=await no(ce,B,H,Z,P&&P.submission,P&&P.fetcherSubmission,P&&P.replace,P&&P.initialHydration===!0,W,ne,Q);fe||(Ze=null,Gn(B,Qn({matches:H},ne?{actionData:ne}:{},{loaderData:we,errors:ke})))}async function wo(xe,B,P,F,Z){Z===void 0&&(Z={}),nn();let H=$M(B,P);xn({navigation:H},{flushSync:Z.flushSync===!0});let W,ce=i_(F,B);if(!ce.route.action&&!ce.route.lazy)W={type:Yn.error,error:fo(405,{method:xe.method,pathname:B.pathname,routeId:ce.route.id})};else if(W=await rh("action",xe,ce,F,m,c,C,I.v7_relativeSplatPath),xe.signal.aborted)return{shortCircuited:!0};if(Qs(W)){let ne;return Z&&Z.replace!=null?ne=Z.replace:ne=W.location===de.location.pathname+de.location.search,await Hn(de,W,{submission:P,replace:ne}),{shortCircuited:!0}}if(mu(W)){let ne=Ch(F,ce.route.id);return(Z&&Z.replace)!==!0&&(be=cr.Push),{pendingActionData:{},pendingActionError:{[ne.route.id]:W.error}}}if(Js(W))throw fo(400,{type:"defer-action"});return{pendingActionData:{[ce.route.id]:W.data}}}async function no(xe,B,P,F,Z,H,W,ce,ne,Q,fe){let we=F||Wg(B,Z),ke=Z||H||V1(we),Pe=u||x,[et,nt]=P1(e.history,de,P,ke,B,I.v7_partialHydration&&ce===!0,Ft,It,zt,Tt,ht,kt,Pe,C,Q,fe);if(Ue(Pt=>!(P&&P.some(Wt=>Wt.route.id===Pt))||et&&et.some(Wt=>Wt.route.id===Pt)),lt=++Be,et.length===0&&nt.length===0){let Pt=io();return Gn(B,Qn({matches:P,loaderData:{},errors:fe||null},Q?{actionData:Q}:{},Pt?{fetchers:new Map(de.fetchers)}:{}),{flushSync:ne}),{shortCircuited:!0}}if(!Rt&&(!I.v7_partialHydration||!ce)){nt.forEach(Wt=>{let oi=de.fetchers.get(Wt.key),Vi=oh(void 0,oi?oi.data:void 0);de.fetchers.set(Wt.key,Vi)});let Pt=Q||de.actionData;xn(Qn({navigation:we},Pt?Object.keys(Pt).length===0?{actionData:null}:{actionData:Pt}:{},nt.length>0?{fetchers:new Map(de.fetchers)}:{}),{flushSync:ne})}nt.forEach(Pt=>{xt.has(Pt.key)&&zr(Pt.key),Pt.controller&&xt.set(Pt.key,Pt.controller)});let Ye=()=>nt.forEach(Pt=>zr(Pt.key));Ze&&Ze.signal.addEventListener("abort",Ye);let{results:ut,loaderResults:yt,fetcherResults:Ot}=await Ar(de.matches,P,et,nt,xe);if(xe.signal.aborted)return{shortCircuited:!0};Ze&&Ze.signal.removeEventListener("abort",Ye),nt.forEach(Pt=>xt.delete(Pt.key));let Ht=O1(ut);if(Ht){if(Ht.idx>=et.length){let Pt=nt[Ht.idx-et.length].key;kt.add(Pt)}return await Hn(de,Ht.result,{replace:W}),{shortCircuited:!0}}let{loaderData:Nt,errors:Bt}=L1(de,P,et,yt,fe,nt,Ot,tn);tn.forEach((Pt,Wt)=>{Pt.subscribe(oi=>{(oi||Pt.done)&&tn.delete(Wt)})});let Wn=io(),Xt=Ne(lt),wn=Wn||Xt||nt.length>0;return Qn({loaderData:Nt,errors:Bt},wn?{fetchers:new Map(de.fetchers)}:{})}function ro(xe,B,P,F){if(l)throw new Error("router.fetch() was called during the server render, but it shouldn't be. You are likely calling a useFetcher() method in the body of your component. Try moving it to a useEffect or a callback.");xt.has(xe)&&zr(xe);let Z=(F&&F.unstable_flushSync)===!0,H=u||x,W=n_(de.location,de.matches,C,I.v7_prependBasename,P,I.v7_relativeSplatPath,B,F==null?void 0:F.relative),ce=fu(H,W,C);if(!ce){br(xe,B,fo(404,{pathname:W}),{flushSync:Z});return}let{path:ne,submission:Q,error:fe}=M1(I.v7_normalizeFormMethod,!0,W,F);if(fe){br(xe,B,fe,{flushSync:Z});return}let we=i_(ce,ne);if(Me=(F&&F.preventScrollReset)===!0,Q&&Vo(Q.formMethod)){bo(xe,B,ne,we,ce,Z,Q);return}ht.set(xe,{routeId:B,path:ne}),Ae(xe,B,ne,we,ce,Z,Q)}async function bo(xe,B,P,F,Z,H,W){if(nn(),ht.delete(xe),!F.route.action&&!F.route.lazy){let Wt=fo(405,{method:W.formMethod,pathname:P,routeId:B});br(xe,B,Wt,{flushSync:H});return}let ce=de.fetchers.get(xe);Dt(xe,jM(W,ce),{flushSync:H});let ne=new AbortController,Q=ih(e.history,P,ne.signal,W);xt.set(xe,ne);let fe=Be,we=await rh("action",Q,F,Z,m,c,C,I.v7_relativeSplatPath);if(Q.signal.aborted){xt.get(xe)===ne&&xt.delete(xe);return}if(I.v7_fetcherPersist&&Tt.has(xe)){if(Qs(we)||mu(we)){Dt(xe,os(void 0));return}}else{if(Qs(we))if(xt.delete(xe),lt>fe){Dt(xe,os(void 0));return}else return kt.add(xe),Dt(xe,oh(W)),Hn(de,we,{fetcherSubmission:W});if(mu(we)){br(xe,B,we.error);return}}if(Js(we))throw fo(400,{type:"defer-action"});let ke=de.navigation.location||de.location,Pe=ih(e.history,ke,ne.signal),et=u||x,nt=de.navigation.state!=="idle"?fu(et,de.navigation.location,C):de.matches;Kt(nt,"Didn't find any matches after fetcher action");let Ye=++Be;dt.set(xe,Ye);let ut=oh(W,we.data);de.fetchers.set(xe,ut);let[yt,Ot]=P1(e.history,de,nt,W,ke,!1,Ft,It,zt,Tt,ht,kt,et,C,{[F.route.id]:we.data},void 0);Ot.filter(Wt=>Wt.key!==xe).forEach(Wt=>{let oi=Wt.key,Vi=de.fetchers.get(oi),qo=oh(void 0,Vi?Vi.data:void 0);de.fetchers.set(oi,qo),xt.has(oi)&&zr(oi),Wt.controller&&xt.set(oi,Wt.controller)}),xn({fetchers:new Map(de.fetchers)});let Ht=()=>Ot.forEach(Wt=>zr(Wt.key));ne.signal.addEventListener("abort",Ht);let{results:Nt,loaderResults:Bt,fetcherResults:Wn}=await Ar(de.matches,nt,yt,Ot,Pe);if(ne.signal.aborted)return;ne.signal.removeEventListener("abort",Ht),dt.delete(xe),xt.delete(xe),Ot.forEach(Wt=>xt.delete(Wt.key));let Xt=O1(Nt);if(Xt){if(Xt.idx>=yt.length){let Wt=Ot[Xt.idx-yt.length].key;kt.add(Wt)}return Hn(de,Xt.result)}let{loaderData:wn,errors:Pt}=L1(de,de.matches,yt,Bt,void 0,Ot,Wn,tn);if(de.fetchers.has(xe)){let Wt=os(we.data);de.fetchers.set(xe,Wt)}Ne(Ye),de.navigation.state==="loading"&&Ye>lt?(Kt(be,"Expected pending action"),Ze&&Ze.abort(),Gn(de.navigation.location,{matches:nt,loaderData:wn,errors:Pt,fetchers:new Map(de.fetchers)})):(xn({errors:Pt,loaderData:R1(de.loaderData,wn,nt,Pt),fetchers:new Map(de.fetchers)}),Ft=!1)}async function Ae(xe,B,P,F,Z,H,W){let ce=de.fetchers.get(xe);Dt(xe,oh(W,ce?ce.data:void 0),{flushSync:H});let ne=new AbortController,Q=ih(e.history,P,ne.signal);xt.set(xe,ne);let fe=Be,we=await rh("loader",Q,F,Z,m,c,C,I.v7_relativeSplatPath);if(Js(we)&&(we=await uS(we,Q.signal,!0)||we),xt.get(xe)===ne&&xt.delete(xe),!Q.signal.aborted){if(Tt.has(xe)){Dt(xe,os(void 0));return}if(Qs(we))if(lt>fe){Dt(xe,os(void 0));return}else{kt.add(xe),await Hn(de,we);return}if(mu(we)){br(xe,B,we.error);return}Kt(!Js(we),"Unhandled fetcher deferred data"),Dt(xe,os(we.data))}}async function Hn(xe,B,P){let{submission:F,fetcherSubmission:Z,replace:H}=P===void 0?{}:P;B.revalidate&&(Ft=!0);let W=Zh(xe.location,B.location,{_isRedirect:!0});if(Kt(W,"Expected a location on the redirect navigation"),o){let ke=!1;if(B.reloadDocument)ke=!0;else if(oS.test(B.location)){const Pe=e.history.createURL(B.location);ke=Pe.origin!==t.location.origin||ed(Pe.pathname,C)==null}if(ke){H?t.location.replace(B.location):t.location.assign(B.location);return}}Ze=null;let ce=H===!0?cr.Replace:cr.Push,{formMethod:ne,formAction:Q,formEncType:fe}=xe.navigation;!F&&!Z&&ne&&Q&&fe&&(F=V1(xe.navigation));let we=F||Z;if(PM.has(B.status)&&we&&Vo(we.formMethod))await wr(ce,W,{submission:Qn({},we,{formAction:B.location}),preventScrollReset:Me});else{let ke=Wg(W,F);await wr(ce,W,{overrideNavigation:ke,fetcherSubmission:Z,preventScrollReset:Me})}}async function Ar(xe,B,P,F,Z){let H=await Promise.all([...P.map(ne=>rh("loader",Z,ne,B,m,c,C,I.v7_relativeSplatPath)),...F.map(ne=>ne.matches&&ne.match&&ne.controller?rh("loader",ih(e.history,ne.path,ne.controller.signal),ne.match,ne.matches,m,c,C,I.v7_relativeSplatPath):{type:Yn.error,error:fo(404,{pathname:ne.path})})]),W=H.slice(0,P.length),ce=H.slice(P.length);return await Promise.all([B1(xe,P,W,W.map(()=>Z.signal),!1,de.loaderData),B1(xe,F.map(ne=>ne.match),ce,F.map(ne=>ne.controller?ne.controller.signal:null),!0)]),{results:H,loaderResults:W,fetcherResults:ce}}function nn(){Ft=!0,It.push(...Ue()),ht.forEach((xe,B)=>{xt.has(B)&&(zt.push(B),zr(B))})}function Dt(xe,B,P){P===void 0&&(P={}),de.fetchers.set(xe,B),xn({fetchers:new Map(de.fetchers)},{flushSync:(P&&P.flushSync)===!0})}function br(xe,B,P,F){F===void 0&&(F={});let Z=Ch(de.matches,B);Zr(xe),xn({errors:{[Z.route.id]:P},fetchers:new Map(de.fetchers)},{flushSync:(F&&F.flushSync)===!0})}function So(xe){return I.v7_fetcherPersist&&(_t.set(xe,(_t.get(xe)||0)+1),Tt.has(xe)&&Tt.delete(xe)),de.fetchers.get(xe)||AM}function Zr(xe){let B=de.fetchers.get(xe);xt.has(xe)&&!(B&&B.state==="loading"&&dt.has(xe))&&zr(xe),ht.delete(xe),dt.delete(xe),kt.delete(xe),Tt.delete(xe),de.fetchers.delete(xe)}function Va(xe){if(I.v7_fetcherPersist){let B=(_t.get(xe)||0)-1;B<=0?(_t.delete(xe),Tt.add(xe)):_t.set(xe,B)}else Zr(xe);xn({fetchers:new Map(de.fetchers)})}function zr(xe){let B=xt.get(xe);Kt(B,"Expected fetch controller: "+xe),B.abort(),xt.delete(xe)}function Bi(xe){for(let B of xe){let P=So(B),F=os(P.data);de.fetchers.set(B,F)}}function io(){let xe=[],B=!1;for(let P of kt){let F=de.fetchers.get(P);Kt(F,"Expected fetcher: "+P),F.state==="loading"&&(kt.delete(P),xe.push(P),B=!0)}return Bi(xe),B}function Ne(xe){let B=[];for(let[P,F]of dt)if(F<xe){let Z=de.fetchers.get(P);Kt(Z,"Expected fetcher: "+P),Z.state==="loading"&&(zr(P),dt.delete(P),B.push(P))}return Bi(B),B.length>0}function wi(xe,B){let P=de.blockers.get(xe)||nh;return Zt.get(xe)!==B&&Zt.set(xe,B),P}function gn(xe){de.blockers.delete(xe),Zt.delete(xe)}function bi(xe,B){let P=de.blockers.get(xe)||nh;Kt(P.state==="unblocked"&&B.state==="blocked"||P.state==="blocked"&&B.state==="blocked"||P.state==="blocked"&&B.state==="proceeding"||P.state==="blocked"&&B.state==="unblocked"||P.state==="proceeding"&&B.state==="unblocked","Invalid blocker state transition: "+P.state+" -> "+B.state);let F=new Map(de.blockers);F.set(xe,B),xn({blockers:F})}function Si(xe){let{currentLocation:B,nextLocation:P,historyAction:F}=xe;if(Zt.size===0)return;Zt.size>1&&ll(!1,"A router only supports one blocker at a time");let Z=Array.from(Zt.entries()),[H,W]=Z[Z.length-1],ce=de.blockers.get(H);if(!(ce&&ce.state==="proceeding")&&W({currentLocation:B,nextLocation:P,historyAction:F}))return H}function Ue(xe){let B=[];return tn.forEach((P,F)=>{(!xe||xe(F))&&(P.cancel(),B.push(F),tn.delete(F))}),B}function Mt(xe,B,P){if(U=xe,ue=B,le=P||null,!ae&&de.navigation===Hg){ae=!0;let F=ii(de.location,de.matches);F!=null&&xn({restoreScrollPosition:F})}return()=>{U=null,ue=null,le=null}}function vt(xe,B){return le&&le(xe,B.map(F=>iM(F,de.loaderData)))||xe.key}function fr(xe,B){if(U&&ue){let P=vt(xe,B);U[P]=ue()}}function ii(xe,B){if(U){let P=vt(xe,B),F=U[P];if(typeof F=="number")return F}return null}function Ct(xe){m={},u=t_(xe,c,void 0,m)}return Ce={get basename(){return C},get future(){return I},get state(){return de},get routes(){return x},get window(){return t},initialize:Mn,subscribe:tr,enableScrollRestoration:Mt,navigate:to,fetch:ro,revalidate:jr,createHref:xe=>e.history.createHref(xe),encodeLocation:xe=>e.history.encodeLocation(xe),getFetcher:So,deleteFetcher:Va,dispose:qn,getBlocker:wi,deleteBlocker:gn,_internalFetchControllers:xt,_internalActiveDeferreds:tn,_internalSetRoutes:Ct},Ce}function LM(e){return e!=null&&("formData"in e&&e.formData!=null||"body"in e&&e.body!==void 0)}function n_(e,t,o,l,c,m,x,u){let C,I;if(x){C=[];for(let O of t)if(C.push(O),O.route.id===x){I=O;break}}else C=t,I=t[t.length-1];let D=bM(c||".",wM(C,m),ed(e.pathname,o)||e.pathname,u==="path");return c==null&&(D.search=e.search,D.hash=e.hash),(c==null||c===""||c===".")&&I&&I.route.index&&!gv(D.search)&&(D.search=D.search?D.search.replace(/^\?/,"?index&"):"?index"),l&&o!=="/"&&(D.pathname=D.pathname==="/"?o:nl([o,D.pathname])),Qh(D)}function M1(e,t,o,l){if(!l||!LM(l))return{path:o};if(l.formMethod&&!UM(l.formMethod))return{path:o,error:fo(405,{method:l.formMethod})};let c=()=>({path:o,error:fo(400,{type:"invalid-body"})}),m=l.formMethod||"get",x=e?m.toUpperCase():m.toLowerCase(),u=lS(o);if(l.body!==void 0){if(l.formEncType==="text/plain"){if(!Vo(x))return c();let U=typeof l.body=="string"?l.body:l.body instanceof FormData||l.body instanceof URLSearchParams?Array.from(l.body.entries()).reduce((le,ue)=>{let[ae,oe]=ue;return""+le+ae+"="+oe+`
`},""):String(l.body);return{path:o,submission:{formMethod:x,formAction:u,formEncType:l.formEncType,formData:void 0,json:void 0,text:U}}}else if(l.formEncType==="application/json"){if(!Vo(x))return c();try{let U=typeof l.body=="string"?JSON.parse(l.body):l.body;return{path:o,submission:{formMethod:x,formAction:u,formEncType:l.formEncType,formData:void 0,json:U,text:void 0}}}catch{return c()}}}Kt(typeof FormData=="function","FormData is not available in this environment");let C,I;if(l.formData)C=r_(l.formData),I=l.formData;else if(l.body instanceof FormData)C=r_(l.body),I=l.body;else if(l.body instanceof URLSearchParams)C=l.body,I=D1(C);else if(l.body==null)C=new URLSearchParams,I=new FormData;else try{C=new URLSearchParams(l.body),I=D1(C)}catch{return c()}let D={formMethod:x,formAction:u,formEncType:l&&l.formEncType||"application/x-www-form-urlencoded",formData:I,json:void 0,text:void 0};if(Vo(D.formMethod))return{path:o,submission:D};let O=Oa(o);return t&&O.search&&gv(O.search)&&C.append("index",""),O.search="?"+C,{path:Qh(O),submission:D}}function RM(e,t){let o=e;if(t){let l=e.findIndex(c=>c.route.id===t);l>=0&&(o=e.slice(0,l))}return o}function P1(e,t,o,l,c,m,x,u,C,I,D,O,U,le,ue,ae){let oe=ae?Object.values(ae)[0]:ue?Object.values(ue)[0]:void 0,$=e.createURL(t.location),G=e.createURL(c),ee=ae?Object.keys(ae)[0]:void 0,Ce=RM(o,ee).filter((be,Me)=>{let{route:Ze}=be;if(Ze.lazy)return!0;if(Ze.loader==null)return!1;if(m)return Ze.loader.hydrate?!0:t.loaderData[Ze.id]===void 0&&(!t.errors||t.errors[Ze.id]===void 0);if(FM(t.loaderData,t.matches[Me],be)||u.some(bt=>bt===be.route.id))return!0;let Oe=t.matches[Me],ft=be;return A1(be,Qn({currentUrl:$,currentParams:Oe.params,nextUrl:G,nextParams:ft.params},l,{actionResult:oe,defaultShouldRevalidate:x||$.pathname+$.search===G.pathname+G.search||$.search!==G.search||sS(Oe,ft)}))}),de=[];return D.forEach((be,Me)=>{if(m||!o.some(Rt=>Rt.route.id===be.routeId)||I.has(Me))return;let Ze=fu(U,be.path,le);if(!Ze){de.push({key:Me,routeId:be.routeId,path:be.path,matches:null,match:null,controller:null});return}let Oe=t.fetchers.get(Me),ft=i_(Ze,be.path),bt=!1;O.has(Me)?bt=!1:C.includes(Me)?bt=!0:Oe&&Oe.state!=="idle"&&Oe.data===void 0?bt=x:bt=A1(ft,Qn({currentUrl:$,currentParams:t.matches[t.matches.length-1].params,nextUrl:G,nextParams:o[o.length-1].params},l,{actionResult:oe,defaultShouldRevalidate:x})),bt&&de.push({key:Me,routeId:be.routeId,path:be.path,matches:Ze,match:ft,controller:new AbortController})}),[Ce,de]}function FM(e,t,o){let l=!t||o.route.id!==t.route.id,c=e[o.route.id]===void 0;return l||c}function sS(e,t){let o=e.route.path;return e.pathname!==t.pathname||o!=null&&o.endsWith("*")&&e.params["*"]!==t.params["*"]}function A1(e,t){if(e.route.shouldRevalidate){let o=e.route.shouldRevalidate(t);if(typeof o=="boolean")return o}return t.defaultShouldRevalidate}async function z1(e,t,o){if(!e.lazy)return;let l=await e.lazy();if(!e.lazy)return;let c=o[e.id];Kt(c,"No route found in manifest");let m={};for(let x in l){let C=c[x]!==void 0&&x!=="hasErrorBoundary";ll(!C,'Route "'+c.id+'" has a static property "'+x+'" defined but its lazy function is also returning a value for this property. '+('The lazy route property "'+x+'" will be ignored.')),!C&&!nM.has(x)&&(m[x]=l[x])}Object.assign(c,m),Object.assign(c,Qn({},t(c),{lazy:void 0}))}async function rh(e,t,o,l,c,m,x,u,C){C===void 0&&(C={});let I,D,O,U=ae=>{let oe,$=new Promise((G,ee)=>oe=ee);return O=()=>oe(),t.signal.addEventListener("abort",O),Promise.race([ae({request:t,params:o.params,context:C.requestContext}),$])};try{let ae=o.route[e];if(o.route.lazy)if(ae){let oe,$=await Promise.all([U(ae).catch(G=>{oe=G}),z1(o.route,m,c)]);if(oe)throw oe;D=$[0]}else if(await z1(o.route,m,c),ae=o.route[e],ae)D=await U(ae);else if(e==="action"){let oe=new URL(t.url),$=oe.pathname+oe.search;throw fo(405,{method:t.method,pathname:$,routeId:o.route.id})}else return{type:Yn.data,data:void 0};else if(ae)D=await U(ae);else{let oe=new URL(t.url),$=oe.pathname+oe.search;throw fo(404,{pathname:$})}Kt(D!==void 0,"You defined "+(e==="action"?"an action":"a loader")+" for route "+('"'+o.route.id+"\" but didn't return anything from your `"+e+"` ")+"function. Please return a value or `null`.")}catch(ae){I=Yn.error,D=ae}finally{O&&t.signal.removeEventListener("abort",O)}if(NM(D)){let ae=D.status;if(MM.has(ae)){let $=D.headers.get("Location");if(Kt($,"Redirects returned/thrown from loaders/actions must have a Location header"),!oS.test($))$=n_(new URL(t.url),l.slice(0,l.indexOf(o)+1),x,!0,$,u);else if(!C.isStaticRequest){let G=new URL(t.url),ee=$.startsWith("//")?new URL(G.protocol+$):new URL($),_e=ed(ee.pathname,x)!=null;ee.origin===G.origin&&_e&&($=ee.pathname+ee.search+ee.hash)}if(C.isStaticRequest)throw D.headers.set("Location",$),D;return{type:Yn.redirect,status:ae,location:$,revalidate:D.headers.get("X-Remix-Revalidate")!==null,reloadDocument:D.headers.get("X-Remix-Reload-Document")!==null}}if(C.isRouteRequest)throw{type:I===Yn.error?Yn.error:Yn.data,response:D};let oe;try{let $=D.headers.get("Content-Type");$&&/\bapplication\/json\b/.test($)?D.body==null?oe=null:oe=await D.json():oe=await D.text()}catch($){return{type:Yn.error,error:$}}return I===Yn.error?{type:I,error:new mv(ae,D.statusText,oe),headers:D.headers}:{type:Yn.data,data:oe,statusCode:D.status,headers:D.headers}}if(I===Yn.error)return{type:I,error:D};if(VM(D)){var le,ue;return{type:Yn.deferred,deferredData:D,statusCode:(le=D.init)==null?void 0:le.status,headers:((ue=D.init)==null?void 0:ue.headers)&&new Headers(D.init.headers)}}return{type:Yn.data,data:D}}function ih(e,t,o,l){let c=e.createURL(lS(t)).toString(),m={signal:o};if(l&&Vo(l.formMethod)){let{formMethod:x,formEncType:u}=l;m.method=x.toUpperCase(),u==="application/json"?(m.headers=new Headers({"Content-Type":u}),m.body=JSON.stringify(l.json)):u==="text/plain"?m.body=l.text:u==="application/x-www-form-urlencoded"&&l.formData?m.body=r_(l.formData):m.body=l.formData}return new Request(c,m)}function r_(e){let t=new URLSearchParams;for(let[o,l]of e.entries())t.append(o,typeof l=="string"?l:l.name);return t}function D1(e){let t=new FormData;for(let[o,l]of e.entries())t.append(o,l);return t}function OM(e,t,o,l,c){let m={},x=null,u,C=!1,I={};return o.forEach((D,O)=>{let U=t[O].route.id;if(Kt(!Qs(D),"Cannot handle redirect results in processLoaderData"),mu(D)){let le=Ch(e,U),ue=D.error;l&&(ue=Object.values(l)[0],l=void 0),x=x||{},x[le.route.id]==null&&(x[le.route.id]=ue),m[U]=void 0,C||(C=!0,u=rS(D.error)?D.error.status:500),D.headers&&(I[U]=D.headers)}else Js(D)?(c.set(U,D.deferredData),m[U]=D.deferredData.data):m[U]=D.data,D.statusCode!=null&&D.statusCode!==200&&!C&&(u=D.statusCode),D.headers&&(I[U]=D.headers)}),l&&(x=l,m[Object.keys(l)[0]]=void 0),{loaderData:m,errors:x,statusCode:u||200,loaderHeaders:I}}function L1(e,t,o,l,c,m,x,u){let{loaderData:C,errors:I}=OM(t,o,l,c,u);for(let D=0;D<m.length;D++){let{key:O,match:U,controller:le}=m[D];Kt(x!==void 0&&x[D]!==void 0,"Did not find corresponding fetcher result");let ue=x[D];if(!(le&&le.signal.aborted))if(mu(ue)){let ae=Ch(e.matches,U==null?void 0:U.route.id);I&&I[ae.route.id]||(I=Qn({},I,{[ae.route.id]:ue.error})),e.fetchers.delete(O)}else if(Qs(ue))Kt(!1,"Unhandled fetcher revalidation redirect");else if(Js(ue))Kt(!1,"Unhandled fetcher deferred data");else{let ae=os(ue.data);e.fetchers.set(O,ae)}}return{loaderData:C,errors:I}}function R1(e,t,o,l){let c=Qn({},t);for(let m of o){let x=m.route.id;if(t.hasOwnProperty(x)?t[x]!==void 0&&(c[x]=t[x]):e[x]!==void 0&&m.route.loader&&(c[x]=e[x]),l&&l.hasOwnProperty(x))break}return c}function Ch(e,t){return(t?e.slice(0,e.findIndex(l=>l.route.id===t)+1):[...e]).reverse().find(l=>l.route.hasErrorBoundary===!0)||e[0]}function F1(e){let t=e.length===1?e[0]:e.find(o=>o.index||!o.path||o.path==="/")||{id:"__shim-error-route__"};return{matches:[{params:{},pathname:"",pathnameBase:"",route:t}],route:t}}function fo(e,t){let{pathname:o,routeId:l,method:c,type:m}=t===void 0?{}:t,x="Unknown Server Error",u="Unknown @remix-run/router error";return e===400?(x="Bad Request",c&&o&&l?u="You made a "+c+' request to "'+o+'" but '+('did not provide a `loader` for route "'+l+'", ')+"so there is no way to handle the request.":m==="defer-action"?u="defer() is not supported in actions":m==="invalid-body"&&(u="Unable to encode submission body")):e===403?(x="Forbidden",u='Route "'+l+'" does not match URL "'+o+'"'):e===404?(x="Not Found",u='No route matches URL "'+o+'"'):e===405&&(x="Method Not Allowed",c&&o&&l?u="You made a "+c.toUpperCase()+' request to "'+o+'" but '+('did not provide an `action` for route "'+l+'", ')+"so there is no way to handle the request.":c&&(u='Invalid request method "'+c.toUpperCase()+'"')),new mv(e||500,x,new Error(u),!0)}function O1(e){for(let t=e.length-1;t>=0;t--){let o=e[t];if(Qs(o))return{result:o,idx:t}}}function lS(e){let t=typeof e=="string"?Oa(e):e;return Qh(Qn({},t,{hash:""}))}function BM(e,t){return e.pathname!==t.pathname||e.search!==t.search?!1:e.hash===""?t.hash!=="":e.hash===t.hash?!0:t.hash!==""}function Js(e){return e.type===Yn.deferred}function mu(e){return e.type===Yn.error}function Qs(e){return(e&&e.type)===Yn.redirect}function VM(e){let t=e;return t&&typeof t=="object"&&typeof t.data=="object"&&typeof t.subscribe=="function"&&typeof t.cancel=="function"&&typeof t.resolveData=="function"}function NM(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.headers=="object"&&typeof e.body<"u"}function UM(e){return kM.has(e.toLowerCase())}function Vo(e){return EM.has(e.toLowerCase())}async function B1(e,t,o,l,c,m){for(let x=0;x<o.length;x++){let u=o[x],C=t[x];if(!C)continue;let I=e.find(O=>O.route.id===C.route.id),D=I!=null&&!sS(I,C)&&(m&&m[C.route.id])!==void 0;if(Js(u)&&(c||D)){let O=l[x];Kt(O,"Expected an AbortSignal for revalidating fetcher deferred result"),await uS(u,O,c).then(U=>{U&&(o[x]=U||o[x])})}}}async function uS(e,t,o){if(o===void 0&&(o=!1),!await e.deferredData.resolveData(t)){if(o)try{return{type:Yn.data,data:e.deferredData.unwrappedData}}catch(c){return{type:Yn.error,error:c}}return{type:Yn.data,data:e.deferredData.data}}}function gv(e){return new URLSearchParams(e).getAll("index").some(t=>t==="")}function i_(e,t){let o=typeof t=="string"?Oa(t).search:t.search;if(e[e.length-1].route.index&&gv(o||""))return e[e.length-1];let l=nS(e);return l[l.length-1]}function V1(e){let{formMethod:t,formAction:o,formEncType:l,text:c,formData:m,json:x}=e;if(!(!t||!o||!l)){if(c!=null)return{formMethod:t,formAction:o,formEncType:l,formData:void 0,json:void 0,text:c};if(m!=null)return{formMethod:t,formAction:o,formEncType:l,formData:m,json:void 0,text:void 0};if(x!==void 0)return{formMethod:t,formAction:o,formEncType:l,formData:void 0,json:x,text:void 0}}}function Wg(e,t){return t?{state:"loading",location:e,formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text}:{state:"loading",location:e,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0}}function $M(e,t){return{state:"submitting",location:e,formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text}}function oh(e,t){return e?{state:"loading",formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text,data:t}:{state:"loading",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:t}}function jM(e,t){return{state:"submitting",formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text,data:t?t.data:void 0}}function os(e){return{state:"idle",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:e}}function ZM(e,t){try{let o=e.sessionStorage.getItem(aS);if(o){let l=JSON.parse(o);for(let[c,m]of Object.entries(l||{}))m&&Array.isArray(m)&&t.set(c,new Set(m||[]))}}catch{}}function qM(e,t){if(t.size>0){let o={};for(let[l,c]of t)o[l]=[...c];try{e.sessionStorage.setItem(aS,JSON.stringify(o))}catch(l){ll(!1,"Failed to save applied view transitions in sessionStorage ("+l+").")}}}/**
 * React Router v6.21.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function vf(){return vf=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])}return e},vf.apply(this,arguments)}const cS=he.createContext(null),hS=he.createContext(null),dS=he.createContext(null),Yf=he.createContext(null),Jf=he.createContext({outlet:null,matches:[],isDataRoute:!1}),pS=he.createContext(null);function yv(){return he.useContext(Yf)!=null}function GM(){return yv()||Kt(!1),he.useContext(Yf).location}function HM(e,t,o,l){yv()||Kt(!1);let{navigator:c}=he.useContext(dS),{matches:m}=he.useContext(Jf),x=m[m.length-1],u=x?x.params:{};x&&x.pathname;let C=x?x.pathnameBase:"/";x&&x.route;let I=GM(),D;if(t){var O;let oe=typeof t=="string"?Oa(t):t;C==="/"||(O=oe.pathname)!=null&&O.startsWith(C)||Kt(!1),D=oe}else D=I;let U=D.pathname||"/",le=C==="/"?U:U.slice(C.length)||"/",ue=fu(e,{pathname:le}),ae=JM(ue&&ue.map(oe=>Object.assign({},oe,{params:Object.assign({},u,oe.params),pathname:nl([C,c.encodeLocation?c.encodeLocation(oe.pathname).pathname:oe.pathname]),pathnameBase:oe.pathnameBase==="/"?C:nl([C,c.encodeLocation?c.encodeLocation(oe.pathnameBase).pathname:oe.pathnameBase])})),m,o,l);return t&&ae?he.createElement(Yf.Provider,{value:{location:vf({pathname:"/",search:"",hash:"",state:null,key:"default"},D),navigationType:cr.Pop}},ae):ae}function WM(){let e=nP(),t=rS(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),o=e instanceof Error?e.stack:null,c={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return he.createElement(he.Fragment,null,he.createElement("h2",null,"Unexpected Application Error!"),he.createElement("h3",{style:{fontStyle:"italic"}},t),o?he.createElement("pre",{style:c},o):null,null)}const KM=he.createElement(WM,null);class XM extends he.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,o){return o.location!==t.location||o.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:o.error,location:o.location,revalidation:t.revalidation||o.revalidation}}componentDidCatch(t,o){console.error("React Router caught the following error during render",t,o)}render(){return this.state.error!==void 0?he.createElement(Jf.Provider,{value:this.props.routeContext},he.createElement(pS.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function YM(e){let{routeContext:t,match:o,children:l}=e,c=he.useContext(cS);return c&&c.static&&c.staticContext&&(o.route.errorElement||o.route.ErrorBoundary)&&(c.staticContext._deepestRenderedBoundaryId=o.route.id),he.createElement(Jf.Provider,{value:t},l)}function JM(e,t,o,l){var c;if(t===void 0&&(t=[]),o===void 0&&(o=null),l===void 0&&(l=null),e==null){var m;if((m=o)!=null&&m.errors)e=o.matches;else return null}let x=e,u=(c=o)==null?void 0:c.errors;if(u!=null){let D=x.findIndex(O=>O.route.id&&(u==null?void 0:u[O.route.id]));D>=0||Kt(!1),x=x.slice(0,Math.min(x.length,D+1))}let C=!1,I=-1;if(o&&l&&l.v7_partialHydration)for(let D=0;D<x.length;D++){let O=x[D];if((O.route.HydrateFallback||O.route.hydrateFallbackElement)&&(I=D),O.route.id){let{loaderData:U,errors:le}=o,ue=O.route.loader&&U[O.route.id]===void 0&&(!le||le[O.route.id]===void 0);if(O.route.lazy||ue){C=!0,I>=0?x=x.slice(0,I+1):x=[x[0]];break}}}return x.reduceRight((D,O,U)=>{let le,ue=!1,ae=null,oe=null;o&&(le=u&&O.route.id?u[O.route.id]:void 0,ae=O.route.errorElement||KM,C&&(I<0&&U===0?(rP("route-fallback",!1),ue=!0,oe=null):I===U&&(ue=!0,oe=O.route.hydrateFallbackElement||null)));let $=t.concat(x.slice(0,U+1)),G=()=>{let ee;return le?ee=ae:ue?ee=oe:O.route.Component?ee=he.createElement(O.route.Component,null):O.route.element?ee=O.route.element:ee=D,he.createElement(YM,{match:O,routeContext:{outlet:D,matches:$,isDataRoute:o!=null},children:ee})};return o&&(O.route.ErrorBoundary||O.route.errorElement||U===0)?he.createElement(XM,{location:o.location,revalidation:o.revalidation,component:ae,error:le,children:G(),routeContext:{outlet:null,matches:$,isDataRoute:!0}}):G()},null)}var o_=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(o_||{});function QM(e){let t=he.useContext(hS);return t||Kt(!1),t}function eP(e){let t=he.useContext(Jf);return t||Kt(!1),t}function tP(e){let t=eP(),o=t.matches[t.matches.length-1];return o.route.id||Kt(!1),o.route.id}function nP(){var e;let t=he.useContext(pS),o=QM(o_.UseRouteError),l=tP(o_.UseRouteError);return t!==void 0?t:(e=o.errors)==null?void 0:e[l]}const N1={};function rP(e,t,o){!t&&!N1[e]&&(N1[e]=!0)}function a_(e){Kt(!1)}function iP(e){let{basename:t="/",children:o=null,location:l,navigationType:c=cr.Pop,navigator:m,static:x=!1,future:u}=e;yv()&&Kt(!1);let C=t.replace(/^\/*/,"/"),I=he.useMemo(()=>({basename:C,navigator:m,static:x,future:vf({v7_relativeSplatPath:!1},u)}),[C,u,m,x]);typeof l=="string"&&(l=Oa(l));let{pathname:D="/",search:O="",hash:U="",state:le=null,key:ue="default"}=l,ae=he.useMemo(()=>{let oe=ed(D,C);return oe==null?null:{location:{pathname:oe,search:O,hash:U,state:le,key:ue},navigationType:c}},[C,D,O,U,le,ue,c]);return ae==null?null:he.createElement(dS.Provider,{value:I},he.createElement(Yf.Provider,{children:o,value:ae}))}new Promise(()=>{});function s_(e,t){t===void 0&&(t=[]);let o=[];return he.Children.forEach(e,(l,c)=>{if(!he.isValidElement(l))return;let m=[...t,c];if(l.type===he.Fragment){o.push.apply(o,s_(l.props.children,m));return}l.type!==a_&&Kt(!1),!l.props.index||!l.props.children||Kt(!1);let x={id:l.props.id||m.join("-"),caseSensitive:l.props.caseSensitive,element:l.props.element,Component:l.props.Component,index:l.props.index,path:l.props.path,loader:l.props.loader,action:l.props.action,errorElement:l.props.errorElement,ErrorBoundary:l.props.ErrorBoundary,hasErrorBoundary:l.props.ErrorBoundary!=null||l.props.errorElement!=null,shouldRevalidate:l.props.shouldRevalidate,handle:l.props.handle,lazy:l.props.lazy};l.props.children&&(x.children=s_(l.props.children,m)),o.push(x)}),o}function oP(e){let t={hasErrorBoundary:e.ErrorBoundary!=null||e.errorElement!=null};return e.Component&&Object.assign(t,{element:he.createElement(e.Component),Component:void 0}),e.HydrateFallback&&Object.assign(t,{hydrateFallbackElement:he.createElement(e.HydrateFallback),HydrateFallback:void 0}),e.ErrorBoundary&&Object.assign(t,{errorElement:he.createElement(e.ErrorBoundary),ErrorBoundary:void 0}),t}/**
 * React Router DOM v6.21.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function xf(){return xf=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])}return e},xf.apply(this,arguments)}function aP(e,t){return DM({basename:t==null?void 0:t.basename,future:xf({},t==null?void 0:t.future,{v7_prependBasename:!0}),history:Qk({window:t==null?void 0:t.window}),hydrationData:(t==null?void 0:t.hydrationData)||sP(),routes:e,mapRouteProperties:oP,window:t==null?void 0:t.window}).initialize()}function sP(){var e;let t=(e=window)==null?void 0:e.__staticRouterHydrationData;return t&&t.errors&&(t=xf({},t,{errors:lP(t.errors)})),t}function lP(e){if(!e)return null;let t=Object.entries(e),o={};for(let[l,c]of t)if(c&&c.__type==="RouteErrorResponse")o[l]=new mv(c.status,c.statusText,c.data,c.internal===!0);else if(c&&c.__type==="Error"){if(c.__subType){let m=window[c.__subType];if(typeof m=="function")try{let x=new m(c.message);x.stack="",o[l]=x}catch{}}if(o[l]==null){let m=new Error(c.message);m.stack="",o[l]=m}}else o[l]=c;return o}const uP=he.createContext({isTransitioning:!1}),cP=he.createContext(new Map),hP="startTransition",U1=ly[hP],dP="flushSync",$1=Jk[dP];function pP(e){U1?U1(e):e()}function ah(e){$1?$1(e):e()}class fP{constructor(){this.status="pending",this.promise=new Promise((t,o)=>{this.resolve=l=>{this.status==="pending"&&(this.status="resolved",t(l))},this.reject=l=>{this.status==="pending"&&(this.status="rejected",o(l))}})}}function mP(e){let{fallbackElement:t,router:o,future:l}=e,[c,m]=he.useState(o.state),[x,u]=he.useState(),[C,I]=he.useState({isTransitioning:!1}),[D,O]=he.useState(),[U,le]=he.useState(),[ue,ae]=he.useState(),oe=he.useRef(new Map),{v7_startTransition:$}=l||{},G=he.useCallback(be=>{$?pP(be):be()},[$]),ee=he.useCallback((be,Me)=>{let{deletedFetchers:Ze,unstable_flushSync:Oe,unstable_viewTransitionOpts:ft}=Me;Ze.forEach(Rt=>oe.current.delete(Rt)),be.fetchers.forEach((Rt,Ft)=>{Rt.data!==void 0&&oe.current.set(Ft,Rt.data)});let bt=o.window==null||typeof o.window.document.startViewTransition!="function";if(!ft||bt){Oe?ah(()=>m(be)):G(()=>m(be));return}if(Oe){ah(()=>{U&&(D&&D.resolve(),U.skipTransition()),I({isTransitioning:!0,flushSync:!0,currentLocation:ft.currentLocation,nextLocation:ft.nextLocation})});let Rt=o.window.document.startViewTransition(()=>{ah(()=>m(be))});Rt.finished.finally(()=>{ah(()=>{O(void 0),le(void 0),u(void 0),I({isTransitioning:!1})})}),ah(()=>le(Rt));return}U?(D&&D.resolve(),U.skipTransition(),ae({state:be,currentLocation:ft.currentLocation,nextLocation:ft.nextLocation})):(u(be),I({isTransitioning:!0,flushSync:!1,currentLocation:ft.currentLocation,nextLocation:ft.nextLocation}))},[o.window,U,D,oe,G]);he.useLayoutEffect(()=>o.subscribe(ee),[o,ee]),he.useEffect(()=>{C.isTransitioning&&!C.flushSync&&O(new fP)},[C]),he.useEffect(()=>{if(D&&x&&o.window){let be=x,Me=D.promise,Ze=o.window.document.startViewTransition(async()=>{G(()=>m(be)),await Me});Ze.finished.finally(()=>{O(void 0),le(void 0),u(void 0),I({isTransitioning:!1})}),le(Ze)}},[G,x,D,o.window]),he.useEffect(()=>{D&&x&&c.location.key===x.location.key&&D.resolve()},[D,U,c.location,x]),he.useEffect(()=>{!C.isTransitioning&&ue&&(u(ue.state),I({isTransitioning:!0,flushSync:!1,currentLocation:ue.currentLocation,nextLocation:ue.nextLocation}),ae(void 0))},[C.isTransitioning,ue]),he.useEffect(()=>{},[]);let _e=he.useMemo(()=>({createHref:o.createHref,encodeLocation:o.encodeLocation,go:be=>o.navigate(be),push:(be,Me,Ze)=>o.navigate(be,{state:Me,preventScrollReset:Ze==null?void 0:Ze.preventScrollReset}),replace:(be,Me,Ze)=>o.navigate(be,{replace:!0,state:Me,preventScrollReset:Ze==null?void 0:Ze.preventScrollReset})}),[o]),Ce=o.basename||"/",de=he.useMemo(()=>({router:o,navigator:_e,static:!1,basename:Ce}),[o,_e,Ce]);return he.createElement(he.Fragment,null,he.createElement(cS.Provider,{value:de},he.createElement(hS.Provider,{value:c},he.createElement(cP.Provider,{value:oe.current},he.createElement(uP.Provider,{value:C},he.createElement(iP,{basename:Ce,location:c.location,navigationType:c.historyAction,navigator:_e,future:{v7_relativeSplatPath:o.future.v7_relativeSplatPath}},c.initialized||o.future.v7_partialHydration?he.createElement(gP,{routes:o.routes,future:o.future,state:c}):t))))),null)}function gP(e){let{routes:t,future:o,state:l}=e;return HM(t,void 0,l,o)}var j1;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(j1||(j1={}));var Z1;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(Z1||(Z1={}));var fS={exports:{}};(function(e,t){(function(o,l){e.exports=l()})(EE,function(){var o,l,c;function m(u,C){if(!o)o=C;else if(!l)l=C;else{var I="var sharedChunk = {}; ("+o+")(sharedChunk); ("+l+")(sharedChunk);",D={};o(D),c=C(D),typeof window<"u"&&(c.workerUrl=window.URL.createObjectURL(new Blob([I],{type:"text/javascript"})))}}m(["exports"],function(u){function C(i,n,a,h){return new(a||(a=Promise))(function(p,y){function v(k){try{T(h.next(k))}catch(A){y(A)}}function w(k){try{T(h.throw(k))}catch(A){y(A)}}function T(k){var A;k.done?p(k.value):(A=k.value,A instanceof a?A:new a(function(R){R(A)})).then(v,w)}T((h=h.apply(i,n||[])).next())})}function I(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}typeof SuppressedError=="function"&&SuppressedError;var D=O;function O(i,n){this.x=i,this.y=n}O.prototype={clone:function(){return new O(this.x,this.y)},add:function(i){return this.clone()._add(i)},sub:function(i){return this.clone()._sub(i)},multByPoint:function(i){return this.clone()._multByPoint(i)},divByPoint:function(i){return this.clone()._divByPoint(i)},mult:function(i){return this.clone()._mult(i)},div:function(i){return this.clone()._div(i)},rotate:function(i){return this.clone()._rotate(i)},rotateAround:function(i,n){return this.clone()._rotateAround(i,n)},matMult:function(i){return this.clone()._matMult(i)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(i){return this.x===i.x&&this.y===i.y},dist:function(i){return Math.sqrt(this.distSqr(i))},distSqr:function(i){var n=i.x-this.x,a=i.y-this.y;return n*n+a*a},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(i){return Math.atan2(this.y-i.y,this.x-i.x)},angleWith:function(i){return this.angleWithSep(i.x,i.y)},angleWithSep:function(i,n){return Math.atan2(this.x*n-this.y*i,this.x*i+this.y*n)},_matMult:function(i){var n=i[2]*this.x+i[3]*this.y;return this.x=i[0]*this.x+i[1]*this.y,this.y=n,this},_add:function(i){return this.x+=i.x,this.y+=i.y,this},_sub:function(i){return this.x-=i.x,this.y-=i.y,this},_mult:function(i){return this.x*=i,this.y*=i,this},_div:function(i){return this.x/=i,this.y/=i,this},_multByPoint:function(i){return this.x*=i.x,this.y*=i.y,this},_divByPoint:function(i){return this.x/=i.x,this.y/=i.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var i=this.y;return this.y=this.x,this.x=-i,this},_rotate:function(i){var n=Math.cos(i),a=Math.sin(i),h=a*this.x+n*this.y;return this.x=n*this.x-a*this.y,this.y=h,this},_rotateAround:function(i,n){var a=Math.cos(i),h=Math.sin(i),p=n.y+h*(this.x-n.x)+a*(this.y-n.y);return this.x=n.x+a*(this.x-n.x)-h*(this.y-n.y),this.y=p,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},O.convert=function(i){return i instanceof O?i:Array.isArray(i)?new O(i[0],i[1]):i};var U=I(D),le=ue;function ue(i,n,a,h){this.cx=3*i,this.bx=3*(a-i)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*n,this.by=3*(h-n)-this.cy,this.ay=1-this.cy-this.by,this.p1x=i,this.p1y=n,this.p2x=a,this.p2y=h}ue.prototype={sampleCurveX:function(i){return((this.ax*i+this.bx)*i+this.cx)*i},sampleCurveY:function(i){return((this.ay*i+this.by)*i+this.cy)*i},sampleCurveDerivativeX:function(i){return(3*this.ax*i+2*this.bx)*i+this.cx},solveCurveX:function(i,n){if(n===void 0&&(n=1e-6),i<0)return 0;if(i>1)return 1;for(var a=i,h=0;h<8;h++){var p=this.sampleCurveX(a)-i;if(Math.abs(p)<n)return a;var y=this.sampleCurveDerivativeX(a);if(Math.abs(y)<1e-6)break;a-=p/y}var v=0,w=1;for(a=i,h=0;h<20&&(p=this.sampleCurveX(a),!(Math.abs(p-i)<n));h++)i>p?v=a:w=a,a=.5*(w-v)+v;return a},solve:function(i,n){return this.sampleCurveY(this.solveCurveX(i,n))}};var ae=I(le);let oe,$;function G(){return oe==null&&(oe=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),oe}function ee(){if($==null&&($=!1,G())){const n=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(n){for(let h=0;h<5*5;h++){const p=4*h;n.fillStyle=`rgb(${p},${p+1},${p+2})`,n.fillRect(h%5,Math.floor(h/5),1,1)}const a=n.getImageData(0,0,5,5).data;for(let h=0;h<5*5*4;h++)if(h%4!=3&&a[h]!==h){$=!0;break}}}return $||!1}function _e(i,n,a,h){const p=new ae(i,n,a,h);return function(y){return p.solve(y)}}const Ce=_e(.25,.1,.25,1);function de(i,n,a){return Math.min(a,Math.max(n,i))}function be(i,n,a){const h=a-n,p=((i-n)%h+h)%h+n;return p===n?a:p}function Me(i,...n){for(const a of n)for(const h in a)i[h]=a[h];return i}let Ze=1;function Oe(i,n,a){const h={};for(const p in i)h[p]=n.call(a||this,i[p],p,i);return h}function ft(i,n,a){const h={};for(const p in i)n.call(a||this,i[p],p,i)&&(h[p]=i[p]);return h}function bt(i){return Array.isArray(i)?i.map(bt):typeof i=="object"&&i?Oe(i,bt):i}const Rt={};function Ft(i){Rt[i]||(typeof console<"u"&&console.warn(i),Rt[i]=!0)}function It(i,n,a){return(a.y-i.y)*(n.x-i.x)>(n.y-i.y)*(a.x-i.x)}function zt(i){let n=0;for(let a,h,p=0,y=i.length,v=y-1;p<y;v=p++)a=i[p],h=i[v],n+=(h.x-a.x)*(a.y+h.y);return n}function xt(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}let Be=null;function lt(i){return typeof ImageBitmap<"u"&&i instanceof ImageBitmap}const dt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function kt(i,n,a,h,p){return C(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const y=new VideoFrame(i,{timestamp:0});try{const v=y==null?void 0:y.format;if(!v||!v.startsWith("BGR")&&!v.startsWith("RGB"))throw new Error(`Unrecognized format ${v}`);const w=v.startsWith("BGR"),T=new Uint8ClampedArray(h*p*4);if(yield y.copyTo(T,function(k,A,R,V,j){const q=4*Math.max(-A,0),X=(Math.max(0,R)-R)*V*4+q,re=4*V,se=Math.max(0,A),ye=Math.max(0,R);return{rect:{x:se,y:ye,width:Math.min(k.width,A+V)-se,height:Math.min(k.height,R+j)-ye},layout:[{offset:X,stride:re}]}}(i,n,a,h,p)),w)for(let k=0;k<T.length;k+=4){const A=T[k];T[k]=T[k+2],T[k+2]=A}return T}finally{y.close()}})}let ht,_t,Tt,tn;const Zt={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(i){const n=requestAnimationFrame(i);return{cancel:()=>cancelAnimationFrame(n)}},getImageData(i,n=0){return this.getImageCanvasContext(i).getImageData(-n,-n,i.width+2*n,i.height+2*n)},getImageCanvasContext(i){const n=window.document.createElement("canvas"),a=n.getContext("2d",{willReadFrequently:!0});if(!a)throw new Error("failed to create canvas 2d context");return n.width=i.width,n.height=i.height,a.drawImage(i,0,0,i.width,i.height),a},resolveURL:i=>(Tt||(Tt=document.createElement("a")),Tt.href=i,Tt.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(tn==null&&(tn=matchMedia("(prefers-reduced-motion: reduce)")),tn.matches)}},hn={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};class Mn extends Error{constructor(n,a,h,p){super(`AJAXError: ${a} (${n}): ${h}`),this.status=n,this.statusText=a,this.url=h,this.body=p}}const qn=xt()?()=>self.worker&&self.worker.referrer:()=>(window.location.protocol==="blob:"?window.parent:window).location.href,tr=i=>hn.REGISTERED_PROTOCOLS[i.substring(0,i.indexOf("://"))];function xn(i,n){const a=new AbortController,h=new Request(i.url,{method:i.method||"GET",body:i.body,credentials:i.credentials,headers:i.headers,cache:i.cache,referrer:qn(),signal:a.signal});let p=!1,y=!1;return i.type==="json"&&h.headers.set("Accept","application/json"),y||fetch(h).then(v=>v.ok?(w=>{(i.type==="arrayBuffer"||i.type==="image"?w.arrayBuffer():i.type==="json"?w.json():w.text()).then(T=>{y||(p=!0,n(null,T,w.headers.get("Cache-Control"),w.headers.get("Expires")))}).catch(T=>{y||n(new Error(T.message))})})(v):v.blob().then(w=>n(new Mn(v.status,v.statusText,i.url,w)))).catch(v=>{v.code!==20&&n(new Error(v.message))}),{cancel:()=>{y=!0,p||a.abort()}}}const Gn=function(i,n){if(/:\/\//.test(i.url)&&!/^https?:|^file:/.test(i.url)){if(xt()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",i,n);if(!xt())return(tr(i.url)||xn)(i,n)}if(!(/^file:/.test(a=i.url)||/^file:/.test(qn())&&!/^\w+:/.test(a))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return xn(i,n);if(xt()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",i,n,void 0,!0)}var a;return function(h,p){const y=new XMLHttpRequest;y.open(h.method||"GET",h.url,!0),h.type!=="arrayBuffer"&&h.type!=="image"||(y.responseType="arraybuffer");for(const v in h.headers)y.setRequestHeader(v,h.headers[v]);return h.type==="json"&&(y.responseType="text",y.setRequestHeader("Accept","application/json")),y.withCredentials=h.credentials==="include",y.onerror=()=>{p(new Error(y.statusText))},y.onload=()=>{if((y.status>=200&&y.status<300||y.status===0)&&y.response!==null){let v=y.response;if(h.type==="json")try{v=JSON.parse(y.response)}catch(w){return p(w)}p(null,v,y.getResponseHeader("Cache-Control"),y.getResponseHeader("Expires"))}else{const v=new Blob([y.response],{type:y.getResponseHeader("Content-Type")});p(new Mn(y.status,y.statusText,h.url,v))}},y.send(h.body),{cancel:()=>y.abort()}}(i,n)},to=function(i,n){return Gn(Me(i,{type:"arrayBuffer"}),n)};function jr(i){if(!i||i.indexOf("://")<=0||i.indexOf("data:image/")===0||i.indexOf("blob:")===0)return!0;const n=new URL(i),a=window.location;return n.protocol===a.protocol&&n.host===a.host}function wr(i,n,a){a[i]&&a[i].indexOf(n)!==-1||(a[i]=a[i]||[],a[i].push(n))}function wo(i,n,a){if(a&&a[i]){const h=a[i].indexOf(n);h!==-1&&a[i].splice(h,1)}}class no{constructor(n,a={}){Me(this,a),this.type=n}}class ro extends no{constructor(n,a={}){super("error",Me({error:n},a))}}class bo{on(n,a){return this._listeners=this._listeners||{},wr(n,a,this._listeners),this}off(n,a){return wo(n,a,this._listeners),wo(n,a,this._oneTimeListeners),this}once(n,a){return a?(this._oneTimeListeners=this._oneTimeListeners||{},wr(n,a,this._oneTimeListeners),this):new Promise(h=>this.once(n,h))}fire(n,a){typeof n=="string"&&(n=new no(n,a||{}));const h=n.type;if(this.listens(h)){n.target=this;const p=this._listeners&&this._listeners[h]?this._listeners[h].slice():[];for(const w of p)w.call(this,n);const y=this._oneTimeListeners&&this._oneTimeListeners[h]?this._oneTimeListeners[h].slice():[];for(const w of y)wo(h,w,this._oneTimeListeners),w.call(this,n);const v=this._eventedParent;v&&(Me(n,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),v.fire(n))}else n instanceof ro&&console.error(n.error);return this}listens(n){return this._listeners&&this._listeners[n]&&this._listeners[n].length>0||this._oneTimeListeners&&this._oneTimeListeners[n]&&this._oneTimeListeners[n].length>0||this._eventedParent&&this._eventedParent.listens(n)}setEventedParent(n,a){return this._eventedParent=n,this._eventedParentData=a,this}}var Ae={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const Hn=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function Ar(i,n){const a={};for(const h in i)h!=="ref"&&(a[h]=i[h]);return Hn.forEach(h=>{h in n&&(a[h]=n[h])}),a}function nn(i,n){if(Array.isArray(i)){if(!Array.isArray(n)||i.length!==n.length)return!1;for(let a=0;a<i.length;a++)if(!nn(i[a],n[a]))return!1;return!0}if(typeof i=="object"&&i!==null&&n!==null){if(typeof n!="object"||Object.keys(i).length!==Object.keys(n).length)return!1;for(const a in i)if(!nn(i[a],n[a]))return!1;return!0}return i===n}const Dt={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function br(i,n,a){a.push({command:Dt.addSource,args:[i,n[i]]})}function So(i,n,a){n.push({command:Dt.removeSource,args:[i]}),a[i]=!0}function Zr(i,n,a,h){So(i,a,h),br(i,n,a)}function Va(i,n,a){let h;for(h in i[a])if(Object.prototype.hasOwnProperty.call(i[a],h)&&h!=="data"&&!nn(i[a][h],n[a][h]))return!1;for(h in n[a])if(Object.prototype.hasOwnProperty.call(n[a],h)&&h!=="data"&&!nn(i[a][h],n[a][h]))return!1;return!0}function zr(i,n,a,h,p,y){let v;for(v in n=n||{},i=i||{})Object.prototype.hasOwnProperty.call(i,v)&&(nn(i[v],n[v])||a.push({command:y,args:[h,v,n[v],p]}));for(v in n)Object.prototype.hasOwnProperty.call(n,v)&&!Object.prototype.hasOwnProperty.call(i,v)&&(nn(i[v],n[v])||a.push({command:y,args:[h,v,n[v],p]}))}function Bi(i){return i.id}function io(i,n){return i[n.id]=n,i}class Ne{constructor(n,a,h,p){this.message=(n?`${n}: `:"")+h,p&&(this.identifier=p),a!=null&&a.__line__&&(this.line=a.__line__)}}function wi(i,...n){for(const a of n)for(const h in a)i[h]=a[h];return i}class gn extends Error{constructor(n,a){super(a),this.message=a,this.key=n}}class bi{constructor(n,a=[]){this.parent=n,this.bindings={};for(const[h,p]of a)this.bindings[h]=p}concat(n){return new bi(this,n)}get(n){if(this.bindings[n])return this.bindings[n];if(this.parent)return this.parent.get(n);throw new Error(`${n} not found in scope.`)}has(n){return!!this.bindings[n]||!!this.parent&&this.parent.has(n)}}const Si={kind:"null"},Ue={kind:"number"},Mt={kind:"string"},vt={kind:"boolean"},fr={kind:"color"},ii={kind:"object"},Ct={kind:"value"},xe={kind:"collator"},B={kind:"formatted"},P={kind:"padding"},F={kind:"resolvedImage"},Z={kind:"variableAnchorOffsetCollection"};function H(i,n){return{kind:"array",itemType:i,N:n}}function W(i){if(i.kind==="array"){const n=W(i.itemType);return typeof i.N=="number"?`array<${n}, ${i.N}>`:i.itemType.kind==="value"?"array":`array<${n}>`}return i.kind}const ce=[Si,Ue,Mt,vt,fr,B,ii,H(Ct),P,F,Z];function ne(i,n){if(n.kind==="error")return null;if(i.kind==="array"){if(n.kind==="array"&&(n.N===0&&n.itemType.kind==="value"||!ne(i.itemType,n.itemType))&&(typeof i.N!="number"||i.N===n.N))return null}else{if(i.kind===n.kind)return null;if(i.kind==="value"){for(const a of ce)if(!ne(a,n))return null}}return`Expected ${W(i)} but found ${W(n)} instead.`}function Q(i,n){return n.some(a=>a.kind===i.kind)}function fe(i,n){return n.some(a=>a==="null"?i===null:a==="array"?Array.isArray(i):a==="object"?i&&!Array.isArray(i)&&typeof i=="object":a===typeof i)}function we(i,n){return i.kind==="array"&&n.kind==="array"?i.itemType.kind===n.itemType.kind&&typeof i.N=="number":i.kind===n.kind}const ke=.96422,Pe=.82521,et=4/29,nt=6/29,Ye=3*nt*nt,ut=nt*nt*nt,yt=Math.PI/180,Ot=180/Math.PI;function Ht(i){return(i%=360)<0&&(i+=360),i}function Nt([i,n,a,h]){let p,y;const v=Wn((.2225045*(i=Bt(i))+.7168786*(n=Bt(n))+.0606169*(a=Bt(a)))/1);i===n&&n===a?p=y=v:(p=Wn((.4360747*i+.3850649*n+.1430804*a)/ke),y=Wn((.0139322*i+.0971045*n+.7141733*a)/Pe));const w=116*v-16;return[w<0?0:w,500*(p-v),200*(v-y),h]}function Bt(i){return i<=.04045?i/12.92:Math.pow((i+.055)/1.055,2.4)}function Wn(i){return i>ut?Math.pow(i,1/3):i/Ye+et}function Xt([i,n,a,h]){let p=(i+16)/116,y=isNaN(n)?p:p+n/500,v=isNaN(a)?p:p-a/200;return p=1*Pt(p),y=ke*Pt(y),v=Pe*Pt(v),[wn(3.1338561*y-1.6168667*p-.4906146*v),wn(-.9787684*y+1.9161415*p+.033454*v),wn(.0719453*y-.2289914*p+1.4052427*v),h]}function wn(i){return(i=i<=.00304?12.92*i:1.055*Math.pow(i,1/2.4)-.055)<0?0:i>1?1:i}function Pt(i){return i>nt?i*i*i:Ye*(i-et)}function Wt(i){return parseInt(i.padEnd(2,i),16)/255}function oi(i,n){return Vi(n?i/100:i,0,1)}function Vi(i,n,a){return Math.min(Math.max(n,i),a)}function qo(i){return!i.some(Number.isNaN)}const pm={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};class on{constructor(n,a,h,p=1,y=!0){this.r=n,this.g=a,this.b=h,this.a=p,y||(this.r*=p,this.g*=p,this.b*=p,p||this.overwriteGetter("rgb",[n,a,h,p]))}static parse(n){if(n instanceof on)return n;if(typeof n!="string")return;const a=function(h){if((h=h.toLowerCase().trim())==="transparent")return[0,0,0,0];const p=pm[h];if(p){const[v,w,T]=p;return[v/255,w/255,T/255,1]}if(h.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(h)){const v=h.length<6?1:2;let w=1;return[Wt(h.slice(w,w+=v)),Wt(h.slice(w,w+=v)),Wt(h.slice(w,w+=v)),Wt(h.slice(w,w+v)||"ff")]}if(h.startsWith("rgb")){const v=h.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(v){const[w,T,k,A,R,V,j,q,X,re,se,ye]=v,pe=[A||" ",j||" ",re].join("");if(pe==="  "||pe==="  /"||pe===",,"||pe===",,,"){const ve=[k,V,X].join(""),Te=ve==="%%%"?100:ve===""?255:0;if(Te){const De=[Vi(+T/Te,0,1),Vi(+R/Te,0,1),Vi(+q/Te,0,1),se?oi(+se,ye):1];if(qo(De))return De}}return}}const y=h.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(y){const[v,w,T,k,A,R,V,j,q]=y,X=[T||" ",A||" ",V].join("");if(X==="  "||X==="  /"||X===",,"||X===",,,"){const re=[+w,Vi(+k,0,100),Vi(+R,0,100),j?oi(+j,q):1];if(qo(re))return function([se,ye,pe,ve]){function Te(De){const Xe=(De+se/30)%12,it=ye*Math.min(pe,1-pe);return pe-it*Math.max(-1,Math.min(Xe-3,9-Xe,1))}return se=Ht(se),ye/=100,pe/=100,[Te(0),Te(8),Te(4),ve]}(re)}}}(n);return a?new on(...a,!1):void 0}get rgb(){const{r:n,g:a,b:h,a:p}=this,y=p||1/0;return this.overwriteGetter("rgb",[n/y,a/y,h/y,p])}get hcl(){return this.overwriteGetter("hcl",function(n){const[a,h,p,y]=Nt(n),v=Math.sqrt(h*h+p*p);return[Math.round(1e4*v)?Ht(Math.atan2(p,h)*Ot):NaN,v,a,y]}(this.rgb))}get lab(){return this.overwriteGetter("lab",Nt(this.rgb))}overwriteGetter(n,a){return Object.defineProperty(this,n,{value:a}),a}toString(){const[n,a,h,p]=this.rgb;return`rgba(${[n,a,h].map(y=>Math.round(255*y)).join(",")},${p})`}}on.black=new on(0,0,0,1),on.white=new on(1,1,1,1),on.transparent=new on(0,0,0,0),on.red=new on(1,0,0,1);class $u{constructor(n,a,h){this.sensitivity=n?a?"variant":"case":a?"accent":"base",this.locale=h,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(n,a){return this.collator.compare(n,a)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class fl{constructor(n,a,h,p,y){this.text=n,this.image=a,this.scale=h,this.fontStack=p,this.textColor=y}}class Sr{constructor(n){this.sections=n}static fromString(n){return new Sr([new fl(n,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(n=>n.text.length!==0||n.image&&n.image.name.length!==0)}static factory(n){return n instanceof Sr?n:Sr.fromString(n)}toString(){return this.sections.length===0?"":this.sections.map(n=>n.text).join("")}}class ai{constructor(n){this.values=n.slice()}static parse(n){if(n instanceof ai)return n;if(typeof n=="number")return new ai([n,n,n,n]);if(Array.isArray(n)&&!(n.length<1||n.length>4)){for(const a of n)if(typeof a!="number")return;switch(n.length){case 1:n=[n[0],n[0],n[0],n[0]];break;case 2:n=[n[0],n[1],n[0],n[1]];break;case 3:n=[n[0],n[1],n[2],n[1]]}return new ai(n)}}toString(){return JSON.stringify(this.values)}}const fm=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class Ti{constructor(n){this.values=n.slice()}static parse(n){if(n instanceof Ti)return n;if(Array.isArray(n)&&!(n.length<1)&&n.length%2==0){for(let a=0;a<n.length;a+=2){const h=n[a],p=n[a+1];if(typeof h!="string"||!fm.has(h)||!Array.isArray(p)||p.length!==2||typeof p[0]!="number"||typeof p[1]!="number")return}return new Ti(n)}}toString(){return JSON.stringify(this.values)}}class mr{constructor(n){this.name=n.name,this.available=n.available}toString(){return this.name}static fromString(n){return n?new mr({name:n,available:!1}):null}}function ml(i,n,a,h){return typeof i=="number"&&i>=0&&i<=255&&typeof n=="number"&&n>=0&&n<=255&&typeof a=="number"&&a>=0&&a<=255?h===void 0||typeof h=="number"&&h>=0&&h<=1?null:`Invalid rgba value [${[i,n,a,h].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof h=="number"?[i,n,a,h]:[i,n,a]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Na(i){if(i===null||typeof i=="string"||typeof i=="boolean"||typeof i=="number"||i instanceof on||i instanceof $u||i instanceof Sr||i instanceof ai||i instanceof Ti||i instanceof mr)return!0;if(Array.isArray(i)){for(const n of i)if(!Na(n))return!1;return!0}if(typeof i=="object"){for(const n in i)if(!Na(i[n]))return!1;return!0}return!1}function Tn(i){if(i===null)return Si;if(typeof i=="string")return Mt;if(typeof i=="boolean")return vt;if(typeof i=="number")return Ue;if(i instanceof on)return fr;if(i instanceof $u)return xe;if(i instanceof Sr)return B;if(i instanceof ai)return P;if(i instanceof Ti)return Z;if(i instanceof mr)return F;if(Array.isArray(i)){const n=i.length;let a;for(const h of i){const p=Tn(h);if(a){if(a===p)continue;a=Ct;break}a=p}return H(a||Ct,n)}return ii}function Jt(i){const n=typeof i;return i===null?"":n==="string"||n==="number"||n==="boolean"?String(i):i instanceof on||i instanceof Sr||i instanceof ai||i instanceof Ti||i instanceof mr?i.toString():JSON.stringify(i)}class ua{constructor(n,a){this.type=n,this.value=a}static parse(n,a){if(n.length!==2)return a.error(`'literal' expression requires exactly one argument, but found ${n.length-1} instead.`);if(!Na(n[1]))return a.error("invalid value");const h=n[1];let p=Tn(h);const y=a.expectedType;return p.kind!=="array"||p.N!==0||!y||y.kind!=="array"||typeof y.N=="number"&&y.N!==0||(p=y),new ua(p,h)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class Pn{constructor(n){this.name="ExpressionEvaluationError",this.message=n}toJSON(){return this.message}}const gl={string:Mt,number:Ue,boolean:vt,object:ii};class Ci{constructor(n,a){this.type=n,this.args=a}static parse(n,a){if(n.length<2)return a.error("Expected at least one argument.");let h,p=1;const y=n[0];if(y==="array"){let w,T;if(n.length>2){const k=n[1];if(typeof k!="string"||!(k in gl)||k==="object")return a.error('The item type argument of "array" must be one of string, number, boolean',1);w=gl[k],p++}else w=Ct;if(n.length>3){if(n[2]!==null&&(typeof n[2]!="number"||n[2]<0||n[2]!==Math.floor(n[2])))return a.error('The length argument to "array" must be a positive integer literal',2);T=n[2],p++}h=H(w,T)}else{if(!gl[y])throw new Error(`Types doesn't contain name = ${y}`);h=gl[y]}const v=[];for(;p<n.length;p++){const w=a.parse(n[p],p,Ct);if(!w)return null;v.push(w)}return new Ci(h,v)}evaluate(n){for(let a=0;a<this.args.length;a++){const h=this.args[a].evaluate(n);if(!ne(this.type,Tn(h)))return h;if(a===this.args.length-1)throw new Pn(`Expected value to be of type ${W(this.type)}, but found ${W(Tn(h))} instead.`)}throw new Error}eachChild(n){this.args.forEach(n)}outputDefined(){return this.args.every(n=>n.outputDefined())}}const ju={"to-boolean":vt,"to-color":fr,"to-number":Ue,"to-string":Mt};class Go{constructor(n,a){this.type=n,this.args=a}static parse(n,a){if(n.length<2)return a.error("Expected at least one argument.");const h=n[0];if(!ju[h])throw new Error(`Can't parse ${h} as it is not part of the known types`);if((h==="to-boolean"||h==="to-string")&&n.length!==2)return a.error("Expected one argument.");const p=ju[h],y=[];for(let v=1;v<n.length;v++){const w=a.parse(n[v],v,Ct);if(!w)return null;y.push(w)}return new Go(p,y)}evaluate(n){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(n);case"color":{let a,h;for(const p of this.args){if(a=p.evaluate(n),h=null,a instanceof on)return a;if(typeof a=="string"){const y=n.parseColor(a);if(y)return y}else if(Array.isArray(a)&&(h=a.length<3||a.length>4?`Invalid rbga value ${JSON.stringify(a)}: expected an array containing either three or four numeric values.`:ml(a[0],a[1],a[2],a[3]),!h))return new on(a[0]/255,a[1]/255,a[2]/255,a[3])}throw new Pn(h||`Could not parse color from value '${typeof a=="string"?a:JSON.stringify(a)}'`)}case"padding":{let a;for(const h of this.args){a=h.evaluate(n);const p=ai.parse(a);if(p)return p}throw new Pn(`Could not parse padding from value '${typeof a=="string"?a:JSON.stringify(a)}'`)}case"variableAnchorOffsetCollection":{let a;for(const h of this.args){a=h.evaluate(n);const p=Ti.parse(a);if(p)return p}throw new Pn(`Could not parse variableAnchorOffsetCollection from value '${typeof a=="string"?a:JSON.stringify(a)}'`)}case"number":{let a=null;for(const h of this.args){if(a=h.evaluate(n),a===null)return 0;const p=Number(a);if(!isNaN(p))return p}throw new Pn(`Could not convert ${JSON.stringify(a)} to number.`)}case"formatted":return Sr.fromString(Jt(this.args[0].evaluate(n)));case"resolvedImage":return mr.fromString(Jt(this.args[0].evaluate(n)));default:return Jt(this.args[0].evaluate(n))}}eachChild(n){this.args.forEach(n)}outputDefined(){return this.args.every(n=>n.outputDefined())}}const id=["Unknown","Point","LineString","Polygon"];class Zu{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?id[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(n){let a=this._parseColorCache[n];return a||(a=this._parseColorCache[n]=on.parse(n)),a}}class yl{constructor(n,a,h=[],p,y=new bi,v=[]){this.registry=n,this.path=h,this.key=h.map(w=>`[${w}]`).join(""),this.scope=y,this.errors=v,this.expectedType=p,this._isConstant=a}parse(n,a,h,p,y={}){return a?this.concat(a,h,p)._parse(n,y):this._parse(n,y)}_parse(n,a){function h(p,y,v){return v==="assert"?new Ci(y,[p]):v==="coerce"?new Go(y,[p]):p}if(n!==null&&typeof n!="string"&&typeof n!="boolean"&&typeof n!="number"||(n=["literal",n]),Array.isArray(n)){if(n.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const p=n[0];if(typeof p!="string")return this.error(`Expression name must be a string, but found ${typeof p} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const y=this.registry[p];if(y){let v=y.parse(n,this);if(!v)return null;if(this.expectedType){const w=this.expectedType,T=v.type;if(w.kind!=="string"&&w.kind!=="number"&&w.kind!=="boolean"&&w.kind!=="object"&&w.kind!=="array"||T.kind!=="value")if(w.kind!=="color"&&w.kind!=="formatted"&&w.kind!=="resolvedImage"||T.kind!=="value"&&T.kind!=="string")if(w.kind!=="padding"||T.kind!=="value"&&T.kind!=="number"&&T.kind!=="array")if(w.kind!=="variableAnchorOffsetCollection"||T.kind!=="value"&&T.kind!=="array"){if(this.checkSubtype(w,T))return null}else v=h(v,w,a.typeAnnotation||"coerce");else v=h(v,w,a.typeAnnotation||"coerce");else v=h(v,w,a.typeAnnotation||"coerce");else v=h(v,w,a.typeAnnotation||"assert")}if(!(v instanceof ua)&&v.type.kind!=="resolvedImage"&&this._isConstant(v)){const w=new Zu;try{v=new ua(v.type,v.evaluate(w))}catch(T){return this.error(T.message),null}}return v}return this.error(`Unknown expression "${p}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(n===void 0?"'undefined' value invalid. Use null instead.":typeof n=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof n} instead.`)}concat(n,a,h){const p=typeof n=="number"?this.path.concat(n):this.path,y=h?this.scope.concat(h):this.scope;return new yl(this.registry,this._isConstant,p,a||null,y,this.errors)}error(n,...a){const h=`${this.key}${a.map(p=>`[${p}]`).join("")}`;this.errors.push(new gn(h,n))}checkSubtype(n,a){const h=ne(n,a);return h&&this.error(h),h}}class _l{constructor(n,a,h){this.type=xe,this.locale=h,this.caseSensitive=n,this.diacriticSensitive=a}static parse(n,a){if(n.length!==2)return a.error("Expected one argument.");const h=n[1];if(typeof h!="object"||Array.isArray(h))return a.error("Collator options argument must be an object.");const p=a.parse(h["case-sensitive"]!==void 0&&h["case-sensitive"],1,vt);if(!p)return null;const y=a.parse(h["diacritic-sensitive"]!==void 0&&h["diacritic-sensitive"],1,vt);if(!y)return null;let v=null;return h.locale&&(v=a.parse(h.locale,1,Mt),!v)?null:new _l(p,y,v)}evaluate(n){return new $u(this.caseSensitive.evaluate(n),this.diacriticSensitive.evaluate(n),this.locale?this.locale.evaluate(n):null)}eachChild(n){n(this.caseSensitive),n(this.diacriticSensitive),this.locale&&n(this.locale)}outputDefined(){return!1}}const Ho=8192;function qu(i,n){i[0]=Math.min(i[0],n[0]),i[1]=Math.min(i[1],n[1]),i[2]=Math.max(i[2],n[0]),i[3]=Math.max(i[3],n[1])}function Es(i,n){return!(i[0]<=n[0]||i[2]>=n[2]||i[1]<=n[1]||i[3]>=n[3])}function od(i,n){const a=(180+i[0])/360,h=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+i[1]*Math.PI/360)))/360,p=Math.pow(2,n.z);return[Math.round(a*p*Ho),Math.round(h*p*Ho)]}function mm(i,n,a){const h=i[0]-n[0],p=i[1]-n[1],y=i[0]-a[0],v=i[1]-a[1];return h*v-y*p==0&&h*y<=0&&p*v<=0}function Gu(i,n){let a=!1;for(let v=0,w=n.length;v<w;v++){const T=n[v];for(let k=0,A=T.length;k<A-1;k++){if(mm(i,T[k],T[k+1]))return!1;(p=T[k])[1]>(h=i)[1]!=(y=T[k+1])[1]>h[1]&&h[0]<(y[0]-p[0])*(h[1]-p[1])/(y[1]-p[1])+p[0]&&(a=!a)}}var h,p,y;return a}function Hu(i,n){for(let a=0;a<n.length;a++)if(Gu(i,n[a]))return!0;return!1}function ad(i,n,a,h){const p=h[0]-a[0],y=h[1]-a[1],v=(i[0]-a[0])*y-p*(i[1]-a[1]),w=(n[0]-a[0])*y-p*(n[1]-a[1]);return v>0&&w<0||v<0&&w>0}function gm(i,n,a){for(const k of a)for(let A=0;A<k.length-1;++A)if((w=[(v=k[A+1])[0]-(y=k[A])[0],v[1]-y[1]])[0]*(T=[(p=n)[0]-(h=i)[0],p[1]-h[1]])[1]-w[1]*T[0]!=0&&ad(h,p,y,v)&&ad(y,v,h,p))return!0;var h,p,y,v,w,T;return!1}function sd(i,n){for(let a=0;a<i.length;++a)if(!Gu(i[a],n))return!1;for(let a=0;a<i.length-1;++a)if(gm(i[a],i[a+1],n))return!1;return!0}function ld(i,n){for(let a=0;a<n.length;a++)if(sd(i,n[a]))return!0;return!1}function vl(i,n,a){const h=[];for(let p=0;p<i.length;p++){const y=[];for(let v=0;v<i[p].length;v++){const w=od(i[p][v],a);qu(n,w),y.push(w)}h.push(y)}return h}function ud(i,n,a){const h=[];for(let p=0;p<i.length;p++){const y=vl(i[p],n,a);h.push(y)}return h}function cd(i,n,a,h){if(i[0]<a[0]||i[0]>a[2]){const p=.5*h;let y=i[0]-a[0]>p?-h:a[0]-i[0]>p?h:0;y===0&&(y=i[0]-a[2]>p?-h:a[2]-i[0]>p?h:0),i[0]+=y}qu(n,i)}function Wu(i,n,a,h){const p=Math.pow(2,h.z)*Ho,y=[h.x*Ho,h.y*Ho],v=[];for(const w of i)for(const T of w){const k=[T.x+y[0],T.y+y[1]];cd(k,n,a,p),v.push(k)}return v}function Ku(i,n,a,h){const p=Math.pow(2,h.z)*Ho,y=[h.x*Ho,h.y*Ho],v=[];for(const T of i){const k=[];for(const A of T){const R=[A.x+y[0],A.y+y[1]];qu(n,R),k.push(R)}v.push(k)}if(n[2]-n[0]<=p/2){(w=n)[0]=w[1]=1/0,w[2]=w[3]=-1/0;for(const T of v)for(const k of T)cd(k,n,a,p)}var w;return v}class ca{constructor(n,a){this.type=vt,this.geojson=n,this.geometries=a}static parse(n,a){if(n.length!==2)return a.error(`'within' expression requires exactly one argument, but found ${n.length-1} instead.`);if(Na(n[1])){const h=n[1];if(h.type==="FeatureCollection")for(let p=0;p<h.features.length;++p){const y=h.features[p].geometry.type;if(y==="Polygon"||y==="MultiPolygon")return new ca(h,h.features[p].geometry)}else if(h.type==="Feature"){const p=h.geometry.type;if(p==="Polygon"||p==="MultiPolygon")return new ca(h,h.geometry)}else if(h.type==="Polygon"||h.type==="MultiPolygon")return new ca(h,h)}return a.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(n){if(n.geometry()!=null&&n.canonicalID()!=null){if(n.geometryType()==="Point")return function(a,h){const p=[1/0,1/0,-1/0,-1/0],y=[1/0,1/0,-1/0,-1/0],v=a.canonicalID();if(h.type==="Polygon"){const w=vl(h.coordinates,y,v),T=Wu(a.geometry(),p,y,v);if(!Es(p,y))return!1;for(const k of T)if(!Gu(k,w))return!1}if(h.type==="MultiPolygon"){const w=ud(h.coordinates,y,v),T=Wu(a.geometry(),p,y,v);if(!Es(p,y))return!1;for(const k of T)if(!Hu(k,w))return!1}return!0}(n,this.geometries);if(n.geometryType()==="LineString")return function(a,h){const p=[1/0,1/0,-1/0,-1/0],y=[1/0,1/0,-1/0,-1/0],v=a.canonicalID();if(h.type==="Polygon"){const w=vl(h.coordinates,y,v),T=Ku(a.geometry(),p,y,v);if(!Es(p,y))return!1;for(const k of T)if(!sd(k,w))return!1}if(h.type==="MultiPolygon"){const w=ud(h.coordinates,y,v),T=Ku(a.geometry(),p,y,v);if(!Es(p,y))return!1;for(const k of T)if(!ld(k,w))return!1}return!0}(n,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}class xl{constructor(n,a){this.type=a.type,this.name=n,this.boundExpression=a}static parse(n,a){if(n.length!==2||typeof n[1]!="string")return a.error("'var' expression requires exactly one string literal argument.");const h=n[1];return a.scope.has(h)?new xl(h,a.scope.get(h)):a.error(`Unknown variable "${h}". Make sure "${h}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(n){return this.boundExpression.evaluate(n)}eachChild(){}outputDefined(){return!1}}class Ei{constructor(n,a,h,p){this.name=n,this.type=a,this._evaluate=h,this.args=p}evaluate(n){return this._evaluate(n,this.args)}eachChild(n){this.args.forEach(n)}outputDefined(){return!1}static parse(n,a){const h=n[0],p=Ei.definitions[h];if(!p)return a.error(`Unknown expression "${h}". If you wanted a literal array, use ["literal", [...]].`,0);const y=Array.isArray(p)?p[0]:p.type,v=Array.isArray(p)?[[p[1],p[2]]]:p.overloads,w=v.filter(([k])=>!Array.isArray(k)||k.length===n.length-1);let T=null;for(const[k,A]of w){T=new yl(a.registry,wl,a.path,null,a.scope);const R=[];let V=!1;for(let j=1;j<n.length;j++){const q=n[j],X=Array.isArray(k)?k[j-1]:k.type,re=T.parse(q,1+R.length,X);if(!re){V=!0;break}R.push(re)}if(!V)if(Array.isArray(k)&&k.length!==R.length)T.error(`Expected ${k.length} arguments, but found ${R.length} instead.`);else{for(let j=0;j<R.length;j++){const q=Array.isArray(k)?k[j]:k.type,X=R[j];T.concat(j+1).checkSubtype(q,X.type)}if(T.errors.length===0)return new Ei(h,y,A,R)}}if(w.length===1)a.errors.push(...T.errors);else{const k=(w.length?w:v).map(([R])=>{return V=R,Array.isArray(V)?`(${V.map(W).join(", ")})`:`(${W(V.type)}...)`;var V}).join(" | "),A=[];for(let R=1;R<n.length;R++){const V=a.parse(n[R],1+A.length);if(!V)return null;A.push(W(V.type))}a.error(`Expected arguments of type ${k}, but found (${A.join(", ")}) instead.`)}return null}static register(n,a){Ei.definitions=a;for(const h in a)n[h]=Ei}}function wl(i){if(i instanceof xl)return wl(i.boundExpression);if(i instanceof Ei&&i.name==="error"||i instanceof _l||i instanceof ca)return!1;const n=i instanceof Go||i instanceof Ci;let a=!0;return i.eachChild(h=>{a=n?a&&wl(h):a&&h instanceof ua}),!!a&&bl(i)&&Sl(i,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function bl(i){if(i instanceof Ei&&(i.name==="get"&&i.args.length===1||i.name==="feature-state"||i.name==="has"&&i.args.length===1||i.name==="properties"||i.name==="geometry-type"||i.name==="id"||/^filter-/.test(i.name))||i instanceof ca)return!1;let n=!0;return i.eachChild(a=>{n&&!bl(a)&&(n=!1)}),n}function Is(i){if(i instanceof Ei&&i.name==="feature-state")return!1;let n=!0;return i.eachChild(a=>{n&&!Is(a)&&(n=!1)}),n}function Sl(i,n){if(i instanceof Ei&&n.indexOf(i.name)>=0)return!1;let a=!0;return i.eachChild(h=>{a&&!Sl(h,n)&&(a=!1)}),a}function Ua(i,n){const a=i.length-1;let h,p,y=0,v=a,w=0;for(;y<=v;)if(w=Math.floor((y+v)/2),h=i[w],p=i[w+1],h<=n){if(w===a||n<p)return w;y=w+1}else{if(!(h>n))throw new Pn("Input is not a number.");v=w-1}return 0}class Wo{constructor(n,a,h){this.type=n,this.input=a,this.labels=[],this.outputs=[];for(const[p,y]of h)this.labels.push(p),this.outputs.push(y)}static parse(n,a){if(n.length-1<4)return a.error(`Expected at least 4 arguments, but found only ${n.length-1}.`);if((n.length-1)%2!=0)return a.error("Expected an even number of arguments.");const h=a.parse(n[1],1,Ue);if(!h)return null;const p=[];let y=null;a.expectedType&&a.expectedType.kind!=="value"&&(y=a.expectedType);for(let v=1;v<n.length;v+=2){const w=v===1?-1/0:n[v],T=n[v+1],k=v,A=v+1;if(typeof w!="number")return a.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',k);if(p.length&&p[p.length-1][0]>=w)return a.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',k);const R=a.parse(T,A,y);if(!R)return null;y=y||R.type,p.push([w,R])}return new Wo(y,h,p)}evaluate(n){const a=this.labels,h=this.outputs;if(a.length===1)return h[0].evaluate(n);const p=this.input.evaluate(n);if(p<=a[0])return h[0].evaluate(n);const y=a.length;return p>=a[y-1]?h[y-1].evaluate(n):h[Ua(a,p)].evaluate(n)}eachChild(n){n(this.input);for(const a of this.outputs)n(a)}outputDefined(){return this.outputs.every(n=>n.outputDefined())}}function qt(i,n,a){return i+a*(n-i)}function Tl(i,n,a){return i.map((h,p)=>qt(h,n[p],a))}const si={number:qt,color:function(i,n,a,h="rgb"){switch(h){case"rgb":{const[p,y,v,w]=Tl(i.rgb,n.rgb,a);return new on(p,y,v,w,!1)}case"hcl":{const[p,y,v,w]=i.hcl,[T,k,A,R]=n.hcl;let V,j;if(isNaN(p)||isNaN(T))isNaN(p)?isNaN(T)?V=NaN:(V=T,v!==1&&v!==0||(j=k)):(V=p,A!==1&&A!==0||(j=y));else{let ye=T-p;T>p&&ye>180?ye-=360:T<p&&p-T>180&&(ye+=360),V=p+a*ye}const[q,X,re,se]=function([ye,pe,ve,Te]){return ye=isNaN(ye)?0:ye*yt,Xt([ve,Math.cos(ye)*pe,Math.sin(ye)*pe,Te])}([V,j??qt(y,k,a),qt(v,A,a),qt(w,R,a)]);return new on(q,X,re,se,!1)}case"lab":{const[p,y,v,w]=Xt(Tl(i.lab,n.lab,a));return new on(p,y,v,w,!1)}}},array:Tl,padding:function(i,n,a){return new ai(Tl(i.values,n.values,a))},variableAnchorOffsetCollection:function(i,n,a){const h=i.values,p=n.values;if(h.length!==p.length)throw new Pn(`Cannot interpolate values of different length. from: ${i.toString()}, to: ${n.toString()}`);const y=[];for(let v=0;v<h.length;v+=2){if(h[v]!==p[v])throw new Pn(`Cannot interpolate values containing mismatched anchors. from[${v}]: ${h[v]}, to[${v}]: ${p[v]}`);y.push(h[v]);const[w,T]=h[v+1],[k,A]=p[v+1];y.push([qt(w,k,a),qt(T,A,a)])}return new Ti(y)}};class li{constructor(n,a,h,p,y){this.type=n,this.operator=a,this.interpolation=h,this.input=p,this.labels=[],this.outputs=[];for(const[v,w]of y)this.labels.push(v),this.outputs.push(w)}static interpolationFactor(n,a,h,p){let y=0;if(n.name==="exponential")y=Xu(a,n.base,h,p);else if(n.name==="linear")y=Xu(a,1,h,p);else if(n.name==="cubic-bezier"){const v=n.controlPoints;y=new ae(v[0],v[1],v[2],v[3]).solve(Xu(a,1,h,p))}return y}static parse(n,a){let[h,p,y,...v]=n;if(!Array.isArray(p)||p.length===0)return a.error("Expected an interpolation type expression.",1);if(p[0]==="linear")p={name:"linear"};else if(p[0]==="exponential"){const k=p[1];if(typeof k!="number")return a.error("Exponential interpolation requires a numeric base.",1,1);p={name:"exponential",base:k}}else{if(p[0]!=="cubic-bezier")return a.error(`Unknown interpolation type ${String(p[0])}`,1,0);{const k=p.slice(1);if(k.length!==4||k.some(A=>typeof A!="number"||A<0||A>1))return a.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);p={name:"cubic-bezier",controlPoints:k}}}if(n.length-1<4)return a.error(`Expected at least 4 arguments, but found only ${n.length-1}.`);if((n.length-1)%2!=0)return a.error("Expected an even number of arguments.");if(y=a.parse(y,2,Ue),!y)return null;const w=[];let T=null;h==="interpolate-hcl"||h==="interpolate-lab"?T=fr:a.expectedType&&a.expectedType.kind!=="value"&&(T=a.expectedType);for(let k=0;k<v.length;k+=2){const A=v[k],R=v[k+1],V=k+3,j=k+4;if(typeof A!="number")return a.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',V);if(w.length&&w[w.length-1][0]>=A)return a.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',V);const q=a.parse(R,j,T);if(!q)return null;T=T||q.type,w.push([A,q])}return we(T,Ue)||we(T,fr)||we(T,P)||we(T,Z)||we(T,H(Ue))?new li(T,h,p,y,w):a.error(`Type ${W(T)} is not interpolatable.`)}evaluate(n){const a=this.labels,h=this.outputs;if(a.length===1)return h[0].evaluate(n);const p=this.input.evaluate(n);if(p<=a[0])return h[0].evaluate(n);const y=a.length;if(p>=a[y-1])return h[y-1].evaluate(n);const v=Ua(a,p),w=li.interpolationFactor(this.interpolation,p,a[v],a[v+1]),T=h[v].evaluate(n),k=h[v+1].evaluate(n);switch(this.operator){case"interpolate":return si[this.type.kind](T,k,w);case"interpolate-hcl":return si.color(T,k,w,"hcl");case"interpolate-lab":return si.color(T,k,w,"lab")}}eachChild(n){n(this.input);for(const a of this.outputs)n(a)}outputDefined(){return this.outputs.every(n=>n.outputDefined())}}function Xu(i,n,a,h){const p=h-a,y=i-a;return p===0?0:n===1?y/p:(Math.pow(n,y)-1)/(Math.pow(n,p)-1)}class Cl{constructor(n,a){this.type=n,this.args=a}static parse(n,a){if(n.length<2)return a.error("Expectected at least one argument.");let h=null;const p=a.expectedType;p&&p.kind!=="value"&&(h=p);const y=[];for(const w of n.slice(1)){const T=a.parse(w,1+y.length,h,void 0,{typeAnnotation:"omit"});if(!T)return null;h=h||T.type,y.push(T)}if(!h)throw new Error("No output type");const v=p&&y.some(w=>ne(p,w.type));return new Cl(v?Ct:h,y)}evaluate(n){let a,h=null,p=0;for(const y of this.args)if(p++,h=y.evaluate(n),h&&h instanceof mr&&!h.available&&(a||(a=h.name),h=null,p===this.args.length&&(h=a)),h!==null)break;return h}eachChild(n){this.args.forEach(n)}outputDefined(){return this.args.every(n=>n.outputDefined())}}class El{constructor(n,a){this.type=a.type,this.bindings=[].concat(n),this.result=a}evaluate(n){return this.result.evaluate(n)}eachChild(n){for(const a of this.bindings)n(a[1]);n(this.result)}static parse(n,a){if(n.length<4)return a.error(`Expected at least 3 arguments, but found ${n.length-1} instead.`);const h=[];for(let y=1;y<n.length-1;y+=2){const v=n[y];if(typeof v!="string")return a.error(`Expected string, but found ${typeof v} instead.`,y);if(/[^a-zA-Z0-9_]/.test(v))return a.error("Variable names must contain only alphanumeric characters or '_'.",y);const w=a.parse(n[y+1],y+1);if(!w)return null;h.push([v,w])}const p=a.parse(n[n.length-1],n.length-1,a.expectedType,h);return p?new El(h,p):null}outputDefined(){return this.result.outputDefined()}}class Yu{constructor(n,a,h){this.type=n,this.index=a,this.input=h}static parse(n,a){if(n.length!==3)return a.error(`Expected 2 arguments, but found ${n.length-1} instead.`);const h=a.parse(n[1],1,Ue),p=a.parse(n[2],2,H(a.expectedType||Ct));return h&&p?new Yu(p.type.itemType,h,p):null}evaluate(n){const a=this.index.evaluate(n),h=this.input.evaluate(n);if(a<0)throw new Pn(`Array index out of bounds: ${a} < 0.`);if(a>=h.length)throw new Pn(`Array index out of bounds: ${a} > ${h.length-1}.`);if(a!==Math.floor(a))throw new Pn(`Array index must be an integer, but found ${a} instead.`);return h[a]}eachChild(n){n(this.index),n(this.input)}outputDefined(){return!1}}class Ju{constructor(n,a){this.type=vt,this.needle=n,this.haystack=a}static parse(n,a){if(n.length!==3)return a.error(`Expected 2 arguments, but found ${n.length-1} instead.`);const h=a.parse(n[1],1,Ct),p=a.parse(n[2],2,Ct);return h&&p?Q(h.type,[vt,Mt,Ue,Si,Ct])?new Ju(h,p):a.error(`Expected first argument to be of type boolean, string, number or null, but found ${W(h.type)} instead`):null}evaluate(n){const a=this.needle.evaluate(n),h=this.haystack.evaluate(n);if(!h)return!1;if(!fe(a,["boolean","string","number","null"]))throw new Pn(`Expected first argument to be of type boolean, string, number or null, but found ${W(Tn(a))} instead.`);if(!fe(h,["string","array"]))throw new Pn(`Expected second argument to be of type array or string, but found ${W(Tn(h))} instead.`);return h.indexOf(a)>=0}eachChild(n){n(this.needle),n(this.haystack)}outputDefined(){return!0}}class Il{constructor(n,a,h){this.type=Ue,this.needle=n,this.haystack=a,this.fromIndex=h}static parse(n,a){if(n.length<=2||n.length>=5)return a.error(`Expected 3 or 4 arguments, but found ${n.length-1} instead.`);const h=a.parse(n[1],1,Ct),p=a.parse(n[2],2,Ct);if(!h||!p)return null;if(!Q(h.type,[vt,Mt,Ue,Si,Ct]))return a.error(`Expected first argument to be of type boolean, string, number or null, but found ${W(h.type)} instead`);if(n.length===4){const y=a.parse(n[3],3,Ue);return y?new Il(h,p,y):null}return new Il(h,p)}evaluate(n){const a=this.needle.evaluate(n),h=this.haystack.evaluate(n);if(!fe(a,["boolean","string","number","null"]))throw new Pn(`Expected first argument to be of type boolean, string, number or null, but found ${W(Tn(a))} instead.`);if(!fe(h,["string","array"]))throw new Pn(`Expected second argument to be of type array or string, but found ${W(Tn(h))} instead.`);if(this.fromIndex){const p=this.fromIndex.evaluate(n);return h.indexOf(a,p)}return h.indexOf(a)}eachChild(n){n(this.needle),n(this.haystack),this.fromIndex&&n(this.fromIndex)}outputDefined(){return!1}}class Qu{constructor(n,a,h,p,y,v){this.inputType=n,this.type=a,this.input=h,this.cases=p,this.outputs=y,this.otherwise=v}static parse(n,a){if(n.length<5)return a.error(`Expected at least 4 arguments, but found only ${n.length-1}.`);if(n.length%2!=1)return a.error("Expected an even number of arguments.");let h,p;a.expectedType&&a.expectedType.kind!=="value"&&(p=a.expectedType);const y={},v=[];for(let k=2;k<n.length-1;k+=2){let A=n[k];const R=n[k+1];Array.isArray(A)||(A=[A]);const V=a.concat(k);if(A.length===0)return V.error("Expected at least one branch label.");for(const q of A){if(typeof q!="number"&&typeof q!="string")return V.error("Branch labels must be numbers or strings.");if(typeof q=="number"&&Math.abs(q)>Number.MAX_SAFE_INTEGER)return V.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof q=="number"&&Math.floor(q)!==q)return V.error("Numeric branch labels must be integer values.");if(h){if(V.checkSubtype(h,Tn(q)))return null}else h=Tn(q);if(y[String(q)]!==void 0)return V.error("Branch labels must be unique.");y[String(q)]=v.length}const j=a.parse(R,k,p);if(!j)return null;p=p||j.type,v.push(j)}const w=a.parse(n[1],1,Ct);if(!w)return null;const T=a.parse(n[n.length-1],n.length-1,p);return T?w.type.kind!=="value"&&a.concat(1).checkSubtype(h,w.type)?null:new Qu(h,p,w,y,v,T):null}evaluate(n){const a=this.input.evaluate(n);return(Tn(a)===this.inputType&&this.outputs[this.cases[a]]||this.otherwise).evaluate(n)}eachChild(n){n(this.input),this.outputs.forEach(n),n(this.otherwise)}outputDefined(){return this.outputs.every(n=>n.outputDefined())&&this.otherwise.outputDefined()}}class ec{constructor(n,a,h){this.type=n,this.branches=a,this.otherwise=h}static parse(n,a){if(n.length<4)return a.error(`Expected at least 3 arguments, but found only ${n.length-1}.`);if(n.length%2!=0)return a.error("Expected an odd number of arguments.");let h;a.expectedType&&a.expectedType.kind!=="value"&&(h=a.expectedType);const p=[];for(let v=1;v<n.length-1;v+=2){const w=a.parse(n[v],v,vt);if(!w)return null;const T=a.parse(n[v+1],v+1,h);if(!T)return null;p.push([w,T]),h=h||T.type}const y=a.parse(n[n.length-1],n.length-1,h);if(!y)return null;if(!h)throw new Error("Can't infer output type");return new ec(h,p,y)}evaluate(n){for(const[a,h]of this.branches)if(a.evaluate(n))return h.evaluate(n);return this.otherwise.evaluate(n)}eachChild(n){for(const[a,h]of this.branches)n(a),n(h);n(this.otherwise)}outputDefined(){return this.branches.every(([n,a])=>a.outputDefined())&&this.otherwise.outputDefined()}}class kl{constructor(n,a,h,p){this.type=n,this.input=a,this.beginIndex=h,this.endIndex=p}static parse(n,a){if(n.length<=2||n.length>=5)return a.error(`Expected 3 or 4 arguments, but found ${n.length-1} instead.`);const h=a.parse(n[1],1,Ct),p=a.parse(n[2],2,Ue);if(!h||!p)return null;if(!Q(h.type,[H(Ct),Mt,Ct]))return a.error(`Expected first argument to be of type array or string, but found ${W(h.type)} instead`);if(n.length===4){const y=a.parse(n[3],3,Ue);return y?new kl(h.type,h,p,y):null}return new kl(h.type,h,p)}evaluate(n){const a=this.input.evaluate(n),h=this.beginIndex.evaluate(n);if(!fe(a,["string","array"]))throw new Pn(`Expected first argument to be of type array or string, but found ${W(Tn(a))} instead.`);if(this.endIndex){const p=this.endIndex.evaluate(n);return a.slice(h,p)}return a.slice(h)}eachChild(n){n(this.input),n(this.beginIndex),this.endIndex&&n(this.endIndex)}outputDefined(){return!1}}function hd(i,n){return i==="=="||i==="!="?n.kind==="boolean"||n.kind==="string"||n.kind==="number"||n.kind==="null"||n.kind==="value":n.kind==="string"||n.kind==="number"||n.kind==="value"}function dd(i,n,a,h){return h.compare(n,a)===0}function $a(i,n,a){const h=i!=="=="&&i!=="!=";return class mS{constructor(y,v,w){this.type=vt,this.lhs=y,this.rhs=v,this.collator=w,this.hasUntypedArgument=y.type.kind==="value"||v.type.kind==="value"}static parse(y,v){if(y.length!==3&&y.length!==4)return v.error("Expected two or three arguments.");const w=y[0];let T=v.parse(y[1],1,Ct);if(!T)return null;if(!hd(w,T.type))return v.concat(1).error(`"${w}" comparisons are not supported for type '${W(T.type)}'.`);let k=v.parse(y[2],2,Ct);if(!k)return null;if(!hd(w,k.type))return v.concat(2).error(`"${w}" comparisons are not supported for type '${W(k.type)}'.`);if(T.type.kind!==k.type.kind&&T.type.kind!=="value"&&k.type.kind!=="value")return v.error(`Cannot compare types '${W(T.type)}' and '${W(k.type)}'.`);h&&(T.type.kind==="value"&&k.type.kind!=="value"?T=new Ci(k.type,[T]):T.type.kind!=="value"&&k.type.kind==="value"&&(k=new Ci(T.type,[k])));let A=null;if(y.length===4){if(T.type.kind!=="string"&&k.type.kind!=="string"&&T.type.kind!=="value"&&k.type.kind!=="value")return v.error("Cannot use collator to compare non-string types.");if(A=v.parse(y[3],3,xe),!A)return null}return new mS(T,k,A)}evaluate(y){const v=this.lhs.evaluate(y),w=this.rhs.evaluate(y);if(h&&this.hasUntypedArgument){const T=Tn(v),k=Tn(w);if(T.kind!==k.kind||T.kind!=="string"&&T.kind!=="number")throw new Pn(`Expected arguments for "${i}" to be (string, string) or (number, number), but found (${T.kind}, ${k.kind}) instead.`)}if(this.collator&&!h&&this.hasUntypedArgument){const T=Tn(v),k=Tn(w);if(T.kind!=="string"||k.kind!=="string")return n(y,v,w)}return this.collator?a(y,v,w,this.collator.evaluate(y)):n(y,v,w)}eachChild(y){y(this.lhs),y(this.rhs),this.collator&&y(this.collator)}outputDefined(){return!0}}}const ym=$a("==",function(i,n,a){return n===a},dd),_m=$a("!=",function(i,n,a){return n!==a},function(i,n,a,h){return!dd(0,n,a,h)}),vm=$a("<",function(i,n,a){return n<a},function(i,n,a,h){return h.compare(n,a)<0}),xm=$a(">",function(i,n,a){return n>a},function(i,n,a,h){return h.compare(n,a)>0}),wm=$a("<=",function(i,n,a){return n<=a},function(i,n,a,h){return h.compare(n,a)<=0}),bm=$a(">=",function(i,n,a){return n>=a},function(i,n,a,h){return h.compare(n,a)>=0});class tc{constructor(n,a,h,p,y){this.type=Mt,this.number=n,this.locale=a,this.currency=h,this.minFractionDigits=p,this.maxFractionDigits=y}static parse(n,a){if(n.length!==3)return a.error("Expected two arguments.");const h=a.parse(n[1],1,Ue);if(!h)return null;const p=n[2];if(typeof p!="object"||Array.isArray(p))return a.error("NumberFormat options argument must be an object.");let y=null;if(p.locale&&(y=a.parse(p.locale,1,Mt),!y))return null;let v=null;if(p.currency&&(v=a.parse(p.currency,1,Mt),!v))return null;let w=null;if(p["min-fraction-digits"]&&(w=a.parse(p["min-fraction-digits"],1,Ue),!w))return null;let T=null;return p["max-fraction-digits"]&&(T=a.parse(p["max-fraction-digits"],1,Ue),!T)?null:new tc(h,y,v,w,T)}evaluate(n){return new Intl.NumberFormat(this.locale?this.locale.evaluate(n):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(n):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(n):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(n):void 0}).format(this.number.evaluate(n))}eachChild(n){n(this.number),this.locale&&n(this.locale),this.currency&&n(this.currency),this.minFractionDigits&&n(this.minFractionDigits),this.maxFractionDigits&&n(this.maxFractionDigits)}outputDefined(){return!1}}class Ml{constructor(n){this.type=B,this.sections=n}static parse(n,a){if(n.length<2)return a.error("Expected at least one argument.");const h=n[1];if(!Array.isArray(h)&&typeof h=="object")return a.error("First argument must be an image or text section.");const p=[];let y=!1;for(let v=1;v<=n.length-1;++v){const w=n[v];if(y&&typeof w=="object"&&!Array.isArray(w)){y=!1;let T=null;if(w["font-scale"]&&(T=a.parse(w["font-scale"],1,Ue),!T))return null;let k=null;if(w["text-font"]&&(k=a.parse(w["text-font"],1,H(Mt)),!k))return null;let A=null;if(w["text-color"]&&(A=a.parse(w["text-color"],1,fr),!A))return null;const R=p[p.length-1];R.scale=T,R.font=k,R.textColor=A}else{const T=a.parse(n[v],1,Ct);if(!T)return null;const k=T.type.kind;if(k!=="string"&&k!=="value"&&k!=="null"&&k!=="resolvedImage")return a.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");y=!0,p.push({content:T,scale:null,font:null,textColor:null})}}return new Ml(p)}evaluate(n){return new Sr(this.sections.map(a=>{const h=a.content.evaluate(n);return Tn(h)===F?new fl("",h,null,null,null):new fl(Jt(h),null,a.scale?a.scale.evaluate(n):null,a.font?a.font.evaluate(n).join(","):null,a.textColor?a.textColor.evaluate(n):null)}))}eachChild(n){for(const a of this.sections)n(a.content),a.scale&&n(a.scale),a.font&&n(a.font),a.textColor&&n(a.textColor)}outputDefined(){return!1}}class nc{constructor(n){this.type=F,this.input=n}static parse(n,a){if(n.length!==2)return a.error("Expected two arguments.");const h=a.parse(n[1],1,Mt);return h?new nc(h):a.error("No image name provided.")}evaluate(n){const a=this.input.evaluate(n),h=mr.fromString(a);return h&&n.availableImages&&(h.available=n.availableImages.indexOf(a)>-1),h}eachChild(n){n(this.input)}outputDefined(){return!1}}class rc{constructor(n){this.type=Ue,this.input=n}static parse(n,a){if(n.length!==2)return a.error(`Expected 1 argument, but found ${n.length-1} instead.`);const h=a.parse(n[1],1);return h?h.type.kind!=="array"&&h.type.kind!=="string"&&h.type.kind!=="value"?a.error(`Expected argument of type string or array, but found ${W(h.type)} instead.`):new rc(h):null}evaluate(n){const a=this.input.evaluate(n);if(typeof a=="string"||Array.isArray(a))return a.length;throw new Pn(`Expected value to be of type string or array, but found ${W(Tn(a))} instead.`)}eachChild(n){n(this.input)}outputDefined(){return!1}}const ja={"==":ym,"!=":_m,">":xm,"<":vm,">=":bm,"<=":wm,array:Ci,at:Yu,boolean:Ci,case:ec,coalesce:Cl,collator:_l,format:Ml,image:nc,in:Ju,"index-of":Il,interpolate:li,"interpolate-hcl":li,"interpolate-lab":li,length:rc,let:El,literal:ua,match:Qu,number:Ci,"number-format":tc,object:Ci,slice:kl,step:Wo,string:Ci,"to-boolean":Go,"to-color":Go,"to-number":Go,"to-string":Go,var:xl,within:ca};function pd(i,[n,a,h,p]){n=n.evaluate(i),a=a.evaluate(i),h=h.evaluate(i);const y=p?p.evaluate(i):1,v=ml(n,a,h,y);if(v)throw new Pn(v);return new on(n/255,a/255,h/255,y,!1)}function fd(i,n){return i in n}function ic(i,n){const a=n[i];return a===void 0?null:a}function ha(i){return{type:i}}function md(i){return{result:"success",value:i}}function Ko(i){return{result:"error",value:i}}function Za(i){return i["property-type"]==="data-driven"||i["property-type"]==="cross-faded-data-driven"}function gd(i){return!!i.expression&&i.expression.parameters.indexOf("zoom")>-1}function oc(i){return!!i.expression&&i.expression.interpolated}function Qt(i){return i instanceof Number?"number":i instanceof String?"string":i instanceof Boolean?"boolean":Array.isArray(i)?"array":i===null?"null":typeof i}function Cn(i){return typeof i=="object"&&i!==null&&!Array.isArray(i)}function Sm(i){return i}function Gt(i,n){const a=n.type==="color",h=i.stops&&typeof i.stops[0][0]=="object",p=h||!(h||i.property!==void 0),y=i.type||(oc(n)?"exponential":"interval");if(a||n.type==="padding"){const A=a?on.parse:ai.parse;(i=wi({},i)).stops&&(i.stops=i.stops.map(R=>[R[0],A(R[1])])),i.default=A(i.default?i.default:n.default)}if(i.colorSpace&&(v=i.colorSpace)!=="rgb"&&v!=="hcl"&&v!=="lab")throw new Error(`Unknown color space: "${i.colorSpace}"`);var v;let w,T,k;if(y==="exponential")w=ks;else if(y==="interval")w=bn;else if(y==="categorical"){w=En,T=Object.create(null);for(const A of i.stops)T[A[0]]=A[1];k=typeof i.stops[0][0]}else{if(y!=="identity")throw new Error(`Unknown function type "${y}"`);w=yd}if(h){const A={},R=[];for(let q=0;q<i.stops.length;q++){const X=i.stops[q],re=X[0].zoom;A[re]===void 0&&(A[re]={zoom:re,type:i.type,property:i.property,default:i.default,stops:[]},R.push(re)),A[re].stops.push([X[0].value,X[1]])}const V=[];for(const q of R)V.push([A[q].zoom,Gt(A[q],n)]);const j={name:"linear"};return{kind:"composite",interpolationType:j,interpolationFactor:li.interpolationFactor.bind(void 0,j),zoomStops:V.map(q=>q[0]),evaluate:({zoom:q},X)=>ks({stops:V,base:i.base},n,q).evaluate(q,X)}}if(p){const A=y==="exponential"?{name:"exponential",base:i.base!==void 0?i.base:1}:null;return{kind:"camera",interpolationType:A,interpolationFactor:li.interpolationFactor.bind(void 0,A),zoomStops:i.stops.map(R=>R[0]),evaluate:({zoom:R})=>w(i,n,R,T,k)}}return{kind:"source",evaluate(A,R){const V=R&&R.properties?R.properties[i.property]:void 0;return V===void 0?da(i.default,n.default):w(i,n,V,T,k)}}}function da(i,n,a){return i!==void 0?i:n!==void 0?n:a!==void 0?a:void 0}function En(i,n,a,h,p){return da(typeof a===p?h[a]:void 0,i.default,n.default)}function bn(i,n,a){if(Qt(a)!=="number")return da(i.default,n.default);const h=i.stops.length;if(h===1||a<=i.stops[0][0])return i.stops[0][1];if(a>=i.stops[h-1][0])return i.stops[h-1][1];const p=Ua(i.stops.map(y=>y[0]),a);return i.stops[p][1]}function ks(i,n,a){const h=i.base!==void 0?i.base:1;if(Qt(a)!=="number")return da(i.default,n.default);const p=i.stops.length;if(p===1||a<=i.stops[0][0])return i.stops[0][1];if(a>=i.stops[p-1][0])return i.stops[p-1][1];const y=Ua(i.stops.map(A=>A[0]),a),v=function(A,R,V,j){const q=j-V,X=A-V;return q===0?0:R===1?X/q:(Math.pow(R,X)-1)/(Math.pow(R,q)-1)}(a,h,i.stops[y][0],i.stops[y+1][0]),w=i.stops[y][1],T=i.stops[y+1][1],k=si[n.type]||Sm;return typeof w.evaluate=="function"?{evaluate(...A){const R=w.evaluate.apply(void 0,A),V=T.evaluate.apply(void 0,A);if(R!==void 0&&V!==void 0)return k(R,V,v,i.colorSpace)}}:k(w,T,v,i.colorSpace)}function yd(i,n,a){switch(n.type){case"color":a=on.parse(a);break;case"formatted":a=Sr.fromString(a.toString());break;case"resolvedImage":a=mr.fromString(a.toString());break;case"padding":a=ai.parse(a);break;default:Qt(a)===n.type||n.type==="enum"&&n.values[a]||(a=void 0)}return da(a,i.default,n.default)}Ei.register(ja,{error:[{kind:"error"},[Mt],(i,[n])=>{throw new Pn(n.evaluate(i))}],typeof:[Mt,[Ct],(i,[n])=>W(Tn(n.evaluate(i)))],"to-rgba":[H(Ue,4),[fr],(i,[n])=>{const[a,h,p,y]=n.evaluate(i).rgb;return[255*a,255*h,255*p,y]}],rgb:[fr,[Ue,Ue,Ue],pd],rgba:[fr,[Ue,Ue,Ue,Ue],pd],has:{type:vt,overloads:[[[Mt],(i,[n])=>fd(n.evaluate(i),i.properties())],[[Mt,ii],(i,[n,a])=>fd(n.evaluate(i),a.evaluate(i))]]},get:{type:Ct,overloads:[[[Mt],(i,[n])=>ic(n.evaluate(i),i.properties())],[[Mt,ii],(i,[n,a])=>ic(n.evaluate(i),a.evaluate(i))]]},"feature-state":[Ct,[Mt],(i,[n])=>ic(n.evaluate(i),i.featureState||{})],properties:[ii,[],i=>i.properties()],"geometry-type":[Mt,[],i=>i.geometryType()],id:[Ct,[],i=>i.id()],zoom:[Ue,[],i=>i.globals.zoom],"heatmap-density":[Ue,[],i=>i.globals.heatmapDensity||0],"line-progress":[Ue,[],i=>i.globals.lineProgress||0],accumulated:[Ct,[],i=>i.globals.accumulated===void 0?null:i.globals.accumulated],"+":[Ue,ha(Ue),(i,n)=>{let a=0;for(const h of n)a+=h.evaluate(i);return a}],"*":[Ue,ha(Ue),(i,n)=>{let a=1;for(const h of n)a*=h.evaluate(i);return a}],"-":{type:Ue,overloads:[[[Ue,Ue],(i,[n,a])=>n.evaluate(i)-a.evaluate(i)],[[Ue],(i,[n])=>-n.evaluate(i)]]},"/":[Ue,[Ue,Ue],(i,[n,a])=>n.evaluate(i)/a.evaluate(i)],"%":[Ue,[Ue,Ue],(i,[n,a])=>n.evaluate(i)%a.evaluate(i)],ln2:[Ue,[],()=>Math.LN2],pi:[Ue,[],()=>Math.PI],e:[Ue,[],()=>Math.E],"^":[Ue,[Ue,Ue],(i,[n,a])=>Math.pow(n.evaluate(i),a.evaluate(i))],sqrt:[Ue,[Ue],(i,[n])=>Math.sqrt(n.evaluate(i))],log10:[Ue,[Ue],(i,[n])=>Math.log(n.evaluate(i))/Math.LN10],ln:[Ue,[Ue],(i,[n])=>Math.log(n.evaluate(i))],log2:[Ue,[Ue],(i,[n])=>Math.log(n.evaluate(i))/Math.LN2],sin:[Ue,[Ue],(i,[n])=>Math.sin(n.evaluate(i))],cos:[Ue,[Ue],(i,[n])=>Math.cos(n.evaluate(i))],tan:[Ue,[Ue],(i,[n])=>Math.tan(n.evaluate(i))],asin:[Ue,[Ue],(i,[n])=>Math.asin(n.evaluate(i))],acos:[Ue,[Ue],(i,[n])=>Math.acos(n.evaluate(i))],atan:[Ue,[Ue],(i,[n])=>Math.atan(n.evaluate(i))],min:[Ue,ha(Ue),(i,n)=>Math.min(...n.map(a=>a.evaluate(i)))],max:[Ue,ha(Ue),(i,n)=>Math.max(...n.map(a=>a.evaluate(i)))],abs:[Ue,[Ue],(i,[n])=>Math.abs(n.evaluate(i))],round:[Ue,[Ue],(i,[n])=>{const a=n.evaluate(i);return a<0?-Math.round(-a):Math.round(a)}],floor:[Ue,[Ue],(i,[n])=>Math.floor(n.evaluate(i))],ceil:[Ue,[Ue],(i,[n])=>Math.ceil(n.evaluate(i))],"filter-==":[vt,[Mt,Ct],(i,[n,a])=>i.properties()[n.value]===a.value],"filter-id-==":[vt,[Ct],(i,[n])=>i.id()===n.value],"filter-type-==":[vt,[Mt],(i,[n])=>i.geometryType()===n.value],"filter-<":[vt,[Mt,Ct],(i,[n,a])=>{const h=i.properties()[n.value],p=a.value;return typeof h==typeof p&&h<p}],"filter-id-<":[vt,[Ct],(i,[n])=>{const a=i.id(),h=n.value;return typeof a==typeof h&&a<h}],"filter->":[vt,[Mt,Ct],(i,[n,a])=>{const h=i.properties()[n.value],p=a.value;return typeof h==typeof p&&h>p}],"filter-id->":[vt,[Ct],(i,[n])=>{const a=i.id(),h=n.value;return typeof a==typeof h&&a>h}],"filter-<=":[vt,[Mt,Ct],(i,[n,a])=>{const h=i.properties()[n.value],p=a.value;return typeof h==typeof p&&h<=p}],"filter-id-<=":[vt,[Ct],(i,[n])=>{const a=i.id(),h=n.value;return typeof a==typeof h&&a<=h}],"filter->=":[vt,[Mt,Ct],(i,[n,a])=>{const h=i.properties()[n.value],p=a.value;return typeof h==typeof p&&h>=p}],"filter-id->=":[vt,[Ct],(i,[n])=>{const a=i.id(),h=n.value;return typeof a==typeof h&&a>=h}],"filter-has":[vt,[Ct],(i,[n])=>n.value in i.properties()],"filter-has-id":[vt,[],i=>i.id()!==null&&i.id()!==void 0],"filter-type-in":[vt,[H(Mt)],(i,[n])=>n.value.indexOf(i.geometryType())>=0],"filter-id-in":[vt,[H(Ct)],(i,[n])=>n.value.indexOf(i.id())>=0],"filter-in-small":[vt,[Mt,H(Ct)],(i,[n,a])=>a.value.indexOf(i.properties()[n.value])>=0],"filter-in-large":[vt,[Mt,H(Ct)],(i,[n,a])=>function(h,p,y,v){for(;y<=v;){const w=y+v>>1;if(p[w]===h)return!0;p[w]>h?v=w-1:y=w+1}return!1}(i.properties()[n.value],a.value,0,a.value.length-1)],all:{type:vt,overloads:[[[vt,vt],(i,[n,a])=>n.evaluate(i)&&a.evaluate(i)],[ha(vt),(i,n)=>{for(const a of n)if(!a.evaluate(i))return!1;return!0}]]},any:{type:vt,overloads:[[[vt,vt],(i,[n,a])=>n.evaluate(i)||a.evaluate(i)],[ha(vt),(i,n)=>{for(const a of n)if(a.evaluate(i))return!0;return!1}]]},"!":[vt,[vt],(i,[n])=>!n.evaluate(i)],"is-supported-script":[vt,[Mt],(i,[n])=>{const a=i.globals&&i.globals.isSupportedScript;return!a||a(n.evaluate(i))}],upcase:[Mt,[Mt],(i,[n])=>n.evaluate(i).toUpperCase()],downcase:[Mt,[Mt],(i,[n])=>n.evaluate(i).toLowerCase()],concat:[Mt,ha(Ct),(i,n)=>n.map(a=>Jt(a.evaluate(i))).join("")],"resolved-locale":[Mt,[xe],(i,[n])=>n.evaluate(i).resolvedLocale()]});class ac{constructor(n,a){var h;this.expression=n,this._warningHistory={},this._evaluator=new Zu,this._defaultValue=a?(h=a).type==="color"&&Cn(h.default)?new on(0,0,0,0):h.type==="color"?on.parse(h.default)||null:h.type==="padding"?ai.parse(h.default)||null:h.type==="variableAnchorOffsetCollection"?Ti.parse(h.default)||null:h.default===void 0?null:h.default:null,this._enumValues=a&&a.type==="enum"?a.values:null}evaluateWithoutErrorHandling(n,a,h,p,y,v){return this._evaluator.globals=n,this._evaluator.feature=a,this._evaluator.featureState=h,this._evaluator.canonical=p,this._evaluator.availableImages=y||null,this._evaluator.formattedSection=v,this.expression.evaluate(this._evaluator)}evaluate(n,a,h,p,y,v){this._evaluator.globals=n,this._evaluator.feature=a||null,this._evaluator.featureState=h||null,this._evaluator.canonical=p,this._evaluator.availableImages=y||null,this._evaluator.formattedSection=v||null;try{const w=this.expression.evaluate(this._evaluator);if(w==null||typeof w=="number"&&w!=w)return this._defaultValue;if(this._enumValues&&!(w in this._enumValues))throw new Pn(`Expected value to be one of ${Object.keys(this._enumValues).map(T=>JSON.stringify(T)).join(", ")}, but found ${JSON.stringify(w)} instead.`);return w}catch(w){return this._warningHistory[w.message]||(this._warningHistory[w.message]=!0,typeof console<"u"&&console.warn(w.message)),this._defaultValue}}}function Pl(i){return Array.isArray(i)&&i.length>0&&typeof i[0]=="string"&&i[0]in ja}function Al(i,n){const a=new yl(ja,wl,[],n?function(p){const y={color:fr,string:Mt,number:Ue,enum:Mt,boolean:vt,formatted:B,padding:P,resolvedImage:F,variableAnchorOffsetCollection:Z};return p.type==="array"?H(y[p.value]||Ct,p.length):y[p.type]}(n):void 0),h=a.parse(i,void 0,void 0,void 0,n&&n.type==="string"?{typeAnnotation:"coerce"}:void 0);return h?md(new ac(h,n)):Ko(a.errors)}class sc{constructor(n,a){this.kind=n,this._styleExpression=a,this.isStateDependent=n!=="constant"&&!Is(a.expression)}evaluateWithoutErrorHandling(n,a,h,p,y,v){return this._styleExpression.evaluateWithoutErrorHandling(n,a,h,p,y,v)}evaluate(n,a,h,p,y,v){return this._styleExpression.evaluate(n,a,h,p,y,v)}}class zl{constructor(n,a,h,p){this.kind=n,this.zoomStops=h,this._styleExpression=a,this.isStateDependent=n!=="camera"&&!Is(a.expression),this.interpolationType=p}evaluateWithoutErrorHandling(n,a,h,p,y,v){return this._styleExpression.evaluateWithoutErrorHandling(n,a,h,p,y,v)}evaluate(n,a,h,p,y,v){return this._styleExpression.evaluate(n,a,h,p,y,v)}interpolationFactor(n,a,h){return this.interpolationType?li.interpolationFactor(this.interpolationType,n,a,h):0}}function lc(i,n){const a=Al(i,n);if(a.result==="error")return a;const h=a.value.expression,p=bl(h);if(!p&&!Za(n))return Ko([new gn("","data expressions not supported")]);const y=Sl(h,["zoom"]);if(!y&&!gd(n))return Ko([new gn("","zoom expressions not supported")]);const v=Ps(h);return v||y?v instanceof gn?Ko([v]):v instanceof li&&!oc(n)?Ko([new gn("",'"interpolate" expressions cannot be used with this property')]):md(v?new zl(p?"camera":"composite",a.value,v.labels,v instanceof li?v.interpolation:void 0):new sc(p?"constant":"source",a.value)):Ko([new gn("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Ms{constructor(n,a){this._parameters=n,this._specification=a,wi(this,Gt(this._parameters,this._specification))}static deserialize(n){return new Ms(n._parameters,n._specification)}static serialize(n){return{_parameters:n._parameters,_specification:n._specification}}}function Ps(i){let n=null;if(i instanceof El)n=Ps(i.result);else if(i instanceof Cl){for(const a of i.args)if(n=Ps(a),n)break}else(i instanceof Wo||i instanceof li)&&i.input instanceof Ei&&i.input.name==="zoom"&&(n=i);return n instanceof gn||i.eachChild(a=>{const h=Ps(a);h instanceof gn?n=h:!n&&h?n=new gn("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):n&&h&&n!==h&&(n=new gn("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),n}function As(i){if(i===!0||i===!1)return!0;if(!Array.isArray(i)||i.length===0)return!1;switch(i[0]){case"has":return i.length>=2&&i[1]!=="$id"&&i[1]!=="$type";case"in":return i.length>=3&&(typeof i[1]!="string"||Array.isArray(i[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return i.length!==3||Array.isArray(i[1])||Array.isArray(i[2]);case"any":case"all":for(const n of i.slice(1))if(!As(n)&&typeof n!="boolean")return!1;return!0;default:return!0}}const Tm={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function uc(i){if(i==null)return{filter:()=>!0,needGeometry:!1};As(i)||(i=Dl(i));const n=Al(i,Tm);if(n.result==="error")throw new Error(n.value.map(a=>`${a.key}: ${a.message}`).join(", "));return{filter:(a,h,p)=>n.value.evaluate(a,h,{},p),needGeometry:_d(i)}}function Cm(i,n){return i<n?-1:i>n?1:0}function _d(i){if(!Array.isArray(i))return!1;if(i[0]==="within")return!0;for(let n=1;n<i.length;n++)if(_d(i[n]))return!0;return!1}function Dl(i){if(!i)return!0;const n=i[0];return i.length<=1?n!=="any":n==="=="?cc(i[1],i[2],"=="):n==="!="?zs(cc(i[1],i[2],"==")):n==="<"||n===">"||n==="<="||n===">="?cc(i[1],i[2],n):n==="any"?(a=i.slice(1),["any"].concat(a.map(Dl))):n==="all"?["all"].concat(i.slice(1).map(Dl)):n==="none"?["all"].concat(i.slice(1).map(Dl).map(zs)):n==="in"?vd(i[1],i.slice(2)):n==="!in"?zs(vd(i[1],i.slice(2))):n==="has"?xd(i[1]):n==="!has"?zs(xd(i[1])):n!=="within"||i;var a}function cc(i,n,a){switch(i){case"$type":return[`filter-type-${a}`,n];case"$id":return[`filter-id-${a}`,n];default:return[`filter-${a}`,i,n]}}function vd(i,n){if(n.length===0)return!1;switch(i){case"$type":return["filter-type-in",["literal",n]];case"$id":return["filter-id-in",["literal",n]];default:return n.length>200&&!n.some(a=>typeof a!=typeof n[0])?["filter-in-large",i,["literal",n.sort(Cm)]]:["filter-in-small",i,["literal",n]]}}function xd(i){switch(i){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",i]}}function zs(i){return["!",i]}function Ll(i){const n=typeof i;if(n==="number"||n==="boolean"||n==="string"||i==null)return JSON.stringify(i);if(Array.isArray(i)){let p="[";for(const y of i)p+=`${Ll(y)},`;return`${p}]`}const a=Object.keys(i).sort();let h="{";for(let p=0;p<a.length;p++)h+=`${JSON.stringify(a[p])}:${Ll(i[a[p]])},`;return`${h}}`}function Rl(i){let n="";for(const a of Hn)n+=`/${Ll(i[a])}`;return n}function wd(i){const n=i.value;return n?[new Ne(i.key,n,"constants have been deprecated as of v8")]:[]}function An(i){return i instanceof Number||i instanceof String||i instanceof Boolean?i.valueOf():i}function pa(i){if(Array.isArray(i))return i.map(pa);if(i instanceof Object&&!(i instanceof Number||i instanceof String||i instanceof Boolean)){const n={};for(const a in i)n[a]=pa(i[a]);return n}return An(i)}function qr(i){const n=i.key,a=i.value,h=i.valueSpec||{},p=i.objectElementValidators||{},y=i.style,v=i.styleSpec,w=i.validateSpec;let T=[];const k=Qt(a);if(k!=="object")return[new Ne(n,a,`object expected, ${k} found`)];for(const A in a){const R=A.split(".")[0],V=h[R]||h["*"];let j;if(p[R])j=p[R];else if(h[R])j=w;else if(p["*"])j=p["*"];else{if(!h["*"]){T.push(new Ne(n,a[A],`unknown property "${A}"`));continue}j=w}T=T.concat(j({key:(n&&`${n}.`)+A,value:a[A],valueSpec:V,style:y,styleSpec:v,object:a,objectKey:A,validateSpec:w},a))}for(const A in h)p[A]||h[A].required&&h[A].default===void 0&&a[A]===void 0&&T.push(new Ne(n,a,`missing required property "${A}"`));return T}function qa(i){const n=i.value,a=i.valueSpec,h=i.style,p=i.styleSpec,y=i.key,v=i.arrayElementValidator||i.validateSpec;if(Qt(n)!=="array")return[new Ne(y,n,`array expected, ${Qt(n)} found`)];if(a.length&&n.length!==a.length)return[new Ne(y,n,`array length ${a.length} expected, length ${n.length} found`)];if(a["min-length"]&&n.length<a["min-length"])return[new Ne(y,n,`array length at least ${a["min-length"]} expected, length ${n.length} found`)];let w={type:a.value,values:a.values};p.$version<7&&(w.function=a.function),Qt(a.value)==="object"&&(w=a.value);let T=[];for(let k=0;k<n.length;k++)T=T.concat(v({array:n,arrayIndex:k,value:n[k],valueSpec:w,validateSpec:i.validateSpec,style:h,styleSpec:p,key:`${y}[${k}]`}));return T}function Ds(i){const n=i.key,a=i.value,h=i.valueSpec;let p=Qt(a);return p==="number"&&a!=a&&(p="NaN"),p!=="number"?[new Ne(n,a,`number expected, ${p} found`)]:"minimum"in h&&a<h.minimum?[new Ne(n,a,`${a} is less than the minimum value ${h.minimum}`)]:"maximum"in h&&a>h.maximum?[new Ne(n,a,`${a} is greater than the maximum value ${h.maximum}`)]:[]}function Fl(i){const n=i.valueSpec,a=An(i.value.type);let h,p,y,v={};const w=a!=="categorical"&&i.value.property===void 0,T=!w,k=Qt(i.value.stops)==="array"&&Qt(i.value.stops[0])==="array"&&Qt(i.value.stops[0][0])==="object",A=qr({key:i.key,value:i.value,valueSpec:i.styleSpec.function,validateSpec:i.validateSpec,style:i.style,styleSpec:i.styleSpec,objectElementValidators:{stops:function(j){if(a==="identity")return[new Ne(j.key,j.value,'identity function may not have a "stops" property')];let q=[];const X=j.value;return q=q.concat(qa({key:j.key,value:X,valueSpec:j.valueSpec,validateSpec:j.validateSpec,style:j.style,styleSpec:j.styleSpec,arrayElementValidator:R})),Qt(X)==="array"&&X.length===0&&q.push(new Ne(j.key,X,"array must have at least one stop")),q},default:function(j){return j.validateSpec({key:j.key,value:j.value,valueSpec:n,validateSpec:j.validateSpec,style:j.style,styleSpec:j.styleSpec})}}});return a==="identity"&&w&&A.push(new Ne(i.key,i.value,'missing required property "property"')),a==="identity"||i.value.stops||A.push(new Ne(i.key,i.value,'missing required property "stops"')),a==="exponential"&&i.valueSpec.expression&&!oc(i.valueSpec)&&A.push(new Ne(i.key,i.value,"exponential functions not supported")),i.styleSpec.$version>=8&&(T&&!Za(i.valueSpec)?A.push(new Ne(i.key,i.value,"property functions not supported")):w&&!gd(i.valueSpec)&&A.push(new Ne(i.key,i.value,"zoom functions not supported"))),a!=="categorical"&&!k||i.value.property!==void 0||A.push(new Ne(i.key,i.value,'"property" property is required')),A;function R(j){let q=[];const X=j.value,re=j.key;if(Qt(X)!=="array")return[new Ne(re,X,`array expected, ${Qt(X)} found`)];if(X.length!==2)return[new Ne(re,X,`array length 2 expected, length ${X.length} found`)];if(k){if(Qt(X[0])!=="object")return[new Ne(re,X,`object expected, ${Qt(X[0])} found`)];if(X[0].zoom===void 0)return[new Ne(re,X,"object stop key must have zoom")];if(X[0].value===void 0)return[new Ne(re,X,"object stop key must have value")];if(y&&y>An(X[0].zoom))return[new Ne(re,X[0].zoom,"stop zoom values must appear in ascending order")];An(X[0].zoom)!==y&&(y=An(X[0].zoom),p=void 0,v={}),q=q.concat(qr({key:`${re}[0]`,value:X[0],valueSpec:{zoom:{}},validateSpec:j.validateSpec,style:j.style,styleSpec:j.styleSpec,objectElementValidators:{zoom:Ds,value:V}}))}else q=q.concat(V({key:`${re}[0]`,value:X[0],valueSpec:{},validateSpec:j.validateSpec,style:j.style,styleSpec:j.styleSpec},X));return Pl(pa(X[1]))?q.concat([new Ne(`${re}[1]`,X[1],"expressions are not allowed in function stops.")]):q.concat(j.validateSpec({key:`${re}[1]`,value:X[1],valueSpec:n,validateSpec:j.validateSpec,style:j.style,styleSpec:j.styleSpec}))}function V(j,q){const X=Qt(j.value),re=An(j.value),se=j.value!==null?j.value:q;if(h){if(X!==h)return[new Ne(j.key,se,`${X} stop domain type must match previous stop domain type ${h}`)]}else h=X;if(X!=="number"&&X!=="string"&&X!=="boolean")return[new Ne(j.key,se,"stop domain value must be a number, string, or boolean")];if(X!=="number"&&a!=="categorical"){let ye=`number expected, ${X} found`;return Za(n)&&a===void 0&&(ye+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Ne(j.key,se,ye)]}return a!=="categorical"||X!=="number"||isFinite(re)&&Math.floor(re)===re?a!=="categorical"&&X==="number"&&p!==void 0&&re<p?[new Ne(j.key,se,"stop domain values must appear in ascending order")]:(p=re,a==="categorical"&&re in v?[new Ne(j.key,se,"stop domain values must be unique")]:(v[re]=!0,[])):[new Ne(j.key,se,`integer expected, found ${re}`)]}}function fa(i){const n=(i.expressionContext==="property"?lc:Al)(pa(i.value),i.valueSpec);if(n.result==="error")return n.value.map(h=>new Ne(`${i.key}${h.key}`,i.value,h.message));const a=n.value.expression||n.value._styleExpression.expression;if(i.expressionContext==="property"&&i.propertyKey==="text-font"&&!a.outputDefined())return[new Ne(i.key,i.value,`Invalid data expression for "${i.propertyKey}". Output values must be contained as literals within the expression.`)];if(i.expressionContext==="property"&&i.propertyType==="layout"&&!Is(a))return[new Ne(i.key,i.value,'"feature-state" data expressions are not supported with layout properties.')];if(i.expressionContext==="filter"&&!Is(a))return[new Ne(i.key,i.value,'"feature-state" data expressions are not supported with filters.')];if(i.expressionContext&&i.expressionContext.indexOf("cluster")===0){if(!Sl(a,["zoom","feature-state"]))return[new Ne(i.key,i.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(i.expressionContext==="cluster-initial"&&!bl(a))return[new Ne(i.key,i.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Ls(i){const n=i.key,a=i.value,h=i.valueSpec,p=[];return Array.isArray(h.values)?h.values.indexOf(An(a))===-1&&p.push(new Ne(n,a,`expected one of [${h.values.join(", ")}], ${JSON.stringify(a)} found`)):Object.keys(h.values).indexOf(An(a))===-1&&p.push(new Ne(n,a,`expected one of [${Object.keys(h.values).join(", ")}], ${JSON.stringify(a)} found`)),p}function Ga(i){return As(pa(i.value))?fa(wi({},i,{expressionContext:"filter",valueSpec:{value:"boolean"}})):bd(i)}function bd(i){const n=i.value,a=i.key;if(Qt(n)!=="array")return[new Ne(a,n,`array expected, ${Qt(n)} found`)];const h=i.styleSpec;let p,y=[];if(n.length<1)return[new Ne(a,n,"filter array must have at least 1 element")];switch(y=y.concat(Ls({key:`${a}[0]`,value:n[0],valueSpec:h.filter_operator,style:i.style,styleSpec:i.styleSpec})),An(n[0])){case"<":case"<=":case">":case">=":n.length>=2&&An(n[1])==="$type"&&y.push(new Ne(a,n,`"$type" cannot be use with operator "${n[0]}"`));case"==":case"!=":n.length!==3&&y.push(new Ne(a,n,`filter array for operator "${n[0]}" must have 3 elements`));case"in":case"!in":n.length>=2&&(p=Qt(n[1]),p!=="string"&&y.push(new Ne(`${a}[1]`,n[1],`string expected, ${p} found`)));for(let v=2;v<n.length;v++)p=Qt(n[v]),An(n[1])==="$type"?y=y.concat(Ls({key:`${a}[${v}]`,value:n[v],valueSpec:h.geometry_type,style:i.style,styleSpec:i.styleSpec})):p!=="string"&&p!=="number"&&p!=="boolean"&&y.push(new Ne(`${a}[${v}]`,n[v],`string, number, or boolean expected, ${p} found`));break;case"any":case"all":case"none":for(let v=1;v<n.length;v++)y=y.concat(bd({key:`${a}[${v}]`,value:n[v],style:i.style,styleSpec:i.styleSpec}));break;case"has":case"!has":p=Qt(n[1]),n.length!==2?y.push(new Ne(a,n,`filter array for "${n[0]}" operator must have 2 elements`)):p!=="string"&&y.push(new Ne(`${a}[1]`,n[1],`string expected, ${p} found`));break;case"within":p=Qt(n[1]),n.length!==2?y.push(new Ne(a,n,`filter array for "${n[0]}" operator must have 2 elements`)):p!=="object"&&y.push(new Ne(`${a}[1]`,n[1],`object expected, ${p} found`))}return y}function Sd(i,n){const a=i.key,h=i.validateSpec,p=i.style,y=i.styleSpec,v=i.value,w=i.objectKey,T=y[`${n}_${i.layerType}`];if(!T)return[];const k=w.match(/^(.*)-transition$/);if(n==="paint"&&k&&T[k[1]]&&T[k[1]].transition)return h({key:a,value:v,valueSpec:y.transition,style:p,styleSpec:y});const A=i.valueSpec||T[w];if(!A)return[new Ne(a,v,`unknown property "${w}"`)];let R;if(Qt(v)==="string"&&Za(A)&&!A.tokens&&(R=/^{([^}]+)}$/.exec(v)))return[new Ne(a,v,`"${w}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(R[1])} }\`.`)];const V=[];return i.layerType==="symbol"&&(w==="text-field"&&p&&!p.glyphs&&V.push(new Ne(a,v,'use of "text-field" requires a style "glyphs" property')),w==="text-font"&&Cn(pa(v))&&An(v.type)==="identity"&&V.push(new Ne(a,v,'"text-font" does not support identity functions'))),V.concat(h({key:i.key,value:v,valueSpec:A,style:p,styleSpec:y,expressionContext:"property",propertyType:n,propertyKey:w}))}function Td(i){return Sd(i,"paint")}function Cd(i){return Sd(i,"layout")}function Ed(i){let n=[];const a=i.value,h=i.key,p=i.style,y=i.styleSpec;a.type||a.ref||n.push(new Ne(h,a,'either "type" or "ref" is required'));let v=An(a.type);const w=An(a.ref);if(a.id){const T=An(a.id);for(let k=0;k<i.arrayIndex;k++){const A=p.layers[k];An(A.id)===T&&n.push(new Ne(h,a.id,`duplicate layer id "${a.id}", previously used at line ${A.id.__line__}`))}}if("ref"in a){let T;["type","source","source-layer","filter","layout"].forEach(k=>{k in a&&n.push(new Ne(h,a[k],`"${k}" is prohibited for ref layers`))}),p.layers.forEach(k=>{An(k.id)===w&&(T=k)}),T?T.ref?n.push(new Ne(h,a.ref,"ref cannot reference another ref layer")):v=An(T.type):n.push(new Ne(h,a.ref,`ref layer "${w}" not found`))}else if(v!=="background")if(a.source){const T=p.sources&&p.sources[a.source],k=T&&An(T.type);T?k==="vector"&&v==="raster"?n.push(new Ne(h,a.source,`layer "${a.id}" requires a raster source`)):k!=="raster-dem"&&v==="hillshade"?n.push(new Ne(h,a.source,`layer "${a.id}" requires a raster-dem source`)):k==="raster"&&v!=="raster"?n.push(new Ne(h,a.source,`layer "${a.id}" requires a vector source`)):k!=="vector"||a["source-layer"]?k==="raster-dem"&&v!=="hillshade"?n.push(new Ne(h,a.source,"raster-dem source can only be used with layer type 'hillshade'.")):v!=="line"||!a.paint||!a.paint["line-gradient"]||k==="geojson"&&T.lineMetrics||n.push(new Ne(h,a,`layer "${a.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):n.push(new Ne(h,a,`layer "${a.id}" must specify a "source-layer"`)):n.push(new Ne(h,a.source,`source "${a.source}" not found`))}else n.push(new Ne(h,a,'missing required property "source"'));return n=n.concat(qr({key:h,value:a,valueSpec:y.layer,style:i.style,styleSpec:i.styleSpec,validateSpec:i.validateSpec,objectElementValidators:{"*":()=>[],type:()=>i.validateSpec({key:`${h}.type`,value:a.type,valueSpec:y.layer.type,style:i.style,styleSpec:i.styleSpec,validateSpec:i.validateSpec,object:a,objectKey:"type"}),filter:Ga,layout:T=>qr({layer:a,key:T.key,value:T.value,style:T.style,styleSpec:T.styleSpec,validateSpec:T.validateSpec,objectElementValidators:{"*":k=>Cd(wi({layerType:v},k))}}),paint:T=>qr({layer:a,key:T.key,value:T.value,style:T.style,styleSpec:T.styleSpec,validateSpec:T.validateSpec,objectElementValidators:{"*":k=>Td(wi({layerType:v},k))}})}})),n}function oo(i){const n=i.value,a=i.key,h=Qt(n);return h!=="string"?[new Ne(a,n,`string expected, ${h} found`)]:[]}const Rs={promoteId:function({key:i,value:n}){if(Qt(n)==="string")return oo({key:i,value:n});{const a=[];for(const h in n)a.push(...oo({key:`${i}.${h}`,value:n[h]}));return a}}};function ui(i){const n=i.value,a=i.key,h=i.styleSpec,p=i.style,y=i.validateSpec;if(!n.type)return[new Ne(a,n,'"type" is required')];const v=An(n.type);let w;switch(v){case"vector":case"raster":return w=qr({key:a,value:n,valueSpec:h[`source_${v.replace("-","_")}`],style:i.style,styleSpec:h,objectElementValidators:Rs,validateSpec:y}),w;case"raster-dem":return w=function(T){var k;const A=(k=T.sourceName)!==null&&k!==void 0?k:"",R=T.value,V=T.styleSpec,j=V.source_raster_dem,q=T.style;let X=[];const re=Qt(R);if(R===void 0)return X;if(re!=="object")return X.push(new Ne("source_raster_dem",R,`object expected, ${re} found`)),X;const se=An(R.encoding)==="custom",ye=["redFactor","greenFactor","blueFactor","baseShift"],pe=T.value.encoding?`"${T.value.encoding}"`:"Default";for(const ve in R)!se&&ye.includes(ve)?X.push(new Ne(ve,R[ve],`In "${A}": "${ve}" is only valid when "encoding" is set to "custom". ${pe} encoding found`)):j[ve]?X=X.concat(T.validateSpec({key:ve,value:R[ve],valueSpec:j[ve],validateSpec:T.validateSpec,style:q,styleSpec:V})):X.push(new Ne(ve,R[ve],`unknown property "${ve}"`));return X}({sourceName:a,value:n,style:i.style,styleSpec:h,validateSpec:y}),w;case"geojson":if(w=qr({key:a,value:n,valueSpec:h.source_geojson,style:p,styleSpec:h,validateSpec:y,objectElementValidators:Rs}),n.cluster)for(const T in n.clusterProperties){const[k,A]=n.clusterProperties[T],R=typeof k=="string"?[k,["accumulated"],["get",T]]:k;w.push(...fa({key:`${a}.${T}.map`,value:A,validateSpec:y,expressionContext:"cluster-map"})),w.push(...fa({key:`${a}.${T}.reduce`,value:R,validateSpec:y,expressionContext:"cluster-reduce"}))}return w;case"video":return qr({key:a,value:n,valueSpec:h.source_video,style:p,validateSpec:y,styleSpec:h});case"image":return qr({key:a,value:n,valueSpec:h.source_image,style:p,validateSpec:y,styleSpec:h});case"canvas":return[new Ne(a,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Ls({key:`${a}.type`,value:n.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:p,validateSpec:y,styleSpec:h})}}function Fs(i){const n=i.value,a=i.styleSpec,h=a.light,p=i.style;let y=[];const v=Qt(n);if(n===void 0)return y;if(v!=="object")return y=y.concat([new Ne("light",n,`object expected, ${v} found`)]),y;for(const w in n){const T=w.match(/^(.*)-transition$/);y=y.concat(T&&h[T[1]]&&h[T[1]].transition?i.validateSpec({key:w,value:n[w],valueSpec:a.transition,validateSpec:i.validateSpec,style:p,styleSpec:a}):h[w]?i.validateSpec({key:w,value:n[w],valueSpec:h[w],validateSpec:i.validateSpec,style:p,styleSpec:a}):[new Ne(w,n[w],`unknown property "${w}"`)])}return y}function Id(i){const n=i.value,a=i.styleSpec,h=a.terrain,p=i.style;let y=[];const v=Qt(n);if(n===void 0)return y;if(v!=="object")return y=y.concat([new Ne("terrain",n,`object expected, ${v} found`)]),y;for(const w in n)y=y.concat(h[w]?i.validateSpec({key:w,value:n[w],valueSpec:h[w],validateSpec:i.validateSpec,style:p,styleSpec:a}):[new Ne(w,n[w],`unknown property "${w}"`)]);return y}function kd(i){let n=[];const a=i.value,h=i.key;if(Array.isArray(a)){const p=[],y=[];for(const v in a)a[v].id&&p.includes(a[v].id)&&n.push(new Ne(h,a,`all the sprites' ids must be unique, but ${a[v].id} is duplicated`)),p.push(a[v].id),a[v].url&&y.includes(a[v].url)&&n.push(new Ne(h,a,`all the sprites' URLs must be unique, but ${a[v].url} is duplicated`)),y.push(a[v].url),n=n.concat(qr({key:`${h}[${v}]`,value:a[v],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:i.validateSpec}));return n}return oo({key:h,value:a})}const Md={"*":()=>[],array:qa,boolean:function(i){const n=i.value,a=i.key,h=Qt(n);return h!=="boolean"?[new Ne(a,n,`boolean expected, ${h} found`)]:[]},number:Ds,color:function(i){const n=i.key,a=i.value,h=Qt(a);return h!=="string"?[new Ne(n,a,`color expected, ${h} found`)]:on.parse(String(a))?[]:[new Ne(n,a,`color expected, "${a}" found`)]},constants:wd,enum:Ls,filter:Ga,function:Fl,layer:Ed,object:qr,source:ui,light:Fs,terrain:Id,string:oo,formatted:function(i){return oo(i).length===0?[]:fa(i)},resolvedImage:function(i){return oo(i).length===0?[]:fa(i)},padding:function(i){const n=i.key,a=i.value;if(Qt(a)==="array"){if(a.length<1||a.length>4)return[new Ne(n,a,`padding requires 1 to 4 values; ${a.length} values found`)];const h={type:"number"};let p=[];for(let y=0;y<a.length;y++)p=p.concat(i.validateSpec({key:`${n}[${y}]`,value:a[y],validateSpec:i.validateSpec,valueSpec:h}));return p}return Ds({key:n,value:a,valueSpec:{}})},variableAnchorOffsetCollection:function(i){const n=i.key,a=i.value,h=Qt(a),p=i.styleSpec;if(h!=="array"||a.length<1||a.length%2!=0)return[new Ne(n,a,"variableAnchorOffsetCollection requires a non-empty array of even length")];let y=[];for(let v=0;v<a.length;v+=2)y=y.concat(Ls({key:`${n}[${v}]`,value:a[v],valueSpec:p.layout_symbol["text-anchor"]})),y=y.concat(qa({key:`${n}[${v+1}]`,value:a[v+1],valueSpec:{length:2,value:"number"},validateSpec:i.validateSpec,style:i.style,styleSpec:p}));return y},sprite:kd};function To(i){const n=i.value,a=i.valueSpec,h=i.styleSpec;return i.validateSpec=To,a.expression&&Cn(An(n))?Fl(i):a.expression&&Pl(pa(n))?fa(i):a.type&&Md[a.type]?Md[a.type](i):qr(wi({},i,{valueSpec:a.type?h[a.type]:a}))}function Pd(i){const n=i.value,a=i.key,h=oo(i);return h.length||(n.indexOf("{fontstack}")===-1&&h.push(new Ne(a,n,'"glyphs" url must include a "{fontstack}" token')),n.indexOf("{range}")===-1&&h.push(new Ne(a,n,'"glyphs" url must include a "{range}" token'))),h}function Ii(i,n=Ae){let a=[];return a=a.concat(To({key:"",value:i,valueSpec:n.$root,styleSpec:n,style:i,validateSpec:To,objectElementValidators:{glyphs:Pd,"*":()=>[]}})),i.constants&&(a=a.concat(wd({key:"constants",value:i.constants,style:i,styleSpec:n,validateSpec:To}))),Ol(a)}function Co(i){return function(n){return i({...n,validateSpec:To})}}function Ol(i){return[].concat(i).sort((n,a)=>n.line-a.line)}function Eo(i){return function(...n){return Ol(i.apply(this,n))}}Ii.source=Eo(Co(ui)),Ii.sprite=Eo(Co(kd)),Ii.glyphs=Eo(Co(Pd)),Ii.light=Eo(Co(Fs)),Ii.terrain=Eo(Co(Id)),Ii.layer=Eo(Co(Ed)),Ii.filter=Eo(Co(Ga)),Ii.paintProperty=Eo(Co(Td)),Ii.layoutProperty=Eo(Co(Cd));const Io=Ii,Em=Io.light,hc=Io.paintProperty,Ad=Io.layoutProperty;function Bl(i,n){let a=!1;if(n&&n.length)for(const h of n)i.fire(new ro(new Error(h.message))),a=!0;return a}class Ha{constructor(n,a,h){const p=this.cells=[];if(n instanceof ArrayBuffer){this.arrayBuffer=n;const v=new Int32Array(this.arrayBuffer);n=v[0],this.d=(a=v[1])+2*(h=v[2]);for(let T=0;T<this.d*this.d;T++){const k=v[3+T],A=v[3+T+1];p.push(k===A?null:v.subarray(k,A))}const w=v[3+p.length+1];this.keys=v.subarray(v[3+p.length],w),this.bboxes=v.subarray(w),this.insert=this._insertReadonly}else{this.d=a+2*h;for(let v=0;v<this.d*this.d;v++)p.push([]);this.keys=[],this.bboxes=[]}this.n=a,this.extent=n,this.padding=h,this.scale=a/n,this.uid=0;const y=h/a*n;this.min=-y,this.max=n+y}insert(n,a,h,p,y){this._forEachCell(a,h,p,y,this._insertCell,this.uid++,void 0,void 0),this.keys.push(n),this.bboxes.push(a),this.bboxes.push(h),this.bboxes.push(p),this.bboxes.push(y)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(n,a,h,p,y,v){this.cells[y].push(v)}query(n,a,h,p,y){const v=this.min,w=this.max;if(n<=v&&a<=v&&w<=h&&w<=p&&!y)return Array.prototype.slice.call(this.keys);{const T=[];return this._forEachCell(n,a,h,p,this._queryCell,T,{},y),T}}_queryCell(n,a,h,p,y,v,w,T){const k=this.cells[y];if(k!==null){const A=this.keys,R=this.bboxes;for(let V=0;V<k.length;V++){const j=k[V];if(w[j]===void 0){const q=4*j;(T?T(R[q+0],R[q+1],R[q+2],R[q+3]):n<=R[q+2]&&a<=R[q+3]&&h>=R[q+0]&&p>=R[q+1])?(w[j]=!0,v.push(A[j])):w[j]=!1}}}}_forEachCell(n,a,h,p,y,v,w,T){const k=this._convertToCellCoord(n),A=this._convertToCellCoord(a),R=this._convertToCellCoord(h),V=this._convertToCellCoord(p);for(let j=k;j<=R;j++)for(let q=A;q<=V;q++){const X=this.d*q+j;if((!T||T(this._convertFromCellCoord(j),this._convertFromCellCoord(q),this._convertFromCellCoord(j+1),this._convertFromCellCoord(q+1)))&&y.call(this,n,a,h,p,X,v,w,T))return}}_convertFromCellCoord(n){return(n-this.padding)/this.scale}_convertToCellCoord(n){return Math.max(0,Math.min(this.d-1,Math.floor(n*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const n=this.cells,a=3+this.cells.length+1+1;let h=0;for(let v=0;v<this.cells.length;v++)h+=this.cells[v].length;const p=new Int32Array(a+h+this.keys.length+this.bboxes.length);p[0]=this.extent,p[1]=this.n,p[2]=this.padding;let y=a;for(let v=0;v<n.length;v++){const w=n[v];p[3+v]=y,p.set(w,y),y+=w.length}return p[3+n.length]=y,p.set(this.keys,y),y+=this.keys.length,p[3+n.length+1]=y,p.set(this.bboxes,y),y+=this.bboxes.length,p.buffer}static serialize(n,a){const h=n.toArrayBuffer();return a&&a.push(h),{buffer:h}}static deserialize(n){return new Ha(n.buffer)}}const ko={};function Je(i,n,a={}){if(ko[i])throw new Error(`${i} is already registered.`);Object.defineProperty(n,"_classRegistryKey",{value:i,writeable:!1}),ko[i]={klass:n,omit:a.omit||[],shallow:a.shallow||[]}}Je("Object",Object),Je("TransferableGridIndex",Ha),Je("Color",on),Je("Error",Error),Je("AJAXError",Mn),Je("ResolvedImage",mr),Je("StylePropertyFunction",Ms),Je("StyleExpression",ac,{omit:["_evaluator"]}),Je("ZoomDependentExpression",zl),Je("ZoomConstantExpression",sc),Je("CompoundExpression",Ei,{omit:["_evaluate"]});for(const i in ja)ja[i]._classRegistryKey||Je(`Expression_${i}`,ja[i]);function Vl(i){return i&&typeof ArrayBuffer<"u"&&(i instanceof ArrayBuffer||i.constructor&&i.constructor.name==="ArrayBuffer")}function Xo(i,n){if(i==null||typeof i=="boolean"||typeof i=="number"||typeof i=="string"||i instanceof Boolean||i instanceof Number||i instanceof String||i instanceof Date||i instanceof RegExp||i instanceof Blob)return i;if(Vl(i)||lt(i))return n&&n.push(i),i;if(ArrayBuffer.isView(i)){const a=i;return n&&n.push(a.buffer),a}if(i instanceof ImageData)return n&&n.push(i.data.buffer),i;if(Array.isArray(i)){const a=[];for(const h of i)a.push(Xo(h,n));return a}if(typeof i=="object"){const a=i.constructor,h=a._classRegistryKey;if(!h)throw new Error("can't serialize object of unregistered class");if(!ko[h])throw new Error(`${h} is not registered.`);const p=a.serialize?a.serialize(i,n):{};if(a.serialize){if(n&&p===n[n.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const y in i){if(!i.hasOwnProperty(y)||ko[h].omit.indexOf(y)>=0)continue;const v=i[y];p[y]=ko[h].shallow.indexOf(y)>=0?v:Xo(v,n)}i instanceof Error&&(p.message=i.message)}if(p.$name)throw new Error("$name property is reserved for worker serialization logic.");return h!=="Object"&&(p.$name=h),p}throw new Error("can't serialize object of type "+typeof i)}function Wa(i){if(i==null||typeof i=="boolean"||typeof i=="number"||typeof i=="string"||i instanceof Boolean||i instanceof Number||i instanceof String||i instanceof Date||i instanceof RegExp||i instanceof Blob||Vl(i)||lt(i)||ArrayBuffer.isView(i)||i instanceof ImageData)return i;if(Array.isArray(i))return i.map(Wa);if(typeof i=="object"){const n=i.$name||"Object";if(!ko[n])throw new Error(`can't deserialize unregistered class ${n}`);const{klass:a}=ko[n];if(!a)throw new Error(`can't deserialize unregistered class ${n}`);if(a.deserialize)return a.deserialize(i);const h=Object.create(a.prototype);for(const p of Object.keys(i)){if(p==="$name")continue;const y=i[p];h[p]=ko[n].shallow.indexOf(p)>=0?y:Wa(y)}return h}throw new Error("can't deserialize object of type "+typeof i)}class zd{constructor(){this.first=!0}update(n,a){const h=Math.floor(n);return this.first?(this.first=!1,this.lastIntegerZoom=h,this.lastIntegerZoomTime=0,this.lastZoom=n,this.lastFloorZoom=h,!0):(this.lastFloorZoom>h?(this.lastIntegerZoom=h+1,this.lastIntegerZoomTime=a):this.lastFloorZoom<h&&(this.lastIntegerZoom=h,this.lastIntegerZoomTime=a),n!==this.lastZoom&&(this.lastZoom=n,this.lastFloorZoom=h,!0))}}const Ke={"Latin-1 Supplement":i=>i>=128&&i<=255,Arabic:i=>i>=1536&&i<=1791,"Arabic Supplement":i=>i>=1872&&i<=1919,"Arabic Extended-A":i=>i>=2208&&i<=2303,"Hangul Jamo":i=>i>=4352&&i<=4607,"Unified Canadian Aboriginal Syllabics":i=>i>=5120&&i<=5759,Khmer:i=>i>=6016&&i<=6143,"Unified Canadian Aboriginal Syllabics Extended":i=>i>=6320&&i<=6399,"General Punctuation":i=>i>=8192&&i<=8303,"Letterlike Symbols":i=>i>=8448&&i<=8527,"Number Forms":i=>i>=8528&&i<=8591,"Miscellaneous Technical":i=>i>=8960&&i<=9215,"Control Pictures":i=>i>=9216&&i<=9279,"Optical Character Recognition":i=>i>=9280&&i<=9311,"Enclosed Alphanumerics":i=>i>=9312&&i<=9471,"Geometric Shapes":i=>i>=9632&&i<=9727,"Miscellaneous Symbols":i=>i>=9728&&i<=9983,"Miscellaneous Symbols and Arrows":i=>i>=11008&&i<=11263,"CJK Radicals Supplement":i=>i>=11904&&i<=12031,"Kangxi Radicals":i=>i>=12032&&i<=12255,"Ideographic Description Characters":i=>i>=12272&&i<=12287,"CJK Symbols and Punctuation":i=>i>=12288&&i<=12351,Hiragana:i=>i>=12352&&i<=12447,Katakana:i=>i>=12448&&i<=12543,Bopomofo:i=>i>=12544&&i<=12591,"Hangul Compatibility Jamo":i=>i>=12592&&i<=12687,Kanbun:i=>i>=12688&&i<=12703,"Bopomofo Extended":i=>i>=12704&&i<=12735,"CJK Strokes":i=>i>=12736&&i<=12783,"Katakana Phonetic Extensions":i=>i>=12784&&i<=12799,"Enclosed CJK Letters and Months":i=>i>=12800&&i<=13055,"CJK Compatibility":i=>i>=13056&&i<=13311,"CJK Unified Ideographs Extension A":i=>i>=13312&&i<=19903,"Yijing Hexagram Symbols":i=>i>=19904&&i<=19967,"CJK Unified Ideographs":i=>i>=19968&&i<=40959,"Yi Syllables":i=>i>=40960&&i<=42127,"Yi Radicals":i=>i>=42128&&i<=42191,"Hangul Jamo Extended-A":i=>i>=43360&&i<=43391,"Hangul Syllables":i=>i>=44032&&i<=55215,"Hangul Jamo Extended-B":i=>i>=55216&&i<=55295,"Private Use Area":i=>i>=57344&&i<=63743,"CJK Compatibility Ideographs":i=>i>=63744&&i<=64255,"Arabic Presentation Forms-A":i=>i>=64336&&i<=65023,"Vertical Forms":i=>i>=65040&&i<=65055,"CJK Compatibility Forms":i=>i>=65072&&i<=65103,"Small Form Variants":i=>i>=65104&&i<=65135,"Arabic Presentation Forms-B":i=>i>=65136&&i<=65279,"Halfwidth and Fullwidth Forms":i=>i>=65280&&i<=65519};function dc(i){for(const n of i)if(fc(n.charCodeAt(0)))return!0;return!1}function pc(i){for(const n of i)if(!Im(n.charCodeAt(0)))return!1;return!0}function Im(i){return!(Ke.Arabic(i)||Ke["Arabic Supplement"](i)||Ke["Arabic Extended-A"](i)||Ke["Arabic Presentation Forms-A"](i)||Ke["Arabic Presentation Forms-B"](i))}function fc(i){return!(i!==746&&i!==747&&(i<4352||!(Ke["Bopomofo Extended"](i)||Ke.Bopomofo(i)||Ke["CJK Compatibility Forms"](i)&&!(i>=65097&&i<=65103)||Ke["CJK Compatibility Ideographs"](i)||Ke["CJK Compatibility"](i)||Ke["CJK Radicals Supplement"](i)||Ke["CJK Strokes"](i)||!(!Ke["CJK Symbols and Punctuation"](i)||i>=12296&&i<=12305||i>=12308&&i<=12319||i===12336)||Ke["CJK Unified Ideographs Extension A"](i)||Ke["CJK Unified Ideographs"](i)||Ke["Enclosed CJK Letters and Months"](i)||Ke["Hangul Compatibility Jamo"](i)||Ke["Hangul Jamo Extended-A"](i)||Ke["Hangul Jamo Extended-B"](i)||Ke["Hangul Jamo"](i)||Ke["Hangul Syllables"](i)||Ke.Hiragana(i)||Ke["Ideographic Description Characters"](i)||Ke.Kanbun(i)||Ke["Kangxi Radicals"](i)||Ke["Katakana Phonetic Extensions"](i)||Ke.Katakana(i)&&i!==12540||!(!Ke["Halfwidth and Fullwidth Forms"](i)||i===65288||i===65289||i===65293||i>=65306&&i<=65310||i===65339||i===65341||i===65343||i>=65371&&i<=65503||i===65507||i>=65512&&i<=65519)||!(!Ke["Small Form Variants"](i)||i>=65112&&i<=65118||i>=65123&&i<=65126)||Ke["Unified Canadian Aboriginal Syllabics"](i)||Ke["Unified Canadian Aboriginal Syllabics Extended"](i)||Ke["Vertical Forms"](i)||Ke["Yijing Hexagram Symbols"](i)||Ke["Yi Syllables"](i)||Ke["Yi Radicals"](i))))}function Dd(i){return!(fc(i)||function(n){return!!(Ke["Latin-1 Supplement"](n)&&(n===167||n===169||n===174||n===177||n===188||n===189||n===190||n===215||n===247)||Ke["General Punctuation"](n)&&(n===8214||n===8224||n===8225||n===8240||n===8241||n===8251||n===8252||n===8258||n===8263||n===8264||n===8265||n===8273)||Ke["Letterlike Symbols"](n)||Ke["Number Forms"](n)||Ke["Miscellaneous Technical"](n)&&(n>=8960&&n<=8967||n>=8972&&n<=8991||n>=8996&&n<=9e3||n===9003||n>=9085&&n<=9114||n>=9150&&n<=9165||n===9167||n>=9169&&n<=9179||n>=9186&&n<=9215)||Ke["Control Pictures"](n)&&n!==9251||Ke["Optical Character Recognition"](n)||Ke["Enclosed Alphanumerics"](n)||Ke["Geometric Shapes"](n)||Ke["Miscellaneous Symbols"](n)&&!(n>=9754&&n<=9759)||Ke["Miscellaneous Symbols and Arrows"](n)&&(n>=11026&&n<=11055||n>=11088&&n<=11097||n>=11192&&n<=11243)||Ke["CJK Symbols and Punctuation"](n)||Ke.Katakana(n)||Ke["Private Use Area"](n)||Ke["CJK Compatibility Forms"](n)||Ke["Small Form Variants"](n)||Ke["Halfwidth and Fullwidth Forms"](n)||n===8734||n===8756||n===8757||n>=9984&&n<=10087||n>=10102&&n<=10131||n===65532||n===65533)}(i))}function Ld(i){return i>=1424&&i<=2303||Ke["Arabic Presentation Forms-A"](i)||Ke["Arabic Presentation Forms-B"](i)}function Rd(i,n){return!(!n&&Ld(i)||i>=2304&&i<=3583||i>=3840&&i<=4255||Ke.Khmer(i))}function km(i){for(const n of i)if(Ld(n.charCodeAt(0)))return!0;return!1}const mc="deferred",gc="loading",yc="loaded";let _c=null,Gr="unavailable",Yo=null;const Os=function(i){i&&typeof i=="string"&&i.indexOf("NetworkError")>-1&&(Gr="error"),_c&&_c(i)};function vc(){Bs.fire(new no("pluginStateChange",{pluginStatus:Gr,pluginURL:Yo}))}const Bs=new bo,xc=function(){return Gr},Fd=function(){if(Gr!==mc||!Yo)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Gr=gc,vc(),Yo&&to({url:Yo},i=>{i?Os(i):(Gr=yc,vc())})},ci={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>Gr===yc||ci.applyArabicShaping!=null,isLoading:()=>Gr===gc,setState(i){if(!xt())throw new Error("Cannot set the state of the rtl-text-plugin when not in the web-worker context");Gr=i.pluginStatus,Yo=i.pluginURL},isParsed(){if(!xt())throw new Error("rtl-text-plugin is only parsed on the worker-threads");return ci.applyArabicShaping!=null&&ci.processBidirectionalText!=null&&ci.processStyledBidirectionalText!=null},getPluginURL(){if(!xt())throw new Error("rtl-text-plugin url can only be queried from the worker threads");return Yo}};class yn{constructor(n,a){this.zoom=n,a?(this.now=a.now,this.fadeDuration=a.fadeDuration,this.zoomHistory=a.zoomHistory,this.transition=a.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new zd,this.transition={})}isSupportedScript(n){return function(a,h){for(const p of a)if(!Rd(p.charCodeAt(0),h))return!1;return!0}(n,ci.isLoaded())}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const n=this.zoom,a=n-Math.floor(n),h=this.crossFadingFactor();return n>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:a+(1-a)*h}:{fromScale:.5,toScale:1,t:1-(1-h)*a}}}class Nl{constructor(n,a){this.property=n,this.value=a,this.expression=function(h,p){if(Cn(h))return new Ms(h,p);if(Pl(h)){const y=lc(h,p);if(y.result==="error")throw new Error(y.value.map(v=>`${v.key}: ${v.message}`).join(", "));return y.value}{let y=h;return p.type==="color"&&typeof h=="string"?y=on.parse(h):p.type!=="padding"||typeof h!="number"&&!Array.isArray(h)?p.type==="variableAnchorOffsetCollection"&&Array.isArray(h)&&(y=Ti.parse(h)):y=ai.parse(h),{kind:"constant",evaluate:()=>y}}}(a===void 0?n.specification.default:a,n.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(n,a,h){return this.property.possiblyEvaluate(this,n,a,h)}}class wc{constructor(n){this.property=n,this.value=new Nl(n,void 0)}transitioned(n,a){return new Bd(this.property,this.value,a,Me({},n.transition,this.transition),n.now)}untransitioned(){return new Bd(this.property,this.value,null,{},0)}}class Od{constructor(n){this._properties=n,this._values=Object.create(n.defaultTransitionablePropertyValues)}getValue(n){return bt(this._values[n].value.value)}setValue(n,a){Object.prototype.hasOwnProperty.call(this._values,n)||(this._values[n]=new wc(this._values[n].property)),this._values[n].value=new Nl(this._values[n].property,a===null?void 0:bt(a))}getTransition(n){return bt(this._values[n].transition)}setTransition(n,a){Object.prototype.hasOwnProperty.call(this._values,n)||(this._values[n]=new wc(this._values[n].property)),this._values[n].transition=bt(a)||void 0}serialize(){const n={};for(const a of Object.keys(this._values)){const h=this.getValue(a);h!==void 0&&(n[a]=h);const p=this.getTransition(a);p!==void 0&&(n[`${a}-transition`]=p)}return n}transitioned(n,a){const h=new Vd(this._properties);for(const p of Object.keys(this._values))h._values[p]=this._values[p].transitioned(n,a._values[p]);return h}untransitioned(){const n=new Vd(this._properties);for(const a of Object.keys(this._values))n._values[a]=this._values[a].untransitioned();return n}}class Bd{constructor(n,a,h,p,y){this.property=n,this.value=a,this.begin=y+p.delay||0,this.end=this.begin+p.duration||0,n.specification.transition&&(p.delay||p.duration)&&(this.prior=h)}possiblyEvaluate(n,a,h){const p=n.now||0,y=this.value.possiblyEvaluate(n,a,h),v=this.prior;if(v){if(p>this.end)return this.prior=null,y;if(this.value.isDataDriven())return this.prior=null,y;if(p<this.begin)return v.possiblyEvaluate(n,a,h);{const w=(p-this.begin)/(this.end-this.begin);return this.property.interpolate(v.possiblyEvaluate(n,a,h),y,function(T){if(T<=0)return 0;if(T>=1)return 1;const k=T*T,A=k*T;return 4*(T<.5?A:3*(T-k)+A-.75)}(w))}}return y}}class Vd{constructor(n){this._properties=n,this._values=Object.create(n.defaultTransitioningPropertyValues)}possiblyEvaluate(n,a,h){const p=new Ul(this._properties);for(const y of Object.keys(this._values))p._values[y]=this._values[y].possiblyEvaluate(n,a,h);return p}hasTransition(){for(const n of Object.keys(this._values))if(this._values[n].prior)return!0;return!1}}class Mm{constructor(n){this._properties=n,this._values=Object.create(n.defaultPropertyValues)}hasValue(n){return this._values[n].value!==void 0}getValue(n){return bt(this._values[n].value)}setValue(n,a){this._values[n]=new Nl(this._values[n].property,a===null?void 0:bt(a))}serialize(){const n={};for(const a of Object.keys(this._values)){const h=this.getValue(a);h!==void 0&&(n[a]=h)}return n}possiblyEvaluate(n,a,h){const p=new Ul(this._properties);for(const y of Object.keys(this._values))p._values[y]=this._values[y].possiblyEvaluate(n,a,h);return p}}class Dr{constructor(n,a,h){this.property=n,this.value=a,this.parameters=h}isConstant(){return this.value.kind==="constant"}constantOr(n){return this.value.kind==="constant"?this.value.value:n}evaluate(n,a,h,p){return this.property.evaluate(this.value,this.parameters,n,a,h,p)}}class Ul{constructor(n){this._properties=n,this._values=Object.create(n.defaultPossiblyEvaluatedValues)}get(n){return this._values[n]}}class st{constructor(n){this.specification=n}possiblyEvaluate(n,a){if(n.isDataDriven())throw new Error("Value should not be data driven");return n.expression.evaluate(a)}interpolate(n,a,h){const p=si[this.specification.type];return p?p(n,a,h):n}}class mt{constructor(n,a){this.specification=n,this.overrides=a}possiblyEvaluate(n,a,h,p){return new Dr(this,n.expression.kind==="constant"||n.expression.kind==="camera"?{kind:"constant",value:n.expression.evaluate(a,null,{},h,p)}:n.expression,a)}interpolate(n,a,h){if(n.value.kind!=="constant"||a.value.kind!=="constant")return n;if(n.value.value===void 0||a.value.value===void 0)return new Dr(this,{kind:"constant",value:void 0},n.parameters);const p=si[this.specification.type];if(p){const y=p(n.value.value,a.value.value,h);return new Dr(this,{kind:"constant",value:y},n.parameters)}return n}evaluate(n,a,h,p,y,v){return n.kind==="constant"?n.value:n.evaluate(a,h,p,y,v)}}class Vs extends mt{possiblyEvaluate(n,a,h,p){if(n.value===void 0)return new Dr(this,{kind:"constant",value:void 0},a);if(n.expression.kind==="constant"){const y=n.expression.evaluate(a,null,{},h,p),v=n.property.specification.type==="resolvedImage"&&typeof y!="string"?y.name:y,w=this._calculate(v,v,v,a);return new Dr(this,{kind:"constant",value:w},a)}if(n.expression.kind==="camera"){const y=this._calculate(n.expression.evaluate({zoom:a.zoom-1}),n.expression.evaluate({zoom:a.zoom}),n.expression.evaluate({zoom:a.zoom+1}),a);return new Dr(this,{kind:"constant",value:y},a)}return new Dr(this,n.expression,a)}evaluate(n,a,h,p,y,v){if(n.kind==="source"){const w=n.evaluate(a,h,p,y,v);return this._calculate(w,w,w,a)}return n.kind==="composite"?this._calculate(n.evaluate({zoom:Math.floor(a.zoom)-1},h,p),n.evaluate({zoom:Math.floor(a.zoom)},h,p),n.evaluate({zoom:Math.floor(a.zoom)+1},h,p),a):n.value}_calculate(n,a,h,p){return p.zoom>p.zoomHistory.lastIntegerZoom?{from:n,to:a}:{from:h,to:a}}interpolate(n){return n}}class bc{constructor(n){this.specification=n}possiblyEvaluate(n,a,h,p){if(n.value!==void 0){if(n.expression.kind==="constant"){const y=n.expression.evaluate(a,null,{},h,p);return this._calculate(y,y,y,a)}return this._calculate(n.expression.evaluate(new yn(Math.floor(a.zoom-1),a)),n.expression.evaluate(new yn(Math.floor(a.zoom),a)),n.expression.evaluate(new yn(Math.floor(a.zoom+1),a)),a)}}_calculate(n,a,h,p){return p.zoom>p.zoomHistory.lastIntegerZoom?{from:n,to:a}:{from:h,to:a}}interpolate(n){return n}}class Sc{constructor(n){this.specification=n}possiblyEvaluate(n,a,h,p){return!!n.expression.evaluate(a,null,{},h,p)}interpolate(){return!1}}class Vn{constructor(n){this.properties=n,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const a in n){const h=n[a];h.specification.overridable&&this.overridableProperties.push(a);const p=this.defaultPropertyValues[a]=new Nl(h,void 0),y=this.defaultTransitionablePropertyValues[a]=new wc(h);this.defaultTransitioningPropertyValues[a]=y.untransitioned(),this.defaultPossiblyEvaluatedValues[a]=p.possiblyEvaluate({})}}}Je("DataDrivenProperty",mt),Je("DataConstantProperty",st),Je("CrossFadedDataDrivenProperty",Vs),Je("CrossFadedProperty",bc),Je("ColorRampProperty",Sc);const Tc="-transition";class ki extends bo{constructor(n,a){if(super(),this.id=n.id,this.type=n.type,this._featureFilter={filter:()=>!0,needGeometry:!1},n.type!=="custom"&&(this.metadata=n.metadata,this.minzoom=n.minzoom,this.maxzoom=n.maxzoom,n.type!=="background"&&(this.source=n.source,this.sourceLayer=n["source-layer"],this.filter=n.filter),a.layout&&(this._unevaluatedLayout=new Mm(a.layout)),a.paint)){this._transitionablePaint=new Od(a.paint);for(const h in n.paint)this.setPaintProperty(h,n.paint[h],{validate:!1});for(const h in n.layout)this.setLayoutProperty(h,n.layout[h],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Ul(a.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(n){return n==="visibility"?this.visibility:this._unevaluatedLayout.getValue(n)}setLayoutProperty(n,a,h={}){a!=null&&this._validate(Ad,`layers.${this.id}.layout.${n}`,n,a,h)||(n!=="visibility"?this._unevaluatedLayout.setValue(n,a):this.visibility=a)}getPaintProperty(n){return n.endsWith(Tc)?this._transitionablePaint.getTransition(n.slice(0,-11)):this._transitionablePaint.getValue(n)}setPaintProperty(n,a,h={}){if(a!=null&&this._validate(hc,`layers.${this.id}.paint.${n}`,n,a,h))return!1;if(n.endsWith(Tc))return this._transitionablePaint.setTransition(n.slice(0,-11),a||void 0),!1;{const p=this._transitionablePaint._values[n],y=p.property.specification["property-type"]==="cross-faded-data-driven",v=p.value.isDataDriven(),w=p.value;this._transitionablePaint.setValue(n,a),this._handleSpecialPaintPropertyUpdate(n);const T=this._transitionablePaint._values[n].value;return T.isDataDriven()||v||y||this._handleOverridablePaintPropertyUpdate(n,w,T)}}_handleSpecialPaintPropertyUpdate(n){}_handleOverridablePaintPropertyUpdate(n,a,h){return!1}isHidden(n){return!!(this.minzoom&&n<this.minzoom)||!!(this.maxzoom&&n>=this.maxzoom)||this.visibility==="none"}updateTransitions(n){this._transitioningPaint=this._transitionablePaint.transitioned(n,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(n,a){n.getCrossfadeParameters&&(this._crossfadeParameters=n.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(n,void 0,a)),this.paint=this._transitioningPaint.possiblyEvaluate(n,void 0,a)}serialize(){const n={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(n.layout=n.layout||{},n.layout.visibility=this.visibility),ft(n,(a,h)=>!(a===void 0||h==="layout"&&!Object.keys(a).length||h==="paint"&&!Object.keys(a).length))}_validate(n,a,h,p,y={}){return(!y||y.validate!==!1)&&Bl(this,n.call(Io,{key:a,layerType:this.type,objectKey:h,value:p,styleSpec:Ae,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const n in this.paint._values){const a=this.paint.get(n);if(a instanceof Dr&&Za(a.property.specification)&&(a.value.kind==="source"||a.value.kind==="composite")&&a.value.isStateDependent)return!0}return!1}}const Nd={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class ma{constructor(n,a){this._structArray=n,this._pos1=a*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class zn{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(n,a){return n._trim(),a&&(n.isTransferred=!0,a.push(n.arrayBuffer)),{length:n.length,arrayBuffer:n.arrayBuffer}}static deserialize(n){const a=Object.create(this.prototype);return a.arrayBuffer=n.arrayBuffer,a.length=n.length,a.capacity=n.arrayBuffer.byteLength/a.bytesPerElement,a._refreshViews(),a}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(n){this.reserve(n),this.length=n}reserve(n){if(n>this.capacity){this.capacity=Math.max(n,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const a=this.uint8;this._refreshViews(),a&&this.uint8.set(a)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function In(i,n=1){let a=0,h=0;return{members:i.map(p=>{const y=Nd[p.type].BYTES_PER_ELEMENT,v=a=Ka(a,Math.max(n,y)),w=p.components||1;return h=Math.max(h,y),a+=y*w,{name:p.name,type:p.type,components:w,offset:v}}),size:Ka(a,Math.max(h,n)),alignment:n}}function Ka(i,n){return Math.ceil(i/n)*n}class Ns extends zn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,a){const h=this.length;return this.resize(h+1),this.emplace(h,n,a)}emplace(n,a,h){const p=2*n;return this.int16[p+0]=a,this.int16[p+1]=h,n}}Ns.prototype.bytesPerElement=4,Je("StructArrayLayout2i4",Ns);class Us extends zn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,a,h){const p=this.length;return this.resize(p+1),this.emplace(p,n,a,h)}emplace(n,a,h,p){const y=3*n;return this.int16[y+0]=a,this.int16[y+1]=h,this.int16[y+2]=p,n}}Us.prototype.bytesPerElement=6,Je("StructArrayLayout3i6",Us);class ga extends zn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,a,h,p){const y=this.length;return this.resize(y+1),this.emplace(y,n,a,h,p)}emplace(n,a,h,p,y){const v=4*n;return this.int16[v+0]=a,this.int16[v+1]=h,this.int16[v+2]=p,this.int16[v+3]=y,n}}ga.prototype.bytesPerElement=8,Je("StructArrayLayout4i8",ga);class Cc extends zn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,a,h,p,y,v){const w=this.length;return this.resize(w+1),this.emplace(w,n,a,h,p,y,v)}emplace(n,a,h,p,y,v,w){const T=6*n;return this.int16[T+0]=a,this.int16[T+1]=h,this.int16[T+2]=p,this.int16[T+3]=y,this.int16[T+4]=v,this.int16[T+5]=w,n}}Cc.prototype.bytesPerElement=12,Je("StructArrayLayout2i4i12",Cc);class Ec extends zn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,a,h,p,y,v){const w=this.length;return this.resize(w+1),this.emplace(w,n,a,h,p,y,v)}emplace(n,a,h,p,y,v,w){const T=4*n,k=8*n;return this.int16[T+0]=a,this.int16[T+1]=h,this.uint8[k+4]=p,this.uint8[k+5]=y,this.uint8[k+6]=v,this.uint8[k+7]=w,n}}Ec.prototype.bytesPerElement=8,Je("StructArrayLayout2i4ub8",Ec);class Xa extends zn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,a){const h=this.length;return this.resize(h+1),this.emplace(h,n,a)}emplace(n,a,h){const p=2*n;return this.float32[p+0]=a,this.float32[p+1]=h,n}}Xa.prototype.bytesPerElement=8,Je("StructArrayLayout2f8",Xa);class Ic extends zn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,a,h,p,y,v,w,T,k,A){const R=this.length;return this.resize(R+1),this.emplace(R,n,a,h,p,y,v,w,T,k,A)}emplace(n,a,h,p,y,v,w,T,k,A,R){const V=10*n;return this.uint16[V+0]=a,this.uint16[V+1]=h,this.uint16[V+2]=p,this.uint16[V+3]=y,this.uint16[V+4]=v,this.uint16[V+5]=w,this.uint16[V+6]=T,this.uint16[V+7]=k,this.uint16[V+8]=A,this.uint16[V+9]=R,n}}Ic.prototype.bytesPerElement=20,Je("StructArrayLayout10ui20",Ic);class kc extends zn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,a,h,p,y,v,w,T,k,A,R,V){const j=this.length;return this.resize(j+1),this.emplace(j,n,a,h,p,y,v,w,T,k,A,R,V)}emplace(n,a,h,p,y,v,w,T,k,A,R,V,j){const q=12*n;return this.int16[q+0]=a,this.int16[q+1]=h,this.int16[q+2]=p,this.int16[q+3]=y,this.uint16[q+4]=v,this.uint16[q+5]=w,this.uint16[q+6]=T,this.uint16[q+7]=k,this.int16[q+8]=A,this.int16[q+9]=R,this.int16[q+10]=V,this.int16[q+11]=j,n}}kc.prototype.bytesPerElement=24,Je("StructArrayLayout4i4ui4i24",kc);class en extends zn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,a,h){const p=this.length;return this.resize(p+1),this.emplace(p,n,a,h)}emplace(n,a,h,p){const y=3*n;return this.float32[y+0]=a,this.float32[y+1]=h,this.float32[y+2]=p,n}}en.prototype.bytesPerElement=12,Je("StructArrayLayout3f12",en);class g extends zn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(n){const a=this.length;return this.resize(a+1),this.emplace(a,n)}emplace(n,a){return this.uint32[1*n+0]=a,n}}g.prototype.bytesPerElement=4,Je("StructArrayLayout1ul4",g);class r extends zn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,a,h,p,y,v,w,T,k){const A=this.length;return this.resize(A+1),this.emplace(A,n,a,h,p,y,v,w,T,k)}emplace(n,a,h,p,y,v,w,T,k,A){const R=10*n,V=5*n;return this.int16[R+0]=a,this.int16[R+1]=h,this.int16[R+2]=p,this.int16[R+3]=y,this.int16[R+4]=v,this.int16[R+5]=w,this.uint32[V+3]=T,this.uint16[R+8]=k,this.uint16[R+9]=A,n}}r.prototype.bytesPerElement=20,Je("StructArrayLayout6i1ul2ui20",r);class s extends zn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,a,h,p,y,v){const w=this.length;return this.resize(w+1),this.emplace(w,n,a,h,p,y,v)}emplace(n,a,h,p,y,v,w){const T=6*n;return this.int16[T+0]=a,this.int16[T+1]=h,this.int16[T+2]=p,this.int16[T+3]=y,this.int16[T+4]=v,this.int16[T+5]=w,n}}s.prototype.bytesPerElement=12,Je("StructArrayLayout2i2i2i12",s);class d extends zn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,a,h,p,y){const v=this.length;return this.resize(v+1),this.emplace(v,n,a,h,p,y)}emplace(n,a,h,p,y,v){const w=4*n,T=8*n;return this.float32[w+0]=a,this.float32[w+1]=h,this.float32[w+2]=p,this.int16[T+6]=y,this.int16[T+7]=v,n}}d.prototype.bytesPerElement=16,Je("StructArrayLayout2f1f2i16",d);class f extends zn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,a,h,p){const y=this.length;return this.resize(y+1),this.emplace(y,n,a,h,p)}emplace(n,a,h,p,y){const v=12*n,w=3*n;return this.uint8[v+0]=a,this.uint8[v+1]=h,this.float32[w+1]=p,this.float32[w+2]=y,n}}f.prototype.bytesPerElement=12,Je("StructArrayLayout2ub2f12",f);class _ extends zn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,a,h){const p=this.length;return this.resize(p+1),this.emplace(p,n,a,h)}emplace(n,a,h,p){const y=3*n;return this.uint16[y+0]=a,this.uint16[y+1]=h,this.uint16[y+2]=p,n}}_.prototype.bytesPerElement=6,Je("StructArrayLayout3ui6",_);class b extends zn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,a,h,p,y,v,w,T,k,A,R,V,j,q,X,re,se){const ye=this.length;return this.resize(ye+1),this.emplace(ye,n,a,h,p,y,v,w,T,k,A,R,V,j,q,X,re,se)}emplace(n,a,h,p,y,v,w,T,k,A,R,V,j,q,X,re,se,ye){const pe=24*n,ve=12*n,Te=48*n;return this.int16[pe+0]=a,this.int16[pe+1]=h,this.uint16[pe+2]=p,this.uint16[pe+3]=y,this.uint32[ve+2]=v,this.uint32[ve+3]=w,this.uint32[ve+4]=T,this.uint16[pe+10]=k,this.uint16[pe+11]=A,this.uint16[pe+12]=R,this.float32[ve+7]=V,this.float32[ve+8]=j,this.uint8[Te+36]=q,this.uint8[Te+37]=X,this.uint8[Te+38]=re,this.uint32[ve+10]=se,this.int16[pe+22]=ye,n}}b.prototype.bytesPerElement=48,Je("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",b);class S extends zn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,a,h,p,y,v,w,T,k,A,R,V,j,q,X,re,se,ye,pe,ve,Te,De,Xe,it,We,He,$e,tt){const qe=this.length;return this.resize(qe+1),this.emplace(qe,n,a,h,p,y,v,w,T,k,A,R,V,j,q,X,re,se,ye,pe,ve,Te,De,Xe,it,We,He,$e,tt)}emplace(n,a,h,p,y,v,w,T,k,A,R,V,j,q,X,re,se,ye,pe,ve,Te,De,Xe,it,We,He,$e,tt,qe){const Fe=32*n,pt=16*n;return this.int16[Fe+0]=a,this.int16[Fe+1]=h,this.int16[Fe+2]=p,this.int16[Fe+3]=y,this.int16[Fe+4]=v,this.int16[Fe+5]=w,this.int16[Fe+6]=T,this.int16[Fe+7]=k,this.uint16[Fe+8]=A,this.uint16[Fe+9]=R,this.uint16[Fe+10]=V,this.uint16[Fe+11]=j,this.uint16[Fe+12]=q,this.uint16[Fe+13]=X,this.uint16[Fe+14]=re,this.uint16[Fe+15]=se,this.uint16[Fe+16]=ye,this.uint16[Fe+17]=pe,this.uint16[Fe+18]=ve,this.uint16[Fe+19]=Te,this.uint16[Fe+20]=De,this.uint16[Fe+21]=Xe,this.uint16[Fe+22]=it,this.uint32[pt+12]=We,this.float32[pt+13]=He,this.float32[pt+14]=$e,this.uint16[Fe+30]=tt,this.uint16[Fe+31]=qe,n}}S.prototype.bytesPerElement=64,Je("StructArrayLayout8i15ui1ul2f2ui64",S);class E extends zn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n){const a=this.length;return this.resize(a+1),this.emplace(a,n)}emplace(n,a){return this.float32[1*n+0]=a,n}}E.prototype.bytesPerElement=4,Je("StructArrayLayout1f4",E);class M extends zn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,a,h){const p=this.length;return this.resize(p+1),this.emplace(p,n,a,h)}emplace(n,a,h,p){const y=3*n;return this.uint16[6*n+0]=a,this.float32[y+1]=h,this.float32[y+2]=p,n}}M.prototype.bytesPerElement=12,Je("StructArrayLayout1ui2f12",M);class z extends zn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,a,h){const p=this.length;return this.resize(p+1),this.emplace(p,n,a,h)}emplace(n,a,h,p){const y=4*n;return this.uint32[2*n+0]=a,this.uint16[y+2]=h,this.uint16[y+3]=p,n}}z.prototype.bytesPerElement=8,Je("StructArrayLayout1ul2ui8",z);class L extends zn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,a){const h=this.length;return this.resize(h+1),this.emplace(h,n,a)}emplace(n,a,h){const p=2*n;return this.uint16[p+0]=a,this.uint16[p+1]=h,n}}L.prototype.bytesPerElement=4,Je("StructArrayLayout2ui4",L);class N extends zn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n){const a=this.length;return this.resize(a+1),this.emplace(a,n)}emplace(n,a){return this.uint16[1*n+0]=a,n}}N.prototype.bytesPerElement=2,Je("StructArrayLayout1ui2",N);class J extends zn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,a,h,p){const y=this.length;return this.resize(y+1),this.emplace(y,n,a,h,p)}emplace(n,a,h,p,y){const v=4*n;return this.float32[v+0]=a,this.float32[v+1]=h,this.float32[v+2]=p,this.float32[v+3]=y,n}}J.prototype.bytesPerElement=16,Je("StructArrayLayout4f16",J);class Y extends ma{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new U(this.anchorPointX,this.anchorPointY)}}Y.prototype.size=20;class te extends r{get(n){return new Y(this,n)}}Je("CollisionBoxArray",te);class K extends ma{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(n){this._structArray.uint8[this._pos1+37]=n}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(n){this._structArray.uint8[this._pos1+38]=n}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(n){this._structArray.uint32[this._pos4+10]=n}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}K.prototype.size=48;class me extends b{get(n){return new K(this,n)}}Je("PlacedSymbolArray",me);class Se extends ma{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(n){this._structArray.uint32[this._pos4+12]=n}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}Se.prototype.size=64;class ie extends S{get(n){return new Se(this,n)}}Je("SymbolInstanceArray",ie);class ge extends E{getoffsetX(n){return this.float32[1*n+0]}}Je("GlyphOffsetArray",ge);class Ee extends Us{getx(n){return this.int16[3*n+0]}gety(n){return this.int16[3*n+1]}gettileUnitDistanceFromAnchor(n){return this.int16[3*n+2]}}Je("SymbolLineVertexArray",Ee);class Ie extends ma{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}Ie.prototype.size=12;class ze extends M{get(n){return new Ie(this,n)}}Je("TextAnchorOffsetArray",ze);class Re extends ma{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}Re.prototype.size=8;class Le extends z{get(n){return new Re(this,n)}}Je("FeatureIndexArray",Le);class Ve extends Ns{}class rt extends Ns{}class Ut extends Ns{}class Ge extends Cc{}class gt extends Ec{}class ot extends Xa{}class an extends Ic{}class Vt extends kc{}class At extends en{}class $t extends g{}class Rn extends s{}class pn extends f{}class gr extends _{}class nr extends L{}const Nn=In([{name:"a_pos",components:2,type:"Int16"}],4),{members:hi}=Nn;class _n{constructor(n=[]){this.segments=n}prepareSegment(n,a,h,p){let y=this.segments[this.segments.length-1];return n>_n.MAX_VERTEX_ARRAY_LENGTH&&Ft(`Max vertices per segment is ${_n.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${n}`),(!y||y.vertexLength+n>_n.MAX_VERTEX_ARRAY_LENGTH||y.sortKey!==p)&&(y={vertexOffset:a.length,primitiveOffset:h.length,vertexLength:0,primitiveLength:0},p!==void 0&&(y.sortKey=p),this.segments.push(y)),y}get(){return this.segments}destroy(){for(const n of this.segments)for(const a in n.vaos)n.vaos[a].destroy()}static simpleSegment(n,a,h,p){return new _n([{vertexOffset:n,primitiveOffset:a,vertexLength:h,primitiveLength:p,vaos:{},sortKey:0}])}}function ao(i,n){return 256*(i=de(Math.floor(i),0,255))+de(Math.floor(n),0,255)}_n.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Je("SegmentVector",_n);const so=In([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var Jo={exports:{}},ya={exports:{}};ya.exports=function(i,n){var a,h,p,y,v,w,T,k;for(h=i.length-(a=3&i.length),p=n,v=3432918353,w=461845907,k=0;k<h;)T=255&i.charCodeAt(k)|(255&i.charCodeAt(++k))<<8|(255&i.charCodeAt(++k))<<16|(255&i.charCodeAt(++k))<<24,++k,p=27492+(65535&(y=5*(65535&(p=(p^=T=(65535&(T=(T=(65535&T)*v+(((T>>>16)*v&65535)<<16)&4294967295)<<15|T>>>17))*w+(((T>>>16)*w&65535)<<16)&4294967295)<<13|p>>>19))+((5*(p>>>16)&65535)<<16)&4294967295))+((58964+(y>>>16)&65535)<<16);switch(T=0,a){case 3:T^=(255&i.charCodeAt(k+2))<<16;case 2:T^=(255&i.charCodeAt(k+1))<<8;case 1:p^=T=(65535&(T=(T=(65535&(T^=255&i.charCodeAt(k)))*v+(((T>>>16)*v&65535)<<16)&4294967295)<<15|T>>>17))*w+(((T>>>16)*w&65535)<<16)&4294967295}return p^=i.length,p=2246822507*(65535&(p^=p>>>16))+((2246822507*(p>>>16)&65535)<<16)&4294967295,p=3266489909*(65535&(p^=p>>>13))+((3266489909*(p>>>16)&65535)<<16)&4294967295,(p^=p>>>16)>>>0};var Ya=ya.exports,Tr={exports:{}};Tr.exports=function(i,n){for(var a,h=i.length,p=n^h,y=0;h>=4;)a=1540483477*(65535&(a=255&i.charCodeAt(y)|(255&i.charCodeAt(++y))<<8|(255&i.charCodeAt(++y))<<16|(255&i.charCodeAt(++y))<<24))+((1540483477*(a>>>16)&65535)<<16),p=1540483477*(65535&p)+((1540483477*(p>>>16)&65535)<<16)^(a=1540483477*(65535&(a^=a>>>24))+((1540483477*(a>>>16)&65535)<<16)),h-=4,++y;switch(h){case 3:p^=(255&i.charCodeAt(y+2))<<16;case 2:p^=(255&i.charCodeAt(y+1))<<8;case 1:p=1540483477*(65535&(p^=255&i.charCodeAt(y)))+((1540483477*(p>>>16)&65535)<<16)}return p=1540483477*(65535&(p^=p>>>13))+((1540483477*(p>>>16)&65535)<<16),(p^=p>>>15)>>>0};var yr=Ya,Lr=Tr.exports;Jo.exports=yr,Jo.exports.murmur3=yr,Jo.exports.murmur2=Lr;var _a=I(Jo.exports);class Fn{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(n,a,h,p){this.ids.push(rr(n)),this.positions.push(a,h,p)}getPositions(n){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const a=rr(n);let h=0,p=this.ids.length-1;for(;h<p;){const v=h+p>>1;this.ids[v]>=a?p=v:h=v+1}const y=[];for(;this.ids[h]===a;)y.push({index:this.positions[3*h],start:this.positions[3*h+1],end:this.positions[3*h+2]}),h++;return y}static serialize(n,a){const h=new Float64Array(n.ids),p=new Uint32Array(n.positions);return Hr(h,p,0,h.length-1),a&&a.push(h.buffer,p.buffer),{ids:h,positions:p}}static deserialize(n){const a=new Fn;return a.ids=n.ids,a.positions=n.positions,a.indexed=!0,a}}function rr(i){const n=+i;return!isNaN(n)&&n<=Number.MAX_SAFE_INTEGER?n:_a(String(i))}function Hr(i,n,a,h){for(;a<h;){const p=i[a+h>>1];let y=a-1,v=h+1;for(;;){do y++;while(i[y]<p);do v--;while(i[v]>p);if(y>=v)break;On(i,y,v),On(n,3*y,3*v),On(n,3*y+1,3*v+1),On(n,3*y+2,3*v+2)}v-a<h-v?(Hr(i,n,a,v),a=v+1):(Hr(i,n,v+1,h),h=v)}}function On(i,n,a){const h=i[n];i[n]=i[a],i[a]=h}Je("FeaturePositionMap",Fn);class va{constructor(n,a){this.gl=n.gl,this.location=a}}class $l extends va{constructor(n,a){super(n,a),this.current=0}set(n){this.current!==n&&(this.current=n,this.gl.uniform1f(this.location,n))}}class Ud extends va{constructor(n,a){super(n,a),this.current=[0,0,0,0]}set(n){n[0]===this.current[0]&&n[1]===this.current[1]&&n[2]===this.current[2]&&n[3]===this.current[3]||(this.current=n,this.gl.uniform4f(this.location,n[0],n[1],n[2],n[3]))}}class $d extends va{constructor(n,a){super(n,a),this.current=on.transparent}set(n){n.r===this.current.r&&n.g===this.current.g&&n.b===this.current.b&&n.a===this.current.a||(this.current=n,this.gl.uniform4f(this.location,n.r,n.g,n.b,n.a))}}const Pm=new Float32Array(16);function Mc(i){return[ao(255*i.r,255*i.g),ao(255*i.b,255*i.a)]}class lo{constructor(n,a,h){this.value=n,this.uniformNames=a.map(p=>`u_${p}`),this.type=h}setUniform(n,a,h){n.set(h.constantOr(this.value))}getBinding(n,a,h){return this.type==="color"?new $d(n,a):new $l(n,a)}}class xa{constructor(n,a){this.uniformNames=a.map(h=>`u_${h}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(n,a){this.pixelRatioFrom=a.pixelRatio,this.pixelRatioTo=n.pixelRatio,this.patternFrom=a.tlbr,this.patternTo=n.tlbr}setUniform(n,a,h,p){const y=p==="u_pattern_to"?this.patternTo:p==="u_pattern_from"?this.patternFrom:p==="u_pixel_ratio_to"?this.pixelRatioTo:p==="u_pixel_ratio_from"?this.pixelRatioFrom:null;y&&n.set(y)}getBinding(n,a,h){return h.substr(0,9)==="u_pattern"?new Ud(n,a):new $l(n,a)}}class uo{constructor(n,a,h,p){this.expression=n,this.type=h,this.maxValue=0,this.paintVertexAttributes=a.map(y=>({name:`a_${y}`,type:"Float32",components:h==="color"?2:1,offset:0})),this.paintVertexArray=new p}populatePaintArray(n,a,h,p,y){const v=this.paintVertexArray.length,w=this.expression.evaluate(new yn(0),a,{},p,[],y);this.paintVertexArray.resize(n),this._setPaintValue(v,n,w)}updatePaintArray(n,a,h,p){const y=this.expression.evaluate({zoom:0},h,p);this._setPaintValue(n,a,y)}_setPaintValue(n,a,h){if(this.type==="color"){const p=Mc(h);for(let y=n;y<a;y++)this.paintVertexArray.emplace(y,p[0],p[1])}else{for(let p=n;p<a;p++)this.paintVertexArray.emplace(p,h);this.maxValue=Math.max(this.maxValue,Math.abs(h))}}upload(n){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=n.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Mi{constructor(n,a,h,p,y,v){this.expression=n,this.uniformNames=a.map(w=>`u_${w}_t`),this.type=h,this.useIntegerZoom=p,this.zoom=y,this.maxValue=0,this.paintVertexAttributes=a.map(w=>({name:`a_${w}`,type:"Float32",components:h==="color"?4:2,offset:0})),this.paintVertexArray=new v}populatePaintArray(n,a,h,p,y){const v=this.expression.evaluate(new yn(this.zoom),a,{},p,[],y),w=this.expression.evaluate(new yn(this.zoom+1),a,{},p,[],y),T=this.paintVertexArray.length;this.paintVertexArray.resize(n),this._setPaintValue(T,n,v,w)}updatePaintArray(n,a,h,p){const y=this.expression.evaluate({zoom:this.zoom},h,p),v=this.expression.evaluate({zoom:this.zoom+1},h,p);this._setPaintValue(n,a,y,v)}_setPaintValue(n,a,h,p){if(this.type==="color"){const y=Mc(h),v=Mc(p);for(let w=n;w<a;w++)this.paintVertexArray.emplace(w,y[0],y[1],v[0],v[1])}else{for(let y=n;y<a;y++)this.paintVertexArray.emplace(y,h,p);this.maxValue=Math.max(this.maxValue,Math.abs(h),Math.abs(p))}}upload(n){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=n.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(n,a){const h=this.useIntegerZoom?Math.floor(a.zoom):a.zoom,p=de(this.expression.interpolationFactor(h,this.zoom,this.zoom+1),0,1);n.set(p)}getBinding(n,a,h){return new $l(n,a)}}class co{constructor(n,a,h,p,y,v){this.expression=n,this.type=a,this.useIntegerZoom=h,this.zoom=p,this.layerId=v,this.zoomInPaintVertexArray=new y,this.zoomOutPaintVertexArray=new y}populatePaintArray(n,a,h){const p=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(n),this.zoomOutPaintVertexArray.resize(n),this._setPaintValues(p,n,a.patterns&&a.patterns[this.layerId],h)}updatePaintArray(n,a,h,p,y){this._setPaintValues(n,a,h.patterns&&h.patterns[this.layerId],y)}_setPaintValues(n,a,h,p){if(!p||!h)return;const{min:y,mid:v,max:w}=h,T=p[y],k=p[v],A=p[w];if(T&&k&&A)for(let R=n;R<a;R++)this.zoomInPaintVertexArray.emplace(R,k.tl[0],k.tl[1],k.br[0],k.br[1],T.tl[0],T.tl[1],T.br[0],T.br[1],k.pixelRatio,T.pixelRatio),this.zoomOutPaintVertexArray.emplace(R,k.tl[0],k.tl[1],k.br[0],k.br[1],A.tl[0],A.tl[1],A.br[0],A.br[1],k.pixelRatio,A.pixelRatio)}upload(n){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=n.createVertexBuffer(this.zoomInPaintVertexArray,so.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=n.createVertexBuffer(this.zoomOutPaintVertexArray,so.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class Pc{constructor(n,a,h){this.binders={},this._buffers=[];const p=[];for(const y in n.paint._values){if(!h(y))continue;const v=n.paint.get(y);if(!(v instanceof Dr&&Za(v.property.specification)))continue;const w=PT(y,n.type),T=v.value,k=v.property.specification.type,A=v.property.useIntegerZoom,R=v.property.specification["property-type"],V=R==="cross-faded"||R==="cross-faded-data-driven";if(T.kind==="constant")this.binders[y]=V?new xa(T.value,w):new lo(T.value,w,k),p.push(`/u_${y}`);else if(T.kind==="source"||V){const j=Fv(y,k,"source");this.binders[y]=V?new co(T,k,A,a,j,n.id):new uo(T,w,k,j),p.push(`/a_${y}`)}else{const j=Fv(y,k,"composite");this.binders[y]=new Mi(T,w,k,A,a,j),p.push(`/z_${y}`)}}this.cacheKey=p.sort().join("")}getMaxValue(n){const a=this.binders[n];return a instanceof uo||a instanceof Mi?a.maxValue:0}populatePaintArrays(n,a,h,p,y){for(const v in this.binders){const w=this.binders[v];(w instanceof uo||w instanceof Mi||w instanceof co)&&w.populatePaintArray(n,a,h,p,y)}}setConstantPatternPositions(n,a){for(const h in this.binders){const p=this.binders[h];p instanceof xa&&p.setConstantPatternPositions(n,a)}}updatePaintArrays(n,a,h,p,y){let v=!1;for(const w in n){const T=a.getPositions(w);for(const k of T){const A=h.feature(k.index);for(const R in this.binders){const V=this.binders[R];if((V instanceof uo||V instanceof Mi||V instanceof co)&&V.expression.isStateDependent===!0){const j=p.paint.get(R);V.expression=j.value,V.updatePaintArray(k.start,k.end,A,n[w],y),v=!0}}}}return v}defines(){const n=[];for(const a in this.binders){const h=this.binders[a];(h instanceof lo||h instanceof xa)&&n.push(...h.uniformNames.map(p=>`#define HAS_UNIFORM_${p}`))}return n}getBinderAttributes(){const n=[];for(const a in this.binders){const h=this.binders[a];if(h instanceof uo||h instanceof Mi)for(let p=0;p<h.paintVertexAttributes.length;p++)n.push(h.paintVertexAttributes[p].name);else if(h instanceof co)for(let p=0;p<so.members.length;p++)n.push(so.members[p].name)}return n}getBinderUniforms(){const n=[];for(const a in this.binders){const h=this.binders[a];if(h instanceof lo||h instanceof xa||h instanceof Mi)for(const p of h.uniformNames)n.push(p)}return n}getPaintVertexBuffers(){return this._buffers}getUniforms(n,a){const h=[];for(const p in this.binders){const y=this.binders[p];if(y instanceof lo||y instanceof xa||y instanceof Mi){for(const v of y.uniformNames)if(a[v]){const w=y.getBinding(n,a[v],v);h.push({name:v,property:p,binding:w})}}}return h}setUniforms(n,a,h,p){for(const{name:y,property:v,binding:w}of a)this.binders[v].setUniform(w,p,h.get(v),y)}updatePaintBuffers(n){this._buffers=[];for(const a in this.binders){const h=this.binders[a];if(n&&h instanceof co){const p=n.fromScale===2?h.zoomInPaintVertexBuffer:h.zoomOutPaintVertexBuffer;p&&this._buffers.push(p)}else(h instanceof uo||h instanceof Mi)&&h.paintVertexBuffer&&this._buffers.push(h.paintVertexBuffer)}}upload(n){for(const a in this.binders){const h=this.binders[a];(h instanceof uo||h instanceof Mi||h instanceof co)&&h.upload(n)}this.updatePaintBuffers()}destroy(){for(const n in this.binders){const a=this.binders[n];(a instanceof uo||a instanceof Mi||a instanceof co)&&a.destroy()}}}class Mo{constructor(n,a,h=()=>!0){this.programConfigurations={};for(const p of n)this.programConfigurations[p.id]=new Pc(p,a,h);this.needsUpload=!1,this._featureMap=new Fn,this._bufferOffset=0}populatePaintArrays(n,a,h,p,y,v){for(const w in this.programConfigurations)this.programConfigurations[w].populatePaintArrays(n,a,p,y,v);a.id!==void 0&&this._featureMap.add(a.id,h,this._bufferOffset,n),this._bufferOffset=n,this.needsUpload=!0}updatePaintArrays(n,a,h,p){for(const y of h)this.needsUpload=this.programConfigurations[y.id].updatePaintArrays(n,this._featureMap,a,y,p)||this.needsUpload}get(n){return this.programConfigurations[n]}upload(n){if(this.needsUpload){for(const a in this.programConfigurations)this.programConfigurations[a].upload(n);this.needsUpload=!1}}destroy(){for(const n in this.programConfigurations)this.programConfigurations[n].destroy()}}function PT(i,n){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[i]||[i.replace(`${n}-`,"").replace(/-/g,"_")]}function Fv(i,n,a){const h={color:{source:Xa,composite:J},number:{source:E,composite:Xa}},p=function(y){return{"line-pattern":{source:an,composite:an},"fill-pattern":{source:an,composite:an},"fill-extrusion-pattern":{source:an,composite:an}}[y]}(i);return p&&p[a]||h[n][a]}Je("ConstantBinder",lo),Je("CrossFadedConstantBinder",xa),Je("SourceExpressionBinder",uo),Je("CrossFadedCompositeBinder",co),Je("CompositeExpressionBinder",Mi),Je("ProgramConfiguration",Pc,{omit:["_buffers"]}),Je("ProgramConfigurationSet",Mo);const Kn=8192,Am=Math.pow(2,14)-1,Ov=-Am-1;function $s(i){const n=Kn/i.extent,a=i.loadGeometry();for(let h=0;h<a.length;h++){const p=a[h];for(let y=0;y<p.length;y++){const v=p[y],w=Math.round(v.x*n),T=Math.round(v.y*n);v.x=de(w,Ov,Am),v.y=de(T,Ov,Am),(w<v.x||w>v.x+1||T<v.y||T>v.y+1)&&Ft("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return a}function js(i,n){return{type:i.type,id:i.id,properties:i.properties,geometry:n?$s(i):[]}}function jd(i,n,a,h,p){i.emplaceBack(2*n+(h+1)/2,2*a+(p+1)/2)}class zm{constructor(n){this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(a=>a.id),this.index=n.index,this.hasPattern=!1,this.layoutVertexArray=new rt,this.indexArray=new gr,this.segments=new _n,this.programConfigurations=new Mo(n.layers,n.zoom),this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id)}populate(n,a,h){const p=this.layers[0],y=[];let v=null,w=!1;p.type==="circle"&&(v=p.layout.get("circle-sort-key"),w=!v.isConstant());for(const{feature:T,id:k,index:A,sourceLayerIndex:R}of n){const V=this.layers[0]._featureFilter.needGeometry,j=js(T,V);if(!this.layers[0]._featureFilter.filter(new yn(this.zoom),j,h))continue;const q=w?v.evaluate(j,{},h):void 0,X={id:k,properties:T.properties,type:T.type,sourceLayerIndex:R,index:A,geometry:V?j.geometry:$s(T),patterns:{},sortKey:q};y.push(X)}w&&y.sort((T,k)=>T.sortKey-k.sortKey);for(const T of y){const{geometry:k,index:A,sourceLayerIndex:R}=T,V=n[A].feature;this.addFeature(T,k,A,h),a.featureIndex.insert(V,k,A,R,this.index)}}update(n,a,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(n,a,this.stateDependentLayers,h)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,hi),this.indexBuffer=n.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(n,a,h,p){for(const y of a)for(const v of y){const w=v.x,T=v.y;if(w<0||w>=Kn||T<0||T>=Kn)continue;const k=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,n.sortKey),A=k.vertexLength;jd(this.layoutVertexArray,w,T,-1,-1),jd(this.layoutVertexArray,w,T,1,-1),jd(this.layoutVertexArray,w,T,1,1),jd(this.layoutVertexArray,w,T,-1,1),this.indexArray.emplaceBack(A,A+1,A+2),this.indexArray.emplaceBack(A,A+3,A+2),k.vertexLength+=4,k.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,h,{},p)}}function Bv(i,n){for(let a=0;a<i.length;a++)if(jl(n,i[a]))return!0;for(let a=0;a<n.length;a++)if(jl(i,n[a]))return!0;return!!Dm(i,n)}function AT(i,n,a){return!!jl(i,n)||!!Lm(n,i,a)}function Vv(i,n){if(i.length===1)return Uv(n,i[0]);for(let a=0;a<n.length;a++){const h=n[a];for(let p=0;p<h.length;p++)if(jl(i,h[p]))return!0}for(let a=0;a<i.length;a++)if(Uv(n,i[a]))return!0;for(let a=0;a<n.length;a++)if(Dm(i,n[a]))return!0;return!1}function zT(i,n,a){if(i.length>1){if(Dm(i,n))return!0;for(let h=0;h<n.length;h++)if(Lm(n[h],i,a))return!0}for(let h=0;h<i.length;h++)if(Lm(i[h],n,a))return!0;return!1}function Dm(i,n){if(i.length===0||n.length===0)return!1;for(let a=0;a<i.length-1;a++){const h=i[a],p=i[a+1];for(let y=0;y<n.length-1;y++)if(DT(h,p,n[y],n[y+1]))return!0}return!1}function DT(i,n,a,h){return It(i,a,h)!==It(n,a,h)&&It(i,n,a)!==It(i,n,h)}function Lm(i,n,a){const h=a*a;if(n.length===1)return i.distSqr(n[0])<h;for(let p=1;p<n.length;p++)if(Nv(i,n[p-1],n[p])<h)return!0;return!1}function Nv(i,n,a){const h=n.distSqr(a);if(h===0)return i.distSqr(n);const p=((i.x-n.x)*(a.x-n.x)+(i.y-n.y)*(a.y-n.y))/h;return i.distSqr(p<0?n:p>1?a:a.sub(n)._mult(p)._add(n))}function Uv(i,n){let a,h,p,y=!1;for(let v=0;v<i.length;v++){a=i[v];for(let w=0,T=a.length-1;w<a.length;T=w++)h=a[w],p=a[T],h.y>n.y!=p.y>n.y&&n.x<(p.x-h.x)*(n.y-h.y)/(p.y-h.y)+h.x&&(y=!y)}return y}function jl(i,n){let a=!1;for(let h=0,p=i.length-1;h<i.length;p=h++){const y=i[h],v=i[p];y.y>n.y!=v.y>n.y&&n.x<(v.x-y.x)*(n.y-y.y)/(v.y-y.y)+y.x&&(a=!a)}return a}function LT(i,n,a){const h=a[0],p=a[2];if(i.x<h.x&&n.x<h.x||i.x>p.x&&n.x>p.x||i.y<h.y&&n.y<h.y||i.y>p.y&&n.y>p.y)return!1;const y=It(i,n,a[0]);return y!==It(i,n,a[1])||y!==It(i,n,a[2])||y!==It(i,n,a[3])}function Ac(i,n,a){const h=n.paint.get(i).value;return h.kind==="constant"?h.value:a.programConfigurations.get(n.id).getMaxValue(i)}function Zd(i){return Math.sqrt(i[0]*i[0]+i[1]*i[1])}function qd(i,n,a,h,p){if(!n[0]&&!n[1])return i;const y=U.convert(n)._mult(p);a==="viewport"&&y._rotate(-h);const v=[];for(let w=0;w<i.length;w++)v.push(i[w].sub(y));return v}let $v,jv;Je("CircleBucket",zm,{omit:["layers"]});var RT={get paint(){return jv=jv||new Vn({"circle-radius":new mt(Ae.paint_circle["circle-radius"]),"circle-color":new mt(Ae.paint_circle["circle-color"]),"circle-blur":new mt(Ae.paint_circle["circle-blur"]),"circle-opacity":new mt(Ae.paint_circle["circle-opacity"]),"circle-translate":new st(Ae.paint_circle["circle-translate"]),"circle-translate-anchor":new st(Ae.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new st(Ae.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new st(Ae.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new mt(Ae.paint_circle["circle-stroke-width"]),"circle-stroke-color":new mt(Ae.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new mt(Ae.paint_circle["circle-stroke-opacity"])})},get layout(){return $v=$v||new Vn({"circle-sort-key":new mt(Ae.layout_circle["circle-sort-key"])})}},Wr=1e-6,Zl=typeof Float32Array<"u"?Float32Array:Array;function Rm(i){return i[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=1,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=1,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i}function Zv(i,n,a){var h=n[0],p=n[1],y=n[2],v=n[3],w=n[4],T=n[5],k=n[6],A=n[7],R=n[8],V=n[9],j=n[10],q=n[11],X=n[12],re=n[13],se=n[14],ye=n[15],pe=a[0],ve=a[1],Te=a[2],De=a[3];return i[0]=pe*h+ve*w+Te*R+De*X,i[1]=pe*p+ve*T+Te*V+De*re,i[2]=pe*y+ve*k+Te*j+De*se,i[3]=pe*v+ve*A+Te*q+De*ye,i[4]=(pe=a[4])*h+(ve=a[5])*w+(Te=a[6])*R+(De=a[7])*X,i[5]=pe*p+ve*T+Te*V+De*re,i[6]=pe*y+ve*k+Te*j+De*se,i[7]=pe*v+ve*A+Te*q+De*ye,i[8]=(pe=a[8])*h+(ve=a[9])*w+(Te=a[10])*R+(De=a[11])*X,i[9]=pe*p+ve*T+Te*V+De*re,i[10]=pe*y+ve*k+Te*j+De*se,i[11]=pe*v+ve*A+Te*q+De*ye,i[12]=(pe=a[12])*h+(ve=a[13])*w+(Te=a[14])*R+(De=a[15])*X,i[13]=pe*p+ve*T+Te*V+De*re,i[14]=pe*y+ve*k+Te*j+De*se,i[15]=pe*v+ve*A+Te*q+De*ye,i}Math.hypot||(Math.hypot=function(){for(var i=0,n=arguments.length;n--;)i+=arguments[n]*arguments[n];return Math.sqrt(i)});var zc,FT=Zv;function Gd(i,n,a){var h=n[0],p=n[1],y=n[2],v=n[3];return i[0]=a[0]*h+a[4]*p+a[8]*y+a[12]*v,i[1]=a[1]*h+a[5]*p+a[9]*y+a[13]*v,i[2]=a[2]*h+a[6]*p+a[10]*y+a[14]*v,i[3]=a[3]*h+a[7]*p+a[11]*y+a[15]*v,i}zc=new Zl(4),Zl!=Float32Array&&(zc[0]=0,zc[1]=0,zc[2]=0,zc[3]=0);class OT extends ki{constructor(n){super(n,RT)}createBucket(n){return new zm(n)}queryRadius(n){const a=n;return Ac("circle-radius",this,a)+Ac("circle-stroke-width",this,a)+Zd(this.paint.get("circle-translate"))}queryIntersectsFeature(n,a,h,p,y,v,w,T){const k=qd(n,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),v.angle,w),A=this.paint.get("circle-radius").evaluate(a,h)+this.paint.get("circle-stroke-width").evaluate(a,h),R=this.paint.get("circle-pitch-alignment")==="map",V=R?k:function(q,X){return q.map(re=>qv(re,X))}(k,T),j=R?A*w:A;for(const q of p)for(const X of q){const re=R?X:qv(X,T);let se=j;const ye=Gd([],[X.x,X.y,0,1],T);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?se*=ye[3]/v.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(se*=v.cameraToCenterDistance/ye[3]),AT(V,re,se))return!0}return!1}}function qv(i,n){const a=Gd([],[i.x,i.y,0,1],n);return new U(a[0]/a[3],a[1]/a[3])}class Gv extends zm{}let Hv;Je("HeatmapBucket",Gv,{omit:["layers"]});var BT={get paint(){return Hv=Hv||new Vn({"heatmap-radius":new mt(Ae.paint_heatmap["heatmap-radius"]),"heatmap-weight":new mt(Ae.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new st(Ae.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Sc(Ae.paint_heatmap["heatmap-color"]),"heatmap-opacity":new st(Ae.paint_heatmap["heatmap-opacity"])})}};function Fm(i,{width:n,height:a},h,p){if(p){if(p instanceof Uint8ClampedArray)p=new Uint8Array(p.buffer);else if(p.length!==n*a*h)throw new RangeError(`mismatched image size. expected: ${p.length} but got: ${n*a*h}`)}else p=new Uint8Array(n*a*h);return i.width=n,i.height=a,i.data=p,i}function Wv(i,{width:n,height:a},h){if(n===i.width&&a===i.height)return;const p=Fm({},{width:n,height:a},h);Om(i,p,{x:0,y:0},{x:0,y:0},{width:Math.min(i.width,n),height:Math.min(i.height,a)},h),i.width=n,i.height=a,i.data=p.data}function Om(i,n,a,h,p,y){if(p.width===0||p.height===0)return n;if(p.width>i.width||p.height>i.height||a.x>i.width-p.width||a.y>i.height-p.height)throw new RangeError("out of range source coordinates for image copy");if(p.width>n.width||p.height>n.height||h.x>n.width-p.width||h.y>n.height-p.height)throw new RangeError("out of range destination coordinates for image copy");const v=i.data,w=n.data;if(v===w)throw new Error("srcData equals dstData, so image is already copied");for(let T=0;T<p.height;T++){const k=((a.y+T)*i.width+a.x)*y,A=((h.y+T)*n.width+h.x)*y;for(let R=0;R<p.width*y;R++)w[A+R]=v[k+R]}return n}class Dc{constructor(n,a){Fm(this,n,1,a)}resize(n){Wv(this,n,1)}clone(){return new Dc({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(n,a,h,p,y){Om(n,a,h,p,y,1)}}class Ni{constructor(n,a){Fm(this,n,4,a)}resize(n){Wv(this,n,4)}replace(n,a){a?this.data.set(n):this.data=n instanceof Uint8ClampedArray?new Uint8Array(n.buffer):n}clone(){return new Ni({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(n,a,h,p,y){Om(n,a,h,p,y,4)}}function Kv(i){const n={},a=i.resolution||256,h=i.clips?i.clips.length:1,p=i.image||new Ni({width:a,height:h});if(Math.log(a)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${a}`);const y=(v,w,T)=>{n[i.evaluationKey]=T;const k=i.expression.evaluate(n);p.data[v+w+0]=Math.floor(255*k.r/k.a),p.data[v+w+1]=Math.floor(255*k.g/k.a),p.data[v+w+2]=Math.floor(255*k.b/k.a),p.data[v+w+3]=Math.floor(255*k.a)};if(i.clips)for(let v=0,w=0;v<h;++v,w+=4*a)for(let T=0,k=0;T<a;T++,k+=4){const A=T/(a-1),{start:R,end:V}=i.clips[v];y(w,k,R*(1-A)+V*A)}else for(let v=0,w=0;v<a;v++,w+=4)y(0,w,v/(a-1));return p}Je("AlphaImage",Dc),Je("RGBAImage",Ni);class VT extends ki{createBucket(n){return new Gv(n)}constructor(n){super(n,BT),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(n){n==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Kv({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let Xv;var NT={get paint(){return Xv=Xv||new Vn({"hillshade-illumination-direction":new st(Ae.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new st(Ae.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new st(Ae.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new st(Ae.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new st(Ae.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new st(Ae.paint_hillshade["hillshade-accent-color"])})}};class UT extends ki{constructor(n){super(n,NT)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}const $T=In([{name:"a_pos",components:2,type:"Int16"}],4),{members:jT}=$T;var Bm={exports:{}};function Hd(i,n,a){a=a||2;var h,p,y,v,w,T,k,A=n&&n.length,R=A?n[0]*a:i.length,V=Yv(i,0,R,a,!0),j=[];if(!V||V.next===V.prev)return j;if(A&&(V=function(X,re,se,ye){var pe,ve,Te,De=[];for(pe=0,ve=re.length;pe<ve;pe++)(Te=Yv(X,re[pe]*ye,pe<ve-1?re[pe+1]*ye:X.length,ye,!1))===Te.next&&(Te.steiner=!0),De.push(YT(Te));for(De.sort(WT),pe=0;pe<De.length;pe++)se=KT(De[pe],se);return se}(i,n,V,a)),i.length>80*a){h=y=i[0],p=v=i[1];for(var q=a;q<R;q+=a)(w=i[q])<h&&(h=w),(T=i[q+1])<p&&(p=T),w>y&&(y=w),T>v&&(v=T);k=(k=Math.max(y-h,v-p))!==0?32767/k:0}return Lc(V,j,a,h,p,k,0),j}function Yv(i,n,a,h,p){var y,v;if(p===Um(i,n,a,h)>0)for(y=n;y<a;y+=h)v=e0(y,i[y],i[y+1],v);else for(y=a-h;y>=n;y-=h)v=e0(y,i[y],i[y+1],v);return v&&Wd(v,v.next)&&(Fc(v),v=v.next),v}function Zs(i,n){if(!i)return i;n||(n=i);var a,h=i;do if(a=!1,h.steiner||!Wd(h,h.next)&&Un(h.prev,h,h.next)!==0)h=h.next;else{if(Fc(h),(h=n=h.prev)===h.next)break;a=!0}while(a||h!==n);return n}function Lc(i,n,a,h,p,y,v){if(i){!v&&y&&function(A,R,V,j){var q=A;do q.z===0&&(q.z=Vm(q.x,q.y,R,V,j)),q.prevZ=q.prev,q.nextZ=q.next,q=q.next;while(q!==A);q.prevZ.nextZ=null,q.prevZ=null,function(X){var re,se,ye,pe,ve,Te,De,Xe,it=1;do{for(se=X,X=null,ve=null,Te=0;se;){for(Te++,ye=se,De=0,re=0;re<it&&(De++,ye=ye.nextZ);re++);for(Xe=it;De>0||Xe>0&&ye;)De!==0&&(Xe===0||!ye||se.z<=ye.z)?(pe=se,se=se.nextZ,De--):(pe=ye,ye=ye.nextZ,Xe--),ve?ve.nextZ=pe:X=pe,pe.prevZ=ve,ve=pe;se=ye}ve.nextZ=null,it*=2}while(Te>1)}(q)}(i,h,p,y);for(var w,T,k=i;i.prev!==i.next;)if(w=i.prev,T=i.next,y?qT(i,h,p,y):ZT(i))n.push(w.i/a|0),n.push(i.i/a|0),n.push(T.i/a|0),Fc(i),i=T.next,k=T.next;else if((i=T)===k){v?v===1?Lc(i=GT(Zs(i),n,a),n,a,h,p,y,2):v===2&&HT(i,n,a,h,p,y):Lc(Zs(i),n,a,h,p,y,1);break}}}function ZT(i){var n=i.prev,a=i,h=i.next;if(Un(n,a,h)>=0)return!1;for(var p=n.x,y=a.x,v=h.x,w=n.y,T=a.y,k=h.y,A=p<y?p<v?p:v:y<v?y:v,R=w<T?w<k?w:k:T<k?T:k,V=p>y?p>v?p:v:y>v?y:v,j=w>T?w>k?w:k:T>k?T:k,q=h.next;q!==n;){if(q.x>=A&&q.x<=V&&q.y>=R&&q.y<=j&&ql(p,w,y,T,v,k,q.x,q.y)&&Un(q.prev,q,q.next)>=0)return!1;q=q.next}return!0}function qT(i,n,a,h){var p=i.prev,y=i,v=i.next;if(Un(p,y,v)>=0)return!1;for(var w=p.x,T=y.x,k=v.x,A=p.y,R=y.y,V=v.y,j=w<T?w<k?w:k:T<k?T:k,q=A<R?A<V?A:V:R<V?R:V,X=w>T?w>k?w:k:T>k?T:k,re=A>R?A>V?A:V:R>V?R:V,se=Vm(j,q,n,a,h),ye=Vm(X,re,n,a,h),pe=i.prevZ,ve=i.nextZ;pe&&pe.z>=se&&ve&&ve.z<=ye;){if(pe.x>=j&&pe.x<=X&&pe.y>=q&&pe.y<=re&&pe!==p&&pe!==v&&ql(w,A,T,R,k,V,pe.x,pe.y)&&Un(pe.prev,pe,pe.next)>=0||(pe=pe.prevZ,ve.x>=j&&ve.x<=X&&ve.y>=q&&ve.y<=re&&ve!==p&&ve!==v&&ql(w,A,T,R,k,V,ve.x,ve.y)&&Un(ve.prev,ve,ve.next)>=0))return!1;ve=ve.nextZ}for(;pe&&pe.z>=se;){if(pe.x>=j&&pe.x<=X&&pe.y>=q&&pe.y<=re&&pe!==p&&pe!==v&&ql(w,A,T,R,k,V,pe.x,pe.y)&&Un(pe.prev,pe,pe.next)>=0)return!1;pe=pe.prevZ}for(;ve&&ve.z<=ye;){if(ve.x>=j&&ve.x<=X&&ve.y>=q&&ve.y<=re&&ve!==p&&ve!==v&&ql(w,A,T,R,k,V,ve.x,ve.y)&&Un(ve.prev,ve,ve.next)>=0)return!1;ve=ve.nextZ}return!0}function GT(i,n,a){var h=i;do{var p=h.prev,y=h.next.next;!Wd(p,y)&&Jv(p,h,h.next,y)&&Rc(p,y)&&Rc(y,p)&&(n.push(p.i/a|0),n.push(h.i/a|0),n.push(y.i/a|0),Fc(h),Fc(h.next),h=i=y),h=h.next}while(h!==i);return Zs(h)}function HT(i,n,a,h,p,y){var v=i;do{for(var w=v.next.next;w!==v.prev;){if(v.i!==w.i&&JT(v,w)){var T=Qv(v,w);return v=Zs(v,v.next),T=Zs(T,T.next),Lc(v,n,a,h,p,y,0),void Lc(T,n,a,h,p,y,0)}w=w.next}v=v.next}while(v!==i)}function WT(i,n){return i.x-n.x}function KT(i,n){var a=function(p,y){var v,w=y,T=p.x,k=p.y,A=-1/0;do{if(k<=w.y&&k>=w.next.y&&w.next.y!==w.y){var R=w.x+(k-w.y)*(w.next.x-w.x)/(w.next.y-w.y);if(R<=T&&R>A&&(A=R,v=w.x<w.next.x?w:w.next,R===T))return v}w=w.next}while(w!==y);if(!v)return null;var V,j=v,q=v.x,X=v.y,re=1/0;w=v;do T>=w.x&&w.x>=q&&T!==w.x&&ql(k<X?T:A,k,q,X,k<X?A:T,k,w.x,w.y)&&(V=Math.abs(k-w.y)/(T-w.x),Rc(w,p)&&(V<re||V===re&&(w.x>v.x||w.x===v.x&&XT(v,w)))&&(v=w,re=V)),w=w.next;while(w!==j);return v}(i,n);if(!a)return n;var h=Qv(a,i);return Zs(h,h.next),Zs(a,a.next)}function XT(i,n){return Un(i.prev,i,n.prev)<0&&Un(n.next,i,i.next)<0}function Vm(i,n,a,h,p){return(i=1431655765&((i=858993459&((i=252645135&((i=16711935&((i=(i-a)*p|0)|i<<8))|i<<4))|i<<2))|i<<1))|(n=1431655765&((n=858993459&((n=252645135&((n=16711935&((n=(n-h)*p|0)|n<<8))|n<<4))|n<<2))|n<<1))<<1}function YT(i){var n=i,a=i;do(n.x<a.x||n.x===a.x&&n.y<a.y)&&(a=n),n=n.next;while(n!==i);return a}function ql(i,n,a,h,p,y,v,w){return(p-v)*(n-w)>=(i-v)*(y-w)&&(i-v)*(h-w)>=(a-v)*(n-w)&&(a-v)*(y-w)>=(p-v)*(h-w)}function JT(i,n){return i.next.i!==n.i&&i.prev.i!==n.i&&!function(a,h){var p=a;do{if(p.i!==a.i&&p.next.i!==a.i&&p.i!==h.i&&p.next.i!==h.i&&Jv(p,p.next,a,h))return!0;p=p.next}while(p!==a);return!1}(i,n)&&(Rc(i,n)&&Rc(n,i)&&function(a,h){var p=a,y=!1,v=(a.x+h.x)/2,w=(a.y+h.y)/2;do p.y>w!=p.next.y>w&&p.next.y!==p.y&&v<(p.next.x-p.x)*(w-p.y)/(p.next.y-p.y)+p.x&&(y=!y),p=p.next;while(p!==a);return y}(i,n)&&(Un(i.prev,i,n.prev)||Un(i,n.prev,n))||Wd(i,n)&&Un(i.prev,i,i.next)>0&&Un(n.prev,n,n.next)>0)}function Un(i,n,a){return(n.y-i.y)*(a.x-n.x)-(n.x-i.x)*(a.y-n.y)}function Wd(i,n){return i.x===n.x&&i.y===n.y}function Jv(i,n,a,h){var p=Xd(Un(i,n,a)),y=Xd(Un(i,n,h)),v=Xd(Un(a,h,i)),w=Xd(Un(a,h,n));return p!==y&&v!==w||!(p!==0||!Kd(i,a,n))||!(y!==0||!Kd(i,h,n))||!(v!==0||!Kd(a,i,h))||!(w!==0||!Kd(a,n,h))}function Kd(i,n,a){return n.x<=Math.max(i.x,a.x)&&n.x>=Math.min(i.x,a.x)&&n.y<=Math.max(i.y,a.y)&&n.y>=Math.min(i.y,a.y)}function Xd(i){return i>0?1:i<0?-1:0}function Rc(i,n){return Un(i.prev,i,i.next)<0?Un(i,n,i.next)>=0&&Un(i,i.prev,n)>=0:Un(i,n,i.prev)<0||Un(i,i.next,n)<0}function Qv(i,n){var a=new Nm(i.i,i.x,i.y),h=new Nm(n.i,n.x,n.y),p=i.next,y=n.prev;return i.next=n,n.prev=i,a.next=p,p.prev=a,h.next=a,a.prev=h,y.next=h,h.prev=y,h}function e0(i,n,a,h){var p=new Nm(i,n,a);return h?(p.next=h.next,p.prev=h,h.next.prev=p,h.next=p):(p.prev=p,p.next=p),p}function Fc(i){i.next.prev=i.prev,i.prev.next=i.next,i.prevZ&&(i.prevZ.nextZ=i.nextZ),i.nextZ&&(i.nextZ.prevZ=i.prevZ)}function Nm(i,n,a){this.i=i,this.x=n,this.y=a,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Um(i,n,a,h){for(var p=0,y=n,v=a-h;y<a;y+=h)p+=(i[v]-i[y])*(i[y+1]+i[v+1]),v=y;return p}Bm.exports=Hd,Bm.exports.default=Hd,Hd.deviation=function(i,n,a,h){var p=n&&n.length,y=Math.abs(Um(i,0,p?n[0]*a:i.length,a));if(p)for(var v=0,w=n.length;v<w;v++)y-=Math.abs(Um(i,n[v]*a,v<w-1?n[v+1]*a:i.length,a));var T=0;for(v=0;v<h.length;v+=3){var k=h[v]*a,A=h[v+1]*a,R=h[v+2]*a;T+=Math.abs((i[k]-i[R])*(i[A+1]-i[k+1])-(i[k]-i[A])*(i[R+1]-i[k+1]))}return y===0&&T===0?0:Math.abs((T-y)/y)},Hd.flatten=function(i){for(var n=i[0][0].length,a={vertices:[],holes:[],dimensions:n},h=0,p=0;p<i.length;p++){for(var y=0;y<i[p].length;y++)for(var v=0;v<n;v++)a.vertices.push(i[p][y][v]);p>0&&a.holes.push(h+=i[p-1].length)}return a};var t0=I(Bm.exports);function QT(i,n,a,h,p){n0(i,n,a||0,h||i.length-1,p||eC)}function n0(i,n,a,h,p){for(;h>a;){if(h-a>600){var y=h-a+1,v=n-a+1,w=Math.log(y),T=.5*Math.exp(2*w/3),k=.5*Math.sqrt(w*T*(y-T)/y)*(v-y/2<0?-1:1);n0(i,n,Math.max(a,Math.floor(n-v*T/y+k)),Math.min(h,Math.floor(n+(y-v)*T/y+k)),p)}var A=i[n],R=a,V=h;for(Oc(i,a,n),p(i[h],A)>0&&Oc(i,a,h);R<V;){for(Oc(i,R,V),R++,V--;p(i[R],A)<0;)R++;for(;p(i[V],A)>0;)V--}p(i[a],A)===0?Oc(i,a,V):Oc(i,++V,h),V<=n&&(a=V+1),n<=V&&(h=V-1)}}function Oc(i,n,a){var h=i[n];i[n]=i[a],i[a]=h}function eC(i,n){return i<n?-1:i>n?1:0}function $m(i,n){const a=i.length;if(a<=1)return[i];const h=[];let p,y;for(let v=0;v<a;v++){const w=zt(i[v]);w!==0&&(i[v].area=Math.abs(w),y===void 0&&(y=w<0),y===w<0?(p&&h.push(p),p=[i[v]]):p.push(i[v]))}if(p&&h.push(p),n>1)for(let v=0;v<h.length;v++)h[v].length<=n||(QT(h[v],n,1,h[v].length-1,tC),h[v]=h[v].slice(0,n));return h}function tC(i,n){return n.area-i.area}function jm(i,n,a){const h=a.patternDependencies;let p=!1;for(const y of n){const v=y.paint.get(`${i}-pattern`);v.isConstant()||(p=!0);const w=v.constantOr(null);w&&(p=!0,h[w.to]=!0,h[w.from]=!0)}return p}function Zm(i,n,a,h,p){const y=p.patternDependencies;for(const v of n){const w=v.paint.get(`${i}-pattern`).value;if(w.kind!=="constant"){let T=w.evaluate({zoom:h-1},a,{},p.availableImages),k=w.evaluate({zoom:h},a,{},p.availableImages),A=w.evaluate({zoom:h+1},a,{},p.availableImages);T=T&&T.name?T.name:T,k=k&&k.name?k.name:k,A=A&&A.name?A.name:A,y[T]=!0,y[k]=!0,y[A]=!0,a.patterns[v.id]={min:T,mid:k,max:A}}}return a}class qm{constructor(n){this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(a=>a.id),this.index=n.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Ut,this.indexArray=new gr,this.indexArray2=new nr,this.programConfigurations=new Mo(n.layers,n.zoom),this.segments=new _n,this.segments2=new _n,this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id)}populate(n,a,h){this.hasPattern=jm("fill",this.layers,a);const p=this.layers[0].layout.get("fill-sort-key"),y=!p.isConstant(),v=[];for(const{feature:w,id:T,index:k,sourceLayerIndex:A}of n){const R=this.layers[0]._featureFilter.needGeometry,V=js(w,R);if(!this.layers[0]._featureFilter.filter(new yn(this.zoom),V,h))continue;const j=y?p.evaluate(V,{},h,a.availableImages):void 0,q={id:T,properties:w.properties,type:w.type,sourceLayerIndex:A,index:k,geometry:R?V.geometry:$s(w),patterns:{},sortKey:j};v.push(q)}y&&v.sort((w,T)=>w.sortKey-T.sortKey);for(const w of v){const{geometry:T,index:k,sourceLayerIndex:A}=w;if(this.hasPattern){const R=Zm("fill",this.layers,w,this.zoom,a);this.patternFeatures.push(R)}else this.addFeature(w,T,k,h,{});a.featureIndex.insert(n[k].feature,T,k,A,this.index)}}update(n,a,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(n,a,this.stateDependentLayers,h)}addFeatures(n,a,h){for(const p of this.patternFeatures)this.addFeature(p,p.geometry,p.index,a,h)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,jT),this.indexBuffer=n.createIndexBuffer(this.indexArray),this.indexBuffer2=n.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(n,a,h,p,y){for(const v of $m(a,500)){let w=0;for(const j of v)w+=j.length;const T=this.segments.prepareSegment(w,this.layoutVertexArray,this.indexArray),k=T.vertexLength,A=[],R=[];for(const j of v){if(j.length===0)continue;j!==v[0]&&R.push(A.length/2);const q=this.segments2.prepareSegment(j.length,this.layoutVertexArray,this.indexArray2),X=q.vertexLength;this.layoutVertexArray.emplaceBack(j[0].x,j[0].y),this.indexArray2.emplaceBack(X+j.length-1,X),A.push(j[0].x),A.push(j[0].y);for(let re=1;re<j.length;re++)this.layoutVertexArray.emplaceBack(j[re].x,j[re].y),this.indexArray2.emplaceBack(X+re-1,X+re),A.push(j[re].x),A.push(j[re].y);q.vertexLength+=j.length,q.primitiveLength+=j.length}const V=t0(A,R);for(let j=0;j<V.length;j+=3)this.indexArray.emplaceBack(k+V[j],k+V[j+1],k+V[j+2]);T.vertexLength+=w,T.primitiveLength+=V.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,h,y,p)}}let r0,i0;Je("FillBucket",qm,{omit:["layers","patternFeatures"]});var nC={get paint(){return i0=i0||new Vn({"fill-antialias":new st(Ae.paint_fill["fill-antialias"]),"fill-opacity":new mt(Ae.paint_fill["fill-opacity"]),"fill-color":new mt(Ae.paint_fill["fill-color"]),"fill-outline-color":new mt(Ae.paint_fill["fill-outline-color"]),"fill-translate":new st(Ae.paint_fill["fill-translate"]),"fill-translate-anchor":new st(Ae.paint_fill["fill-translate-anchor"]),"fill-pattern":new Vs(Ae.paint_fill["fill-pattern"])})},get layout(){return r0=r0||new Vn({"fill-sort-key":new mt(Ae.layout_fill["fill-sort-key"])})}};class rC extends ki{constructor(n){super(n,nC)}recalculate(n,a){super.recalculate(n,a);const h=this.paint._values["fill-outline-color"];h.value.kind==="constant"&&h.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(n){return new qm(n)}queryRadius(){return Zd(this.paint.get("fill-translate"))}queryIntersectsFeature(n,a,h,p,y,v,w){return Vv(qd(n,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),v.angle,w),p)}isTileClipped(){return!0}}const iC=In([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),oC=In([{name:"a_centroid",components:2,type:"Int16"}],4),{members:aC}=iC;var Ja={},sC=D,o0=Gl;function Gl(i,n,a,h,p){this.properties={},this.extent=a,this.type=0,this._pbf=i,this._geometry=-1,this._keys=h,this._values=p,i.readFields(lC,this,n)}function lC(i,n,a){i==1?n.id=a.readVarint():i==2?function(h,p){for(var y=h.readVarint()+h.pos;h.pos<y;){var v=p._keys[h.readVarint()],w=p._values[h.readVarint()];p.properties[v]=w}}(a,n):i==3?n.type=a.readVarint():i==4&&(n._geometry=a.pos)}function uC(i){for(var n,a,h=0,p=0,y=i.length,v=y-1;p<y;v=p++)h+=((a=i[v]).x-(n=i[p]).x)*(n.y+a.y);return h}Gl.types=["Unknown","Point","LineString","Polygon"],Gl.prototype.loadGeometry=function(){var i=this._pbf;i.pos=this._geometry;for(var n,a=i.readVarint()+i.pos,h=1,p=0,y=0,v=0,w=[];i.pos<a;){if(p<=0){var T=i.readVarint();h=7&T,p=T>>3}if(p--,h===1||h===2)y+=i.readSVarint(),v+=i.readSVarint(),h===1&&(n&&w.push(n),n=[]),n.push(new sC(y,v));else{if(h!==7)throw new Error("unknown command "+h);n&&n.push(n[0].clone())}}return n&&w.push(n),w},Gl.prototype.bbox=function(){var i=this._pbf;i.pos=this._geometry;for(var n=i.readVarint()+i.pos,a=1,h=0,p=0,y=0,v=1/0,w=-1/0,T=1/0,k=-1/0;i.pos<n;){if(h<=0){var A=i.readVarint();a=7&A,h=A>>3}if(h--,a===1||a===2)(p+=i.readSVarint())<v&&(v=p),p>w&&(w=p),(y+=i.readSVarint())<T&&(T=y),y>k&&(k=y);else if(a!==7)throw new Error("unknown command "+a)}return[v,T,w,k]},Gl.prototype.toGeoJSON=function(i,n,a){var h,p,y=this.extent*Math.pow(2,a),v=this.extent*i,w=this.extent*n,T=this.loadGeometry(),k=Gl.types[this.type];function A(j){for(var q=0;q<j.length;q++){var X=j[q];j[q]=[360*(X.x+v)/y-180,360/Math.PI*Math.atan(Math.exp((180-360*(X.y+w)/y)*Math.PI/180))-90]}}switch(this.type){case 1:var R=[];for(h=0;h<T.length;h++)R[h]=T[h][0];A(T=R);break;case 2:for(h=0;h<T.length;h++)A(T[h]);break;case 3:for(T=function(j){var q=j.length;if(q<=1)return[j];for(var X,re,se=[],ye=0;ye<q;ye++){var pe=uC(j[ye]);pe!==0&&(re===void 0&&(re=pe<0),re===pe<0?(X&&se.push(X),X=[j[ye]]):X.push(j[ye]))}return X&&se.push(X),se}(T),h=0;h<T.length;h++)for(p=0;p<T[h].length;p++)A(T[h][p])}T.length===1?T=T[0]:k="Multi"+k;var V={type:"Feature",geometry:{type:k,coordinates:T},properties:this.properties};return"id"in this&&(V.id=this.id),V};var cC=o0,a0=s0;function s0(i,n){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=i,this._keys=[],this._values=[],this._features=[],i.readFields(hC,this,n),this.length=this._features.length}function hC(i,n,a){i===15?n.version=a.readVarint():i===1?n.name=a.readString():i===5?n.extent=a.readVarint():i===2?n._features.push(a.pos):i===3?n._keys.push(a.readString()):i===4&&n._values.push(function(h){for(var p=null,y=h.readVarint()+h.pos;h.pos<y;){var v=h.readVarint()>>3;p=v===1?h.readString():v===2?h.readFloat():v===3?h.readDouble():v===4?h.readVarint64():v===5?h.readVarint():v===6?h.readSVarint():v===7?h.readBoolean():null}return p}(a))}s0.prototype.feature=function(i){if(i<0||i>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[i];var n=this._pbf.readVarint()+this._pbf.pos;return new cC(this._pbf,n,this.extent,this._keys,this._values)};var dC=a0;function pC(i,n,a){if(i===3){var h=new dC(a,a.readVarint()+a.pos);h.length&&(n[h.name]=h)}}Ja.VectorTile=function(i,n){this.layers=i.readFields(pC,{},n)},Ja.VectorTileFeature=o0,Ja.VectorTileLayer=a0;const fC=Ja.VectorTileFeature.types,Gm=Math.pow(2,13);function Bc(i,n,a,h,p,y,v,w){i.emplaceBack(n,a,2*Math.floor(h*Gm)+v,p*Gm*2,y*Gm*2,Math.round(w))}class Hm{constructor(n){this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(a=>a.id),this.index=n.index,this.hasPattern=!1,this.layoutVertexArray=new Ge,this.centroidVertexArray=new Ve,this.indexArray=new gr,this.programConfigurations=new Mo(n.layers,n.zoom),this.segments=new _n,this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id)}populate(n,a,h){this.features=[],this.hasPattern=jm("fill-extrusion",this.layers,a);for(const{feature:p,id:y,index:v,sourceLayerIndex:w}of n){const T=this.layers[0]._featureFilter.needGeometry,k=js(p,T);if(!this.layers[0]._featureFilter.filter(new yn(this.zoom),k,h))continue;const A={id:y,sourceLayerIndex:w,index:v,geometry:T?k.geometry:$s(p),properties:p.properties,type:p.type,patterns:{}};this.hasPattern?this.features.push(Zm("fill-extrusion",this.layers,A,this.zoom,a)):this.addFeature(A,A.geometry,v,h,{}),a.featureIndex.insert(p,A.geometry,v,w,this.index,!0)}}addFeatures(n,a,h){for(const p of this.features){const{geometry:y}=p;this.addFeature(p,y,p.index,a,h)}}update(n,a,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(n,a,this.stateDependentLayers,h)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,aC),this.centroidVertexBuffer=n.createVertexBuffer(this.centroidVertexArray,oC.members,!0),this.indexBuffer=n.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(n,a,h,p,y){const v={x:0,y:0,vertexCount:0};for(const w of $m(a,500)){let T=0;for(const q of w)T+=q.length;let k=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const q of w){if(q.length===0||gC(q))continue;let X=0;for(let re=0;re<q.length;re++){const se=q[re];if(re>=1){const ye=q[re-1];if(!mC(se,ye)){k.vertexLength+4>_n.MAX_VERTEX_ARRAY_LENGTH&&(k=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const pe=se.sub(ye)._perp()._unit(),ve=ye.dist(se);X+ve>32768&&(X=0),Bc(this.layoutVertexArray,se.x,se.y,pe.x,pe.y,0,0,X),Bc(this.layoutVertexArray,se.x,se.y,pe.x,pe.y,0,1,X),v.x+=2*se.x,v.y+=2*se.y,v.vertexCount+=2,X+=ve,Bc(this.layoutVertexArray,ye.x,ye.y,pe.x,pe.y,0,0,X),Bc(this.layoutVertexArray,ye.x,ye.y,pe.x,pe.y,0,1,X),v.x+=2*ye.x,v.y+=2*ye.y,v.vertexCount+=2;const Te=k.vertexLength;this.indexArray.emplaceBack(Te,Te+2,Te+1),this.indexArray.emplaceBack(Te+1,Te+2,Te+3),k.vertexLength+=4,k.primitiveLength+=2}}}}if(k.vertexLength+T>_n.MAX_VERTEX_ARRAY_LENGTH&&(k=this.segments.prepareSegment(T,this.layoutVertexArray,this.indexArray)),fC[n.type]!=="Polygon")continue;const A=[],R=[],V=k.vertexLength;for(const q of w)if(q.length!==0){q!==w[0]&&R.push(A.length/2);for(let X=0;X<q.length;X++){const re=q[X];Bc(this.layoutVertexArray,re.x,re.y,0,0,1,1,0),v.x+=re.x,v.y+=re.y,v.vertexCount+=1,A.push(re.x),A.push(re.y)}}const j=t0(A,R);for(let q=0;q<j.length;q+=3)this.indexArray.emplaceBack(V+j[q],V+j[q+2],V+j[q+1]);k.primitiveLength+=j.length/3,k.vertexLength+=T}for(let w=0;w<v.vertexCount;w++)this.centroidVertexArray.emplaceBack(Math.floor(v.x/v.vertexCount),Math.floor(v.y/v.vertexCount));this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,h,y,p)}}function mC(i,n){return i.x===n.x&&(i.x<0||i.x>Kn)||i.y===n.y&&(i.y<0||i.y>Kn)}function gC(i){return i.every(n=>n.x<0)||i.every(n=>n.x>Kn)||i.every(n=>n.y<0)||i.every(n=>n.y>Kn)}let l0;Je("FillExtrusionBucket",Hm,{omit:["layers","features"]});var yC={get paint(){return l0=l0||new Vn({"fill-extrusion-opacity":new st(Ae["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new mt(Ae["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new st(Ae["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new st(Ae["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Vs(Ae["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new mt(Ae["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new mt(Ae["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new st(Ae["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class _C extends ki{constructor(n){super(n,yC)}createBucket(n){return new Hm(n)}queryRadius(){return Zd(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(n,a,h,p,y,v,w,T){const k=qd(n,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),v.angle,w),A=this.paint.get("fill-extrusion-height").evaluate(a,h),R=this.paint.get("fill-extrusion-base").evaluate(a,h),V=function(q,X,re,se){const ye=[];for(const pe of q){const ve=[pe.x,pe.y,0,1];Gd(ve,ve,X),ye.push(new U(ve[0]/ve[3],ve[1]/ve[3]))}return ye}(k,T),j=function(q,X,re,se){const ye=[],pe=[],ve=se[8]*X,Te=se[9]*X,De=se[10]*X,Xe=se[11]*X,it=se[8]*re,We=se[9]*re,He=se[10]*re,$e=se[11]*re;for(const tt of q){const qe=[],Fe=[];for(const pt of tt){const at=pt.x,Lt=pt.y,vn=se[0]*at+se[4]*Lt+se[12],Sn=se[1]*at+se[5]*Lt+se[13],or=se[2]*at+se[6]*Lt+se[14],Pi=se[3]*at+se[7]*Lt+se[15],Kr=or+De,Xn=Pi+Xe,_r=vn+it,Er=Sn+We,Xr=or+He,Yr=Pi+$e,ar=new U((vn+ve)/Xn,(Sn+Te)/Xn);ar.z=Kr/Xn,qe.push(ar);const sr=new U(_r/Yr,Er/Yr);sr.z=Xr/Yr,Fe.push(sr)}ye.push(qe),pe.push(Fe)}return[ye,pe]}(p,R,A,T);return function(q,X,re){let se=1/0;Vv(re,X)&&(se=u0(re,X[0]));for(let ye=0;ye<X.length;ye++){const pe=X[ye],ve=q[ye];for(let Te=0;Te<pe.length-1;Te++){const De=pe[Te],Xe=[De,pe[Te+1],ve[Te+1],ve[Te],De];Bv(re,Xe)&&(se=Math.min(se,u0(re,Xe)))}}return se!==1/0&&se}(j[0],j[1],V)}}function Vc(i,n){return i.x*n.x+i.y*n.y}function u0(i,n){if(i.length===1){let a=0;const h=n[a++];let p;for(;!p||h.equals(p);)if(p=n[a++],!p)return 1/0;for(;a<n.length;a++){const y=n[a],v=i[0],w=p.sub(h),T=y.sub(h),k=v.sub(h),A=Vc(w,w),R=Vc(w,T),V=Vc(T,T),j=Vc(k,w),q=Vc(k,T),X=A*V-R*R,re=(V*j-R*q)/X,se=(A*q-R*j)/X,ye=h.z*(1-re-se)+p.z*re+y.z*se;if(isFinite(ye))return ye}return 1/0}{let a=1/0;for(const h of n)a=Math.min(a,h.z);return a}}const vC=In([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:xC}=vC,wC=In([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:bC}=wC,SC=Ja.VectorTileFeature.types,TC=Math.cos(Math.PI/180*37.5),c0=Math.pow(2,14)/.5;class Wm{constructor(n){this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(a=>a.id),this.index=n.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(a=>{this.gradients[a.id]={}}),this.layoutVertexArray=new gt,this.layoutVertexArray2=new ot,this.indexArray=new gr,this.programConfigurations=new Mo(n.layers,n.zoom),this.segments=new _n,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id)}populate(n,a,h){this.hasPattern=jm("line",this.layers,a);const p=this.layers[0].layout.get("line-sort-key"),y=!p.isConstant(),v=[];for(const{feature:w,id:T,index:k,sourceLayerIndex:A}of n){const R=this.layers[0]._featureFilter.needGeometry,V=js(w,R);if(!this.layers[0]._featureFilter.filter(new yn(this.zoom),V,h))continue;const j=y?p.evaluate(V,{},h):void 0,q={id:T,properties:w.properties,type:w.type,sourceLayerIndex:A,index:k,geometry:R?V.geometry:$s(w),patterns:{},sortKey:j};v.push(q)}y&&v.sort((w,T)=>w.sortKey-T.sortKey);for(const w of v){const{geometry:T,index:k,sourceLayerIndex:A}=w;if(this.hasPattern){const R=Zm("line",this.layers,w,this.zoom,a);this.patternFeatures.push(R)}else this.addFeature(w,T,k,h,{});a.featureIndex.insert(n[k].feature,T,k,A,this.index)}}update(n,a,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(n,a,this.stateDependentLayers,h)}addFeatures(n,a,h){for(const p of this.patternFeatures)this.addFeature(p,p.geometry,p.index,a,h)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=n.createVertexBuffer(this.layoutVertexArray2,bC)),this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,xC),this.indexBuffer=n.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(n){if(n.properties&&Object.prototype.hasOwnProperty.call(n.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(n.properties,"mapbox_clip_end"))return{start:+n.properties.mapbox_clip_start,end:+n.properties.mapbox_clip_end}}addFeature(n,a,h,p,y){const v=this.layers[0].layout,w=v.get("line-join").evaluate(n,{}),T=v.get("line-cap"),k=v.get("line-miter-limit"),A=v.get("line-round-limit");this.lineClips=this.lineFeatureClips(n);for(const R of a)this.addLine(R,n,w,T,k,A);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,h,y,p)}addLine(n,a,h,p,y,v){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let se=0;se<n.length-1;se++)this.totalDistance+=n[se].dist(n[se+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const w=SC[a.type]==="Polygon";let T=n.length;for(;T>=2&&n[T-1].equals(n[T-2]);)T--;let k=0;for(;k<T-1&&n[k].equals(n[k+1]);)k++;if(T<(w?3:2))return;h==="bevel"&&(y=1.05);const A=this.overscaling<=16?15*Kn/(512*this.overscaling):0,R=this.segments.prepareSegment(10*T,this.layoutVertexArray,this.indexArray);let V,j,q,X,re;this.e1=this.e2=-1,w&&(V=n[T-2],re=n[k].sub(V)._unit()._perp());for(let se=k;se<T;se++){if(q=se===T-1?w?n[k+1]:void 0:n[se+1],q&&n[se].equals(q))continue;re&&(X=re),V&&(j=V),V=n[se],re=q?q.sub(V)._unit()._perp():X,X=X||re;let ye=X.add(re);ye.x===0&&ye.y===0||ye._unit();const pe=X.x*re.x+X.y*re.y,ve=ye.x*re.x+ye.y*re.y,Te=ve!==0?1/ve:1/0,De=2*Math.sqrt(2-2*ve),Xe=ve<TC&&j&&q,it=X.x*re.y-X.y*re.x>0;if(Xe&&se>k){const $e=V.dist(j);if($e>2*A){const tt=V.sub(V.sub(j)._mult(A/$e)._round());this.updateDistance(j,tt),this.addCurrentVertex(tt,X,0,0,R),j=tt}}const We=j&&q;let He=We?h:w?"butt":p;if(We&&He==="round"&&(Te<v?He="miter":Te<=2&&(He="fakeround")),He==="miter"&&Te>y&&(He="bevel"),He==="bevel"&&(Te>2&&(He="flipbevel"),Te<y&&(He="miter")),j&&this.updateDistance(j,V),He==="miter")ye._mult(Te),this.addCurrentVertex(V,ye,0,0,R);else if(He==="flipbevel"){if(Te>100)ye=re.mult(-1);else{const $e=Te*X.add(re).mag()/X.sub(re).mag();ye._perp()._mult($e*(it?-1:1))}this.addCurrentVertex(V,ye,0,0,R),this.addCurrentVertex(V,ye.mult(-1),0,0,R)}else if(He==="bevel"||He==="fakeround"){const $e=-Math.sqrt(Te*Te-1),tt=it?$e:0,qe=it?0:$e;if(j&&this.addCurrentVertex(V,X,tt,qe,R),He==="fakeround"){const Fe=Math.round(180*De/Math.PI/20);for(let pt=1;pt<Fe;pt++){let at=pt/Fe;if(at!==.5){const vn=at-.5;at+=at*vn*(at-1)*((1.0904+pe*(pe*(3.55645-1.43519*pe)-3.2452))*vn*vn+(.848013+pe*(.215638*pe-1.06021)))}const Lt=re.sub(X)._mult(at)._add(X)._unit()._mult(it?-1:1);this.addHalfVertex(V,Lt.x,Lt.y,!1,it,0,R)}}q&&this.addCurrentVertex(V,re,-tt,-qe,R)}else if(He==="butt")this.addCurrentVertex(V,ye,0,0,R);else if(He==="square"){const $e=j?1:-1;this.addCurrentVertex(V,ye,$e,$e,R)}else He==="round"&&(j&&(this.addCurrentVertex(V,X,0,0,R),this.addCurrentVertex(V,X,1,1,R,!0)),q&&(this.addCurrentVertex(V,re,-1,-1,R,!0),this.addCurrentVertex(V,re,0,0,R)));if(Xe&&se<T-1){const $e=V.dist(q);if($e>2*A){const tt=V.add(q.sub(V)._mult(A/$e)._round());this.updateDistance(V,tt),this.addCurrentVertex(tt,re,0,0,R),V=tt}}}}addCurrentVertex(n,a,h,p,y,v=!1){const w=a.y*p-a.x,T=-a.y-a.x*p;this.addHalfVertex(n,a.x+a.y*h,a.y-a.x*h,v,!1,h,y),this.addHalfVertex(n,w,T,v,!0,-p,y),this.distance>c0/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(n,a,h,p,y,v))}addHalfVertex({x:n,y:a},h,p,y,v,w,T){const k=.5*(this.lineClips?this.scaledDistance*(c0-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((n<<1)+(y?1:0),(a<<1)+(v?1:0),Math.round(63*h)+128,Math.round(63*p)+128,1+(w===0?0:w<0?-1:1)|(63&k)<<2,k>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const A=T.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,A),T.primitiveLength++),v?this.e2=A:this.e1=A}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(n,a){this.distance+=n.dist(a),this.updateScaledDistance()}}let h0,d0;Je("LineBucket",Wm,{omit:["layers","patternFeatures"]});var p0={get paint(){return d0=d0||new Vn({"line-opacity":new mt(Ae.paint_line["line-opacity"]),"line-color":new mt(Ae.paint_line["line-color"]),"line-translate":new st(Ae.paint_line["line-translate"]),"line-translate-anchor":new st(Ae.paint_line["line-translate-anchor"]),"line-width":new mt(Ae.paint_line["line-width"]),"line-gap-width":new mt(Ae.paint_line["line-gap-width"]),"line-offset":new mt(Ae.paint_line["line-offset"]),"line-blur":new mt(Ae.paint_line["line-blur"]),"line-dasharray":new bc(Ae.paint_line["line-dasharray"]),"line-pattern":new Vs(Ae.paint_line["line-pattern"]),"line-gradient":new Sc(Ae.paint_line["line-gradient"])})},get layout(){return h0=h0||new Vn({"line-cap":new st(Ae.layout_line["line-cap"]),"line-join":new mt(Ae.layout_line["line-join"]),"line-miter-limit":new st(Ae.layout_line["line-miter-limit"]),"line-round-limit":new st(Ae.layout_line["line-round-limit"]),"line-sort-key":new mt(Ae.layout_line["line-sort-key"])})}};class CC extends mt{possiblyEvaluate(n,a){return a=new yn(Math.floor(a.zoom),{now:a.now,fadeDuration:a.fadeDuration,zoomHistory:a.zoomHistory,transition:a.transition}),super.possiblyEvaluate(n,a)}evaluate(n,a,h,p){return a=Me({},a,{zoom:Math.floor(a.zoom)}),super.evaluate(n,a,h,p)}}let Yd;class EC extends ki{constructor(n){super(n,p0),this.gradientVersion=0,Yd||(Yd=new CC(p0.paint.properties["line-width"].specification),Yd.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(n){if(n==="line-gradient"){const a=this.gradientExpression();this.stepInterpolant=!!function(h){return h._styleExpression!==void 0}(a)&&a._styleExpression.expression instanceof Wo,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(n,a){super.recalculate(n,a),this.paint._values["line-floorwidth"]=Yd.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,n)}createBucket(n){return new Wm(n)}queryRadius(n){const a=n,h=f0(Ac("line-width",this,a),Ac("line-gap-width",this,a)),p=Ac("line-offset",this,a);return h/2+Math.abs(p)+Zd(this.paint.get("line-translate"))}queryIntersectsFeature(n,a,h,p,y,v,w){const T=qd(n,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),v.angle,w),k=w/2*f0(this.paint.get("line-width").evaluate(a,h),this.paint.get("line-gap-width").evaluate(a,h)),A=this.paint.get("line-offset").evaluate(a,h);return A&&(p=function(R,V){const j=[];for(let q=0;q<R.length;q++){const X=R[q],re=[];for(let se=0;se<X.length;se++){const ye=X[se-1],pe=X[se],ve=X[se+1],Te=se===0?new U(0,0):pe.sub(ye)._unit()._perp(),De=se===X.length-1?new U(0,0):ve.sub(pe)._unit()._perp(),Xe=Te._add(De)._unit(),it=Xe.x*De.x+Xe.y*De.y;it!==0&&Xe._mult(1/it),re.push(Xe._mult(V)._add(pe))}j.push(re)}return j}(p,A*w)),function(R,V,j){for(let q=0;q<V.length;q++){const X=V[q];if(R.length>=3){for(let re=0;re<X.length;re++)if(jl(R,X[re]))return!0}if(zT(R,X,j))return!0}return!1}(T,p,k)}isTileClipped(){return!0}}function f0(i,n){return n>0?n+2*i:i}const IC=In([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),kC=In([{name:"a_projected_pos",components:3,type:"Float32"}],4);In([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const MC=In([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]);In([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const m0=In([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),PC=In([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function AC(i,n,a){return i.sections.forEach(h=>{h.text=function(p,y,v){const w=y.layout.get("text-transform").evaluate(v,{});return w==="uppercase"?p=p.toLocaleUpperCase():w==="lowercase"&&(p=p.toLocaleLowerCase()),ci.applyArabicShaping&&(p=ci.applyArabicShaping(p)),p}(h.text,n,a)}),i}In([{name:"triangle",components:3,type:"Uint16"}]),In([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),In([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),In([{type:"Float32",name:"offsetX"}]),In([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),In([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const Nc={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂"};var ir=24,g0=sn,y0=function(i,n,a,h,p){var y,v,w=8*p-h-1,T=(1<<w)-1,k=T>>1,A=-7,R=a?p-1:0,V=a?-1:1,j=i[n+R];for(R+=V,y=j&(1<<-A)-1,j>>=-A,A+=w;A>0;y=256*y+i[n+R],R+=V,A-=8);for(v=y&(1<<-A)-1,y>>=-A,A+=h;A>0;v=256*v+i[n+R],R+=V,A-=8);if(y===0)y=1-k;else{if(y===T)return v?NaN:1/0*(j?-1:1);v+=Math.pow(2,h),y-=k}return(j?-1:1)*v*Math.pow(2,y-h)},_0=function(i,n,a,h,p,y){var v,w,T,k=8*y-p-1,A=(1<<k)-1,R=A>>1,V=p===23?Math.pow(2,-24)-Math.pow(2,-77):0,j=h?0:y-1,q=h?1:-1,X=n<0||n===0&&1/n<0?1:0;for(n=Math.abs(n),isNaN(n)||n===1/0?(w=isNaN(n)?1:0,v=A):(v=Math.floor(Math.log(n)/Math.LN2),n*(T=Math.pow(2,-v))<1&&(v--,T*=2),(n+=v+R>=1?V/T:V*Math.pow(2,1-R))*T>=2&&(v++,T/=2),v+R>=A?(w=0,v=A):v+R>=1?(w=(n*T-1)*Math.pow(2,p),v+=R):(w=n*Math.pow(2,R-1)*Math.pow(2,p),v=0));p>=8;i[a+j]=255&w,j+=q,w/=256,p-=8);for(v=v<<p|w,k+=p;k>0;i[a+j]=255&v,j+=q,v/=256,k-=8);i[a+j-q]|=128*X};function sn(i){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(i)?i:new Uint8Array(i||0),this.pos=0,this.type=0,this.length=this.buf.length}sn.Varint=0,sn.Fixed64=1,sn.Bytes=2,sn.Fixed32=5;var Km=4294967296,v0=1/Km,x0=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function wa(i){return i.type===sn.Bytes?i.readVarint()+i.pos:i.pos+1}function Hl(i,n,a){return a?4294967296*n+(i>>>0):4294967296*(n>>>0)+(i>>>0)}function w0(i,n,a){var h=n<=16383?1:n<=2097151?2:n<=268435455?3:Math.floor(Math.log(n)/(7*Math.LN2));a.realloc(h);for(var p=a.pos-1;p>=i;p--)a.buf[p+h]=a.buf[p]}function zC(i,n){for(var a=0;a<i.length;a++)n.writeVarint(i[a])}function DC(i,n){for(var a=0;a<i.length;a++)n.writeSVarint(i[a])}function LC(i,n){for(var a=0;a<i.length;a++)n.writeFloat(i[a])}function RC(i,n){for(var a=0;a<i.length;a++)n.writeDouble(i[a])}function FC(i,n){for(var a=0;a<i.length;a++)n.writeBoolean(i[a])}function OC(i,n){for(var a=0;a<i.length;a++)n.writeFixed32(i[a])}function BC(i,n){for(var a=0;a<i.length;a++)n.writeSFixed32(i[a])}function VC(i,n){for(var a=0;a<i.length;a++)n.writeFixed64(i[a])}function NC(i,n){for(var a=0;a<i.length;a++)n.writeSFixed64(i[a])}function Jd(i,n){return(i[n]|i[n+1]<<8|i[n+2]<<16)+16777216*i[n+3]}function Wl(i,n,a){i[a]=n,i[a+1]=n>>>8,i[a+2]=n>>>16,i[a+3]=n>>>24}function b0(i,n){return(i[n]|i[n+1]<<8|i[n+2]<<16)+(i[n+3]<<24)}sn.prototype={destroy:function(){this.buf=null},readFields:function(i,n,a){for(a=a||this.length;this.pos<a;){var h=this.readVarint(),p=h>>3,y=this.pos;this.type=7&h,i(p,n,this),this.pos===y&&this.skip(h)}return n},readMessage:function(i,n){return this.readFields(i,n,this.readVarint()+this.pos)},readFixed32:function(){var i=Jd(this.buf,this.pos);return this.pos+=4,i},readSFixed32:function(){var i=b0(this.buf,this.pos);return this.pos+=4,i},readFixed64:function(){var i=Jd(this.buf,this.pos)+Jd(this.buf,this.pos+4)*Km;return this.pos+=8,i},readSFixed64:function(){var i=Jd(this.buf,this.pos)+b0(this.buf,this.pos+4)*Km;return this.pos+=8,i},readFloat:function(){var i=y0(this.buf,this.pos,!0,23,4);return this.pos+=4,i},readDouble:function(){var i=y0(this.buf,this.pos,!0,52,8);return this.pos+=8,i},readVarint:function(i){var n,a,h=this.buf;return n=127&(a=h[this.pos++]),a<128?n:(n|=(127&(a=h[this.pos++]))<<7,a<128?n:(n|=(127&(a=h[this.pos++]))<<14,a<128?n:(n|=(127&(a=h[this.pos++]))<<21,a<128?n:function(p,y,v){var w,T,k=v.buf;if(w=(112&(T=k[v.pos++]))>>4,T<128||(w|=(127&(T=k[v.pos++]))<<3,T<128)||(w|=(127&(T=k[v.pos++]))<<10,T<128)||(w|=(127&(T=k[v.pos++]))<<17,T<128)||(w|=(127&(T=k[v.pos++]))<<24,T<128)||(w|=(1&(T=k[v.pos++]))<<31,T<128))return Hl(p,w,y);throw new Error("Expected varint not more than 10 bytes")}(n|=(15&(a=h[this.pos]))<<28,i,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var i=this.readVarint();return i%2==1?(i+1)/-2:i/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var i=this.readVarint()+this.pos,n=this.pos;return this.pos=i,i-n>=12&&x0?function(a,h,p){return x0.decode(a.subarray(h,p))}(this.buf,n,i):function(a,h,p){for(var y="",v=h;v<p;){var w,T,k,A=a[v],R=null,V=A>239?4:A>223?3:A>191?2:1;if(v+V>p)break;V===1?A<128&&(R=A):V===2?(192&(w=a[v+1]))==128&&(R=(31&A)<<6|63&w)<=127&&(R=null):V===3?(T=a[v+2],(192&(w=a[v+1]))==128&&(192&T)==128&&((R=(15&A)<<12|(63&w)<<6|63&T)<=2047||R>=55296&&R<=57343)&&(R=null)):V===4&&(T=a[v+2],k=a[v+3],(192&(w=a[v+1]))==128&&(192&T)==128&&(192&k)==128&&((R=(15&A)<<18|(63&w)<<12|(63&T)<<6|63&k)<=65535||R>=1114112)&&(R=null)),R===null?(R=65533,V=1):R>65535&&(R-=65536,y+=String.fromCharCode(R>>>10&1023|55296),R=56320|1023&R),y+=String.fromCharCode(R),v+=V}return y}(this.buf,n,i)},readBytes:function(){var i=this.readVarint()+this.pos,n=this.buf.subarray(this.pos,i);return this.pos=i,n},readPackedVarint:function(i,n){if(this.type!==sn.Bytes)return i.push(this.readVarint(n));var a=wa(this);for(i=i||[];this.pos<a;)i.push(this.readVarint(n));return i},readPackedSVarint:function(i){if(this.type!==sn.Bytes)return i.push(this.readSVarint());var n=wa(this);for(i=i||[];this.pos<n;)i.push(this.readSVarint());return i},readPackedBoolean:function(i){if(this.type!==sn.Bytes)return i.push(this.readBoolean());var n=wa(this);for(i=i||[];this.pos<n;)i.push(this.readBoolean());return i},readPackedFloat:function(i){if(this.type!==sn.Bytes)return i.push(this.readFloat());var n=wa(this);for(i=i||[];this.pos<n;)i.push(this.readFloat());return i},readPackedDouble:function(i){if(this.type!==sn.Bytes)return i.push(this.readDouble());var n=wa(this);for(i=i||[];this.pos<n;)i.push(this.readDouble());return i},readPackedFixed32:function(i){if(this.type!==sn.Bytes)return i.push(this.readFixed32());var n=wa(this);for(i=i||[];this.pos<n;)i.push(this.readFixed32());return i},readPackedSFixed32:function(i){if(this.type!==sn.Bytes)return i.push(this.readSFixed32());var n=wa(this);for(i=i||[];this.pos<n;)i.push(this.readSFixed32());return i},readPackedFixed64:function(i){if(this.type!==sn.Bytes)return i.push(this.readFixed64());var n=wa(this);for(i=i||[];this.pos<n;)i.push(this.readFixed64());return i},readPackedSFixed64:function(i){if(this.type!==sn.Bytes)return i.push(this.readSFixed64());var n=wa(this);for(i=i||[];this.pos<n;)i.push(this.readSFixed64());return i},skip:function(i){var n=7&i;if(n===sn.Varint)for(;this.buf[this.pos++]>127;);else if(n===sn.Bytes)this.pos=this.readVarint()+this.pos;else if(n===sn.Fixed32)this.pos+=4;else{if(n!==sn.Fixed64)throw new Error("Unimplemented type: "+n);this.pos+=8}},writeTag:function(i,n){this.writeVarint(i<<3|n)},realloc:function(i){for(var n=this.length||16;n<this.pos+i;)n*=2;if(n!==this.length){var a=new Uint8Array(n);a.set(this.buf),this.buf=a,this.length=n}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(i){this.realloc(4),Wl(this.buf,i,this.pos),this.pos+=4},writeSFixed32:function(i){this.realloc(4),Wl(this.buf,i,this.pos),this.pos+=4},writeFixed64:function(i){this.realloc(8),Wl(this.buf,-1&i,this.pos),Wl(this.buf,Math.floor(i*v0),this.pos+4),this.pos+=8},writeSFixed64:function(i){this.realloc(8),Wl(this.buf,-1&i,this.pos),Wl(this.buf,Math.floor(i*v0),this.pos+4),this.pos+=8},writeVarint:function(i){(i=+i||0)>268435455||i<0?function(n,a){var h,p;if(n>=0?(h=n%4294967296|0,p=n/4294967296|0):(p=~(-n/4294967296),4294967295^(h=~(-n%4294967296))?h=h+1|0:(h=0,p=p+1|0)),n>=18446744073709552e3||n<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");a.realloc(10),function(y,v,w){w.buf[w.pos++]=127&y|128,y>>>=7,w.buf[w.pos++]=127&y|128,y>>>=7,w.buf[w.pos++]=127&y|128,y>>>=7,w.buf[w.pos++]=127&y|128,w.buf[w.pos]=127&(y>>>=7)}(h,0,a),function(y,v){var w=(7&y)<<4;v.buf[v.pos++]|=w|((y>>>=3)?128:0),y&&(v.buf[v.pos++]=127&y|((y>>>=7)?128:0),y&&(v.buf[v.pos++]=127&y|((y>>>=7)?128:0),y&&(v.buf[v.pos++]=127&y|((y>>>=7)?128:0),y&&(v.buf[v.pos++]=127&y|((y>>>=7)?128:0),y&&(v.buf[v.pos++]=127&y)))))}(p,a)}(i,this):(this.realloc(4),this.buf[this.pos++]=127&i|(i>127?128:0),i<=127||(this.buf[this.pos++]=127&(i>>>=7)|(i>127?128:0),i<=127||(this.buf[this.pos++]=127&(i>>>=7)|(i>127?128:0),i<=127||(this.buf[this.pos++]=i>>>7&127))))},writeSVarint:function(i){this.writeVarint(i<0?2*-i-1:2*i)},writeBoolean:function(i){this.writeVarint(!!i)},writeString:function(i){i=String(i),this.realloc(4*i.length),this.pos++;var n=this.pos;this.pos=function(h,p,y){for(var v,w,T=0;T<p.length;T++){if((v=p.charCodeAt(T))>55295&&v<57344){if(!w){v>56319||T+1===p.length?(h[y++]=239,h[y++]=191,h[y++]=189):w=v;continue}if(v<56320){h[y++]=239,h[y++]=191,h[y++]=189,w=v;continue}v=w-55296<<10|v-56320|65536,w=null}else w&&(h[y++]=239,h[y++]=191,h[y++]=189,w=null);v<128?h[y++]=v:(v<2048?h[y++]=v>>6|192:(v<65536?h[y++]=v>>12|224:(h[y++]=v>>18|240,h[y++]=v>>12&63|128),h[y++]=v>>6&63|128),h[y++]=63&v|128)}return y}(this.buf,i,this.pos);var a=this.pos-n;a>=128&&w0(n,a,this),this.pos=n-1,this.writeVarint(a),this.pos+=a},writeFloat:function(i){this.realloc(4),_0(this.buf,i,this.pos,!0,23,4),this.pos+=4},writeDouble:function(i){this.realloc(8),_0(this.buf,i,this.pos,!0,52,8),this.pos+=8},writeBytes:function(i){var n=i.length;this.writeVarint(n),this.realloc(n);for(var a=0;a<n;a++)this.buf[this.pos++]=i[a]},writeRawMessage:function(i,n){this.pos++;var a=this.pos;i(n,this);var h=this.pos-a;h>=128&&w0(a,h,this),this.pos=a-1,this.writeVarint(h),this.pos+=h},writeMessage:function(i,n,a){this.writeTag(i,sn.Bytes),this.writeRawMessage(n,a)},writePackedVarint:function(i,n){n.length&&this.writeMessage(i,zC,n)},writePackedSVarint:function(i,n){n.length&&this.writeMessage(i,DC,n)},writePackedBoolean:function(i,n){n.length&&this.writeMessage(i,FC,n)},writePackedFloat:function(i,n){n.length&&this.writeMessage(i,LC,n)},writePackedDouble:function(i,n){n.length&&this.writeMessage(i,RC,n)},writePackedFixed32:function(i,n){n.length&&this.writeMessage(i,OC,n)},writePackedSFixed32:function(i,n){n.length&&this.writeMessage(i,BC,n)},writePackedFixed64:function(i,n){n.length&&this.writeMessage(i,VC,n)},writePackedSFixed64:function(i,n){n.length&&this.writeMessage(i,NC,n)},writeBytesField:function(i,n){this.writeTag(i,sn.Bytes),this.writeBytes(n)},writeFixed32Field:function(i,n){this.writeTag(i,sn.Fixed32),this.writeFixed32(n)},writeSFixed32Field:function(i,n){this.writeTag(i,sn.Fixed32),this.writeSFixed32(n)},writeFixed64Field:function(i,n){this.writeTag(i,sn.Fixed64),this.writeFixed64(n)},writeSFixed64Field:function(i,n){this.writeTag(i,sn.Fixed64),this.writeSFixed64(n)},writeVarintField:function(i,n){this.writeTag(i,sn.Varint),this.writeVarint(n)},writeSVarintField:function(i,n){this.writeTag(i,sn.Varint),this.writeSVarint(n)},writeStringField:function(i,n){this.writeTag(i,sn.Bytes),this.writeString(n)},writeFloatField:function(i,n){this.writeTag(i,sn.Fixed32),this.writeFloat(n)},writeDoubleField:function(i,n){this.writeTag(i,sn.Fixed64),this.writeDouble(n)},writeBooleanField:function(i,n){this.writeVarintField(i,!!n)}};var Xm=I(g0);const Ym=3;function UC(i,n,a){i===1&&a.readMessage($C,n)}function $C(i,n,a){if(i===3){const{id:h,bitmap:p,width:y,height:v,left:w,top:T,advance:k}=a.readMessage(jC,{});n.push({id:h,bitmap:new Dc({width:y+2*Ym,height:v+2*Ym},p),metrics:{width:y,height:v,left:w,top:T,advance:k}})}}function jC(i,n,a){i===1?n.id=a.readVarint():i===2?n.bitmap=a.readBytes():i===3?n.width=a.readVarint():i===4?n.height=a.readVarint():i===5?n.left=a.readSVarint():i===6?n.top=a.readSVarint():i===7&&(n.advance=a.readVarint())}const S0=Ym;function T0(i){let n=0,a=0;for(const v of i)n+=v.w*v.h,a=Math.max(a,v.w);i.sort((v,w)=>w.h-v.h);const h=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(n/.95)),a),h:1/0}];let p=0,y=0;for(const v of i)for(let w=h.length-1;w>=0;w--){const T=h[w];if(!(v.w>T.w||v.h>T.h)){if(v.x=T.x,v.y=T.y,y=Math.max(y,v.y+v.h),p=Math.max(p,v.x+v.w),v.w===T.w&&v.h===T.h){const k=h.pop();w<h.length&&(h[w]=k)}else v.h===T.h?(T.x+=v.w,T.w-=v.w):v.w===T.w?(T.y+=v.h,T.h-=v.h):(h.push({x:T.x+v.w,y:T.y,w:T.w-v.w,h:v.h}),T.y+=v.h,T.h-=v.h);break}}return{w:p,h:y,fill:n/(p*y)||0}}const di=1;class Jm{constructor(n,{pixelRatio:a,version:h,stretchX:p,stretchY:y,content:v}){this.paddedRect=n,this.pixelRatio=a,this.stretchX=p,this.stretchY=y,this.content=v,this.version=h}get tl(){return[this.paddedRect.x+di,this.paddedRect.y+di]}get br(){return[this.paddedRect.x+this.paddedRect.w-di,this.paddedRect.y+this.paddedRect.h-di]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2*di)/this.pixelRatio,(this.paddedRect.h-2*di)/this.pixelRatio]}}class C0{constructor(n,a){const h={},p={};this.haveRenderCallbacks=[];const y=[];this.addImages(n,h,y),this.addImages(a,p,y);const{w:v,h:w}=T0(y),T=new Ni({width:v||1,height:w||1});for(const k in n){const A=n[k],R=h[k].paddedRect;Ni.copy(A.data,T,{x:0,y:0},{x:R.x+di,y:R.y+di},A.data)}for(const k in a){const A=a[k],R=p[k].paddedRect,V=R.x+di,j=R.y+di,q=A.data.width,X=A.data.height;Ni.copy(A.data,T,{x:0,y:0},{x:V,y:j},A.data),Ni.copy(A.data,T,{x:0,y:X-1},{x:V,y:j-1},{width:q,height:1}),Ni.copy(A.data,T,{x:0,y:0},{x:V,y:j+X},{width:q,height:1}),Ni.copy(A.data,T,{x:q-1,y:0},{x:V-1,y:j},{width:1,height:X}),Ni.copy(A.data,T,{x:0,y:0},{x:V+q,y:j},{width:1,height:X})}this.image=T,this.iconPositions=h,this.patternPositions=p}addImages(n,a,h){for(const p in n){const y=n[p],v={x:0,y:0,w:y.data.width+2*di,h:y.data.height+2*di};h.push(v),a[p]=new Jm(v,y),y.hasRenderCallback&&this.haveRenderCallbacks.push(p)}}patchUpdatedImages(n,a){n.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const h in n.updatedImages)this.patchUpdatedImage(this.iconPositions[h],n.getImage(h),a),this.patchUpdatedImage(this.patternPositions[h],n.getImage(h),a)}patchUpdatedImage(n,a,h){if(!n||!a||n.version===a.version)return;n.version=a.version;const[p,y]=n.tl;h.update(a.data,void 0,{x:p,y})}}var Qa;Je("ImagePosition",Jm),Je("ImageAtlas",C0),u.ai=void 0,(Qa=u.ai||(u.ai={}))[Qa.none=0]="none",Qa[Qa.horizontal=1]="horizontal",Qa[Qa.vertical=2]="vertical",Qa[Qa.horizontalOnly=3]="horizontalOnly";const Uc=-17;class $c{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(n,a){const h=new $c;return h.scale=n||1,h.fontStack=a,h}static forImage(n){const a=new $c;return a.imageName=n,a}}class Kl{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(n,a){const h=new Kl;for(let p=0;p<n.sections.length;p++){const y=n.sections[p];y.image?h.addImageSection(y):h.addTextSection(y,a)}return h}length(){return this.text.length}getSection(n){return this.sections[this.sectionIndex[n]]}getSectionIndex(n){return this.sectionIndex[n]}getCharCode(n){return this.text.charCodeAt(n)}verticalizePunctuation(){this.text=function(n){let a="";for(let h=0;h<n.length;h++){const p=n.charCodeAt(h+1)||null,y=n.charCodeAt(h-1)||null;a+=p&&Dd(p)&&!Nc[n[h+1]]||y&&Dd(y)&&!Nc[n[h-1]]||!Nc[n[h]]?n[h]:Nc[n[h]]}return a}(this.text)}trim(){let n=0;for(let h=0;h<this.text.length&&ep[this.text.charCodeAt(h)];h++)n++;let a=this.text.length;for(let h=this.text.length-1;h>=0&&h>=n&&ep[this.text.charCodeAt(h)];h--)a--;this.text=this.text.substring(n,a),this.sectionIndex=this.sectionIndex.slice(n,a)}substring(n,a){const h=new Kl;return h.text=this.text.substring(n,a),h.sectionIndex=this.sectionIndex.slice(n,a),h.sections=this.sections,h}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((n,a)=>Math.max(n,this.sections[a].scale),0)}addTextSection(n,a){this.text+=n.text,this.sections.push($c.forText(n.scale,n.fontStack||a));const h=this.sections.length-1;for(let p=0;p<n.text.length;++p)this.sectionIndex.push(h)}addImageSection(n){const a=n.image?n.image.name:"";if(a.length===0)return void Ft("Can't add FormattedSection with an empty image.");const h=this.getNextImageSectionCharCode();h?(this.text+=String.fromCharCode(h),this.sections.push($c.forImage(a)),this.sectionIndex.push(this.sections.length-1)):Ft("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Qd(i,n,a,h,p,y,v,w,T,k,A,R,V,j,q,X){const re=Kl.fromFeature(i,p);let se;R===u.ai.vertical&&re.verticalizePunctuation();const{processBidirectionalText:ye,processStyledBidirectionalText:pe}=ci;if(ye&&re.sections.length===1){se=[];const De=ye(re.toString(),Qm(re,k,y,n,h,j,q));for(const Xe of De){const it=new Kl;it.text=Xe,it.sections=re.sections;for(let We=0;We<Xe.length;We++)it.sectionIndex.push(0);se.push(it)}}else if(pe){se=[];const De=pe(re.text,re.sectionIndex,Qm(re,k,y,n,h,j,q));for(const Xe of De){const it=new Kl;it.text=Xe[0],it.sectionIndex=Xe[1],it.sections=re.sections,se.push(it)}}else se=function(De,Xe){const it=[],We=De.text;let He=0;for(const $e of Xe)it.push(De.substring(He,$e)),He=$e;return He<We.length&&it.push(De.substring(He,We.length)),it}(re,Qm(re,k,y,n,h,j,q));const ve=[],Te={positionedLines:ve,text:re.toString(),top:A[1],bottom:A[1],left:A[0],right:A[0],writingMode:R,iconsInText:!1,verticalizable:!1};return function(De,Xe,it,We,He,$e,tt,qe,Fe,pt,at,Lt){let vn=0,Sn=Uc,or=0,Pi=0;const Kr=qe==="right"?1:qe==="left"?0:.5;let Xn=0;for(const ar of He){ar.trim();const sr=ar.getMaxScale(),Rr=(sr-1)*ir,Jr={positionedGlyphs:[],lineOffset:0};De.positionedLines[Xn]=Jr;const Fr=Jr.positionedGlyphs;let pi=0;if(!ar.length()){Sn+=$e,++Xn;continue}for(let lr=0;lr<ar.length();lr++){const jt=ar.getSection(lr),Or=ar.getSectionIndex(lr),Ir=ar.getCharCode(lr);let ur=0,ho=null,Po=null,Ao=null,ba=ir;const po=!(Fe===u.ai.horizontal||!at&&!fc(Ir)||at&&(ep[Ir]||(_r=Ir,Ke.Arabic(_r)||Ke["Arabic Supplement"](_r)||Ke["Arabic Extended-A"](_r)||Ke["Arabic Presentation Forms-A"](_r)||Ke["Arabic Presentation Forms-B"](_r))));if(jt.imageName){const $i=We[jt.imageName];if(!$i)continue;Ao=jt.imageName,De.iconsInText=De.iconsInText||!0,Po=$i.paddedRect;const mi=$i.displaySize;jt.scale=jt.scale*ir/Lt,ho={width:mi[0],height:mi[1],left:di,top:-S0,advance:po?mi[1]:mi[0]},ur=Rr+(ir-mi[1]*jt.scale),ba=ho.advance;const Sa=po?mi[0]*jt.scale-ir*sr:mi[1]*jt.scale-ir*sr;Sa>0&&Sa>pi&&(pi=Sa)}else{const $i=it[jt.fontStack],mi=$i&&$i[Ir];if(mi&&mi.rect)Po=mi.rect,ho=mi.metrics;else{const Sa=Xe[jt.fontStack],Hc=Sa&&Sa[Ir];if(!Hc)continue;ho=Hc.metrics}ur=(sr-jt.scale)*ir}po?(De.verticalizable=!0,Fr.push({glyph:Ir,imageName:Ao,x:vn,y:Sn+ur,vertical:po,scale:jt.scale,fontStack:jt.fontStack,sectionIndex:Or,metrics:ho,rect:Po}),vn+=ba*jt.scale+pt):(Fr.push({glyph:Ir,imageName:Ao,x:vn,y:Sn+ur,vertical:po,scale:jt.scale,fontStack:jt.fontStack,sectionIndex:Or,metrics:ho,rect:Po}),vn+=ho.advance*jt.scale+pt)}Fr.length!==0&&(or=Math.max(vn-pt,or),GC(Fr,0,Fr.length-1,Kr,pi)),vn=0;const fi=$e*sr+pi;Jr.lineOffset=Math.max(pi,Rr),Sn+=fi,Pi=Math.max(fi,Pi),++Xn}var _r;const Er=Sn-Uc,{horizontalAlign:Xr,verticalAlign:Yr}=eg(tt);(function(ar,sr,Rr,Jr,Fr,pi,fi,lr,jt){const Or=(sr-Rr)*Fr;let Ir=0;Ir=pi!==fi?-lr*Jr-Uc:(-Jr*jt+.5)*fi;for(const ur of ar)for(const ho of ur.positionedGlyphs)ho.x+=Or,ho.y+=Ir})(De.positionedLines,Kr,Xr,Yr,or,Pi,$e,Er,He.length),De.top+=-Yr*Er,De.bottom=De.top+Er,De.left+=-Xr*or,De.right=De.left+or}(Te,n,a,h,se,v,w,T,R,k,V,X),!function(De){for(const Xe of De)if(Xe.positionedGlyphs.length!==0)return!1;return!0}(ve)&&Te}const ep={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},ZC={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function E0(i,n,a,h,p,y){if(n.imageName){const v=h[n.imageName];return v?v.displaySize[0]*n.scale*ir/y+p:0}{const v=a[n.fontStack],w=v&&v[i];return w?w.metrics.advance*n.scale+p:0}}function I0(i,n,a,h){const p=Math.pow(i-n,2);return h?i<n?p/2:2*p:p+Math.abs(a)*a}function qC(i,n,a){let h=0;return i===10&&(h-=1e4),a&&(h+=150),i!==40&&i!==65288||(h+=50),n!==41&&n!==65289||(h+=50),h}function k0(i,n,a,h,p,y){let v=null,w=I0(n,a,p,y);for(const T of h){const k=I0(n-T.x,a,p,y)+T.badness;k<=w&&(v=T,w=k)}return{index:i,x:n,priorBreak:v,badness:w}}function M0(i){return i?M0(i.priorBreak).concat(i.index):[]}function Qm(i,n,a,h,p,y,v){if(y!=="point")return[];if(!i)return[];const w=[],T=function(V,j,q,X,re,se){let ye=0;for(let pe=0;pe<V.length();pe++){const ve=V.getSection(pe);ye+=E0(V.getCharCode(pe),ve,X,re,j,se)}return ye/Math.max(1,Math.ceil(ye/q))}(i,n,a,h,p,v),k=i.text.indexOf("​")>=0;let A=0;for(let V=0;V<i.length();V++){const j=i.getSection(V),q=i.getCharCode(V);if(ep[q]||(A+=E0(q,j,h,p,n,v)),V<i.length()-1){const X=!((R=q)<11904||!(Ke["Bopomofo Extended"](R)||Ke.Bopomofo(R)||Ke["CJK Compatibility Forms"](R)||Ke["CJK Compatibility Ideographs"](R)||Ke["CJK Compatibility"](R)||Ke["CJK Radicals Supplement"](R)||Ke["CJK Strokes"](R)||Ke["CJK Symbols and Punctuation"](R)||Ke["CJK Unified Ideographs Extension A"](R)||Ke["CJK Unified Ideographs"](R)||Ke["Enclosed CJK Letters and Months"](R)||Ke["Halfwidth and Fullwidth Forms"](R)||Ke.Hiragana(R)||Ke["Ideographic Description Characters"](R)||Ke["Kangxi Radicals"](R)||Ke["Katakana Phonetic Extensions"](R)||Ke.Katakana(R)||Ke["Vertical Forms"](R)||Ke["Yi Radicals"](R)||Ke["Yi Syllables"](R)));(ZC[q]||X||j.imageName)&&w.push(k0(V+1,A,T,w,qC(q,i.getCharCode(V+1),X&&k),!1))}}var R;return M0(k0(i.length(),A,T,w,0,!0))}function eg(i){let n=.5,a=.5;switch(i){case"right":case"top-right":case"bottom-right":n=1;break;case"left":case"top-left":case"bottom-left":n=0}switch(i){case"bottom":case"bottom-right":case"bottom-left":a=1;break;case"top":case"top-right":case"top-left":a=0}return{horizontalAlign:n,verticalAlign:a}}function GC(i,n,a,h,p){if(!h&&!p)return;const y=i[a],v=(i[a].x+y.metrics.advance*y.scale)*h;for(let w=n;w<=a;w++)i[w].x-=v,i[w].y+=p}function HC(i,n,a){const{horizontalAlign:h,verticalAlign:p}=eg(a),y=n[0]-i.displaySize[0]*h,v=n[1]-i.displaySize[1]*p;return{image:i,top:v,bottom:v+i.displaySize[1],left:y,right:y+i.displaySize[0]}}function P0(i,n,a,h,p,y){const v=i.image;let w;if(v.content){const re=v.content,se=v.pixelRatio||1;w=[re[0]/se,re[1]/se,v.displaySize[0]-re[2]/se,v.displaySize[1]-re[3]/se]}const T=n.left*y,k=n.right*y;let A,R,V,j;a==="width"||a==="both"?(j=p[0]+T-h[3],R=p[0]+k+h[1]):(j=p[0]+(T+k-v.displaySize[0])/2,R=j+v.displaySize[0]);const q=n.top*y,X=n.bottom*y;return a==="height"||a==="both"?(A=p[1]+q-h[0],V=p[1]+X+h[2]):(A=p[1]+(q+X-v.displaySize[1])/2,V=A+v.displaySize[1]),{image:v,top:A,right:R,bottom:V,left:j,collisionPadding:w}}const jc=255,Qo=128,es=jc*Qo;function A0(i,n){const{expression:a}=n;if(a.kind==="constant")return{kind:"constant",layoutSize:a.evaluate(new yn(i+1))};if(a.kind==="source")return{kind:"source"};{const{zoomStops:h,interpolationType:p}=a;let y=0;for(;y<h.length&&h[y]<=i;)y++;y=Math.max(0,y-1);let v=y;for(;v<h.length&&h[v]<i+1;)v++;v=Math.min(h.length-1,v);const w=h[y],T=h[v];return a.kind==="composite"?{kind:"composite",minZoom:w,maxZoom:T,interpolationType:p}:{kind:"camera",minZoom:w,maxZoom:T,minSize:a.evaluate(new yn(w)),maxSize:a.evaluate(new yn(T)),interpolationType:p}}}function tg(i,n,a){let h="never";const p=i.get(n);return p?h=p:i.get(a)&&(h="always"),h}const WC=Ja.VectorTileFeature.types,KC=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function tp(i,n,a,h,p,y,v,w,T,k,A,R,V){const j=w?Math.min(es,Math.round(w[0])):0,q=w?Math.min(es,Math.round(w[1])):0;i.emplaceBack(n,a,Math.round(32*h),Math.round(32*p),y,v,(j<<1)+(T?1:0),q,16*k,16*A,256*R,256*V)}function ng(i,n,a){i.emplaceBack(n.x,n.y,a),i.emplaceBack(n.x,n.y,a),i.emplaceBack(n.x,n.y,a),i.emplaceBack(n.x,n.y,a)}function XC(i){for(const n of i.sections)if(km(n.text))return!0;return!1}class rg{constructor(n){this.layoutVertexArray=new Vt,this.indexArray=new gr,this.programConfigurations=n,this.segments=new _n,this.dynamicLayoutVertexArray=new At,this.opacityVertexArray=new $t,this.hasVisibleVertices=!1,this.placedSymbolArray=new me}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(n,a,h,p){this.isEmpty()||(h&&(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,IC.members),this.indexBuffer=n.createIndexBuffer(this.indexArray,a),this.dynamicLayoutVertexBuffer=n.createVertexBuffer(this.dynamicLayoutVertexArray,kC.members,!0),this.opacityVertexBuffer=n.createVertexBuffer(this.opacityVertexArray,KC,!0),this.opacityVertexBuffer.itemSize=1),(h||p)&&this.programConfigurations.upload(n))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}Je("SymbolBuffers",rg);class ig{constructor(n,a,h){this.layoutVertexArray=new n,this.layoutAttributes=a,this.indexArray=new h,this.segments=new _n,this.collisionVertexArray=new pn}upload(n){this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=n.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=n.createVertexBuffer(this.collisionVertexArray,MC.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}Je("CollisionBuffers",ig);class Xl{constructor(n){this.collisionBoxArray=n.collisionBoxArray,this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(v=>v.id),this.index=n.index,this.pixelRatio=n.pixelRatio,this.sourceLayerIndex=n.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Rm([]),this.placementViewportMatrix=Rm([]);const a=this.layers[0]._unevaluatedLayout._values;this.textSizeData=A0(this.zoom,a["text-size"]),this.iconSizeData=A0(this.zoom,a["icon-size"]);const h=this.layers[0].layout,p=h.get("symbol-sort-key"),y=h.get("symbol-z-order");this.canOverlap=tg(h,"text-overlap","text-allow-overlap")!=="never"||tg(h,"icon-overlap","icon-allow-overlap")!=="never"||h.get("text-ignore-placement")||h.get("icon-ignore-placement"),this.sortFeaturesByKey=y!=="viewport-y"&&!p.isConstant(),this.sortFeaturesByY=(y==="viewport-y"||y==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,h.get("symbol-placement")==="point"&&(this.writingModes=h.get("text-writing-mode").map(v=>u.ai[v])),this.stateDependentLayerIds=this.layers.filter(v=>v.isStateDependent()).map(v=>v.id),this.sourceID=n.sourceID}createArrays(){this.text=new rg(new Mo(this.layers,this.zoom,n=>/^text/.test(n))),this.icon=new rg(new Mo(this.layers,this.zoom,n=>/^icon/.test(n))),this.glyphOffsetArray=new ge,this.lineVertexArray=new Ee,this.symbolInstances=new ie,this.textAnchorOffsets=new ze}calculateGlyphDependencies(n,a,h,p,y){for(let v=0;v<n.length;v++)if(a[n.charCodeAt(v)]=!0,(h||p)&&y){const w=Nc[n.charAt(v)];w&&(a[w.charCodeAt(0)]=!0)}}populate(n,a,h){const p=this.layers[0],y=p.layout,v=y.get("text-font"),w=y.get("text-field"),T=y.get("icon-image"),k=(w.value.kind!=="constant"||w.value.value instanceof Sr&&!w.value.value.isEmpty()||w.value.value.toString().length>0)&&(v.value.kind!=="constant"||v.value.value.length>0),A=T.value.kind!=="constant"||!!T.value.value||Object.keys(T.parameters).length>0,R=y.get("symbol-sort-key");if(this.features=[],!k&&!A)return;const V=a.iconDependencies,j=a.glyphDependencies,q=a.availableImages,X=new yn(this.zoom);for(const{feature:re,id:se,index:ye,sourceLayerIndex:pe}of n){const ve=p._featureFilter.needGeometry,Te=js(re,ve);if(!p._featureFilter.filter(X,Te,h))continue;let De,Xe;if(ve||(Te.geometry=$s(re)),k){const We=p.getValueAndResolveTokens("text-field",Te,h,q),He=Sr.factory(We);XC(He)&&(this.hasRTLText=!0),(!this.hasRTLText||xc()==="unavailable"||this.hasRTLText&&ci.isParsed())&&(De=AC(He,p,Te))}if(A){const We=p.getValueAndResolveTokens("icon-image",Te,h,q);Xe=We instanceof mr?We:mr.fromString(We)}if(!De&&!Xe)continue;const it=this.sortFeaturesByKey?R.evaluate(Te,{},h):void 0;if(this.features.push({id:se,text:De,icon:Xe,index:ye,sourceLayerIndex:pe,geometry:Te.geometry,properties:re.properties,type:WC[re.type],sortKey:it}),Xe&&(V[Xe.name]=!0),De){const We=v.evaluate(Te,{},h).join(","),He=y.get("text-rotation-alignment")!=="viewport"&&y.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(u.ai.vertical)>=0;for(const $e of De.sections)if($e.image)V[$e.image.name]=!0;else{const tt=dc(De.toString()),qe=$e.fontStack||We,Fe=j[qe]=j[qe]||{};this.calculateGlyphDependencies($e.text,Fe,He,this.allowVerticalPlacement,tt)}}}y.get("symbol-placement")==="line"&&(this.features=function(re){const se={},ye={},pe=[];let ve=0;function Te(We){pe.push(re[We]),ve++}function De(We,He,$e){const tt=ye[We];return delete ye[We],ye[He]=tt,pe[tt].geometry[0].pop(),pe[tt].geometry[0]=pe[tt].geometry[0].concat($e[0]),tt}function Xe(We,He,$e){const tt=se[He];return delete se[He],se[We]=tt,pe[tt].geometry[0].shift(),pe[tt].geometry[0]=$e[0].concat(pe[tt].geometry[0]),tt}function it(We,He,$e){const tt=$e?He[0][He[0].length-1]:He[0][0];return`${We}:${tt.x}:${tt.y}`}for(let We=0;We<re.length;We++){const He=re[We],$e=He.geometry,tt=He.text?He.text.toString():null;if(!tt){Te(We);continue}const qe=it(tt,$e),Fe=it(tt,$e,!0);if(qe in ye&&Fe in se&&ye[qe]!==se[Fe]){const pt=Xe(qe,Fe,$e),at=De(qe,Fe,pe[pt].geometry);delete se[qe],delete ye[Fe],ye[it(tt,pe[at].geometry,!0)]=at,pe[pt].geometry=null}else qe in ye?De(qe,Fe,$e):Fe in se?Xe(qe,Fe,$e):(Te(We),se[qe]=ve-1,ye[Fe]=ve-1)}return pe.filter(We=>We.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((re,se)=>re.sortKey-se.sortKey)}update(n,a,h){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(n,a,this.layers,h),this.icon.programConfigurations.updatePaintArrays(n,a,this.layers,h))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(n){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(n),this.iconCollisionBox.upload(n)),this.text.upload(n,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(n,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(n,a){const h=this.lineVertexArray.length;if(n.segment!==void 0){let p=n.dist(a[n.segment+1]),y=n.dist(a[n.segment]);const v={};for(let w=n.segment+1;w<a.length;w++)v[w]={x:a[w].x,y:a[w].y,tileUnitDistanceFromAnchor:p},w<a.length-1&&(p+=a[w+1].dist(a[w]));for(let w=n.segment||0;w>=0;w--)v[w]={x:a[w].x,y:a[w].y,tileUnitDistanceFromAnchor:y},w>0&&(y+=a[w-1].dist(a[w]));for(let w=0;w<a.length;w++){const T=v[w];this.lineVertexArray.emplaceBack(T.x,T.y,T.tileUnitDistanceFromAnchor)}}return{lineStartIndex:h,lineLength:this.lineVertexArray.length-h}}addSymbols(n,a,h,p,y,v,w,T,k,A,R,V){const j=n.indexArray,q=n.layoutVertexArray,X=n.segments.prepareSegment(4*a.length,q,j,this.canOverlap?v.sortKey:void 0),re=this.glyphOffsetArray.length,se=X.vertexLength,ye=this.allowVerticalPlacement&&w===u.ai.vertical?Math.PI/2:0,pe=v.text&&v.text.sections;for(let ve=0;ve<a.length;ve++){const{tl:Te,tr:De,bl:Xe,br:it,tex:We,pixelOffsetTL:He,pixelOffsetBR:$e,minFontScaleX:tt,minFontScaleY:qe,glyphOffset:Fe,isSDF:pt,sectionIndex:at}=a[ve],Lt=X.vertexLength,vn=Fe[1];tp(q,T.x,T.y,Te.x,vn+Te.y,We.x,We.y,h,pt,He.x,He.y,tt,qe),tp(q,T.x,T.y,De.x,vn+De.y,We.x+We.w,We.y,h,pt,$e.x,He.y,tt,qe),tp(q,T.x,T.y,Xe.x,vn+Xe.y,We.x,We.y+We.h,h,pt,He.x,$e.y,tt,qe),tp(q,T.x,T.y,it.x,vn+it.y,We.x+We.w,We.y+We.h,h,pt,$e.x,$e.y,tt,qe),ng(n.dynamicLayoutVertexArray,T,ye),j.emplaceBack(Lt,Lt+1,Lt+2),j.emplaceBack(Lt+1,Lt+2,Lt+3),X.vertexLength+=4,X.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Fe[0]),ve!==a.length-1&&at===a[ve+1].sectionIndex||n.programConfigurations.populatePaintArrays(q.length,v,v.index,{},V,pe&&pe[at])}n.placedSymbolArray.emplaceBack(T.x,T.y,re,this.glyphOffsetArray.length-re,se,k,A,T.segment,h?h[0]:0,h?h[1]:0,p[0],p[1],w,0,!1,0,R)}_addCollisionDebugVertex(n,a,h,p,y,v){return a.emplaceBack(0,0),n.emplaceBack(h.x,h.y,p,y,Math.round(v.x),Math.round(v.y))}addCollisionDebugVertices(n,a,h,p,y,v,w){const T=y.segments.prepareSegment(4,y.layoutVertexArray,y.indexArray),k=T.vertexLength,A=y.layoutVertexArray,R=y.collisionVertexArray,V=w.anchorX,j=w.anchorY;this._addCollisionDebugVertex(A,R,v,V,j,new U(n,a)),this._addCollisionDebugVertex(A,R,v,V,j,new U(h,a)),this._addCollisionDebugVertex(A,R,v,V,j,new U(h,p)),this._addCollisionDebugVertex(A,R,v,V,j,new U(n,p)),T.vertexLength+=4;const q=y.indexArray;q.emplaceBack(k,k+1),q.emplaceBack(k+1,k+2),q.emplaceBack(k+2,k+3),q.emplaceBack(k+3,k),T.primitiveLength+=4}addDebugCollisionBoxes(n,a,h,p){for(let y=n;y<a;y++){const v=this.collisionBoxArray.get(y);this.addCollisionDebugVertices(v.x1,v.y1,v.x2,v.y2,p?this.textCollisionBox:this.iconCollisionBox,v.anchorPoint,h)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new ig(Rn,m0.members,nr),this.iconCollisionBox=new ig(Rn,m0.members,nr);for(let n=0;n<this.symbolInstances.length;n++){const a=this.symbolInstances.get(n);this.addDebugCollisionBoxes(a.textBoxStartIndex,a.textBoxEndIndex,a,!0),this.addDebugCollisionBoxes(a.verticalTextBoxStartIndex,a.verticalTextBoxEndIndex,a,!0),this.addDebugCollisionBoxes(a.iconBoxStartIndex,a.iconBoxEndIndex,a,!1),this.addDebugCollisionBoxes(a.verticalIconBoxStartIndex,a.verticalIconBoxEndIndex,a,!1)}}_deserializeCollisionBoxesForSymbol(n,a,h,p,y,v,w,T,k){const A={};for(let R=a;R<h;R++){const V=n.get(R);A.textBox={x1:V.x1,y1:V.y1,x2:V.x2,y2:V.y2,anchorPointX:V.anchorPointX,anchorPointY:V.anchorPointY},A.textFeatureIndex=V.featureIndex;break}for(let R=p;R<y;R++){const V=n.get(R);A.verticalTextBox={x1:V.x1,y1:V.y1,x2:V.x2,y2:V.y2,anchorPointX:V.anchorPointX,anchorPointY:V.anchorPointY},A.verticalTextFeatureIndex=V.featureIndex;break}for(let R=v;R<w;R++){const V=n.get(R);A.iconBox={x1:V.x1,y1:V.y1,x2:V.x2,y2:V.y2,anchorPointX:V.anchorPointX,anchorPointY:V.anchorPointY},A.iconFeatureIndex=V.featureIndex;break}for(let R=T;R<k;R++){const V=n.get(R);A.verticalIconBox={x1:V.x1,y1:V.y1,x2:V.x2,y2:V.y2,anchorPointX:V.anchorPointX,anchorPointY:V.anchorPointY},A.verticalIconFeatureIndex=V.featureIndex;break}return A}deserializeCollisionBoxes(n){this.collisionArrays=[];for(let a=0;a<this.symbolInstances.length;a++){const h=this.symbolInstances.get(a);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(n,h.textBoxStartIndex,h.textBoxEndIndex,h.verticalTextBoxStartIndex,h.verticalTextBoxEndIndex,h.iconBoxStartIndex,h.iconBoxEndIndex,h.verticalIconBoxStartIndex,h.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(n,a){const h=n.placedSymbolArray.get(a),p=h.vertexStartIndex+4*h.numGlyphs;for(let y=h.vertexStartIndex;y<p;y+=4)n.indexArray.emplaceBack(y,y+1,y+2),n.indexArray.emplaceBack(y+1,y+2,y+3)}getSortedSymbolIndexes(n){if(this.sortedAngle===n&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const a=Math.sin(n),h=Math.cos(n),p=[],y=[],v=[];for(let w=0;w<this.symbolInstances.length;++w){v.push(w);const T=this.symbolInstances.get(w);p.push(0|Math.round(a*T.anchorX+h*T.anchorY)),y.push(T.featureIndex)}return v.sort((w,T)=>p[w]-p[T]||y[T]-y[w]),v}addToSortKeyRanges(n,a){const h=this.sortKeyRanges[this.sortKeyRanges.length-1];h&&h.sortKey===a?h.symbolInstanceEnd=n+1:this.sortKeyRanges.push({sortKey:a,symbolInstanceStart:n,symbolInstanceEnd:n+1})}sortFeatures(n){if(this.sortFeaturesByY&&this.sortedAngle!==n&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(n),this.sortedAngle=n,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const a of this.symbolInstanceIndexes){const h=this.symbolInstances.get(a);this.featureSortOrder.push(h.featureIndex),[h.rightJustifiedTextSymbolIndex,h.centerJustifiedTextSymbolIndex,h.leftJustifiedTextSymbolIndex].forEach((p,y,v)=>{p>=0&&v.indexOf(p)===y&&this.addIndicesForPlacedSymbol(this.text,p)}),h.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,h.verticalPlacedTextSymbolIndex),h.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,h.placedIconSymbolIndex),h.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,h.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let z0,D0;Je("SymbolBucket",Xl,{omit:["layers","collisionBoxArray","features","compareText"]}),Xl.MAX_GLYPHS=65535,Xl.addDynamicAttributes=ng;var og={get paint(){return D0=D0||new Vn({"icon-opacity":new mt(Ae.paint_symbol["icon-opacity"]),"icon-color":new mt(Ae.paint_symbol["icon-color"]),"icon-halo-color":new mt(Ae.paint_symbol["icon-halo-color"]),"icon-halo-width":new mt(Ae.paint_symbol["icon-halo-width"]),"icon-halo-blur":new mt(Ae.paint_symbol["icon-halo-blur"]),"icon-translate":new st(Ae.paint_symbol["icon-translate"]),"icon-translate-anchor":new st(Ae.paint_symbol["icon-translate-anchor"]),"text-opacity":new mt(Ae.paint_symbol["text-opacity"]),"text-color":new mt(Ae.paint_symbol["text-color"],{runtimeType:fr,getOverride:i=>i.textColor,hasOverride:i=>!!i.textColor}),"text-halo-color":new mt(Ae.paint_symbol["text-halo-color"]),"text-halo-width":new mt(Ae.paint_symbol["text-halo-width"]),"text-halo-blur":new mt(Ae.paint_symbol["text-halo-blur"]),"text-translate":new st(Ae.paint_symbol["text-translate"]),"text-translate-anchor":new st(Ae.paint_symbol["text-translate-anchor"])})},get layout(){return z0=z0||new Vn({"symbol-placement":new st(Ae.layout_symbol["symbol-placement"]),"symbol-spacing":new st(Ae.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new st(Ae.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new mt(Ae.layout_symbol["symbol-sort-key"]),"symbol-z-order":new st(Ae.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new st(Ae.layout_symbol["icon-allow-overlap"]),"icon-overlap":new st(Ae.layout_symbol["icon-overlap"]),"icon-ignore-placement":new st(Ae.layout_symbol["icon-ignore-placement"]),"icon-optional":new st(Ae.layout_symbol["icon-optional"]),"icon-rotation-alignment":new st(Ae.layout_symbol["icon-rotation-alignment"]),"icon-size":new mt(Ae.layout_symbol["icon-size"]),"icon-text-fit":new st(Ae.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new st(Ae.layout_symbol["icon-text-fit-padding"]),"icon-image":new mt(Ae.layout_symbol["icon-image"]),"icon-rotate":new mt(Ae.layout_symbol["icon-rotate"]),"icon-padding":new mt(Ae.layout_symbol["icon-padding"]),"icon-keep-upright":new st(Ae.layout_symbol["icon-keep-upright"]),"icon-offset":new mt(Ae.layout_symbol["icon-offset"]),"icon-anchor":new mt(Ae.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new st(Ae.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new st(Ae.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new st(Ae.layout_symbol["text-rotation-alignment"]),"text-field":new mt(Ae.layout_symbol["text-field"]),"text-font":new mt(Ae.layout_symbol["text-font"]),"text-size":new mt(Ae.layout_symbol["text-size"]),"text-max-width":new mt(Ae.layout_symbol["text-max-width"]),"text-line-height":new st(Ae.layout_symbol["text-line-height"]),"text-letter-spacing":new mt(Ae.layout_symbol["text-letter-spacing"]),"text-justify":new mt(Ae.layout_symbol["text-justify"]),"text-radial-offset":new mt(Ae.layout_symbol["text-radial-offset"]),"text-variable-anchor":new st(Ae.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new mt(Ae.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new mt(Ae.layout_symbol["text-anchor"]),"text-max-angle":new st(Ae.layout_symbol["text-max-angle"]),"text-writing-mode":new st(Ae.layout_symbol["text-writing-mode"]),"text-rotate":new mt(Ae.layout_symbol["text-rotate"]),"text-padding":new st(Ae.layout_symbol["text-padding"]),"text-keep-upright":new st(Ae.layout_symbol["text-keep-upright"]),"text-transform":new mt(Ae.layout_symbol["text-transform"]),"text-offset":new mt(Ae.layout_symbol["text-offset"]),"text-allow-overlap":new st(Ae.layout_symbol["text-allow-overlap"]),"text-overlap":new st(Ae.layout_symbol["text-overlap"]),"text-ignore-placement":new st(Ae.layout_symbol["text-ignore-placement"]),"text-optional":new st(Ae.layout_symbol["text-optional"])})}};class L0{constructor(n){if(n.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=n.property.overrides?n.property.overrides.runtimeType:Si,this.defaultValue=n}evaluate(n){if(n.formattedSection){const a=this.defaultValue.property.overrides;if(a&&a.hasOverride(n.formattedSection))return a.getOverride(n.formattedSection)}return n.feature&&n.featureState?this.defaultValue.evaluate(n.feature,n.featureState):this.defaultValue.property.specification.default}eachChild(n){this.defaultValue.isConstant()||n(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Je("FormatSectionOverride",L0,{omit:["defaultValue"]});class np extends ki{constructor(n){super(n,og)}recalculate(n,a){if(super.recalculate(n,a),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const h=this.layout.get("text-writing-mode");if(h){const p=[];for(const y of h)p.indexOf(y)<0&&p.push(y);this.layout._values["text-writing-mode"]=p}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(n,a,h,p){const y=this.layout.get(n).evaluate(a,{},h,p),v=this._unevaluatedLayout._values[n];return v.isDataDriven()||Pl(v.value)||!y?y:function(w,T){return T.replace(/{([^{}]+)}/g,(k,A)=>w&&A in w?String(w[A]):"")}(a.properties,y)}createBucket(n){return new Xl(n)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const n of og.paint.overridableProperties){if(!np.hasPaintOverride(this.layout,n))continue;const a=this.paint.get(n),h=new L0(a),p=new ac(h,a.property.specification);let y=null;y=a.value.kind==="constant"||a.value.kind==="source"?new sc("source",p):new zl("composite",p,a.value.zoomStops),this.paint._values[n]=new Dr(a.property,y,a.parameters)}}_handleOverridablePaintPropertyUpdate(n,a,h){return!(!this.layout||a.isDataDriven()||h.isDataDriven())&&np.hasPaintOverride(this.layout,n)}static hasPaintOverride(n,a){const h=n.get("text-field"),p=og.paint.properties[a];let y=!1;const v=w=>{for(const T of w)if(p.overrides&&p.overrides.hasOverride(T))return void(y=!0)};if(h.value.kind==="constant"&&h.value.value instanceof Sr)v(h.value.value.sections);else if(h.value.kind==="source"){const w=k=>{y||(k instanceof ua&&Tn(k.value)===B?v(k.value.sections):k instanceof Ml?v(k.sections):k.eachChild(w))},T=h.value;T._styleExpression&&w(T._styleExpression.expression)}return y}}let R0;var YC={get paint(){return R0=R0||new Vn({"background-color":new st(Ae.paint_background["background-color"]),"background-pattern":new bc(Ae.paint_background["background-pattern"]),"background-opacity":new st(Ae.paint_background["background-opacity"])})}};class JC extends ki{constructor(n){super(n,YC)}}let F0;var QC={get paint(){return F0=F0||new Vn({"raster-opacity":new st(Ae.paint_raster["raster-opacity"]),"raster-hue-rotate":new st(Ae.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new st(Ae.paint_raster["raster-brightness-min"]),"raster-brightness-max":new st(Ae.paint_raster["raster-brightness-max"]),"raster-saturation":new st(Ae.paint_raster["raster-saturation"]),"raster-contrast":new st(Ae.paint_raster["raster-contrast"]),"raster-resampling":new st(Ae.paint_raster["raster-resampling"]),"raster-fade-duration":new st(Ae.paint_raster["raster-fade-duration"])})}};class eE extends ki{constructor(n){super(n,QC)}}class tE extends ki{constructor(n){super(n,{}),this.onAdd=a=>{this.implementation.onAdd&&this.implementation.onAdd(a,a.painter.context.gl)},this.onRemove=a=>{this.implementation.onRemove&&this.implementation.onRemove(a,a.painter.context.gl)},this.implementation=n}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class nE{constructor(n){this._callback=n,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){delete this._channel,this._callback=()=>{}}}const ag=63710088e-1;class ts{constructor(n,a){if(isNaN(n)||isNaN(a))throw new Error(`Invalid LngLat object: (${n}, ${a})`);if(this.lng=+n,this.lat=+a,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new ts(be(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(n){const a=Math.PI/180,h=this.lat*a,p=n.lat*a,y=Math.sin(h)*Math.sin(p)+Math.cos(h)*Math.cos(p)*Math.cos((n.lng-this.lng)*a);return ag*Math.acos(Math.min(y,1))}static convert(n){if(n instanceof ts)return n;if(Array.isArray(n)&&(n.length===2||n.length===3))return new ts(Number(n[0]),Number(n[1]));if(!Array.isArray(n)&&typeof n=="object"&&n!==null)return new ts(Number("lng"in n?n.lng:n.lon),Number(n.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const O0=2*Math.PI*ag;function B0(i){return O0*Math.cos(i*Math.PI/180)}function V0(i){return(180+i)/360}function N0(i){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+i*Math.PI/360)))/360}function U0(i,n){return i/B0(n)}function $0(i){return 360*i-180}function sg(i){return 360/Math.PI*Math.atan(Math.exp((180-360*i)*Math.PI/180))-90}class rp{constructor(n,a,h=0){this.x=+n,this.y=+a,this.z=+h}static fromLngLat(n,a=0){const h=ts.convert(n);return new rp(V0(h.lng),N0(h.lat),U0(a,h.lat))}toLngLat(){return new ts($0(this.x),sg(this.y))}toAltitude(){return this.z*B0(sg(this.y))}meterInMercatorCoordinateUnits(){return 1/O0*(n=sg(this.y),1/Math.cos(n*Math.PI/180));var n}}function j0(i,n,a){var h=2*Math.PI*6378137/256/Math.pow(2,a);return[i*h-2*Math.PI*6378137/2,n*h-2*Math.PI*6378137/2]}class lg{constructor(n,a,h){if(n<0||n>25||h<0||h>=Math.pow(2,n)||a<0||a>=Math.pow(2,n))throw new Error(`x=${a}, y=${h}, z=${n} outside of bounds. 0<=x<${Math.pow(2,n)}, 0<=y<${Math.pow(2,n)} 0<=z<=25 `);this.z=n,this.x=a,this.y=h,this.key=Zc(0,n,n,a,h)}equals(n){return this.z===n.z&&this.x===n.x&&this.y===n.y}url(n,a,h){const p=(v=this.y,w=this.z,T=j0(256*(y=this.x),256*(v=Math.pow(2,w)-v-1),w),k=j0(256*(y+1),256*(v+1),w),T[0]+","+T[1]+","+k[0]+","+k[1]);var y,v,w,T,k;const A=function(R,V,j){let q,X="";for(let re=R;re>0;re--)q=1<<re-1,X+=(V&q?1:0)+(j&q?2:0);return X}(this.z,this.x,this.y);return n[(this.x+this.y)%n.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(h==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,a>1?"@2x":"").replace(/{quadkey}/g,A).replace(/{bbox-epsg-3857}/g,p)}isChildOf(n){const a=this.z-n.z;return a>0&&n.x===this.x>>a&&n.y===this.y>>a}getTilePoint(n){const a=Math.pow(2,this.z);return new U((n.x*a-this.x)*Kn,(n.y*a-this.y)*Kn)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Z0{constructor(n,a){this.wrap=n,this.canonical=a,this.key=Zc(n,a.z,a.z,a.x,a.y)}}class Ui{constructor(n,a,h,p,y){if(n<h)throw new Error(`overscaledZ should be >= z; overscaledZ = ${n}; z = ${h}`);this.overscaledZ=n,this.wrap=a,this.canonical=new lg(h,+p,+y),this.key=Zc(a,n,h,p,y)}clone(){return new Ui(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(n){return this.overscaledZ===n.overscaledZ&&this.wrap===n.wrap&&this.canonical.equals(n.canonical)}scaledTo(n){if(n>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${n}; overscaledZ = ${this.overscaledZ}`);const a=this.canonical.z-n;return n>this.canonical.z?new Ui(n,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Ui(n,this.wrap,n,this.canonical.x>>a,this.canonical.y>>a)}calculateScaledKey(n,a){if(n>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${n}; overscaledZ = ${this.overscaledZ}`);const h=this.canonical.z-n;return n>this.canonical.z?Zc(this.wrap*+a,n,this.canonical.z,this.canonical.x,this.canonical.y):Zc(this.wrap*+a,n,n,this.canonical.x>>h,this.canonical.y>>h)}isChildOf(n){if(n.wrap!==this.wrap)return!1;const a=this.canonical.z-n.canonical.z;return n.overscaledZ===0||n.overscaledZ<this.overscaledZ&&n.canonical.x===this.canonical.x>>a&&n.canonical.y===this.canonical.y>>a}children(n){if(this.overscaledZ>=n)return[new Ui(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const a=this.canonical.z+1,h=2*this.canonical.x,p=2*this.canonical.y;return[new Ui(a,this.wrap,a,h,p),new Ui(a,this.wrap,a,h+1,p),new Ui(a,this.wrap,a,h,p+1),new Ui(a,this.wrap,a,h+1,p+1)]}isLessThan(n){return this.wrap<n.wrap||!(this.wrap>n.wrap)&&(this.overscaledZ<n.overscaledZ||!(this.overscaledZ>n.overscaledZ)&&(this.canonical.x<n.canonical.x||!(this.canonical.x>n.canonical.x)&&this.canonical.y<n.canonical.y))}wrapped(){return new Ui(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(n){return new Ui(this.overscaledZ,n,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Z0(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(n){return this.canonical.getTilePoint(new rp(n.x-this.wrap,n.y))}}function Zc(i,n,a,h,p){(i*=2)<0&&(i=-1*i-1);const y=1<<a;return(y*y*i+y*p+h).toString(36)+a.toString(36)+n.toString(36)}Je("CanonicalTileID",lg),Je("OverscaledTileID",Ui,{omit:["posMatrix"]});class q0{constructor(n,a,h,p=1,y=1,v=1,w=0){if(this.uid=n,a.height!==a.width)throw new RangeError("DEM tiles must be square");if(h&&!["mapbox","terrarium","custom"].includes(h))return void Ft(`"${h}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=a.height;const T=this.dim=a.height-2;switch(this.data=new Uint32Array(a.data.buffer),h){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=p,this.greenFactor=y,this.blueFactor=v,this.baseShift=w;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let k=0;k<T;k++)this.data[this._idx(-1,k)]=this.data[this._idx(0,k)],this.data[this._idx(T,k)]=this.data[this._idx(T-1,k)],this.data[this._idx(k,-1)]=this.data[this._idx(k,0)],this.data[this._idx(k,T)]=this.data[this._idx(k,T-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(T,-1)]=this.data[this._idx(T-1,0)],this.data[this._idx(-1,T)]=this.data[this._idx(0,T-1)],this.data[this._idx(T,T)]=this.data[this._idx(T-1,T-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let k=0;k<T;k++)for(let A=0;A<T;A++){const R=this.get(k,A);R>this.max&&(this.max=R),R<this.min&&(this.min=R)}}get(n,a){const h=new Uint8Array(this.data.buffer),p=4*this._idx(n,a);return this.unpack(h[p],h[p+1],h[p+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(n,a){if(n<-1||n>=this.dim+1||a<-1||a>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(a+1)*this.stride+(n+1)}unpack(n,a,h){return n*this.redFactor+a*this.greenFactor+h*this.blueFactor-this.baseShift}getPixels(){return new Ni({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(n,a,h){if(this.dim!==n.dim)throw new Error("dem dimension mismatch");let p=a*this.dim,y=a*this.dim+this.dim,v=h*this.dim,w=h*this.dim+this.dim;switch(a){case-1:p=y-1;break;case 1:y=p+1}switch(h){case-1:v=w-1;break;case 1:w=v+1}const T=-a*this.dim,k=-h*this.dim;for(let A=v;A<w;A++)for(let R=p;R<y;R++)this.data[this._idx(R,A)]=n.data[this._idx(R+T,A+k)]}}Je("DEMData",q0);class G0{constructor(n){this._stringToNumber={},this._numberToString=[];for(let a=0;a<n.length;a++){const h=n[a];this._stringToNumber[h]=a,this._numberToString[a]=h}}encode(n){return this._stringToNumber[n]}decode(n){if(n>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${n} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[n]}}class H0{constructor(n,a,h,p,y){this.type="Feature",this._vectorTileFeature=n,n._z=a,n._x=h,n._y=p,this.properties=n.properties,this.id=y}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(n){this._geometry=n}toJSON(){const n={geometry:this.geometry};for(const a in this)a!=="_geometry"&&a!=="_vectorTileFeature"&&(n[a]=this[a]);return n}}class W0{constructor(n,a){this.tileID=n,this.x=n.canonical.x,this.y=n.canonical.y,this.z=n.canonical.z,this.grid=new Ha(Kn,16,0),this.grid3D=new Ha(Kn,16,0),this.featureIndexArray=new Le,this.promoteId=a}insert(n,a,h,p,y,v){const w=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(h,p,y);const T=v?this.grid3D:this.grid;for(let k=0;k<a.length;k++){const A=a[k],R=[1/0,1/0,-1/0,-1/0];for(let V=0;V<A.length;V++){const j=A[V];R[0]=Math.min(R[0],j.x),R[1]=Math.min(R[1],j.y),R[2]=Math.max(R[2],j.x),R[3]=Math.max(R[3],j.y)}R[0]<Kn&&R[1]<Kn&&R[2]>=0&&R[3]>=0&&T.insert(w,R[0],R[1],R[2],R[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new Ja.VectorTile(new Xm(this.rawTileData)).layers,this.sourceLayerCoder=new G0(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(n,a,h,p){this.loadVTLayers();const y=n.params||{},v=Kn/n.tileSize/n.scale,w=uc(y.filter),T=n.queryGeometry,k=n.queryPadding*v,A=X0(T),R=this.grid.query(A.minX-k,A.minY-k,A.maxX+k,A.maxY+k),V=X0(n.cameraQueryGeometry),j=this.grid3D.query(V.minX-k,V.minY-k,V.maxX+k,V.maxY+k,(re,se,ye,pe)=>function(ve,Te,De,Xe,it){for(const He of ve)if(Te<=He.x&&De<=He.y&&Xe>=He.x&&it>=He.y)return!0;const We=[new U(Te,De),new U(Te,it),new U(Xe,it),new U(Xe,De)];if(ve.length>2){for(const He of We)if(jl(ve,He))return!0}for(let He=0;He<ve.length-1;He++)if(LT(ve[He],ve[He+1],We))return!0;return!1}(n.cameraQueryGeometry,re-k,se-k,ye+k,pe+k));for(const re of j)R.push(re);R.sort(rE);const q={};let X;for(let re=0;re<R.length;re++){const se=R[re];if(se===X)continue;X=se;const ye=this.featureIndexArray.get(se);let pe=null;this.loadMatchingFeature(q,ye.bucketIndex,ye.sourceLayerIndex,ye.featureIndex,w,y.layers,y.availableImages,a,h,p,(ve,Te,De)=>(pe||(pe=$s(ve)),Te.queryIntersectsFeature(T,ve,De,pe,this.z,n.transform,v,n.pixelPosMatrix)))}return q}loadMatchingFeature(n,a,h,p,y,v,w,T,k,A,R){const V=this.bucketLayerIDs[a];if(v&&!function(re,se){for(let ye=0;ye<re.length;ye++)if(se.indexOf(re[ye])>=0)return!0;return!1}(v,V))return;const j=this.sourceLayerCoder.decode(h),q=this.vtLayers[j].feature(p);if(y.needGeometry){const re=js(q,!0);if(!y.filter(new yn(this.tileID.overscaledZ),re,this.tileID.canonical))return}else if(!y.filter(new yn(this.tileID.overscaledZ),q))return;const X=this.getId(q,j);for(let re=0;re<V.length;re++){const se=V[re];if(v&&v.indexOf(se)<0)continue;const ye=T[se];if(!ye)continue;let pe={};X&&A&&(pe=A.getState(ye.sourceLayer||"_geojsonTileLayer",X));const ve=Me({},k[se]);ve.paint=K0(ve.paint,ye.paint,q,pe,w),ve.layout=K0(ve.layout,ye.layout,q,pe,w);const Te=!R||R(q,ye,pe);if(!Te)continue;const De=new H0(q,this.z,this.x,this.y,X);De.layer=ve;let Xe=n[se];Xe===void 0&&(Xe=n[se]=[]),Xe.push({featureIndex:p,feature:De,intersectionZ:Te})}}lookupSymbolFeatures(n,a,h,p,y,v,w,T){const k={};this.loadVTLayers();const A=uc(y);for(const R of n)this.loadMatchingFeature(k,h,p,R,A,v,w,T,a);return k}hasLayer(n){for(const a of this.bucketLayerIDs)for(const h of a)if(n===h)return!0;return!1}getId(n,a){let h=n.id;return this.promoteId&&(h=n.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[a]],typeof h=="boolean"&&(h=Number(h))),h}}function K0(i,n,a,h,p){return Oe(i,(y,v)=>{const w=n instanceof Ul?n.get(v):null;return w&&w.evaluate?w.evaluate(a,h,p):w})}function X0(i){let n=1/0,a=1/0,h=-1/0,p=-1/0;for(const y of i)n=Math.min(n,y.x),a=Math.min(a,y.y),h=Math.max(h,y.x),p=Math.max(p,y.y);return{minX:n,minY:a,maxX:h,maxY:p}}function rE(i,n){return n-i}function Y0(i,n,a,h,p){const y=[];for(let v=0;v<i.length;v++){const w=i[v];let T;for(let k=0;k<w.length-1;k++){let A=w[k],R=w[k+1];A.x<n&&R.x<n||(A.x<n?A=new U(n,A.y+(n-A.x)/(R.x-A.x)*(R.y-A.y))._round():R.x<n&&(R=new U(n,A.y+(n-A.x)/(R.x-A.x)*(R.y-A.y))._round()),A.y<a&&R.y<a||(A.y<a?A=new U(A.x+(a-A.y)/(R.y-A.y)*(R.x-A.x),a)._round():R.y<a&&(R=new U(A.x+(a-A.y)/(R.y-A.y)*(R.x-A.x),a)._round()),A.x>=h&&R.x>=h||(A.x>=h?A=new U(h,A.y+(h-A.x)/(R.x-A.x)*(R.y-A.y))._round():R.x>=h&&(R=new U(h,A.y+(h-A.x)/(R.x-A.x)*(R.y-A.y))._round()),A.y>=p&&R.y>=p||(A.y>=p?A=new U(A.x+(p-A.y)/(R.y-A.y)*(R.x-A.x),p)._round():R.y>=p&&(R=new U(A.x+(p-A.y)/(R.y-A.y)*(R.x-A.x),p)._round()),T&&A.equals(T[T.length-1])||(T=[A],y.push(T)),T.push(R)))))}}return y}Je("FeatureIndex",W0,{omit:["rawTileData","sourceLayerCoder"]});class ns extends U{constructor(n,a,h,p){super(n,a),this.angle=h,p!==void 0&&(this.segment=p)}clone(){return new ns(this.x,this.y,this.angle,this.segment)}}function J0(i,n,a,h,p){if(n.segment===void 0||a===0)return!0;let y=n,v=n.segment+1,w=0;for(;w>-a/2;){if(v--,v<0)return!1;w-=i[v].dist(y),y=i[v]}w+=i[v].dist(i[v+1]),v++;const T=[];let k=0;for(;w<a/2;){const A=i[v],R=i[v+1];if(!R)return!1;let V=i[v-1].angleTo(A)-A.angleTo(R);for(V=Math.abs((V+3*Math.PI)%(2*Math.PI)-Math.PI),T.push({distance:w,angleDelta:V}),k+=V;w-T[0].distance>h;)k-=T.shift().angleDelta;if(k>p)return!1;v++,w+=A.dist(R)}return!0}function Q0(i){let n=0;for(let a=0;a<i.length-1;a++)n+=i[a].dist(i[a+1]);return n}function ex(i,n,a){return i?.6*n*a:0}function tx(i,n){return Math.max(i?i.right-i.left:0,n?n.right-n.left:0)}function iE(i,n,a,h,p,y){const v=ex(a,p,y),w=tx(a,h)*y;let T=0;const k=Q0(i)/2;for(let A=0;A<i.length-1;A++){const R=i[A],V=i[A+1],j=R.dist(V);if(T+j>k){const q=(k-T)/j,X=si.number(R.x,V.x,q),re=si.number(R.y,V.y,q),se=new ns(X,re,V.angleTo(R),A);return se._round(),!v||J0(i,se,w,v,n)?se:void 0}T+=j}}function oE(i,n,a,h,p,y,v,w,T){const k=ex(h,y,v),A=tx(h,p),R=A*v,V=i[0].x===0||i[0].x===T||i[0].y===0||i[0].y===T;return n-R<n/4&&(n=R+n/4),nx(i,V?n/2*w%n:(A/2+2*y)*v*w%n,n,k,a,R,V,!1,T)}function nx(i,n,a,h,p,y,v,w,T){const k=y/2,A=Q0(i);let R=0,V=n-a,j=[];for(let q=0;q<i.length-1;q++){const X=i[q],re=i[q+1],se=X.dist(re),ye=re.angleTo(X);for(;V+a<R+se;){V+=a;const pe=(V-R)/se,ve=si.number(X.x,re.x,pe),Te=si.number(X.y,re.y,pe);if(ve>=0&&ve<T&&Te>=0&&Te<T&&V-k>=0&&V+k<=A){const De=new ns(ve,Te,ye,q);De._round(),h&&!J0(i,De,y,h,p)||j.push(De)}}R+=se}return w||j.length||v||(j=nx(i,R/2,a,h,p,y,v,!0,T)),j}Je("Anchor",ns);const Yl=di;function rx(i,n,a,h){const p=[],y=i.image,v=y.pixelRatio,w=y.paddedRect.w-2*Yl,T=y.paddedRect.h-2*Yl,k=i.right-i.left,A=i.bottom-i.top,R=y.stretchX||[[0,w]],V=y.stretchY||[[0,T]],j=($e,tt)=>$e+tt[1]-tt[0],q=R.reduce(j,0),X=V.reduce(j,0),re=w-q,se=T-X;let ye=0,pe=q,ve=0,Te=X,De=0,Xe=re,it=0,We=se;if(y.content&&h){const $e=y.content;ye=ip(R,0,$e[0]),ve=ip(V,0,$e[1]),pe=ip(R,$e[0],$e[2]),Te=ip(V,$e[1],$e[3]),De=$e[0]-ye,it=$e[1]-ve,Xe=$e[2]-$e[0]-pe,We=$e[3]-$e[1]-Te}const He=($e,tt,qe,Fe)=>{const pt=op($e.stretch-ye,pe,k,i.left),at=ap($e.fixed-De,Xe,$e.stretch,q),Lt=op(tt.stretch-ve,Te,A,i.top),vn=ap(tt.fixed-it,We,tt.stretch,X),Sn=op(qe.stretch-ye,pe,k,i.left),or=ap(qe.fixed-De,Xe,qe.stretch,q),Pi=op(Fe.stretch-ve,Te,A,i.top),Kr=ap(Fe.fixed-it,We,Fe.stretch,X),Xn=new U(pt,Lt),_r=new U(Sn,Lt),Er=new U(Sn,Pi),Xr=new U(pt,Pi),Yr=new U(at/v,vn/v),ar=new U(or/v,Kr/v),sr=n*Math.PI/180;if(sr){const Fr=Math.sin(sr),pi=Math.cos(sr),fi=[pi,-Fr,Fr,pi];Xn._matMult(fi),_r._matMult(fi),Xr._matMult(fi),Er._matMult(fi)}const Rr=$e.stretch+$e.fixed,Jr=tt.stretch+tt.fixed;return{tl:Xn,tr:_r,bl:Xr,br:Er,tex:{x:y.paddedRect.x+Yl+Rr,y:y.paddedRect.y+Yl+Jr,w:qe.stretch+qe.fixed-Rr,h:Fe.stretch+Fe.fixed-Jr},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Yr,pixelOffsetBR:ar,minFontScaleX:Xe/v/k,minFontScaleY:We/v/A,isSDF:a}};if(h&&(y.stretchX||y.stretchY)){const $e=ix(R,re,q),tt=ix(V,se,X);for(let qe=0;qe<$e.length-1;qe++){const Fe=$e[qe],pt=$e[qe+1];for(let at=0;at<tt.length-1;at++)p.push(He(Fe,tt[at],pt,tt[at+1]))}}else p.push(He({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:w+1},{fixed:0,stretch:T+1}));return p}function ip(i,n,a){let h=0;for(const p of i)h+=Math.max(n,Math.min(a,p[1]))-Math.max(n,Math.min(a,p[0]));return h}function ix(i,n,a){const h=[{fixed:-Yl,stretch:0}];for(const[p,y]of i){const v=h[h.length-1];h.push({fixed:p-v.stretch,stretch:v.stretch}),h.push({fixed:p-v.stretch,stretch:v.stretch+(y-p)})}return h.push({fixed:n+Yl,stretch:a}),h}function op(i,n,a,h){return i/n*a+h}function ap(i,n,a,h){return i-n*a/h}class sp{constructor(n,a,h,p,y,v,w,T,k,A){if(this.boxStartIndex=n.length,k){let R=v.top,V=v.bottom;const j=v.collisionPadding;j&&(R-=j[1],V+=j[3]);let q=V-R;q>0&&(q=Math.max(10,q),this.circleDiameter=q)}else{let R=v.top*w-T[0],V=v.bottom*w+T[2],j=v.left*w-T[3],q=v.right*w+T[1];const X=v.collisionPadding;if(X&&(j-=X[0]*w,R-=X[1]*w,q+=X[2]*w,V+=X[3]*w),A){const re=new U(j,R),se=new U(q,R),ye=new U(j,V),pe=new U(q,V),ve=A*Math.PI/180;re._rotate(ve),se._rotate(ve),ye._rotate(ve),pe._rotate(ve),j=Math.min(re.x,se.x,ye.x,pe.x),q=Math.max(re.x,se.x,ye.x,pe.x),R=Math.min(re.y,se.y,ye.y,pe.y),V=Math.max(re.y,se.y,ye.y,pe.y)}n.emplaceBack(a.x,a.y,j,R,q,V,h,p,y)}this.boxEndIndex=n.length}}class aE{constructor(n=[],a=sE){if(this.data=n,this.length=this.data.length,this.compare=a,this.length>0)for(let h=(this.length>>1)-1;h>=0;h--)this._down(h)}push(n){this.data.push(n),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const n=this.data[0],a=this.data.pop();return this.length--,this.length>0&&(this.data[0]=a,this._down(0)),n}peek(){return this.data[0]}_up(n){const{data:a,compare:h}=this,p=a[n];for(;n>0;){const y=n-1>>1,v=a[y];if(h(p,v)>=0)break;a[n]=v,n=y}a[n]=p}_down(n){const{data:a,compare:h}=this,p=this.length>>1,y=a[n];for(;n<p;){let v=1+(n<<1),w=a[v];const T=v+1;if(T<this.length&&h(a[T],w)<0&&(v=T,w=a[T]),h(w,y)>=0)break;a[n]=w,n=v}a[n]=y}}function sE(i,n){return i<n?-1:i>n?1:0}function lE(i,n=1,a=!1){let h=1/0,p=1/0,y=-1/0,v=-1/0;const w=i[0];for(let j=0;j<w.length;j++){const q=w[j];(!j||q.x<h)&&(h=q.x),(!j||q.y<p)&&(p=q.y),(!j||q.x>y)&&(y=q.x),(!j||q.y>v)&&(v=q.y)}const T=Math.min(y-h,v-p);let k=T/2;const A=new aE([],uE);if(T===0)return new U(h,p);for(let j=h;j<y;j+=T)for(let q=p;q<v;q+=T)A.push(new Jl(j+k,q+k,k,i));let R=function(j){let q=0,X=0,re=0;const se=j[0];for(let ye=0,pe=se.length,ve=pe-1;ye<pe;ve=ye++){const Te=se[ye],De=se[ve],Xe=Te.x*De.y-De.x*Te.y;X+=(Te.x+De.x)*Xe,re+=(Te.y+De.y)*Xe,q+=3*Xe}return new Jl(X/q,re/q,0,j)}(i),V=A.length;for(;A.length;){const j=A.pop();(j.d>R.d||!R.d)&&(R=j,a&&console.log("found best %d after %d probes",Math.round(1e4*j.d)/1e4,V)),j.max-R.d<=n||(k=j.h/2,A.push(new Jl(j.p.x-k,j.p.y-k,k,i)),A.push(new Jl(j.p.x+k,j.p.y-k,k,i)),A.push(new Jl(j.p.x-k,j.p.y+k,k,i)),A.push(new Jl(j.p.x+k,j.p.y+k,k,i)),V+=4)}return a&&(console.log(`num probes: ${V}`),console.log(`best distance: ${R.d}`)),R.p}function uE(i,n){return n.max-i.max}function Jl(i,n,a,h){this.p=new U(i,n),this.h=a,this.d=function(p,y){let v=!1,w=1/0;for(let T=0;T<y.length;T++){const k=y[T];for(let A=0,R=k.length,V=R-1;A<R;V=A++){const j=k[A],q=k[V];j.y>p.y!=q.y>p.y&&p.x<(q.x-j.x)*(p.y-j.y)/(q.y-j.y)+j.x&&(v=!v),w=Math.min(w,Nv(p,j,q))}}return(v?1:-1)*Math.sqrt(w)}(this.p,h),this.max=this.d+this.h*Math.SQRT2}var Cr;u.aq=void 0,(Cr=u.aq||(u.aq={}))[Cr.center=1]="center",Cr[Cr.left=2]="left",Cr[Cr.right=3]="right",Cr[Cr.top=4]="top",Cr[Cr.bottom=5]="bottom",Cr[Cr["top-left"]=6]="top-left",Cr[Cr["top-right"]=7]="top-right",Cr[Cr["bottom-left"]=8]="bottom-left",Cr[Cr["bottom-right"]=9]="bottom-right";const rs=7,ug=Number.POSITIVE_INFINITY;function ox(i,n){return n[1]!==ug?function(a,h,p){let y=0,v=0;switch(h=Math.abs(h),p=Math.abs(p),a){case"top-right":case"top-left":case"top":v=p-rs;break;case"bottom-right":case"bottom-left":case"bottom":v=-p+rs}switch(a){case"top-right":case"bottom-right":case"right":y=-h;break;case"top-left":case"bottom-left":case"left":y=h}return[y,v]}(i,n[0],n[1]):function(a,h){let p=0,y=0;h<0&&(h=0);const v=h/Math.SQRT2;switch(a){case"top-right":case"top-left":y=v-rs;break;case"bottom-right":case"bottom-left":y=-v+rs;break;case"bottom":y=-h+rs;break;case"top":y=h-rs}switch(a){case"top-right":case"bottom-right":p=-v;break;case"top-left":case"bottom-left":p=v;break;case"left":p=h;break;case"right":p=-h}return[p,y]}(i,n[0])}function ax(i,n,a){var h;const p=i.layout,y=(h=p.get("text-variable-anchor-offset"))===null||h===void 0?void 0:h.evaluate(n,{},a);if(y){const w=y.values,T=[];for(let k=0;k<w.length;k+=2){const A=T[k]=w[k],R=w[k+1].map(V=>V*ir);A.startsWith("top")?R[1]-=rs:A.startsWith("bottom")&&(R[1]+=rs),T[k+1]=R}return new Ti(T)}const v=p.get("text-variable-anchor");if(v){let w;w=i._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[p.get("text-radial-offset").evaluate(n,{},a)*ir,ug]:p.get("text-offset").evaluate(n,{},a).map(k=>k*ir);const T=[];for(const k of v)T.push(k,ox(k,w));return new Ti(T)}return null}function cg(i){switch(i){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function cE(i,n,a,h,p,y,v,w,T,k,A){let R=y.textMaxSize.evaluate(n,{});R===void 0&&(R=v);const V=i.layers[0].layout,j=V.get("icon-offset").evaluate(n,{},A),q=lx(a.horizontal),X=v/24,re=i.tilePixelRatio*X,se=i.tilePixelRatio*R/24,ye=i.tilePixelRatio*w,pe=i.tilePixelRatio*V.get("symbol-spacing"),ve=V.get("text-padding")*i.tilePixelRatio,Te=function(Fe,pt,at,Lt=1){const vn=Fe.get("icon-padding").evaluate(pt,{},at),Sn=vn&&vn.values;return[Sn[0]*Lt,Sn[1]*Lt,Sn[2]*Lt,Sn[3]*Lt]}(V,n,A,i.tilePixelRatio),De=V.get("text-max-angle")/180*Math.PI,Xe=V.get("text-rotation-alignment")!=="viewport"&&V.get("symbol-placement")!=="point",it=V.get("icon-rotation-alignment")==="map"&&V.get("symbol-placement")!=="point",We=V.get("symbol-placement"),He=pe/2,$e=V.get("icon-text-fit");let tt;h&&$e!=="none"&&(i.allowVerticalPlacement&&a.vertical&&(tt=P0(h,a.vertical,$e,V.get("icon-text-fit-padding"),j,X)),q&&(h=P0(h,q,$e,V.get("icon-text-fit-padding"),j,X)));const qe=(Fe,pt)=>{pt.x<0||pt.x>=Kn||pt.y<0||pt.y>=Kn||function(at,Lt,vn,Sn,or,Pi,Kr,Xn,_r,Er,Xr,Yr,ar,sr,Rr,Jr,Fr,pi,fi,lr,jt,Or,Ir,ur,ho){const Po=at.addToLineVertexArray(Lt,vn);let Ao,ba,po,$i,mi=0,Sa=0,Hc=0,dx=0,_g=-1,vg=-1;const Ta={};let px=_a("");if(at.allowVerticalPlacement&&Sn.vertical){const Br=Xn.layout.get("text-rotate").evaluate(jt,{},ur)+90;po=new sp(_r,Lt,Er,Xr,Yr,Sn.vertical,ar,sr,Rr,Br),Kr&&($i=new sp(_r,Lt,Er,Xr,Yr,Kr,Fr,pi,Rr,Br))}if(or){const Br=Xn.layout.get("icon-rotate").evaluate(jt,{}),ji=Xn.layout.get("icon-text-fit")!=="none",qs=rx(or,Br,Ir,ji),Do=Kr?rx(Kr,Br,Ir,ji):void 0;ba=new sp(_r,Lt,Er,Xr,Yr,or,Fr,pi,!1,Br),mi=4*qs.length;const Gs=at.iconSizeData;let ea=null;Gs.kind==="source"?(ea=[Qo*Xn.layout.get("icon-size").evaluate(jt,{})],ea[0]>es&&Ft(`${at.layerIds[0]}: Value for "icon-size" is >= ${jc}. Reduce your "icon-size".`)):Gs.kind==="composite"&&(ea=[Qo*Or.compositeIconSizes[0].evaluate(jt,{},ur),Qo*Or.compositeIconSizes[1].evaluate(jt,{},ur)],(ea[0]>es||ea[1]>es)&&Ft(`${at.layerIds[0]}: Value for "icon-size" is >= ${jc}. Reduce your "icon-size".`)),at.addSymbols(at.icon,qs,ea,lr,fi,jt,u.ai.none,Lt,Po.lineStartIndex,Po.lineLength,-1,ur),_g=at.icon.placedSymbolArray.length-1,Do&&(Sa=4*Do.length,at.addSymbols(at.icon,Do,ea,lr,fi,jt,u.ai.vertical,Lt,Po.lineStartIndex,Po.lineLength,-1,ur),vg=at.icon.placedSymbolArray.length-1)}const fx=Object.keys(Sn.horizontal);for(const Br of fx){const ji=Sn.horizontal[Br];if(!Ao){px=_a(ji.text);const Do=Xn.layout.get("text-rotate").evaluate(jt,{},ur);Ao=new sp(_r,Lt,Er,Xr,Yr,ji,ar,sr,Rr,Do)}const qs=ji.positionedLines.length===1;if(Hc+=sx(at,Lt,ji,Pi,Xn,Rr,jt,Jr,Po,Sn.vertical?u.ai.horizontal:u.ai.horizontalOnly,qs?fx:[Br],Ta,_g,Or,ur),qs)break}Sn.vertical&&(dx+=sx(at,Lt,Sn.vertical,Pi,Xn,Rr,jt,Jr,Po,u.ai.vertical,["vertical"],Ta,vg,Or,ur));const pE=Ao?Ao.boxStartIndex:at.collisionBoxArray.length,fE=Ao?Ao.boxEndIndex:at.collisionBoxArray.length,mE=po?po.boxStartIndex:at.collisionBoxArray.length,gE=po?po.boxEndIndex:at.collisionBoxArray.length,yE=ba?ba.boxStartIndex:at.collisionBoxArray.length,_E=ba?ba.boxEndIndex:at.collisionBoxArray.length,vE=$i?$i.boxStartIndex:at.collisionBoxArray.length,xE=$i?$i.boxEndIndex:at.collisionBoxArray.length;let zo=-1;const up=(Br,ji)=>Br&&Br.circleDiameter?Math.max(Br.circleDiameter,ji):ji;zo=up(Ao,zo),zo=up(po,zo),zo=up(ba,zo),zo=up($i,zo);const mx=zo>-1?1:0;mx&&(zo*=ho/ir),at.glyphOffsetArray.length>=Xl.MAX_GLYPHS&&Ft("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),jt.sortKey!==void 0&&at.addToSortKeyRanges(at.symbolInstances.length,jt.sortKey);const wE=ax(Xn,jt,ur),[bE,SE]=function(Br,ji){const qs=Br.length,Do=ji==null?void 0:ji.values;if((Do==null?void 0:Do.length)>0)for(let Gs=0;Gs<Do.length;Gs+=2){const ea=Do[Gs+1];Br.emplaceBack(u.aq[Do[Gs]],ea[0],ea[1])}return[qs,Br.length]}(at.textAnchorOffsets,wE);at.symbolInstances.emplaceBack(Lt.x,Lt.y,Ta.right>=0?Ta.right:-1,Ta.center>=0?Ta.center:-1,Ta.left>=0?Ta.left:-1,Ta.vertical||-1,_g,vg,px,pE,fE,mE,gE,yE,_E,vE,xE,Er,Hc,dx,mi,Sa,mx,0,ar,zo,bE,SE)}(i,pt,Fe,a,h,p,tt,i.layers[0],i.collisionBoxArray,n.index,n.sourceLayerIndex,i.index,re,[ve,ve,ve,ve],Xe,T,ye,Te,it,j,n,y,k,A,v)};if(We==="line")for(const Fe of Y0(n.geometry,0,0,Kn,Kn)){const pt=oE(Fe,pe,De,a.vertical||q,h,24,se,i.overscaling,Kn);for(const at of pt)q&&hE(i,q.text,He,at)||qe(Fe,at)}else if(We==="line-center"){for(const Fe of n.geometry)if(Fe.length>1){const pt=iE(Fe,De,a.vertical||q,h,24,se);pt&&qe(Fe,pt)}}else if(n.type==="Polygon")for(const Fe of $m(n.geometry,0)){const pt=lE(Fe,16);qe(Fe[0],new ns(pt.x,pt.y,0))}else if(n.type==="LineString")for(const Fe of n.geometry)qe(Fe,new ns(Fe[0].x,Fe[0].y,0));else if(n.type==="Point")for(const Fe of n.geometry)for(const pt of Fe)qe([pt],new ns(pt.x,pt.y,0))}function sx(i,n,a,h,p,y,v,w,T,k,A,R,V,j,q){const X=function(ye,pe,ve,Te,De,Xe,it,We){const He=Te.layout.get("text-rotate").evaluate(Xe,{})*Math.PI/180,$e=[];for(const tt of pe.positionedLines)for(const qe of tt.positionedGlyphs){if(!qe.rect)continue;const Fe=qe.rect||{};let pt=S0+1,at=!0,Lt=1,vn=0;const Sn=(De||We)&&qe.vertical,or=qe.metrics.advance*qe.scale/2;if(We&&pe.verticalizable&&(vn=tt.lineOffset/2-(qe.imageName?-(ir-qe.metrics.width*qe.scale)/2:(qe.scale-1)*ir)),qe.imageName){const lr=it[qe.imageName];at=lr.sdf,Lt=lr.pixelRatio,pt=di/Lt}const Pi=De?[qe.x+or,qe.y]:[0,0];let Kr=De?[0,0]:[qe.x+or+ve[0],qe.y+ve[1]-vn],Xn=[0,0];Sn&&(Xn=Kr,Kr=[0,0]);const _r=qe.metrics.isDoubleResolution?2:1,Er=(qe.metrics.left-pt)*qe.scale-or+Kr[0],Xr=(-qe.metrics.top-pt)*qe.scale+Kr[1],Yr=Er+Fe.w/_r*qe.scale/Lt,ar=Xr+Fe.h/_r*qe.scale/Lt,sr=new U(Er,Xr),Rr=new U(Yr,Xr),Jr=new U(Er,ar),Fr=new U(Yr,ar);if(Sn){const lr=new U(-or,or-Uc),jt=-Math.PI/2,Or=ir/2-or,Ir=new U(5-Uc-Or,-(qe.imageName?Or:0)),ur=new U(...Xn);sr._rotateAround(jt,lr)._add(Ir)._add(ur),Rr._rotateAround(jt,lr)._add(Ir)._add(ur),Jr._rotateAround(jt,lr)._add(Ir)._add(ur),Fr._rotateAround(jt,lr)._add(Ir)._add(ur)}if(He){const lr=Math.sin(He),jt=Math.cos(He),Or=[jt,-lr,lr,jt];sr._matMult(Or),Rr._matMult(Or),Jr._matMult(Or),Fr._matMult(Or)}const pi=new U(0,0),fi=new U(0,0);$e.push({tl:sr,tr:Rr,bl:Jr,br:Fr,tex:Fe,writingMode:pe.writingMode,glyphOffset:Pi,sectionIndex:qe.sectionIndex,isSDF:at,pixelOffsetTL:pi,pixelOffsetBR:fi,minFontScaleX:0,minFontScaleY:0})}return $e}(0,a,w,p,y,v,h,i.allowVerticalPlacement),re=i.textSizeData;let se=null;re.kind==="source"?(se=[Qo*p.layout.get("text-size").evaluate(v,{})],se[0]>es&&Ft(`${i.layerIds[0]}: Value for "text-size" is >= ${jc}. Reduce your "text-size".`)):re.kind==="composite"&&(se=[Qo*j.compositeTextSizes[0].evaluate(v,{},q),Qo*j.compositeTextSizes[1].evaluate(v,{},q)],(se[0]>es||se[1]>es)&&Ft(`${i.layerIds[0]}: Value for "text-size" is >= ${jc}. Reduce your "text-size".`)),i.addSymbols(i.text,X,se,w,y,v,k,n,T.lineStartIndex,T.lineLength,V,q);for(const ye of A)R[ye]=i.text.placedSymbolArray.length-1;return 4*X.length}function lx(i){for(const n in i)return i[n];return null}function hE(i,n,a,h){const p=i.compareText;if(n in p){const y=p[n];for(let v=y.length-1;v>=0;v--)if(h.dist(y[v])<a)return!0}else p[n]=[];return p[n].push(h),!1}const ux=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class hg{static from(n){if(!(n instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[a,h]=new Uint8Array(n,0,2);if(a!==219)throw new Error("Data does not appear to be in a KDBush format.");const p=h>>4;if(p!==1)throw new Error(`Got v${p} data when expected v1.`);const y=ux[15&h];if(!y)throw new Error("Unrecognized array type.");const[v]=new Uint16Array(n,2,1),[w]=new Uint32Array(n,4,1);return new hg(w,v,y,n)}constructor(n,a=64,h=Float64Array,p){if(isNaN(n)||n<0)throw new Error(`Unpexpected numItems value: ${n}.`);this.numItems=+n,this.nodeSize=Math.min(Math.max(+a,2),65535),this.ArrayType=h,this.IndexArrayType=n<65536?Uint16Array:Uint32Array;const y=ux.indexOf(this.ArrayType),v=2*n*this.ArrayType.BYTES_PER_ELEMENT,w=n*this.IndexArrayType.BYTES_PER_ELEMENT,T=(8-w%8)%8;if(y<0)throw new Error(`Unexpected typed array class: ${h}.`);p&&p instanceof ArrayBuffer?(this.data=p,this.ids=new this.IndexArrayType(this.data,8,n),this.coords=new this.ArrayType(this.data,8+w+T,2*n),this._pos=2*n,this._finished=!0):(this.data=new ArrayBuffer(8+v+w+T),this.ids=new this.IndexArrayType(this.data,8,n),this.coords=new this.ArrayType(this.data,8+w+T,2*n),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+y]),new Uint16Array(this.data,2,1)[0]=a,new Uint32Array(this.data,4,1)[0]=n)}add(n,a){const h=this._pos>>1;return this.ids[h]=h,this.coords[this._pos++]=n,this.coords[this._pos++]=a,h}finish(){const n=this._pos>>1;if(n!==this.numItems)throw new Error(`Added ${n} items when expected ${this.numItems}.`);return dg(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(n,a,h,p){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:y,coords:v,nodeSize:w}=this,T=[0,y.length-1,0],k=[];for(;T.length;){const A=T.pop()||0,R=T.pop()||0,V=T.pop()||0;if(R-V<=w){for(let re=V;re<=R;re++){const se=v[2*re],ye=v[2*re+1];se>=n&&se<=h&&ye>=a&&ye<=p&&k.push(y[re])}continue}const j=V+R>>1,q=v[2*j],X=v[2*j+1];q>=n&&q<=h&&X>=a&&X<=p&&k.push(y[j]),(A===0?n<=q:a<=X)&&(T.push(V),T.push(j-1),T.push(1-A)),(A===0?h>=q:p>=X)&&(T.push(j+1),T.push(R),T.push(1-A))}return k}within(n,a,h){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:p,coords:y,nodeSize:v}=this,w=[0,p.length-1,0],T=[],k=h*h;for(;w.length;){const A=w.pop()||0,R=w.pop()||0,V=w.pop()||0;if(R-V<=v){for(let re=V;re<=R;re++)hx(y[2*re],y[2*re+1],n,a)<=k&&T.push(p[re]);continue}const j=V+R>>1,q=y[2*j],X=y[2*j+1];hx(q,X,n,a)<=k&&T.push(p[j]),(A===0?n-h<=q:a-h<=X)&&(w.push(V),w.push(j-1),w.push(1-A)),(A===0?n+h>=q:a+h>=X)&&(w.push(j+1),w.push(R),w.push(1-A))}return T}}function dg(i,n,a,h,p,y){if(p-h<=a)return;const v=h+p>>1;cx(i,n,v,h,p,y),dg(i,n,a,h,v-1,1-y),dg(i,n,a,v+1,p,1-y)}function cx(i,n,a,h,p,y){for(;p>h;){if(p-h>600){const k=p-h+1,A=a-h+1,R=Math.log(k),V=.5*Math.exp(2*R/3),j=.5*Math.sqrt(R*V*(k-V)/k)*(A-k/2<0?-1:1);cx(i,n,a,Math.max(h,Math.floor(a-A*V/k+j)),Math.min(p,Math.floor(a+(k-A)*V/k+j)),y)}const v=n[2*a+y];let w=h,T=p;for(qc(i,n,h,a),n[2*p+y]>v&&qc(i,n,h,p);w<T;){for(qc(i,n,w,T),w++,T--;n[2*w+y]<v;)w++;for(;n[2*T+y]>v;)T--}n[2*h+y]===v?qc(i,n,h,T):(T++,qc(i,n,T,p)),T<=a&&(h=T+1),a<=T&&(p=T-1)}}function qc(i,n,a,h){pg(i,a,h),pg(n,2*a,2*h),pg(n,2*a+1,2*h+1)}function pg(i,n,a){const h=i[n];i[n]=i[a],i[a]=h}function hx(i,n,a,h){const p=i-a,y=n-h;return p*p+y*y}var fg;u.bh=void 0,(fg=u.bh||(u.bh={})).create="create",fg.load="load",fg.fullLoad="fullLoad";let lp=null,Gc=[];const mg=1e3/60,gg="loadTime",yg="fullLoadTime",dE={mark(i){performance.mark(i)},frame(i){const n=i;lp!=null&&Gc.push(n-lp),lp=n},clearMetrics(){lp=null,Gc=[],performance.clearMeasures(gg),performance.clearMeasures(yg);for(const i in u.bh)performance.clearMarks(u.bh[i])},getPerformanceMetrics(){performance.measure(gg,u.bh.create,u.bh.load),performance.measure(yg,u.bh.create,u.bh.fullLoad);const i=performance.getEntriesByName(gg)[0].duration,n=performance.getEntriesByName(yg)[0].duration,a=Gc.length,h=1/(Gc.reduce((y,v)=>y+v,0)/a/1e3),p=Gc.filter(y=>y>mg).reduce((y,v)=>y+(v-mg)/mg,0);return{loadTime:i,fullLoadTime:n,fps:h,percentDroppedFrames:p/(a+p)*100,totalFrames:a}}};u.$=function(i,n,a){var h,p,y,v,w,T,k,A,R,V,j,q,X=a[0],re=a[1],se=a[2];return n===i?(i[12]=n[0]*X+n[4]*re+n[8]*se+n[12],i[13]=n[1]*X+n[5]*re+n[9]*se+n[13],i[14]=n[2]*X+n[6]*re+n[10]*se+n[14],i[15]=n[3]*X+n[7]*re+n[11]*se+n[15]):(p=n[1],y=n[2],v=n[3],w=n[4],T=n[5],k=n[6],A=n[7],R=n[8],V=n[9],j=n[10],q=n[11],i[0]=h=n[0],i[1]=p,i[2]=y,i[3]=v,i[4]=w,i[5]=T,i[6]=k,i[7]=A,i[8]=R,i[9]=V,i[10]=j,i[11]=q,i[12]=h*X+w*re+R*se+n[12],i[13]=p*X+T*re+V*se+n[13],i[14]=y*X+k*re+j*se+n[14],i[15]=v*X+A*re+q*se+n[15]),i},u.A=Zl,u.B=si,u.C=class{constructor(i,n,a){this.receive=h=>{const p=h.data,y=p.id;if(y&&(!p.targetMapId||this.mapId===p.targetMapId))if(p.type==="<cancel>"){delete this.tasks[y];const v=this.cancelCallbacks[y];delete this.cancelCallbacks[y],v&&v()}else xt()||p.mustQueue?(this.tasks[y]=p,this.taskQueue.push(y),this.invoker.trigger()):this.processTask(y,p)},this.process=()=>{if(!this.taskQueue.length)return;const h=this.taskQueue.shift(),p=this.tasks[h];delete this.tasks[h],this.taskQueue.length&&this.invoker.trigger(),p&&this.processTask(h,p)},this.target=i,this.parent=n,this.mapId=a,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},this.invoker=new nE(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=xt()?i:window}send(i,n,a,h,p=!1){const y=Math.round(1e18*Math.random()).toString(36).substring(0,10);a&&(this.callbacks[y]=a);const v=[],w={id:y,type:i,hasCallback:!!a,targetMapId:h,mustQueue:p,sourceMapId:this.mapId,data:Xo(n,v)};return this.target.postMessage(w,{transfer:v}),{cancel:()=>{a&&delete this.callbacks[y],this.target.postMessage({id:y,type:"<cancel>",targetMapId:h,sourceMapId:this.mapId})}}}processTask(i,n){if(n.type==="<response>"){const a=this.callbacks[i];delete this.callbacks[i],a&&(n.error?a(Wa(n.error)):a(null,Wa(n.data)))}else{let a=!1;const h=[],p=n.hasCallback?(w,T)=>{a=!0,delete this.cancelCallbacks[i];const k={id:i,type:"<response>",sourceMapId:this.mapId,error:w?Xo(w):null,data:Xo(T,h)};this.target.postMessage(k,{transfer:h})}:w=>{a=!0};let y=null;const v=Wa(n.data);if(this.parent[n.type])y=this.parent[n.type](n.sourceMapId,v,p);else if("getWorkerSource"in this.parent){const w=n.type.split(".");y=this.parent.getWorkerSource(n.sourceMapId,w[0],v.source)[w[1]](v,p)}else p(new Error(`Could not find function ${n.type}`));!a&&y&&y.cancel&&(this.cancelCallbacks[i]=y.cancel)}}remove(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)}},u.D=st,u.E=bo,u.F=function(i,n){const a={};for(let h=0;h<n.length;h++){const p=n[h];p in i&&(a[p]=i[p])}return a},u.G=V0,u.H=N0,u.I=Jm,u.J=G,u.K=ee,u.L=ts,u.M=kt,u.N=Kn,u.O=Ui,u.P=U,u.Q=In,u.R=Ni,u.S=_n,u.T=Od,u.U=rp,u.V=class extends ga{},u.W=lg,u.X=function(i,n){const a=window.document.createElement("video");a.muted=!0,a.onloadstart=function(){n(null,a)};for(let h=0;h<i.length;h++){const p=window.document.createElement("source");jr(i[h])||(a.crossOrigin="Anonymous"),p.src=i[h],a.appendChild(p)}return{cancel:()=>{}}},u.Y=Ne,u.Z=function(){var i=new Zl(16);return Zl!=Float32Array&&(i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=0,i[12]=0,i[13]=0,i[14]=0),i[0]=1,i[5]=1,i[10]=1,i[15]=1,i},u._=C,u.a=lt,u.a$=class extends N{},u.a0=function(i,n,a){var h=a[0],p=a[1],y=a[2];return i[0]=n[0]*h,i[1]=n[1]*h,i[2]=n[2]*h,i[3]=n[3]*h,i[4]=n[4]*p,i[5]=n[5]*p,i[6]=n[6]*p,i[7]=n[7]*p,i[8]=n[8]*y,i[9]=n[9]*y,i[10]=n[10]*y,i[11]=n[11]*y,i[12]=n[12],i[13]=n[13],i[14]=n[14],i[15]=n[15],i},u.a1=Zv,u.a2=function(){return Ze++},u.a3=te,u.a4=Xl,u.a5=function(){ci.isLoading()||ci.isLoaded()||xc()!=="deferred"||Fd()},u.a6=uc,u.a7=js,u.a8=yn,u.a9=H0,u.aA=Os,u.aB=function(i){i=i.slice();const n=Object.create(null);for(let a=0;a<i.length;a++)n[i[a].id]=i[a];for(let a=0;a<i.length;a++)"ref"in i[a]&&(i[a]=Ar(i[a],n[i[a].ref]));return i},u.aC=function(i){if(i.type==="custom")return new tE(i);switch(i.type){case"background":return new JC(i);case"circle":return new OT(i);case"fill":return new rC(i);case"fill-extrusion":return new _C(i);case"heatmap":return new VT(i);case"hillshade":return new UT(i);case"line":return new EC(i);case"raster":return new eE(i);case"symbol":return new np(i)}},u.aD=bt,u.aE=function(i,n){if(!i)return[{command:Dt.setStyle,args:[n]}];let a=[];try{if(!nn(i.version,n.version))return[{command:Dt.setStyle,args:[n]}];nn(i.center,n.center)||a.push({command:Dt.setCenter,args:[n.center]}),nn(i.zoom,n.zoom)||a.push({command:Dt.setZoom,args:[n.zoom]}),nn(i.bearing,n.bearing)||a.push({command:Dt.setBearing,args:[n.bearing]}),nn(i.pitch,n.pitch)||a.push({command:Dt.setPitch,args:[n.pitch]}),nn(i.sprite,n.sprite)||a.push({command:Dt.setSprite,args:[n.sprite]}),nn(i.glyphs,n.glyphs)||a.push({command:Dt.setGlyphs,args:[n.glyphs]}),nn(i.transition,n.transition)||a.push({command:Dt.setTransition,args:[n.transition]}),nn(i.light,n.light)||a.push({command:Dt.setLight,args:[n.light]});const h={},p=[];(function(v,w,T,k){let A;for(A in w=w||{},v=v||{})Object.prototype.hasOwnProperty.call(v,A)&&(Object.prototype.hasOwnProperty.call(w,A)||So(A,T,k));for(A in w)Object.prototype.hasOwnProperty.call(w,A)&&(Object.prototype.hasOwnProperty.call(v,A)?nn(v[A],w[A])||(v[A].type==="geojson"&&w[A].type==="geojson"&&Va(v,w,A)?T.push({command:Dt.setGeoJSONSourceData,args:[A,w[A].data]}):Zr(A,w,T,k)):br(A,w,T))})(i.sources,n.sources,p,h);const y=[];i.layers&&i.layers.forEach(v=>{h[v.source]?a.push({command:Dt.removeLayer,args:[v.id]}):y.push(v)}),a=a.concat(p),function(v,w,T){w=w||[];const k=(v=v||[]).map(Bi),A=w.map(Bi),R=v.reduce(io,{}),V=w.reduce(io,{}),j=k.slice(),q=Object.create(null);let X,re,se,ye,pe,ve,Te;for(X=0,re=0;X<k.length;X++)se=k[X],Object.prototype.hasOwnProperty.call(V,se)?re++:(T.push({command:Dt.removeLayer,args:[se]}),j.splice(j.indexOf(se,re),1));for(X=0,re=0;X<A.length;X++)se=A[A.length-1-X],j[j.length-1-X]!==se&&(Object.prototype.hasOwnProperty.call(R,se)?(T.push({command:Dt.removeLayer,args:[se]}),j.splice(j.lastIndexOf(se,j.length-re),1)):re++,ve=j[j.length-X],T.push({command:Dt.addLayer,args:[V[se],ve]}),j.splice(j.length-X,0,se),q[se]=!0);for(X=0;X<A.length;X++)if(se=A[X],ye=R[se],pe=V[se],!q[se]&&!nn(ye,pe))if(nn(ye.source,pe.source)&&nn(ye["source-layer"],pe["source-layer"])&&nn(ye.type,pe.type)){for(Te in zr(ye.layout,pe.layout,T,se,null,Dt.setLayoutProperty),zr(ye.paint,pe.paint,T,se,null,Dt.setPaintProperty),nn(ye.filter,pe.filter)||T.push({command:Dt.setFilter,args:[se,pe.filter]}),nn(ye.minzoom,pe.minzoom)&&nn(ye.maxzoom,pe.maxzoom)||T.push({command:Dt.setLayerZoomRange,args:[se,pe.minzoom,pe.maxzoom]}),ye)Object.prototype.hasOwnProperty.call(ye,Te)&&Te!=="layout"&&Te!=="paint"&&Te!=="filter"&&Te!=="metadata"&&Te!=="minzoom"&&Te!=="maxzoom"&&(Te.indexOf("paint.")===0?zr(ye[Te],pe[Te],T,se,Te.slice(6),Dt.setPaintProperty):nn(ye[Te],pe[Te])||T.push({command:Dt.setLayerProperty,args:[se,Te,pe[Te]]}));for(Te in pe)Object.prototype.hasOwnProperty.call(pe,Te)&&!Object.prototype.hasOwnProperty.call(ye,Te)&&Te!=="layout"&&Te!=="paint"&&Te!=="filter"&&Te!=="metadata"&&Te!=="minzoom"&&Te!=="maxzoom"&&(Te.indexOf("paint.")===0?zr(ye[Te],pe[Te],T,se,Te.slice(6),Dt.setPaintProperty):nn(ye[Te],pe[Te])||T.push({command:Dt.setLayerProperty,args:[se,Te,pe[Te]]}))}else T.push({command:Dt.removeLayer,args:[se]}),ve=j[j.lastIndexOf(se)+1],T.push({command:Dt.addLayer,args:[pe,ve]})}(y,n.layers,a)}catch(h){console.warn("Unable to compute style diff:",h),a=[{command:Dt.setStyle,args:[n]}]}return a},u.aF=function(i){const n=[],a=i.id;return a===void 0&&n.push({message:`layers.${a}: missing required property "id"`}),i.render===void 0&&n.push({message:`layers.${a}: missing required method "render"`}),i.renderingMode&&i.renderingMode!=="2d"&&i.renderingMode!=="3d"&&n.push({message:`layers.${a}: property "renderingMode" must be either "2d" or "3d"`}),n},u.aG=function i(n,a){if(Array.isArray(n)){if(!Array.isArray(a)||n.length!==a.length)return!1;for(let h=0;h<n.length;h++)if(!i(n[h],a[h]))return!1;return!0}if(typeof n=="object"&&n!==null&&a!==null){if(typeof a!="object"||Object.keys(n).length!==Object.keys(a).length)return!1;for(const h in n)if(!i(n[h],a[h]))return!1;return!0}return n===a},u.aH=Oe,u.aI=ft,u.aJ=Bs,u.aK=function(i){return i({pluginStatus:Gr,pluginURL:Yo}),Bs.on("pluginStateChange",i),i},u.aL=class extends va{constructor(i,n){super(i,n),this.current=0}set(i){this.current!==i&&(this.current=i,this.gl.uniform1i(this.location,i))}},u.aM=$l,u.aN=class extends va{constructor(i,n){super(i,n),this.current=Pm}set(i){if(i[12]!==this.current[12]||i[0]!==this.current[0])return this.current=i,void this.gl.uniformMatrix4fv(this.location,!1,i);for(let n=1;n<16;n++)if(i[n]!==this.current[n]){this.current=i,this.gl.uniformMatrix4fv(this.location,!1,i);break}}},u.aO=Ud,u.aP=class extends va{constructor(i,n){super(i,n),this.current=[0,0,0]}set(i){i[0]===this.current[0]&&i[1]===this.current[1]&&i[2]===this.current[2]||(this.current=i,this.gl.uniform3f(this.location,i[0],i[1],i[2]))}},u.aQ=class extends va{constructor(i,n){super(i,n),this.current=[0,0]}set(i){i[0]===this.current[0]&&i[1]===this.current[1]||(this.current=i,this.gl.uniform2f(this.location,i[0],i[1]))}},u.aR=$d,u.aS=function(i,n,a,h,p,y,v){var w=1/(n-a),T=1/(h-p),k=1/(y-v);return i[0]=-2*w,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=-2*T,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=2*k,i[11]=0,i[12]=(n+a)*w,i[13]=(p+h)*T,i[14]=(v+y)*k,i[15]=1,i},u.aT=on,u.aU=FT,u.aV=class extends d{},u.aW=PC,u.aX=class extends _{},u.aY=function(i){return i<=1?1:Math.pow(2,Math.ceil(Math.log(i)/Math.LN2))},u.aZ=Kv,u.a_=Ve,u.aa=function(i){const n={};if(i.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(a,h,p,y)=>{const v=p||y;return n[h]=!v||v.toLowerCase(),""}),n["max-age"]){const a=parseInt(n["max-age"],10);isNaN(a)?delete n["max-age"]:n["max-age"]=a}return n},u.ab=function(i,n){const a=[];for(const h in i)h in n||a.push(h);return a},u.ac=function(i){if(Be==null){const n=i.navigator?i.navigator.userAgent:null;Be=!!i.safari||!(!n||!(/\b(iPad|iPhone|iPod)\b/.test(n)||n.match("Safari")&&!n.match("Chrome")))}return Be},u.ad=de,u.ae=function(i,n,a){var h=Math.sin(a),p=Math.cos(a),y=n[0],v=n[1],w=n[2],T=n[3],k=n[4],A=n[5],R=n[6],V=n[7];return n!==i&&(i[8]=n[8],i[9]=n[9],i[10]=n[10],i[11]=n[11],i[12]=n[12],i[13]=n[13],i[14]=n[14],i[15]=n[15]),i[0]=y*p+k*h,i[1]=v*p+A*h,i[2]=w*p+R*h,i[3]=T*p+V*h,i[4]=k*p-y*h,i[5]=A*p-v*h,i[6]=R*p-w*h,i[7]=V*p-T*h,i},u.af=function(i){var n=new Zl(16);return n[0]=i[0],n[1]=i[1],n[2]=i[2],n[3]=i[3],n[4]=i[4],n[5]=i[5],n[6]=i[6],n[7]=i[7],n[8]=i[8],n[9]=i[9],n[10]=i[10],n[11]=i[11],n[12]=i[12],n[13]=i[13],n[14]=i[14],n[15]=i[15],n},u.ag=Gd,u.ah=function(i,n){let a=0,h=0;if(i.kind==="constant")h=i.layoutSize;else if(i.kind!=="source"){const{interpolationType:p,minZoom:y,maxZoom:v}=i,w=p?de(li.interpolationFactor(p,n,y,v),0,1):0;i.kind==="camera"?h=si.number(i.minSize,i.maxSize,w):a=w}return{uSizeT:a,uSize:h}},u.aj=function(i,{uSize:n,uSizeT:a},{lowerSize:h,upperSize:p}){return i.kind==="source"?h/Qo:i.kind==="composite"?si.number(h/Qo,p/Qo,a):n},u.ak=ng,u.al=function(i,n,a,h){const p=n.y-i.y,y=n.x-i.x,v=h.y-a.y,w=h.x-a.x,T=v*y-w*p;if(T===0)return null;const k=(w*(i.y-a.y)-v*(i.x-a.x))/T;return new U(i.x+k*y,i.y+k*p)},u.am=Y0,u.an=Bv,u.ao=Rm,u.ap=ir,u.ar=tg,u.as=function(i,n){var a=n[0],h=n[1],p=n[2],y=n[3],v=n[4],w=n[5],T=n[6],k=n[7],A=n[8],R=n[9],V=n[10],j=n[11],q=n[12],X=n[13],re=n[14],se=n[15],ye=a*w-h*v,pe=a*T-p*v,ve=a*k-y*v,Te=h*T-p*w,De=h*k-y*w,Xe=p*k-y*T,it=A*X-R*q,We=A*re-V*q,He=A*se-j*q,$e=R*re-V*X,tt=R*se-j*X,qe=V*se-j*re,Fe=ye*qe-pe*tt+ve*$e+Te*He-De*We+Xe*it;return Fe?(i[0]=(w*qe-T*tt+k*$e)*(Fe=1/Fe),i[1]=(p*tt-h*qe-y*$e)*Fe,i[2]=(X*Xe-re*De+se*Te)*Fe,i[3]=(V*De-R*Xe-j*Te)*Fe,i[4]=(T*He-v*qe-k*We)*Fe,i[5]=(a*qe-p*He+y*We)*Fe,i[6]=(re*ve-q*Xe-se*pe)*Fe,i[7]=(A*Xe-V*ve+j*pe)*Fe,i[8]=(v*tt-w*He+k*it)*Fe,i[9]=(h*He-a*tt-y*it)*Fe,i[10]=(q*De-X*ve+se*ye)*Fe,i[11]=(R*ve-A*De-j*ye)*Fe,i[12]=(w*We-v*$e-T*it)*Fe,i[13]=(a*$e-h*We+p*it)*Fe,i[14]=(X*pe-q*Te-re*ye)*Fe,i[15]=(A*Te-R*pe+V*ye)*Fe,i):null},u.at=cg,u.au=eg,u.av=hg,u.aw=function(){const i={},n=Ae.$version;for(const a in Ae.$root){const h=Ae.$root[a];if(h.required){let p=null;p=a==="version"?n:h.type==="array"?[]:{},p!=null&&(i[a]=p)}}return i},u.ax=Dt,u.ay=zd,u.az=qn,u.b=function(i,n){const a=new Blob([new Uint8Array(i)],{type:"image/png"});createImageBitmap(a).then(h=>{n(null,h)}).catch(h=>{n(new Error(`Could not load image because of ${h.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})},u.b0=gr,u.b1=function(i,n){var a=i[0],h=i[1],p=i[2],y=i[3],v=i[4],w=i[5],T=i[6],k=i[7],A=i[8],R=i[9],V=i[10],j=i[11],q=i[12],X=i[13],re=i[14],se=i[15],ye=n[0],pe=n[1],ve=n[2],Te=n[3],De=n[4],Xe=n[5],it=n[6],We=n[7],He=n[8],$e=n[9],tt=n[10],qe=n[11],Fe=n[12],pt=n[13],at=n[14],Lt=n[15];return Math.abs(a-ye)<=Wr*Math.max(1,Math.abs(a),Math.abs(ye))&&Math.abs(h-pe)<=Wr*Math.max(1,Math.abs(h),Math.abs(pe))&&Math.abs(p-ve)<=Wr*Math.max(1,Math.abs(p),Math.abs(ve))&&Math.abs(y-Te)<=Wr*Math.max(1,Math.abs(y),Math.abs(Te))&&Math.abs(v-De)<=Wr*Math.max(1,Math.abs(v),Math.abs(De))&&Math.abs(w-Xe)<=Wr*Math.max(1,Math.abs(w),Math.abs(Xe))&&Math.abs(T-it)<=Wr*Math.max(1,Math.abs(T),Math.abs(it))&&Math.abs(k-We)<=Wr*Math.max(1,Math.abs(k),Math.abs(We))&&Math.abs(A-He)<=Wr*Math.max(1,Math.abs(A),Math.abs(He))&&Math.abs(R-$e)<=Wr*Math.max(1,Math.abs(R),Math.abs($e))&&Math.abs(V-tt)<=Wr*Math.max(1,Math.abs(V),Math.abs(tt))&&Math.abs(j-qe)<=Wr*Math.max(1,Math.abs(j),Math.abs(qe))&&Math.abs(q-Fe)<=Wr*Math.max(1,Math.abs(q),Math.abs(Fe))&&Math.abs(X-pt)<=Wr*Math.max(1,Math.abs(X),Math.abs(pt))&&Math.abs(re-at)<=Wr*Math.max(1,Math.abs(re),Math.abs(at))&&Math.abs(se-Lt)<=Wr*Math.max(1,Math.abs(se),Math.abs(Lt))},u.b2=function(i,n){return i[0]=n[0],i[1]=n[1],i[2]=n[2],i[3]=n[3],i[4]=n[4],i[5]=n[5],i[6]=n[6],i[7]=n[7],i[8]=n[8],i[9]=n[9],i[10]=n[10],i[11]=n[11],i[12]=n[12],i[13]=n[13],i[14]=n[14],i[15]=n[15],i},u.b3=function(i,n,a){return i[0]=n[0]*a[0],i[1]=n[1]*a[1],i[2]=n[2]*a[2],i[3]=n[3]*a[3],i},u.b4=function(i,n){return i[0]*n[0]+i[1]*n[1]+i[2]*n[2]+i[3]*n[3]},u.b5=be,u.b6=Z0,u.b7=U0,u.b8=function(i,n,a,h,p){var y,v=1/Math.tan(n/2);return i[0]=v/a,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=v,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=-1,i[12]=0,i[13]=0,i[15]=0,p!=null&&p!==1/0?(i[10]=(p+h)*(y=1/(h-p)),i[14]=2*p*h*y):(i[10]=-1,i[14]=-2*h),i},u.b9=function(i,n,a){var h=Math.sin(a),p=Math.cos(a),y=n[4],v=n[5],w=n[6],T=n[7],k=n[8],A=n[9],R=n[10],V=n[11];return n!==i&&(i[0]=n[0],i[1]=n[1],i[2]=n[2],i[3]=n[3],i[12]=n[12],i[13]=n[13],i[14]=n[14],i[15]=n[15]),i[4]=y*p+k*h,i[5]=v*p+A*h,i[6]=w*p+R*h,i[7]=T*p+V*h,i[8]=k*p-y*h,i[9]=A*p-v*h,i[10]=R*p-w*h,i[11]=V*p-T*h,i},u.bA=D,u.bB=g0,u.bC=Al,u.bD=ci,u.ba=_e,u.bb=Ce,u.bc=function(i,n){return i[0]=n[0],i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=n[1],i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=n[2],i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i},u.bd=class extends Us{},u.be=ag,u.bf=$0,u.bg=dE,u.bi=Mn,u.bj=function(i,n,a=!1){if(Gr===mc||Gr===gc||Gr===yc)throw new Error("setRTLTextPlugin cannot be called multiple times.");Yo=Zt.resolveURL(i),Gr=mc,_c=n,vc(),a||Fd()},u.bk=xc,u.bl=function(i,n){const a={};for(let p=0;p<i.length;p++){const y=n&&n[i[p].id]||Rl(i[p]);n&&(n[i[p].id]=y);let v=a[y];v||(v=a[y]=[]),v.push(i[p])}const h=[];for(const p in a)h.push(a[p]);return h},u.bm=Je,u.bn=G0,u.bo=W0,u.bp=C0,u.bq=function(i){i.bucket.createArrays(),i.bucket.tilePixelRatio=Kn/(512*i.bucket.overscaling),i.bucket.compareText={},i.bucket.iconsNeedLinear=!1;const n=i.bucket.layers[0],a=n.layout,h=n._unevaluatedLayout._values,p={layoutIconSize:h["icon-size"].possiblyEvaluate(new yn(i.bucket.zoom+1),i.canonical),layoutTextSize:h["text-size"].possiblyEvaluate(new yn(i.bucket.zoom+1),i.canonical),textMaxSize:h["text-size"].possiblyEvaluate(new yn(18))};if(i.bucket.textSizeData.kind==="composite"){const{minZoom:k,maxZoom:A}=i.bucket.textSizeData;p.compositeTextSizes=[h["text-size"].possiblyEvaluate(new yn(k),i.canonical),h["text-size"].possiblyEvaluate(new yn(A),i.canonical)]}if(i.bucket.iconSizeData.kind==="composite"){const{minZoom:k,maxZoom:A}=i.bucket.iconSizeData;p.compositeIconSizes=[h["icon-size"].possiblyEvaluate(new yn(k),i.canonical),h["icon-size"].possiblyEvaluate(new yn(A),i.canonical)]}const y=a.get("text-line-height")*ir,v=a.get("text-rotation-alignment")!=="viewport"&&a.get("symbol-placement")!=="point",w=a.get("text-keep-upright"),T=a.get("text-size");for(const k of i.bucket.features){const A=a.get("text-font").evaluate(k,{},i.canonical).join(","),R=T.evaluate(k,{},i.canonical),V=p.layoutTextSize.evaluate(k,{},i.canonical),j=p.layoutIconSize.evaluate(k,{},i.canonical),q={horizontal:{},vertical:void 0},X=k.text;let re,se=[0,0];if(X){const ve=X.toString(),Te=a.get("text-letter-spacing").evaluate(k,{},i.canonical)*ir,De=pc(ve)?Te:0,Xe=a.get("text-anchor").evaluate(k,{},i.canonical),it=ax(n,k,i.canonical);if(!it){const qe=a.get("text-radial-offset").evaluate(k,{},i.canonical);se=qe?ox(Xe,[qe*ir,ug]):a.get("text-offset").evaluate(k,{},i.canonical).map(Fe=>Fe*ir)}let We=v?"center":a.get("text-justify").evaluate(k,{},i.canonical);const He=a.get("symbol-placement"),$e=He==="point"?a.get("text-max-width").evaluate(k,{},i.canonical)*ir:0,tt=()=>{i.bucket.allowVerticalPlacement&&dc(ve)&&(q.vertical=Qd(X,i.glyphMap,i.glyphPositions,i.imagePositions,A,$e,y,Xe,"left",De,se,u.ai.vertical,!0,He,V,R))};if(!v&&it){const qe=new Set;if(We==="auto")for(let pt=0;pt<it.values.length;pt+=2)qe.add(cg(it.values[pt]));else qe.add(We);let Fe=!1;for(const pt of qe)if(!q.horizontal[pt])if(Fe)q.horizontal[pt]=q.horizontal[0];else{const at=Qd(X,i.glyphMap,i.glyphPositions,i.imagePositions,A,$e,y,"center",pt,De,se,u.ai.horizontal,!1,He,V,R);at&&(q.horizontal[pt]=at,Fe=at.positionedLines.length===1)}tt()}else{We==="auto"&&(We=cg(Xe));const qe=Qd(X,i.glyphMap,i.glyphPositions,i.imagePositions,A,$e,y,Xe,We,De,se,u.ai.horizontal,!1,He,V,R);qe&&(q.horizontal[We]=qe),tt(),dc(ve)&&v&&w&&(q.vertical=Qd(X,i.glyphMap,i.glyphPositions,i.imagePositions,A,$e,y,Xe,We,De,se,u.ai.vertical,!1,He,V,R))}}let ye=!1;if(k.icon&&k.icon.name){const ve=i.imageMap[k.icon.name];ve&&(re=HC(i.imagePositions[k.icon.name],a.get("icon-offset").evaluate(k,{},i.canonical),a.get("icon-anchor").evaluate(k,{},i.canonical)),ye=!!ve.sdf,i.bucket.sdfIcons===void 0?i.bucket.sdfIcons=ye:i.bucket.sdfIcons!==ye&&Ft("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(ve.pixelRatio!==i.bucket.pixelRatio||a.get("icon-rotate").constantOr(1)!==0)&&(i.bucket.iconsNeedLinear=!0))}const pe=lx(q.horizontal)||q.vertical;i.bucket.iconsInText=!!pe&&pe.iconsInText,(pe||re)&&cE(i.bucket,k,q,re,i.imageMap,p,V,j,se,ye,i.canonical)}i.showCollisionBoxes&&i.bucket.generateCollisionDebugBuffers()},u.br=Wm,u.bs=qm,u.bt=Hm,u.bu=class{constructor(i){this._marks={start:[i.url,"start"].join("#"),end:[i.url,"end"].join("#"),measure:i.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let i=performance.getEntriesByName(this._marks.measure);return i.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),i=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),i}},u.bv=Xm,u.bw=Ja,u.bx=function(i,n,a,h,p){return C(this,void 0,void 0,function*(){if(ee())try{return yield kt(i,n,a,h,p)}catch{}return function(y,v,w,T,k){const A=y.width,R=y.height;ht&&_t||(ht=new OffscreenCanvas(A,R),_t=ht.getContext("2d",{willReadFrequently:!0})),ht.width=A,ht.height=R,_t.drawImage(y,0,0,A,R);const V=_t.getImageData(v,w,T,k);return _t.clearRect(0,0,A,R),V.data}(i,n,a,h,p)})},u.by=q0,u.bz=I,u.c=hn,u.d=function(i,n){const a=new Image;a.onload=()=>{n(null,a),URL.revokeObjectURL(a.src),a.onload=null,window.requestAnimationFrame(()=>{a.src=dt})},a.onerror=()=>n(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const h=new Blob([new Uint8Array(i)],{type:"image/png"});a.src=i.byteLength?URL.createObjectURL(h):dt},u.e=Me,u.f=function(i,n){return Gn(Me(i,{type:"json"}),n)},u.g=tr,u.h=Zt,u.i=xt,u.j=ro,u.k=no,u.l=to,u.m=Gn,u.n=function(i){return new Xm(i).readFields(UC,[])},u.o=function(i,n,a){if(!i.length)return a(null,[]);let h=i.length;const p=new Array(i.length);let y=null;i.forEach((v,w)=>{n(v,(T,k)=>{T&&(y=T),p[w]=k,--h==0&&a(y,p)})})},u.p=T0,u.q=Dc,u.r=Vn,u.s=jr,u.t=Em,u.u=Ke,u.v=Ae,u.w=Ft,u.x=Bl,u.y=Io,u.z=function([i,n,a]){return n+=90,n*=Math.PI/180,a*=Math.PI/180,{x:i*Math.cos(n)*Math.sin(a),y:i*Math.sin(n)*Math.sin(a),z:i*Math.cos(a)}}}),m(["./shared"],function(u){class C{constructor(P){this.keyCache={},P&&this.replace(P)}replace(P){this._layerConfigs={},this._layers={},this.update(P,[])}update(P,F){for(const H of P){this._layerConfigs[H.id]=H;const W=this._layers[H.id]=u.aC(H);W._featureFilter=u.a6(W.filter),this.keyCache[H.id]&&delete this.keyCache[H.id]}for(const H of F)delete this.keyCache[H],delete this._layerConfigs[H],delete this._layers[H];this.familiesBySource={};const Z=u.bl(Object.values(this._layerConfigs),this.keyCache);for(const H of Z){const W=H.map(ke=>this._layers[ke.id]),ce=W[0];if(ce.visibility==="none")continue;const ne=ce.source||"";let Q=this.familiesBySource[ne];Q||(Q=this.familiesBySource[ne]={});const fe=ce.sourceLayer||"_geojsonTileLayer";let we=Q[fe];we||(we=Q[fe]=[]),we.push(W)}}}class I{constructor(P){const F={},Z=[];for(const ne in P){const Q=P[ne],fe=F[ne]={};for(const we in Q){const ke=Q[+we];if(!ke||ke.bitmap.width===0||ke.bitmap.height===0)continue;const Pe={x:0,y:0,w:ke.bitmap.width+2,h:ke.bitmap.height+2};Z.push(Pe),fe[we]={rect:Pe,metrics:ke.metrics}}}const{w:H,h:W}=u.p(Z),ce=new u.q({width:H||1,height:W||1});for(const ne in P){const Q=P[ne];for(const fe in Q){const we=Q[+fe];if(!we||we.bitmap.width===0||we.bitmap.height===0)continue;const ke=F[ne][fe].rect;u.q.copy(we.bitmap,ce,{x:0,y:0},{x:ke.x+1,y:ke.y+1},we.bitmap)}}this.image=ce,this.positions=F}}u.bm("GlyphAtlas",I);class D{constructor(P){this.tileID=new u.O(P.tileID.overscaledZ,P.tileID.wrap,P.tileID.canonical.z,P.tileID.canonical.x,P.tileID.canonical.y),this.uid=P.uid,this.zoom=P.zoom,this.pixelRatio=P.pixelRatio,this.tileSize=P.tileSize,this.source=P.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=P.showCollisionBoxes,this.collectResourceTiming=!!P.collectResourceTiming,this.returnDependencies=!!P.returnDependencies,this.promoteId=P.promoteId,this.inFlightDependencies=[],this.dependencySentinel=-1}parse(P,F,Z,H,W){this.status="parsing",this.data=P,this.collisionBoxArray=new u.a3;const ce=new u.bn(Object.keys(P.layers).sort()),ne=new u.bo(this.tileID,this.promoteId);ne.bucketLayerIDs=[];const Q={},fe={featureIndex:ne,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:Z},we=F.familiesBySource[this.source];for(const Nt in we){const Bt=P.layers[Nt];if(!Bt)continue;Bt.version===1&&u.w(`Vector tile source "${this.source}" layer "${Nt}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Wn=ce.encode(Nt),Xt=[];for(let wn=0;wn<Bt.length;wn++){const Pt=Bt.feature(wn),Wt=ne.getId(Pt,Nt);Xt.push({feature:Pt,id:Wt,index:wn,sourceLayerIndex:Wn})}for(const wn of we[Nt]){const Pt=wn[0];Pt.source!==this.source&&u.w(`layer.source = ${Pt.source} does not equal this.source = ${this.source}`),Pt.minzoom&&this.zoom<Math.floor(Pt.minzoom)||Pt.maxzoom&&this.zoom>=Pt.maxzoom||Pt.visibility!=="none"&&(O(wn,this.zoom,Z),(Q[Pt.id]=Pt.createBucket({index:ne.bucketLayerIDs.length,layers:wn,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Wn,sourceID:this.source})).populate(Xt,fe,this.tileID.canonical),ne.bucketLayerIDs.push(wn.map(Wt=>Wt.id)))}}let ke,Pe,et,nt;const Ye=u.aH(fe.glyphDependencies,Nt=>Object.keys(Nt).map(Number));this.inFlightDependencies.forEach(Nt=>Nt==null?void 0:Nt.cancel()),this.inFlightDependencies=[];const ut=++this.dependencySentinel;Object.keys(Ye).length?this.inFlightDependencies.push(H.send("getGlyphs",{uid:this.uid,stacks:Ye,source:this.source,tileID:this.tileID,type:"glyphs"},(Nt,Bt)=>{ut===this.dependencySentinel&&(ke||(ke=Nt,Pe=Bt,Ht.call(this)))})):Pe={};const yt=Object.keys(fe.iconDependencies);yt.length?this.inFlightDependencies.push(H.send("getImages",{icons:yt,source:this.source,tileID:this.tileID,type:"icons"},(Nt,Bt)=>{ut===this.dependencySentinel&&(ke||(ke=Nt,et=Bt,Ht.call(this)))})):et={};const Ot=Object.keys(fe.patternDependencies);function Ht(){if(ke)return W(ke);if(Pe&&et&&nt){const Nt=new I(Pe),Bt=new u.bp(et,nt);for(const Wn in Q){const Xt=Q[Wn];Xt instanceof u.a4?(O(Xt.layers,this.zoom,Z),u.bq({bucket:Xt,glyphMap:Pe,glyphPositions:Nt.positions,imageMap:et,imagePositions:Bt.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):Xt.hasPattern&&(Xt instanceof u.br||Xt instanceof u.bs||Xt instanceof u.bt)&&(O(Xt.layers,this.zoom,Z),Xt.addFeatures(fe,this.tileID.canonical,Bt.patternPositions))}this.status="done",W(null,{buckets:Object.values(Q).filter(Wn=>!Wn.isEmpty()),featureIndex:ne,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Nt.image,imageAtlas:Bt,glyphMap:this.returnDependencies?Pe:null,iconMap:this.returnDependencies?et:null,glyphPositions:this.returnDependencies?Nt.positions:null})}}Ot.length?this.inFlightDependencies.push(H.send("getImages",{icons:Ot,source:this.source,tileID:this.tileID,type:"patterns"},(Nt,Bt)=>{ut===this.dependencySentinel&&(ke||(ke=Nt,nt=Bt,Ht.call(this)))})):nt={},Ht.call(this)}}function O(B,P,F){const Z=new u.a8(P);for(const H of B)H.recalculate(Z,F)}function U(B,P){const F=u.l(B.request,(Z,H,W,ce)=>{if(Z)P(Z);else if(H)try{const ne=new u.bw.VectorTile(new u.bv(H));P(null,{vectorTile:ne,rawData:H,cacheControl:W,expires:ce})}catch(ne){const Q=new Uint8Array(H);let fe=`Unable to parse the tile at ${B.request.url}, `;fe+=Q[0]===31&&Q[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${ne.messge}`,P(new Error(fe))}});return()=>{F.cancel(),P()}}class le{constructor(P,F,Z,H){this.actor=P,this.layerIndex=F,this.availableImages=Z,this.loadVectorData=H||U,this.fetching={},this.loading={},this.loaded={}}loadTile(P,F){const Z=P.uid;this.loading||(this.loading={});const H=!!(P&&P.request&&P.request.collectResourceTiming)&&new u.bu(P.request),W=this.loading[Z]=new D(P);W.abort=this.loadVectorData(P,(ce,ne)=>{if(delete this.loading[Z],ce||!ne)return W.status="done",this.loaded[Z]=W,F(ce);const Q=ne.rawData,fe={};ne.expires&&(fe.expires=ne.expires),ne.cacheControl&&(fe.cacheControl=ne.cacheControl);const we={};if(H){const ke=H.finish();ke&&(we.resourceTiming=JSON.parse(JSON.stringify(ke)))}W.vectorTile=ne.vectorTile,W.parse(ne.vectorTile,this.layerIndex,this.availableImages,this.actor,(ke,Pe)=>{if(delete this.fetching[Z],ke||!Pe)return F(ke);F(null,u.e({rawTileData:Q.slice(0)},Pe,fe,we))}),this.loaded=this.loaded||{},this.loaded[Z]=W,this.fetching[Z]={rawTileData:Q,cacheControl:fe,resourceTiming:we}})}reloadTile(P,F){const Z=this.loaded,H=P.uid;if(Z&&Z[H]){const W=Z[H];W.showCollisionBoxes=P.showCollisionBoxes,W.status==="parsing"?W.parse(W.vectorTile,this.layerIndex,this.availableImages,this.actor,(ce,ne)=>{if(ce||!ne)return F(ce,ne);let Q;if(this.fetching[H]){const{rawTileData:fe,cacheControl:we,resourceTiming:ke}=this.fetching[H];delete this.fetching[H],Q=u.e({rawTileData:fe.slice(0)},ne,we,ke)}else Q=ne;F(null,Q)}):W.status==="done"&&(W.vectorTile?W.parse(W.vectorTile,this.layerIndex,this.availableImages,this.actor,F):F())}}abortTile(P,F){const Z=this.loading,H=P.uid;Z&&Z[H]&&Z[H].abort&&(Z[H].abort(),delete Z[H]),F()}removeTile(P,F){const Z=this.loaded,H=P.uid;Z&&Z[H]&&delete Z[H],F()}}class ue{constructor(){this.loaded={}}loadTile(P,F){return u._(this,void 0,void 0,function*(){const{uid:Z,encoding:H,rawImageData:W,redFactor:ce,greenFactor:ne,blueFactor:Q,baseShift:fe}=P,we=W.width+2,ke=W.height+2,Pe=u.a(W)?new u.R({width:we,height:ke},yield u.bx(W,-1,-1,we,ke)):W,et=new u.by(Z,Pe,H,ce,ne,Q,fe);this.loaded=this.loaded||{},this.loaded[Z]=et,F(null,et)})}removeTile(P){const F=this.loaded,Z=P.uid;F&&F[Z]&&delete F[Z]}}function ae(B,P){if(B.length!==0){oe(B[0],P);for(var F=1;F<B.length;F++)oe(B[F],!P)}}function oe(B,P){for(var F=0,Z=0,H=0,W=B.length,ce=W-1;H<W;ce=H++){var ne=(B[H][0]-B[ce][0])*(B[ce][1]+B[H][1]),Q=F+ne;Z+=Math.abs(F)>=Math.abs(ne)?F-Q+ne:ne-Q+F,F=Q}F+Z>=0!=!!P&&B.reverse()}var $=u.bz(function B(P,F){var Z,H=P&&P.type;if(H==="FeatureCollection")for(Z=0;Z<P.features.length;Z++)B(P.features[Z],F);else if(H==="GeometryCollection")for(Z=0;Z<P.geometries.length;Z++)B(P.geometries[Z],F);else if(H==="Feature")B(P.geometry,F);else if(H==="Polygon")ae(P.coordinates,F);else if(H==="MultiPolygon")for(Z=0;Z<P.coordinates.length;Z++)ae(P.coordinates[Z],F);return P});const G=u.bw.VectorTileFeature.prototype.toGeoJSON;var ee={exports:{}},_e=u.bA,Ce=u.bw.VectorTileFeature,de=be;function be(B,P){this.options=P||{},this.features=B,this.length=B.length}function Me(B,P){this.id=typeof B.id=="number"?B.id:void 0,this.type=B.type,this.rawGeometry=B.type===1?[B.geometry]:B.geometry,this.properties=B.tags,this.extent=P||4096}be.prototype.feature=function(B){return new Me(this.features[B],this.options.extent)},Me.prototype.loadGeometry=function(){var B=this.rawGeometry;this.geometry=[];for(var P=0;P<B.length;P++){for(var F=B[P],Z=[],H=0;H<F.length;H++)Z.push(new _e(F[H][0],F[H][1]));this.geometry.push(Z)}return this.geometry},Me.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var B=this.geometry,P=1/0,F=-1/0,Z=1/0,H=-1/0,W=0;W<B.length;W++)for(var ce=B[W],ne=0;ne<ce.length;ne++){var Q=ce[ne];P=Math.min(P,Q.x),F=Math.max(F,Q.x),Z=Math.min(Z,Q.y),H=Math.max(H,Q.y)}return[P,Z,F,H]},Me.prototype.toGeoJSON=Ce.prototype.toGeoJSON;var Ze=u.bB,Oe=de;function ft(B){var P=new Ze;return function(F,Z){for(var H in F.layers)Z.writeMessage(3,bt,F.layers[H])}(B,P),P.finish()}function bt(B,P){var F;P.writeVarintField(15,B.version||1),P.writeStringField(1,B.name||""),P.writeVarintField(5,B.extent||4096);var Z={keys:[],values:[],keycache:{},valuecache:{}};for(F=0;F<B.length;F++)Z.feature=B.feature(F),P.writeMessage(2,Rt,Z);var H=Z.keys;for(F=0;F<H.length;F++)P.writeStringField(3,H[F]);var W=Z.values;for(F=0;F<W.length;F++)P.writeMessage(4,Be,W[F])}function Rt(B,P){var F=B.feature;F.id!==void 0&&P.writeVarintField(1,F.id),P.writeMessage(2,Ft,B),P.writeVarintField(3,F.type),P.writeMessage(4,xt,F)}function Ft(B,P){var F=B.feature,Z=B.keys,H=B.values,W=B.keycache,ce=B.valuecache;for(var ne in F.properties){var Q=F.properties[ne],fe=W[ne];if(Q!==null){fe===void 0&&(Z.push(ne),W[ne]=fe=Z.length-1),P.writeVarint(fe);var we=typeof Q;we!=="string"&&we!=="boolean"&&we!=="number"&&(Q=JSON.stringify(Q));var ke=we+":"+Q,Pe=ce[ke];Pe===void 0&&(H.push(Q),ce[ke]=Pe=H.length-1),P.writeVarint(Pe)}}}function It(B,P){return(P<<3)+(7&B)}function zt(B){return B<<1^B>>31}function xt(B,P){for(var F=B.loadGeometry(),Z=B.type,H=0,W=0,ce=F.length,ne=0;ne<ce;ne++){var Q=F[ne],fe=1;Z===1&&(fe=Q.length),P.writeVarint(It(1,fe));for(var we=Z===3?Q.length-1:Q.length,ke=0;ke<we;ke++){ke===1&&Z!==1&&P.writeVarint(It(2,we-1));var Pe=Q[ke].x-H,et=Q[ke].y-W;P.writeVarint(zt(Pe)),P.writeVarint(zt(et)),H+=Pe,W+=et}Z===3&&P.writeVarint(It(7,1))}}function Be(B,P){var F=typeof B;F==="string"?P.writeStringField(1,B):F==="boolean"?P.writeBooleanField(7,B):F==="number"&&(B%1!=0?P.writeDoubleField(3,B):B<0?P.writeSVarintField(6,B):P.writeVarintField(5,B))}ee.exports=ft,ee.exports.fromVectorTileJs=ft,ee.exports.fromGeojsonVt=function(B,P){P=P||{};var F={};for(var Z in B)F[Z]=new Oe(B[Z].features,P),F[Z].name=Z,F[Z].version=P.version,F[Z].extent=P.extent;return ft({layers:F})},ee.exports.GeoJSONWrapper=Oe;var lt=u.bz(ee.exports);const dt={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:B=>B},kt=Math.fround||(ht=new Float32Array(1),B=>(ht[0]=+B,ht[0]));var ht;const _t=3,Tt=5,tn=6;class Zt{constructor(P){this.options=Object.assign(Object.create(dt),P),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(P){const{log:F,minZoom:Z,maxZoom:H}=this.options;F&&console.time("total time");const W=`prepare ${P.length} points`;F&&console.time(W),this.points=P;const ce=[];for(let Q=0;Q<P.length;Q++){const fe=P[Q];if(!fe.geometry)continue;const[we,ke]=fe.geometry.coordinates,Pe=kt(qn(we)),et=kt(tr(ke));ce.push(Pe,et,1/0,Q,-1,1),this.options.reduce&&ce.push(0)}let ne=this.trees[H+1]=this._createTree(ce);F&&console.timeEnd(W);for(let Q=H;Q>=Z;Q--){const fe=+Date.now();ne=this.trees[Q]=this._createTree(this._cluster(ne,Q)),F&&console.log("z%d: %d clusters in %dms",Q,ne.numItems,+Date.now()-fe)}return F&&console.timeEnd("total time"),this}getClusters(P,F){let Z=((P[0]+180)%360+360)%360-180;const H=Math.max(-90,Math.min(90,P[1]));let W=P[2]===180?180:((P[2]+180)%360+360)%360-180;const ce=Math.max(-90,Math.min(90,P[3]));if(P[2]-P[0]>=360)Z=-180,W=180;else if(Z>W){const ke=this.getClusters([Z,H,180,ce],F),Pe=this.getClusters([-180,H,W,ce],F);return ke.concat(Pe)}const ne=this.trees[this._limitZoom(F)],Q=ne.range(qn(Z),tr(ce),qn(W),tr(H)),fe=ne.data,we=[];for(const ke of Q){const Pe=this.stride*ke;we.push(fe[Pe+Tt]>1?hn(fe,Pe,this.clusterProps):this.points[fe[Pe+_t]])}return we}getChildren(P){const F=this._getOriginId(P),Z=this._getOriginZoom(P),H="No cluster with the specified id.",W=this.trees[Z];if(!W)throw new Error(H);const ce=W.data;if(F*this.stride>=ce.length)throw new Error(H);const ne=this.options.radius/(this.options.extent*Math.pow(2,Z-1)),Q=W.within(ce[F*this.stride],ce[F*this.stride+1],ne),fe=[];for(const we of Q){const ke=we*this.stride;ce[ke+4]===P&&fe.push(ce[ke+Tt]>1?hn(ce,ke,this.clusterProps):this.points[ce[ke+_t]])}if(fe.length===0)throw new Error(H);return fe}getLeaves(P,F,Z){const H=[];return this._appendLeaves(H,P,F=F||10,Z=Z||0,0),H}getTile(P,F,Z){const H=this.trees[this._limitZoom(P)],W=Math.pow(2,P),{extent:ce,radius:ne}=this.options,Q=ne/ce,fe=(Z-Q)/W,we=(Z+1+Q)/W,ke={features:[]};return this._addTileFeatures(H.range((F-Q)/W,fe,(F+1+Q)/W,we),H.data,F,Z,W,ke),F===0&&this._addTileFeatures(H.range(1-Q/W,fe,1,we),H.data,W,Z,W,ke),F===W-1&&this._addTileFeatures(H.range(0,fe,Q/W,we),H.data,-1,Z,W,ke),ke.features.length?ke:null}getClusterExpansionZoom(P){let F=this._getOriginZoom(P)-1;for(;F<=this.options.maxZoom;){const Z=this.getChildren(P);if(F++,Z.length!==1)break;P=Z[0].properties.cluster_id}return F}_appendLeaves(P,F,Z,H,W){const ce=this.getChildren(F);for(const ne of ce){const Q=ne.properties;if(Q&&Q.cluster?W+Q.point_count<=H?W+=Q.point_count:W=this._appendLeaves(P,Q.cluster_id,Z,H,W):W<H?W++:P.push(ne),P.length===Z)break}return W}_createTree(P){const F=new u.av(P.length/this.stride|0,this.options.nodeSize,Float32Array);for(let Z=0;Z<P.length;Z+=this.stride)F.add(P[Z],P[Z+1]);return F.finish(),F.data=P,F}_addTileFeatures(P,F,Z,H,W,ce){for(const ne of P){const Q=ne*this.stride,fe=F[Q+Tt]>1;let we,ke,Pe;if(fe)we=Mn(F,Q,this.clusterProps),ke=F[Q],Pe=F[Q+1];else{const Ye=this.points[F[Q+_t]];we=Ye.properties;const[ut,yt]=Ye.geometry.coordinates;ke=qn(ut),Pe=tr(yt)}const et={type:1,geometry:[[Math.round(this.options.extent*(ke*W-Z)),Math.round(this.options.extent*(Pe*W-H))]],tags:we};let nt;nt=fe||this.options.generateId?F[Q+_t]:this.points[F[Q+_t]].id,nt!==void 0&&(et.id=nt),ce.features.push(et)}}_limitZoom(P){return Math.max(this.options.minZoom,Math.min(Math.floor(+P),this.options.maxZoom+1))}_cluster(P,F){const{radius:Z,extent:H,reduce:W,minPoints:ce}=this.options,ne=Z/(H*Math.pow(2,F)),Q=P.data,fe=[],we=this.stride;for(let ke=0;ke<Q.length;ke+=we){if(Q[ke+2]<=F)continue;Q[ke+2]=F;const Pe=Q[ke],et=Q[ke+1],nt=P.within(Q[ke],Q[ke+1],ne),Ye=Q[ke+Tt];let ut=Ye;for(const yt of nt){const Ot=yt*we;Q[Ot+2]>F&&(ut+=Q[Ot+Tt])}if(ut>Ye&&ut>=ce){let yt,Ot=Pe*Ye,Ht=et*Ye,Nt=-1;const Bt=((ke/we|0)<<5)+(F+1)+this.points.length;for(const Wn of nt){const Xt=Wn*we;if(Q[Xt+2]<=F)continue;Q[Xt+2]=F;const wn=Q[Xt+Tt];Ot+=Q[Xt]*wn,Ht+=Q[Xt+1]*wn,Q[Xt+4]=Bt,W&&(yt||(yt=this._map(Q,ke,!0),Nt=this.clusterProps.length,this.clusterProps.push(yt)),W(yt,this._map(Q,Xt)))}Q[ke+4]=Bt,fe.push(Ot/ut,Ht/ut,1/0,Bt,-1,ut),W&&fe.push(Nt)}else{for(let yt=0;yt<we;yt++)fe.push(Q[ke+yt]);if(ut>1)for(const yt of nt){const Ot=yt*we;if(!(Q[Ot+2]<=F)){Q[Ot+2]=F;for(let Ht=0;Ht<we;Ht++)fe.push(Q[Ot+Ht])}}}}return fe}_getOriginId(P){return P-this.points.length>>5}_getOriginZoom(P){return(P-this.points.length)%32}_map(P,F,Z){if(P[F+Tt]>1){const ce=this.clusterProps[P[F+tn]];return Z?Object.assign({},ce):ce}const H=this.points[P[F+_t]].properties,W=this.options.map(H);return Z&&W===H?Object.assign({},W):W}}function hn(B,P,F){return{type:"Feature",id:B[P+_t],properties:Mn(B,P,F),geometry:{type:"Point",coordinates:[(Z=B[P],360*(Z-.5)),xn(B[P+1])]}};var Z}function Mn(B,P,F){const Z=B[P+Tt],H=Z>=1e4?`${Math.round(Z/1e3)}k`:Z>=1e3?Math.round(Z/100)/10+"k":Z,W=B[P+tn],ce=W===-1?{}:Object.assign({},F[W]);return Object.assign(ce,{cluster:!0,cluster_id:B[P+_t],point_count:Z,point_count_abbreviated:H})}function qn(B){return B/360+.5}function tr(B){const P=Math.sin(B*Math.PI/180),F=.5-.25*Math.log((1+P)/(1-P))/Math.PI;return F<0?0:F>1?1:F}function xn(B){const P=(180-360*B)*Math.PI/180;return 360*Math.atan(Math.exp(P))/Math.PI-90}function Gn(B,P,F,Z){for(var H,W=Z,ce=F-P>>1,ne=F-P,Q=B[P],fe=B[P+1],we=B[F],ke=B[F+1],Pe=P+3;Pe<F;Pe+=3){var et=to(B[Pe],B[Pe+1],Q,fe,we,ke);if(et>W)H=Pe,W=et;else if(et===W){var nt=Math.abs(Pe-ce);nt<ne&&(H=Pe,ne=nt)}}W>Z&&(H-P>3&&Gn(B,P,H,Z),B[H+2]=W,F-H>3&&Gn(B,H,F,Z))}function to(B,P,F,Z,H,W){var ce=H-F,ne=W-Z;if(ce!==0||ne!==0){var Q=((B-F)*ce+(P-Z)*ne)/(ce*ce+ne*ne);Q>1?(F=H,Z=W):Q>0&&(F+=ce*Q,Z+=ne*Q)}return(ce=B-F)*ce+(ne=P-Z)*ne}function jr(B,P,F,Z){var H={id:B===void 0?null:B,type:P,geometry:F,tags:Z,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(W){var ce=W.geometry,ne=W.type;if(ne==="Point"||ne==="MultiPoint"||ne==="LineString")wr(W,ce);else if(ne==="Polygon"||ne==="MultiLineString")for(var Q=0;Q<ce.length;Q++)wr(W,ce[Q]);else if(ne==="MultiPolygon")for(Q=0;Q<ce.length;Q++)for(var fe=0;fe<ce[Q].length;fe++)wr(W,ce[Q][fe])}(H),H}function wr(B,P){for(var F=0;F<P.length;F+=3)B.minX=Math.min(B.minX,P[F]),B.minY=Math.min(B.minY,P[F+1]),B.maxX=Math.max(B.maxX,P[F]),B.maxY=Math.max(B.maxY,P[F+1])}function wo(B,P,F,Z){if(P.geometry){var H=P.geometry.coordinates,W=P.geometry.type,ce=Math.pow(F.tolerance/((1<<F.maxZoom)*F.extent),2),ne=[],Q=P.id;if(F.promoteId?Q=P.properties[F.promoteId]:F.generateId&&(Q=Z||0),W==="Point")no(H,ne);else if(W==="MultiPoint")for(var fe=0;fe<H.length;fe++)no(H[fe],ne);else if(W==="LineString")ro(H,ne,ce,!1);else if(W==="MultiLineString"){if(F.lineMetrics){for(fe=0;fe<H.length;fe++)ro(H[fe],ne=[],ce,!1),B.push(jr(Q,"LineString",ne,P.properties));return}bo(H,ne,ce,!1)}else if(W==="Polygon")bo(H,ne,ce,!0);else{if(W!=="MultiPolygon"){if(W==="GeometryCollection"){for(fe=0;fe<P.geometry.geometries.length;fe++)wo(B,{id:Q,geometry:P.geometry.geometries[fe],properties:P.properties},F,Z);return}throw new Error("Input data is not a valid GeoJSON object.")}for(fe=0;fe<H.length;fe++){var we=[];bo(H[fe],we,ce,!0),ne.push(we)}}B.push(jr(Q,W,ne,P.properties))}}function no(B,P){P.push(Ae(B[0])),P.push(Hn(B[1])),P.push(0)}function ro(B,P,F,Z){for(var H,W,ce=0,ne=0;ne<B.length;ne++){var Q=Ae(B[ne][0]),fe=Hn(B[ne][1]);P.push(Q),P.push(fe),P.push(0),ne>0&&(ce+=Z?(H*fe-Q*W)/2:Math.sqrt(Math.pow(Q-H,2)+Math.pow(fe-W,2))),H=Q,W=fe}var we=P.length-3;P[2]=1,Gn(P,0,we,F),P[we+2]=1,P.size=Math.abs(ce),P.start=0,P.end=P.size}function bo(B,P,F,Z){for(var H=0;H<B.length;H++){var W=[];ro(B[H],W,F,Z),P.push(W)}}function Ae(B){return B/360+.5}function Hn(B){var P=Math.sin(B*Math.PI/180),F=.5-.25*Math.log((1+P)/(1-P))/Math.PI;return F<0?0:F>1?1:F}function Ar(B,P,F,Z,H,W,ce,ne){if(Z/=P,W>=(F/=P)&&ce<Z)return B;if(ce<F||W>=Z)return null;for(var Q=[],fe=0;fe<B.length;fe++){var we=B[fe],ke=we.geometry,Pe=we.type,et=H===0?we.minX:we.minY,nt=H===0?we.maxX:we.maxY;if(et>=F&&nt<Z)Q.push(we);else if(!(nt<F||et>=Z)){var Ye=[];if(Pe==="Point"||Pe==="MultiPoint")nn(ke,Ye,F,Z,H);else if(Pe==="LineString")Dt(ke,Ye,F,Z,H,!1,ne.lineMetrics);else if(Pe==="MultiLineString")So(ke,Ye,F,Z,H,!1);else if(Pe==="Polygon")So(ke,Ye,F,Z,H,!0);else if(Pe==="MultiPolygon")for(var ut=0;ut<ke.length;ut++){var yt=[];So(ke[ut],yt,F,Z,H,!0),yt.length&&Ye.push(yt)}if(Ye.length){if(ne.lineMetrics&&Pe==="LineString"){for(ut=0;ut<Ye.length;ut++)Q.push(jr(we.id,Pe,Ye[ut],we.tags));continue}Pe!=="LineString"&&Pe!=="MultiLineString"||(Ye.length===1?(Pe="LineString",Ye=Ye[0]):Pe="MultiLineString"),Pe!=="Point"&&Pe!=="MultiPoint"||(Pe=Ye.length===3?"Point":"MultiPoint"),Q.push(jr(we.id,Pe,Ye,we.tags))}}}return Q.length?Q:null}function nn(B,P,F,Z,H){for(var W=0;W<B.length;W+=3){var ce=B[W+H];ce>=F&&ce<=Z&&(P.push(B[W]),P.push(B[W+1]),P.push(B[W+2]))}}function Dt(B,P,F,Z,H,W,ce){for(var ne,Q,fe=br(B),we=H===0?Va:zr,ke=B.start,Pe=0;Pe<B.length-3;Pe+=3){var et=B[Pe],nt=B[Pe+1],Ye=B[Pe+2],ut=B[Pe+3],yt=B[Pe+4],Ot=H===0?et:nt,Ht=H===0?ut:yt,Nt=!1;ce&&(ne=Math.sqrt(Math.pow(et-ut,2)+Math.pow(nt-yt,2))),Ot<F?Ht>F&&(Q=we(fe,et,nt,ut,yt,F),ce&&(fe.start=ke+ne*Q)):Ot>Z?Ht<Z&&(Q=we(fe,et,nt,ut,yt,Z),ce&&(fe.start=ke+ne*Q)):Zr(fe,et,nt,Ye),Ht<F&&Ot>=F&&(Q=we(fe,et,nt,ut,yt,F),Nt=!0),Ht>Z&&Ot<=Z&&(Q=we(fe,et,nt,ut,yt,Z),Nt=!0),!W&&Nt&&(ce&&(fe.end=ke+ne*Q),P.push(fe),fe=br(B)),ce&&(ke+=ne)}var Bt=B.length-3;et=B[Bt],nt=B[Bt+1],Ye=B[Bt+2],(Ot=H===0?et:nt)>=F&&Ot<=Z&&Zr(fe,et,nt,Ye),Bt=fe.length-3,W&&Bt>=3&&(fe[Bt]!==fe[0]||fe[Bt+1]!==fe[1])&&Zr(fe,fe[0],fe[1],fe[2]),fe.length&&P.push(fe)}function br(B){var P=[];return P.size=B.size,P.start=B.start,P.end=B.end,P}function So(B,P,F,Z,H,W){for(var ce=0;ce<B.length;ce++)Dt(B[ce],P,F,Z,H,W,!1)}function Zr(B,P,F,Z){B.push(P),B.push(F),B.push(Z)}function Va(B,P,F,Z,H,W){var ce=(W-P)/(Z-P);return B.push(W),B.push(F+(H-F)*ce),B.push(1),ce}function zr(B,P,F,Z,H,W){var ce=(W-F)/(H-F);return B.push(P+(Z-P)*ce),B.push(W),B.push(1),ce}function Bi(B,P){for(var F=[],Z=0;Z<B.length;Z++){var H,W=B[Z],ce=W.type;if(ce==="Point"||ce==="MultiPoint"||ce==="LineString")H=io(W.geometry,P);else if(ce==="MultiLineString"||ce==="Polygon"){H=[];for(var ne=0;ne<W.geometry.length;ne++)H.push(io(W.geometry[ne],P))}else if(ce==="MultiPolygon")for(H=[],ne=0;ne<W.geometry.length;ne++){for(var Q=[],fe=0;fe<W.geometry[ne].length;fe++)Q.push(io(W.geometry[ne][fe],P));H.push(Q)}F.push(jr(W.id,ce,H,W.tags))}return F}function io(B,P){var F=[];F.size=B.size,B.start!==void 0&&(F.start=B.start,F.end=B.end);for(var Z=0;Z<B.length;Z+=3)F.push(B[Z]+P,B[Z+1],B[Z+2]);return F}function Ne(B,P){if(B.transformed)return B;var F,Z,H,W=1<<B.z,ce=B.x,ne=B.y;for(F=0;F<B.features.length;F++){var Q=B.features[F],fe=Q.geometry,we=Q.type;if(Q.geometry=[],we===1)for(Z=0;Z<fe.length;Z+=2)Q.geometry.push(wi(fe[Z],fe[Z+1],P,W,ce,ne));else for(Z=0;Z<fe.length;Z++){var ke=[];for(H=0;H<fe[Z].length;H+=2)ke.push(wi(fe[Z][H],fe[Z][H+1],P,W,ce,ne));Q.geometry.push(ke)}}return B.transformed=!0,B}function wi(B,P,F,Z,H,W){return[Math.round(F*(B*Z-H)),Math.round(F*(P*Z-W))]}function gn(B,P,F,Z,H){for(var W=P===H.maxZoom?0:H.tolerance/((1<<P)*H.extent),ce={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:F,y:Z,z:P,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},ne=0;ne<B.length;ne++){ce.numFeatures++,bi(ce,B[ne],W,H);var Q=B[ne].minX,fe=B[ne].minY,we=B[ne].maxX,ke=B[ne].maxY;Q<ce.minX&&(ce.minX=Q),fe<ce.minY&&(ce.minY=fe),we>ce.maxX&&(ce.maxX=we),ke>ce.maxY&&(ce.maxY=ke)}return ce}function bi(B,P,F,Z){var H=P.geometry,W=P.type,ce=[];if(W==="Point"||W==="MultiPoint")for(var ne=0;ne<H.length;ne+=3)ce.push(H[ne]),ce.push(H[ne+1]),B.numPoints++,B.numSimplified++;else if(W==="LineString")Si(ce,H,B,F,!1,!1);else if(W==="MultiLineString"||W==="Polygon")for(ne=0;ne<H.length;ne++)Si(ce,H[ne],B,F,W==="Polygon",ne===0);else if(W==="MultiPolygon")for(var Q=0;Q<H.length;Q++){var fe=H[Q];for(ne=0;ne<fe.length;ne++)Si(ce,fe[ne],B,F,!0,ne===0)}if(ce.length){var we=P.tags||null;if(W==="LineString"&&Z.lineMetrics){for(var ke in we={},P.tags)we[ke]=P.tags[ke];we.mapbox_clip_start=H.start/H.size,we.mapbox_clip_end=H.end/H.size}var Pe={geometry:ce,type:W==="Polygon"||W==="MultiPolygon"?3:W==="LineString"||W==="MultiLineString"?2:1,tags:we};P.id!==null&&(Pe.id=P.id),B.features.push(Pe)}}function Si(B,P,F,Z,H,W){var ce=Z*Z;if(Z>0&&P.size<(H?ce:Z))F.numPoints+=P.length/3;else{for(var ne=[],Q=0;Q<P.length;Q+=3)(Z===0||P[Q+2]>ce)&&(F.numSimplified++,ne.push(P[Q]),ne.push(P[Q+1])),F.numPoints++;H&&function(fe,we){for(var ke=0,Pe=0,et=fe.length,nt=et-2;Pe<et;nt=Pe,Pe+=2)ke+=(fe[Pe]-fe[nt])*(fe[Pe+1]+fe[nt+1]);if(ke>0===we)for(Pe=0,et=fe.length;Pe<et/2;Pe+=2){var Ye=fe[Pe],ut=fe[Pe+1];fe[Pe]=fe[et-2-Pe],fe[Pe+1]=fe[et-1-Pe],fe[et-2-Pe]=Ye,fe[et-1-Pe]=ut}}(ne,W),B.push(ne)}}function Ue(B,P){var F=(P=this.options=function(H,W){for(var ce in W)H[ce]=W[ce];return H}(Object.create(this.options),P)).debug;if(F&&console.time("preprocess data"),P.maxZoom<0||P.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(P.promoteId&&P.generateId)throw new Error("promoteId and generateId cannot be used together.");var Z=function(H,W){var ce=[];if(H.type==="FeatureCollection")for(var ne=0;ne<H.features.length;ne++)wo(ce,H.features[ne],W,ne);else wo(ce,H.type==="Feature"?H:{geometry:H},W);return ce}(B,P);this.tiles={},this.tileCoords=[],F&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",P.indexMaxZoom,P.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),Z=function(H,W){var ce=W.buffer/W.extent,ne=H,Q=Ar(H,1,-1-ce,ce,0,-1,2,W),fe=Ar(H,1,1-ce,2+ce,0,-1,2,W);return(Q||fe)&&(ne=Ar(H,1,-ce,1+ce,0,-1,2,W)||[],Q&&(ne=Bi(Q,1).concat(ne)),fe&&(ne=ne.concat(Bi(fe,-1)))),ne}(Z,P),Z.length&&this.splitTile(Z,0,0,0),F&&(Z.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Mt(B,P,F){return 32*((1<<B)*F+P)+B}function vt(B,P){return P?B.properties[P]:B.id}function fr(B,P){if(B==null)return!0;if(B.type==="Feature")return vt(B,P)!=null;if(B.type==="FeatureCollection"){const F=new Set;for(const Z of B.features){const H=vt(Z,P);if(H==null||F.has(H))return!1;F.add(H)}return!0}return!1}function ii(B,P){const F=new Map;if(B!=null)if(B.type==="Feature")F.set(vt(B,P),B);else for(const Z of B.features)F.set(vt(Z,P),Z);return F}Ue.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Ue.prototype.splitTile=function(B,P,F,Z,H,W,ce){for(var ne=[B,P,F,Z],Q=this.options,fe=Q.debug;ne.length;){Z=ne.pop(),F=ne.pop(),P=ne.pop(),B=ne.pop();var we=1<<P,ke=Mt(P,F,Z),Pe=this.tiles[ke];if(!Pe&&(fe>1&&console.time("creation"),Pe=this.tiles[ke]=gn(B,P,F,Z,Q),this.tileCoords.push({z:P,x:F,y:Z}),fe)){fe>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",P,F,Z,Pe.numFeatures,Pe.numPoints,Pe.numSimplified),console.timeEnd("creation"));var et="z"+P;this.stats[et]=(this.stats[et]||0)+1,this.total++}if(Pe.source=B,H){if(P===Q.maxZoom||P===H)continue;var nt=1<<H-P;if(F!==Math.floor(W/nt)||Z!==Math.floor(ce/nt))continue}else if(P===Q.indexMaxZoom||Pe.numPoints<=Q.indexMaxPoints)continue;if(Pe.source=null,B.length!==0){fe>1&&console.time("clipping");var Ye,ut,yt,Ot,Ht,Nt,Bt=.5*Q.buffer/Q.extent,Wn=.5-Bt,Xt=.5+Bt,wn=1+Bt;Ye=ut=yt=Ot=null,Ht=Ar(B,we,F-Bt,F+Xt,0,Pe.minX,Pe.maxX,Q),Nt=Ar(B,we,F+Wn,F+wn,0,Pe.minX,Pe.maxX,Q),B=null,Ht&&(Ye=Ar(Ht,we,Z-Bt,Z+Xt,1,Pe.minY,Pe.maxY,Q),ut=Ar(Ht,we,Z+Wn,Z+wn,1,Pe.minY,Pe.maxY,Q),Ht=null),Nt&&(yt=Ar(Nt,we,Z-Bt,Z+Xt,1,Pe.minY,Pe.maxY,Q),Ot=Ar(Nt,we,Z+Wn,Z+wn,1,Pe.minY,Pe.maxY,Q),Nt=null),fe>1&&console.timeEnd("clipping"),ne.push(Ye||[],P+1,2*F,2*Z),ne.push(ut||[],P+1,2*F,2*Z+1),ne.push(yt||[],P+1,2*F+1,2*Z),ne.push(Ot||[],P+1,2*F+1,2*Z+1)}}},Ue.prototype.getTile=function(B,P,F){var Z=this.options,H=Z.extent,W=Z.debug;if(B<0||B>24)return null;var ce=1<<B,ne=Mt(B,P=(P%ce+ce)%ce,F);if(this.tiles[ne])return Ne(this.tiles[ne],H);W>1&&console.log("drilling down to z%d-%d-%d",B,P,F);for(var Q,fe=B,we=P,ke=F;!Q&&fe>0;)fe--,we=Math.floor(we/2),ke=Math.floor(ke/2),Q=this.tiles[Mt(fe,we,ke)];return Q&&Q.source?(W>1&&console.log("found parent tile z%d-%d-%d",fe,we,ke),W>1&&console.time("drilling down"),this.splitTile(Q.source,fe,we,ke,B,P,F),W>1&&console.timeEnd("drilling down"),this.tiles[ne]?Ne(this.tiles[ne],H):null):null};class Ct extends le{constructor(P,F,Z,H){super(P,F,Z),this._dataUpdateable=new Map,this.loadGeoJSON=(W,ce)=>{const{promoteId:ne}=W;if(W.request)return u.f(W.request,(Q,fe,we,ke)=>{this._dataUpdateable=fr(fe,ne)?ii(fe,ne):void 0,ce(Q,fe,we,ke)});if(typeof W.data=="string")try{const Q=JSON.parse(W.data);this._dataUpdateable=fr(Q,ne)?ii(Q,ne):void 0,ce(null,Q)}catch{ce(new Error(`Input data given to '${W.source}' is not a valid GeoJSON object.`))}else W.dataDiff?this._dataUpdateable?(function(Q,fe,we){var ke,Pe,et,nt;if(fe.removeAll&&Q.clear(),fe.remove)for(const Ye of fe.remove)Q.delete(Ye);if(fe.add)for(const Ye of fe.add){const ut=vt(Ye,we);ut!=null&&Q.set(ut,Ye)}if(fe.update)for(const Ye of fe.update){let ut=Q.get(Ye.id);if(ut==null)continue;const yt=!Ye.removeAllProperties&&(((ke=Ye.removeProperties)===null||ke===void 0?void 0:ke.length)>0||((Pe=Ye.addOrUpdateProperties)===null||Pe===void 0?void 0:Pe.length)>0);if((Ye.newGeometry||Ye.removeAllProperties||yt)&&(ut=Object.assign({},ut),Q.set(Ye.id,ut),yt&&(ut.properties=Object.assign({},ut.properties))),Ye.newGeometry&&(ut.geometry=Ye.newGeometry),Ye.removeAllProperties)ut.properties={};else if(((et=Ye.removeProperties)===null||et===void 0?void 0:et.length)>0)for(const Ot of Ye.removeProperties)Object.prototype.hasOwnProperty.call(ut.properties,Ot)&&delete ut.properties[Ot];if(((nt=Ye.addOrUpdateProperties)===null||nt===void 0?void 0:nt.length)>0)for(const{key:Ot,value:Ht}of Ye.addOrUpdateProperties)ut.properties[Ot]=Ht}}(this._dataUpdateable,W.dataDiff,ne),ce(null,{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())})):ce(new Error(`Cannot update existing geojson data in ${W.source}`)):ce(new Error(`Input data given to '${W.source}' is not a valid GeoJSON object.`));return{cancel:()=>{}}},this.loadVectorData=this.loadGeoJSONTile,H&&(this.loadGeoJSON=H)}loadGeoJSONTile(P,F){const Z=P.tileID.canonical;if(!this._geoJSONIndex)return F(null,null);const H=this._geoJSONIndex.getTile(Z.z,Z.x,Z.y);if(!H)return F(null,null);const W=new class{constructor(ne){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=u.N,this.length=ne.length,this._features=ne}feature(ne){return new class{constructor(Q){this._feature=Q,this.extent=u.N,this.type=Q.type,this.properties=Q.tags,"id"in Q&&!isNaN(Q.id)&&(this.id=parseInt(Q.id,10))}loadGeometry(){if(this._feature.type===1){const Q=[];for(const fe of this._feature.geometry)Q.push([new u.P(fe[0],fe[1])]);return Q}{const Q=[];for(const fe of this._feature.geometry){const we=[];for(const ke of fe)we.push(new u.P(ke[0],ke[1]));Q.push(we)}return Q}}toGeoJSON(Q,fe,we){return G.call(this,Q,fe,we)}}(this._features[ne])}}(H.features);let ce=lt(W);ce.byteOffset===0&&ce.byteLength===ce.buffer.byteLength||(ce=new Uint8Array(ce)),F(null,{vectorTile:W,rawData:ce.buffer})}loadData(P,F){var Z;(Z=this._pendingRequest)===null||Z===void 0||Z.cancel(),this._pendingCallback&&this._pendingCallback(null,{abandoned:!0});const H=!!(P&&P.request&&P.request.collectResourceTiming)&&new u.bu(P.request);this._pendingCallback=F,this._pendingRequest=this.loadGeoJSON(P,(W,ce)=>{if(delete this._pendingCallback,delete this._pendingRequest,W||!ce)return F(W);if(typeof ce!="object")return F(new Error(`Input data given to '${P.source}' is not a valid GeoJSON object.`));{$(ce,!0);try{if(P.filter){const Q=u.bC(P.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(Q.result==="error")throw new Error(Q.value.map(we=>`${we.key}: ${we.message}`).join(", "));ce={type:"FeatureCollection",features:ce.features.filter(we=>Q.value.evaluate({zoom:0},we))}}this._geoJSONIndex=P.cluster?new Zt(function({superclusterOptions:Q,clusterProperties:fe}){if(!fe||!Q)return Q;const we={},ke={},Pe={accumulated:null,zoom:0},et={properties:null},nt=Object.keys(fe);for(const Ye of nt){const[ut,yt]=fe[Ye],Ot=u.bC(yt),Ht=u.bC(typeof ut=="string"?[ut,["accumulated"],["get",Ye]]:ut);we[Ye]=Ot.value,ke[Ye]=Ht.value}return Q.map=Ye=>{et.properties=Ye;const ut={};for(const yt of nt)ut[yt]=we[yt].evaluate(Pe,et);return ut},Q.reduce=(Ye,ut)=>{et.properties=ut;for(const yt of nt)Pe.accumulated=Ye[yt],Ye[yt]=ke[yt].evaluate(Pe,et)},Q}(P)).load(ce.features):function(Q,fe){return new Ue(Q,fe)}(ce,P.geojsonVtOptions)}catch(Q){return F(Q)}this.loaded={};const ne={};if(H){const Q=H.finish();Q&&(ne.resourceTiming={},ne.resourceTiming[P.source]=JSON.parse(JSON.stringify(Q)))}F(null,ne)}})}reloadTile(P,F){const Z=this.loaded;return Z&&Z[P.uid]?super.reloadTile(P,F):this.loadTile(P,F)}removeSource(P,F){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),F()}getClusterExpansionZoom(P,F){try{F(null,this._geoJSONIndex.getClusterExpansionZoom(P.clusterId))}catch(Z){F(Z)}}getClusterChildren(P,F){try{F(null,this._geoJSONIndex.getChildren(P.clusterId))}catch(Z){F(Z)}}getClusterLeaves(P,F){try{F(null,this._geoJSONIndex.getLeaves(P.clusterId,P.limit,P.offset))}catch(Z){F(Z)}}}class xe{constructor(P){this.self=P,this.actor=new u.C(P,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:le,geojson:Ct},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(F,Z)=>{if(this.workerSourceTypes[F])throw new Error(`Worker source with name "${F}" already registered.`);this.workerSourceTypes[F]=Z},this.self.registerRTLTextPlugin=F=>{if(u.bD.isParsed())throw new Error("RTL text plugin already registered.");u.bD.applyArabicShaping=F.applyArabicShaping,u.bD.processBidirectionalText=F.processBidirectionalText,u.bD.processStyledBidirectionalText=F.processStyledBidirectionalText}}setReferrer(P,F){this.referrer=F}setImages(P,F,Z){this.availableImages[P]=F;for(const H in this.workerSources[P]){const W=this.workerSources[P][H];for(const ce in W)W[ce].availableImages=F}Z()}setLayers(P,F,Z){this.getLayerIndex(P).replace(F),Z()}updateLayers(P,F,Z){this.getLayerIndex(P).update(F.layers,F.removedIds),Z()}loadTile(P,F,Z){this.getWorkerSource(P,F.type,F.source).loadTile(F,Z)}loadDEMTile(P,F,Z){this.getDEMWorkerSource(P,F.source).loadTile(F,Z)}reloadTile(P,F,Z){this.getWorkerSource(P,F.type,F.source).reloadTile(F,Z)}abortTile(P,F,Z){this.getWorkerSource(P,F.type,F.source).abortTile(F,Z)}removeTile(P,F,Z){this.getWorkerSource(P,F.type,F.source).removeTile(F,Z)}removeDEMTile(P,F){this.getDEMWorkerSource(P,F.source).removeTile(F)}removeSource(P,F,Z){if(!this.workerSources[P]||!this.workerSources[P][F.type]||!this.workerSources[P][F.type][F.source])return;const H=this.workerSources[P][F.type][F.source];delete this.workerSources[P][F.type][F.source],H.removeSource!==void 0?H.removeSource(F,Z):Z()}loadWorkerSource(P,F,Z){try{this.self.importScripts(F.url),Z()}catch(H){Z(H.toString())}}syncRTLPluginState(P,F,Z){try{u.bD.setState(F);const H=u.bD.getPluginURL();if(u.bD.isLoaded()&&!u.bD.isParsed()&&H!=null){this.self.importScripts(H);const W=u.bD.isParsed();Z(W?void 0:new Error(`RTL Text Plugin failed to import scripts from ${H}`),W)}}catch(H){Z(H.toString())}}getAvailableImages(P){let F=this.availableImages[P];return F||(F=[]),F}getLayerIndex(P){let F=this.layerIndexes[P];return F||(F=this.layerIndexes[P]=new C),F}getWorkerSource(P,F,Z){return this.workerSources[P]||(this.workerSources[P]={}),this.workerSources[P][F]||(this.workerSources[P][F]={}),this.workerSources[P][F][Z]||(this.workerSources[P][F][Z]=new this.workerSourceTypes[F]({send:(H,W,ce)=>{this.actor.send(H,W,ce,P)}},this.getLayerIndex(P),this.getAvailableImages(P))),this.workerSources[P][F][Z]}getDEMWorkerSource(P,F){return this.demWorkerSources[P]||(this.demWorkerSources[P]={}),this.demWorkerSources[P][F]||(this.demWorkerSources[P][F]=new ue),this.demWorkerSources[P][F]}}return u.i()&&(self.worker=new xe(self)),xe}),m(["./shared"],function(u){var C="3.6.2";class I{static testProp(r){if(!I.docStyle)return r[0];for(let s=0;s<r.length;s++)if(r[s]in I.docStyle)return r[s];return r[0]}static create(r,s,d){const f=window.document.createElement(r);return s!==void 0&&(f.className=s),d&&d.appendChild(f),f}static createNS(r,s){return window.document.createElementNS(r,s)}static disableDrag(){I.docStyle&&I.selectProp&&(I.userSelect=I.docStyle[I.selectProp],I.docStyle[I.selectProp]="none")}static enableDrag(){I.docStyle&&I.selectProp&&(I.docStyle[I.selectProp]=I.userSelect)}static setTransform(r,s){r.style[I.transformProp]=s}static addEventListener(r,s,d,f={}){r.addEventListener(s,d,"passive"in f?f:f.capture)}static removeEventListener(r,s,d,f={}){r.removeEventListener(s,d,"passive"in f?f:f.capture)}static suppressClickInternal(r){r.preventDefault(),r.stopPropagation(),window.removeEventListener("click",I.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",I.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",I.suppressClickInternal,!0)},0)}static mousePos(r,s){const d=r.getBoundingClientRect();return new u.P(s.clientX-d.left-r.clientLeft,s.clientY-d.top-r.clientTop)}static touchPos(r,s){const d=r.getBoundingClientRect(),f=[];for(let _=0;_<s.length;_++)f.push(new u.P(s[_].clientX-d.left-r.clientLeft,s[_].clientY-d.top-r.clientTop));return f}static mouseButton(r){return r.button}static remove(r){r.parentNode&&r.parentNode.removeChild(r)}}I.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,I.selectProp=I.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),I.transformProp=I.testProp(["transform","WebkitTransform"]);const D={supported:!1,testSupport:function(g){!le&&U&&(ue?ae(g):O=g)}};let O,U,le=!1,ue=!1;function ae(g){const r=g.createTexture();g.bindTexture(g.TEXTURE_2D,r);try{if(g.texImage2D(g.TEXTURE_2D,0,g.RGBA,g.RGBA,g.UNSIGNED_BYTE,U),g.isContextLost())return;D.supported=!0}catch{}g.deleteTexture(r),le=!0}var oe,$;typeof document<"u"&&(U=document.createElement("img"),U.onload=function(){O&&ae(O),O=null,ue=!0},U.onerror=function(){le=!0,O=null},U.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(g){let r,s,d,f;g.resetRequestQueue=()=>{r=[],s=0,d=0,f={}},g.addThrottleControl=M=>{const z=d++;return f[z]=M,z},g.removeThrottleControl=M=>{delete f[M],S()},g.getImage=(M,z,L=!0)=>{D.supported&&(M.headers||(M.headers={}),M.headers.accept="image/webp,*/*");const N={requestParameters:M,supportImageRefresh:L,callback:z,cancelled:!1,completed:!1,cancel:()=>{N.completed||N.cancelled||(N.cancelled=!0,N.innerRequest&&(N.innerRequest.cancel(),s--),S())}};return r.push(N),S(),N};const _=M=>{const{requestParameters:z,supportImageRefresh:L,callback:N}=M;return u.e(z,{type:"image"}),(L!==!1||u.i()||u.g(z.url)||z.headers&&!Object.keys(z.headers).reduce((J,Y)=>J&&Y==="accept",!0)?u.m:E)(z,(J,Y,te,K)=>{b(M,N,J,Y,te,K)})},b=(M,z,L,N,J,Y)=>{L?z(L):N instanceof HTMLImageElement||u.a(N)?z(null,N):N&&((te,K)=>{typeof createImageBitmap=="function"?u.b(te,K):u.d(te,K)})(N,(te,K)=>{te!=null?z(te):K!=null&&z(null,K,{cacheControl:J,expires:Y})}),M.cancelled||(M.completed=!0,s--,S())},S=()=>{const M=(()=>{const z=Object.keys(f);let L=!1;if(z.length>0){for(const N of z)if(L=f[N](),L)break}return L})()?u.c.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:u.c.MAX_PARALLEL_IMAGE_REQUESTS;for(let z=s;z<M&&r.length>0;z++){const L=r.shift();if(L.cancelled){z--;continue}const N=_(L);s++,L.innerRequest=N}},E=(M,z)=>{const L=new Image,N=M.url;let J=!1;const Y=M.credentials;return Y&&Y==="include"?L.crossOrigin="use-credentials":(Y&&Y==="same-origin"||!u.s(N))&&(L.crossOrigin="anonymous"),L.fetchPriority="high",L.onload=()=>{z(null,L),L.onerror=L.onload=null},L.onerror=()=>{J||z(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.")),L.onerror=L.onload=null},L.src=N,{cancel:()=>{J=!0,L.src=""}}}}(oe||(oe={})),oe.resetRequestQueue(),function(g){g.Glyphs="Glyphs",g.Image="Image",g.Source="Source",g.SpriteImage="SpriteImage",g.SpriteJSON="SpriteJSON",g.Style="Style",g.Tile="Tile",g.Unknown="Unknown"}($||($={}));class G{constructor(r){this._transformRequestFn=r}transformRequest(r,s){return this._transformRequestFn&&this._transformRequestFn(r,s)||{url:r}}normalizeSpriteURL(r,s,d){const f=function(_){const b=_.match(ee);if(!b)throw new Error(`Unable to parse URL "${_}"`);return{protocol:b[1],authority:b[2],path:b[3]||"/",params:b[4]?b[4].split("&"):[]}}(r);return f.path+=`${s}${d}`,function(_){const b=_.params.length?`?${_.params.join("&")}`:"";return`${_.protocol}://${_.authority}${_.path}${b}`}(f)}setTransformRequest(r){this._transformRequestFn=r}}const ee=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function _e(g){var r=new u.A(3);return r[0]=g[0],r[1]=g[1],r[2]=g[2],r}var Ce,de=function(g,r,s){return g[0]=r[0]-s[0],g[1]=r[1]-s[1],g[2]=r[2]-s[2],g};Ce=new u.A(3),u.A!=Float32Array&&(Ce[0]=0,Ce[1]=0,Ce[2]=0);var be=function(g){var r=g[0],s=g[1];return r*r+s*s};function Me(g){const r=[];if(typeof g=="string")r.push({id:"default",url:g});else if(g&&g.length>0){const s=[];for(const{id:d,url:f}of g){const _=`${d}${f}`;s.indexOf(_)===-1&&(s.push(_),r.push({id:d,url:f}))}}return r}function Ze(g,r,s,d,f){if(d)return void g(d);if(f!==Object.values(r).length||f!==Object.values(s).length)return;const _={};for(const b in r){_[b]={};const S=u.h.getImageCanvasContext(s[b]),E=r[b];for(const M in E){const{width:z,height:L,x:N,y:J,sdf:Y,pixelRatio:te,stretchX:K,stretchY:me,content:Se}=E[M];_[b][M]={data:null,pixelRatio:te,sdf:Y,stretchX:K,stretchY:me,content:Se,spriteData:{width:z,height:L,x:N,y:J,context:S}}}}g(null,_)}(function(){var g=new u.A(2);u.A!=Float32Array&&(g[0]=0,g[1]=0)})();class Oe{constructor(r,s,d,f){this.context=r,this.format=d,this.texture=r.gl.createTexture(),this.update(s,f)}update(r,s,d){const{width:f,height:_}=r,b=!(this.size&&this.size[0]===f&&this.size[1]===_||d),{context:S}=this,{gl:E}=S;if(this.useMipmap=!!(s&&s.useMipmap),E.bindTexture(E.TEXTURE_2D,this.texture),S.pixelStoreUnpackFlipY.set(!1),S.pixelStoreUnpack.set(1),S.pixelStoreUnpackPremultiplyAlpha.set(this.format===E.RGBA&&(!s||s.premultiply!==!1)),b)this.size=[f,_],r instanceof HTMLImageElement||r instanceof HTMLCanvasElement||r instanceof HTMLVideoElement||r instanceof ImageData||u.a(r)?E.texImage2D(E.TEXTURE_2D,0,this.format,this.format,E.UNSIGNED_BYTE,r):E.texImage2D(E.TEXTURE_2D,0,this.format,f,_,0,this.format,E.UNSIGNED_BYTE,r.data);else{const{x:M,y:z}=d||{x:0,y:0};r instanceof HTMLImageElement||r instanceof HTMLCanvasElement||r instanceof HTMLVideoElement||r instanceof ImageData||u.a(r)?E.texSubImage2D(E.TEXTURE_2D,0,M,z,E.RGBA,E.UNSIGNED_BYTE,r):E.texSubImage2D(E.TEXTURE_2D,0,M,z,f,_,E.RGBA,E.UNSIGNED_BYTE,r.data)}this.useMipmap&&this.isSizePowerOfTwo()&&E.generateMipmap(E.TEXTURE_2D)}bind(r,s,d){const{context:f}=this,{gl:_}=f;_.bindTexture(_.TEXTURE_2D,this.texture),d!==_.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(d=_.LINEAR),r!==this.filter&&(_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MAG_FILTER,r),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MIN_FILTER,d||r),this.filter=r),s!==this.wrap&&(_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_S,s),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_T,s),this.wrap=s)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:r}=this.context;r.deleteTexture(this.texture),this.texture=null}}function ft(g){const{userImage:r}=g;return!!(r&&r.render&&r.render())&&(g.data.replace(new Uint8Array(r.data.buffer)),!0)}class bt extends u.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new u.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(r){if(this.loaded!==r&&(this.loaded=r,r)){for(const{ids:s,callback:d}of this.requestors)this._notify(s,d);this.requestors=[]}}getImage(r){const s=this.images[r];if(s&&!s.data&&s.spriteData){const d=s.spriteData;s.data=new u.R({width:d.width,height:d.height},d.context.getImageData(d.x,d.y,d.width,d.height).data),s.spriteData=null}return s}addImage(r,s){if(this.images[r])throw new Error(`Image id ${r} already exist, use updateImage instead`);this._validate(r,s)&&(this.images[r]=s)}_validate(r,s){let d=!0;const f=s.data||s.spriteData;return this._validateStretch(s.stretchX,f&&f.width)||(this.fire(new u.j(new Error(`Image "${r}" has invalid "stretchX" value`))),d=!1),this._validateStretch(s.stretchY,f&&f.height)||(this.fire(new u.j(new Error(`Image "${r}" has invalid "stretchY" value`))),d=!1),this._validateContent(s.content,s)||(this.fire(new u.j(new Error(`Image "${r}" has invalid "content" value`))),d=!1),d}_validateStretch(r,s){if(!r)return!0;let d=0;for(const f of r){if(f[0]<d||f[1]<f[0]||s<f[1])return!1;d=f[1]}return!0}_validateContent(r,s){if(!r)return!0;if(r.length!==4)return!1;const d=s.spriteData,f=d&&d.width||s.data.width,_=d&&d.height||s.data.height;return!(r[0]<0||f<r[0]||r[1]<0||_<r[1]||r[2]<0||f<r[2]||r[3]<0||_<r[3]||r[2]<r[0]||r[3]<r[1])}updateImage(r,s,d=!0){const f=this.getImage(r);if(d&&(f.data.width!==s.data.width||f.data.height!==s.data.height))throw new Error(`size mismatch between old image (${f.data.width}x${f.data.height}) and new image (${s.data.width}x${s.data.height}).`);s.version=f.version+1,this.images[r]=s,this.updatedImages[r]=!0}removeImage(r){const s=this.images[r];delete this.images[r],delete this.patterns[r],s.userImage&&s.userImage.onRemove&&s.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(r,s){let d=!0;if(!this.isLoaded())for(const f of r)this.images[f]||(d=!1);this.isLoaded()||d?this._notify(r,s):this.requestors.push({ids:r,callback:s})}_notify(r,s){const d={};for(const f of r){let _=this.getImage(f);_||(this.fire(new u.k("styleimagemissing",{id:f})),_=this.getImage(f)),_?d[f]={data:_.data.clone(),pixelRatio:_.pixelRatio,sdf:_.sdf,version:_.version,stretchX:_.stretchX,stretchY:_.stretchY,content:_.content,hasRenderCallback:!!(_.userImage&&_.userImage.render)}:u.w(`Image "${f}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}s(null,d)}getPixelSize(){const{width:r,height:s}=this.atlasImage;return{width:r,height:s}}getPattern(r){const s=this.patterns[r],d=this.getImage(r);if(!d)return null;if(s&&s.position.version===d.version)return s.position;if(s)s.position.version=d.version;else{const f={w:d.data.width+2,h:d.data.height+2,x:0,y:0},_=new u.I(f,d);this.patterns[r]={bin:f,position:_}}return this._updatePatternAtlas(),this.patterns[r].position}bind(r){const s=r.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new Oe(r,this.atlasImage,s.RGBA),this.atlasTexture.bind(s.LINEAR,s.CLAMP_TO_EDGE)}_updatePatternAtlas(){const r=[];for(const _ in this.patterns)r.push(this.patterns[_].bin);const{w:s,h:d}=u.p(r),f=this.atlasImage;f.resize({width:s||1,height:d||1});for(const _ in this.patterns){const{bin:b}=this.patterns[_],S=b.x+1,E=b.y+1,M=this.getImage(_).data,z=M.width,L=M.height;u.R.copy(M,f,{x:0,y:0},{x:S,y:E},{width:z,height:L}),u.R.copy(M,f,{x:0,y:L-1},{x:S,y:E-1},{width:z,height:1}),u.R.copy(M,f,{x:0,y:0},{x:S,y:E+L},{width:z,height:1}),u.R.copy(M,f,{x:z-1,y:0},{x:S-1,y:E},{width:1,height:L}),u.R.copy(M,f,{x:0,y:0},{x:S+z,y:E},{width:1,height:L})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(r){for(const s of r){if(this.callbackDispatchedThisFrame[s])continue;this.callbackDispatchedThisFrame[s]=!0;const d=this.getImage(s);d||u.w(`Image with ID: "${s}" was not found`),ft(d)&&this.updateImage(s,d)}}}const Rt=1e20;function Ft(g,r,s,d,f,_,b,S,E){for(let M=r;M<r+d;M++)It(g,s*_+M,_,f,b,S,E);for(let M=s;M<s+f;M++)It(g,M*_+r,1,d,b,S,E)}function It(g,r,s,d,f,_,b){_[0]=0,b[0]=-Rt,b[1]=Rt,f[0]=g[r];for(let S=1,E=0,M=0;S<d;S++){f[S]=g[r+S*s];const z=S*S;do{const L=_[E];M=(f[S]-f[L]+z-L*L)/(S-L)/2}while(M<=b[E]&&--E>-1);E++,_[E]=S,b[E]=M,b[E+1]=Rt}for(let S=0,E=0;S<d;S++){for(;b[E+1]<S;)E++;const M=_[E],z=S-M;g[r+S*s]=f[M]+z*z}}class zt{constructor(r,s){this.requestManager=r,this.localIdeographFontFamily=s,this.entries={}}setURL(r){this.url=r}getGlyphs(r,s){const d=[];for(const f in r)for(const _ of r[f])d.push({stack:f,id:_});u.o(d,({stack:f,id:_},b)=>{let S=this.entries[f];S||(S=this.entries[f]={glyphs:{},requests:{},ranges:{}});let E=S.glyphs[_];if(E!==void 0)return void b(null,{stack:f,id:_,glyph:E});if(E=this._tinySDF(S,f,_),E)return S.glyphs[_]=E,void b(null,{stack:f,id:_,glyph:E});const M=Math.floor(_/256);if(256*M>65535)return void b(new Error("glyphs > 65535 not supported"));if(S.ranges[M])return void b(null,{stack:f,id:_,glyph:E});if(!this.url)return void b(new Error("glyphsUrl is not set"));let z=S.requests[M];z||(z=S.requests[M]=[],zt.loadGlyphRange(f,M,this.url,this.requestManager,(L,N)=>{if(N){for(const J in N)this._doesCharSupportLocalGlyph(+J)||(S.glyphs[+J]=N[+J]);S.ranges[M]=!0}for(const J of z)J(L,N);delete S.requests[M]})),z.push((L,N)=>{L?b(L):N&&b(null,{stack:f,id:_,glyph:N[_]||null})})},(f,_)=>{if(f)s(f);else if(_){const b={};for(const{stack:S,id:E,glyph:M}of _)(b[S]||(b[S]={}))[E]=M&&{id:M.id,bitmap:M.bitmap.clone(),metrics:M.metrics};s(null,b)}})}_doesCharSupportLocalGlyph(r){return!!this.localIdeographFontFamily&&(u.u["CJK Unified Ideographs"](r)||u.u["Hangul Syllables"](r)||u.u.Hiragana(r)||u.u.Katakana(r))}_tinySDF(r,s,d){const f=this.localIdeographFontFamily;if(!f||!this._doesCharSupportLocalGlyph(d))return;let _=r.tinySDF;if(!_){let S="400";/bold/i.test(s)?S="900":/medium/i.test(s)?S="500":/light/i.test(s)&&(S="200"),_=r.tinySDF=new zt.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:f,fontWeight:S})}const b=_.draw(String.fromCharCode(d));return{id:d,bitmap:new u.q({width:b.width||60,height:b.height||60},b.data),metrics:{width:b.glyphWidth/2||24,height:b.glyphHeight/2||24,left:b.glyphLeft/2+.5||0,top:b.glyphTop/2-27.5||-8,advance:b.glyphAdvance/2||24,isDoubleResolution:!0}}}}zt.loadGlyphRange=function(g,r,s,d,f){const _=256*r,b=_+255,S=d.transformRequest(s.replace("{fontstack}",g).replace("{range}",`${_}-${b}`),$.Glyphs);u.l(S,(E,M)=>{if(E)f(E);else if(M){const z={};for(const L of u.n(M))z[L.id]=L;f(null,z)}})},zt.TinySDF=class{constructor({fontSize:g=24,buffer:r=3,radius:s=8,cutoff:d=.25,fontFamily:f="sans-serif",fontWeight:_="normal",fontStyle:b="normal"}={}){this.buffer=r,this.cutoff=d,this.radius=s;const S=this.size=g+4*r,E=this._createCanvas(S),M=this.ctx=E.getContext("2d",{willReadFrequently:!0});M.font=`${b} ${_} ${g}px ${f}`,M.textBaseline="alphabetic",M.textAlign="left",M.fillStyle="black",this.gridOuter=new Float64Array(S*S),this.gridInner=new Float64Array(S*S),this.f=new Float64Array(S),this.z=new Float64Array(S+1),this.v=new Uint16Array(S)}_createCanvas(g){const r=document.createElement("canvas");return r.width=r.height=g,r}draw(g){const{width:r,actualBoundingBoxAscent:s,actualBoundingBoxDescent:d,actualBoundingBoxLeft:f,actualBoundingBoxRight:_}=this.ctx.measureText(g),b=Math.ceil(s),S=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(_-f))),E=Math.min(this.size-this.buffer,b+Math.ceil(d)),M=S+2*this.buffer,z=E+2*this.buffer,L=Math.max(M*z,0),N=new Uint8ClampedArray(L),J={data:N,width:M,height:z,glyphWidth:S,glyphHeight:E,glyphTop:b,glyphLeft:0,glyphAdvance:r};if(S===0||E===0)return J;const{ctx:Y,buffer:te,gridInner:K,gridOuter:me}=this;Y.clearRect(te,te,S,E),Y.fillText(g,te,te+b);const Se=Y.getImageData(te,te,S,E);me.fill(Rt,0,L),K.fill(0,0,L);for(let ie=0;ie<E;ie++)for(let ge=0;ge<S;ge++){const Ee=Se.data[4*(ie*S+ge)+3]/255;if(Ee===0)continue;const Ie=(ie+te)*M+ge+te;if(Ee===1)me[Ie]=0,K[Ie]=Rt;else{const ze=.5-Ee;me[Ie]=ze>0?ze*ze:0,K[Ie]=ze<0?ze*ze:0}}Ft(me,0,0,M,z,M,this.f,this.v,this.z),Ft(K,te,te,S,E,M,this.f,this.v,this.z);for(let ie=0;ie<L;ie++){const ge=Math.sqrt(me[ie])-Math.sqrt(K[ie]);N[ie]=Math.round(255-255*(ge/this.radius+this.cutoff))}return J}};class xt{constructor(){this.specification=u.v.light.position}possiblyEvaluate(r,s){return u.z(r.expression.evaluate(s))}interpolate(r,s,d){return{x:u.B.number(r.x,s.x,d),y:u.B.number(r.y,s.y,d),z:u.B.number(r.z,s.z,d)}}}let Be;class lt extends u.E{constructor(r){super(),Be=Be||new u.r({anchor:new u.D(u.v.light.anchor),position:new xt,color:new u.D(u.v.light.color),intensity:new u.D(u.v.light.intensity)}),this._transitionable=new u.T(Be),this.setLight(r),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(r,s={}){if(!this._validate(u.t,r,s))for(const d in r){const f=r[d];d.endsWith("-transition")?this._transitionable.setTransition(d.slice(0,-11),f):this._transitionable.setValue(d,f)}}updateTransitions(r){this._transitioning=this._transitionable.transitioned(r,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(r){this.properties=this._transitioning.possiblyEvaluate(r)}_validate(r,s,d){return(!d||d.validate!==!1)&&u.x(this,r.call(u.y,u.e({value:s,style:{glyphs:!0,sprite:!0},styleSpec:u.v})))}}class dt{constructor(r,s){this.width=r,this.height=s,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(r,s){const d=r.join(",")+String(s);return this.dashEntry[d]||(this.dashEntry[d]=this.addDash(r,s)),this.dashEntry[d]}getDashRanges(r,s,d){const f=[];let _=r.length%2==1?-r[r.length-1]*d:0,b=r[0]*d,S=!0;f.push({left:_,right:b,isDash:S,zeroLength:r[0]===0});let E=r[0];for(let M=1;M<r.length;M++){S=!S;const z=r[M];_=E*d,E+=z,b=E*d,f.push({left:_,right:b,isDash:S,zeroLength:z===0})}return f}addRoundDash(r,s,d){const f=s/2;for(let _=-d;_<=d;_++){const b=this.width*(this.nextRow+d+_);let S=0,E=r[S];for(let M=0;M<this.width;M++){M/E.right>1&&(E=r[++S]);const z=Math.abs(M-E.left),L=Math.abs(M-E.right),N=Math.min(z,L);let J;const Y=_/d*(f+1);if(E.isDash){const te=f-Math.abs(Y);J=Math.sqrt(N*N+te*te)}else J=f-Math.sqrt(N*N+Y*Y);this.data[b+M]=Math.max(0,Math.min(255,J+128))}}}addRegularDash(r){for(let S=r.length-1;S>=0;--S){const E=r[S],M=r[S+1];E.zeroLength?r.splice(S,1):M&&M.isDash===E.isDash&&(M.left=E.left,r.splice(S,1))}const s=r[0],d=r[r.length-1];s.isDash===d.isDash&&(s.left=d.left-this.width,d.right=s.right+this.width);const f=this.width*this.nextRow;let _=0,b=r[_];for(let S=0;S<this.width;S++){S/b.right>1&&(b=r[++_]);const E=Math.abs(S-b.left),M=Math.abs(S-b.right),z=Math.min(E,M);this.data[f+S]=Math.max(0,Math.min(255,(b.isDash?z:-z)+128))}}addDash(r,s){const d=s?7:0,f=2*d+1;if(this.nextRow+f>this.height)return u.w("LineAtlas out of space"),null;let _=0;for(let S=0;S<r.length;S++)_+=r[S];if(_!==0){const S=this.width/_,E=this.getDashRanges(r,this.width,S);s?this.addRoundDash(E,S,d):this.addRegularDash(E)}const b={y:(this.nextRow+d+.5)/this.height,height:2*d/this.height,width:_};return this.nextRow+=f,this.dirty=!0,b}bind(r){const s=r.gl;this.texture?(s.bindTexture(s.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,s.texSubImage2D(s.TEXTURE_2D,0,0,0,this.width,this.height,s.ALPHA,s.UNSIGNED_BYTE,this.data))):(this.texture=s.createTexture(),s.bindTexture(s.TEXTURE_2D,this.texture),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_S,s.REPEAT),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_T,s.REPEAT),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,s.LINEAR),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,s.LINEAR),s.texImage2D(s.TEXTURE_2D,0,s.ALPHA,this.width,this.height,0,s.ALPHA,s.UNSIGNED_BYTE,this.data))}}class kt{constructor(r,s,d){this.workerPool=r,this.actors=[],this.currentActor=0,this.id=d;const f=this.workerPool.acquire(d);for(let _=0;_<f.length;_++){const b=new u.C(f[_],s,d);b.name=`Worker ${_}`,this.actors.push(b)}if(!this.actors.length)throw new Error("No actors found")}broadcast(r,s,d){u.o(this.actors,(f,_)=>{f.send(r,s,_)},d=d||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(r=!0){this.actors.forEach(s=>{s.remove()}),this.actors=[],r&&this.workerPool.release(this.id)}}function ht(g,r,s){const d=function(f,_){if(f)return s(f);if(_){const b=u.F(u.e(_,g),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);_.vector_layers&&(b.vectorLayers=_.vector_layers,b.vectorLayerIds=b.vectorLayers.map(S=>S.id)),s(null,b)}};return g.url?u.f(r.transformRequest(g.url,$.Source),d):u.h.frame(()=>d(null,g))}class _t{constructor(r,s){r&&(s?this.setSouthWest(r).setNorthEast(s):Array.isArray(r)&&(r.length===4?this.setSouthWest([r[0],r[1]]).setNorthEast([r[2],r[3]]):this.setSouthWest(r[0]).setNorthEast(r[1])))}setNorthEast(r){return this._ne=r instanceof u.L?new u.L(r.lng,r.lat):u.L.convert(r),this}setSouthWest(r){return this._sw=r instanceof u.L?new u.L(r.lng,r.lat):u.L.convert(r),this}extend(r){const s=this._sw,d=this._ne;let f,_;if(r instanceof u.L)f=r,_=r;else{if(!(r instanceof _t))return Array.isArray(r)?r.length===4||r.every(Array.isArray)?this.extend(_t.convert(r)):this.extend(u.L.convert(r)):r&&("lng"in r||"lon"in r)&&"lat"in r?this.extend(u.L.convert(r)):this;if(f=r._sw,_=r._ne,!f||!_)return this}return s||d?(s.lng=Math.min(f.lng,s.lng),s.lat=Math.min(f.lat,s.lat),d.lng=Math.max(_.lng,d.lng),d.lat=Math.max(_.lat,d.lat)):(this._sw=new u.L(f.lng,f.lat),this._ne=new u.L(_.lng,_.lat)),this}getCenter(){return new u.L((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new u.L(this.getWest(),this.getNorth())}getSouthEast(){return new u.L(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(r){const{lng:s,lat:d}=u.L.convert(r);let f=this._sw.lng<=s&&s<=this._ne.lng;return this._sw.lng>this._ne.lng&&(f=this._sw.lng>=s&&s>=this._ne.lng),this._sw.lat<=d&&d<=this._ne.lat&&f}static convert(r){return r instanceof _t?r:r&&new _t(r)}static fromLngLat(r,s=0){const d=360*s/40075017,f=d/Math.cos(Math.PI/180*r.lat);return new _t(new u.L(r.lng-f,r.lat-d),new u.L(r.lng+f,r.lat+d))}}class Tt{constructor(r,s,d){this.bounds=_t.convert(this.validateBounds(r)),this.minzoom=s||0,this.maxzoom=d||24}validateBounds(r){return Array.isArray(r)&&r.length===4?[Math.max(-180,r[0]),Math.max(-90,r[1]),Math.min(180,r[2]),Math.min(90,r[3])]:[-180,-90,180,90]}contains(r){const s=Math.pow(2,r.z),d=Math.floor(u.G(this.bounds.getWest())*s),f=Math.floor(u.H(this.bounds.getNorth())*s),_=Math.ceil(u.G(this.bounds.getEast())*s),b=Math.ceil(u.H(this.bounds.getSouth())*s);return r.x>=d&&r.x<_&&r.y>=f&&r.y<b}}class tn extends u.E{constructor(r,s,d,f){if(super(),this.load=()=>{this._loaded=!1,this.fire(new u.k("dataloading",{dataType:"source"})),this._tileJSONRequest=ht(this._options,this.map._requestManager,(_,b)=>{this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),_?this.fire(new u.j(_)):b&&(u.e(this,b),b.bounds&&(this.tileBounds=new Tt(b.bounds,this.minzoom,this.maxzoom)),this.fire(new u.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new u.k("data",{dataType:"source",sourceDataType:"content"})))})},this.serialize=()=>u.e({},this._options),this.id=r,this.dispatcher=d,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,u.e(this,u.F(s,["url","scheme","tileSize","promoteId"])),this._options=u.e({type:"vector"},s),this._collectResourceTiming=s.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(f)}loaded(){return this._loaded}hasTile(r){return!this.tileBounds||this.tileBounds.contains(r.canonical)}onAdd(r){this.map=r,this.load()}setSourceProperty(r){this._tileJSONRequest&&this._tileJSONRequest.cancel(),r(),this.load()}setTiles(r){return this.setSourceProperty(()=>{this._options.tiles=r}),this}setUrl(r){return this.setSourceProperty(()=>{this.url=r,this._options.url=r}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}loadTile(r,s){const d=r.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),f={request:this.map._requestManager.transformRequest(d,$.Tile),uid:r.uid,tileID:r.tileID,zoom:r.tileID.overscaledZ,tileSize:this.tileSize*r.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function _(b,S){return delete r.request,r.aborted?s(null):b&&b.status!==404?s(b):(S&&S.resourceTiming&&(r.resourceTiming=S.resourceTiming),this.map._refreshExpiredTiles&&S&&r.setExpiryData(S),r.loadVectorData(S,this.map.painter),s(null),void(r.reloadCallback&&(this.loadTile(r,r.reloadCallback),r.reloadCallback=null)))}f.request.collectResourceTiming=this._collectResourceTiming,r.actor&&r.state!=="expired"?r.state==="loading"?r.reloadCallback=s:r.request=r.actor.send("reloadTile",f,_.bind(this)):(r.actor=this.dispatcher.getActor(),r.request=r.actor.send("loadTile",f,_.bind(this)))}abortTile(r){r.request&&(r.request.cancel(),delete r.request),r.actor&&r.actor.send("abortTile",{uid:r.uid,type:this.type,source:this.id},void 0)}unloadTile(r){r.unloadVectorData(),r.actor&&r.actor.send("removeTile",{uid:r.uid,type:this.type,source:this.id},void 0)}hasTransition(){return!1}}class Zt extends u.E{constructor(r,s,d,f){super(),this.id=r,this.dispatcher=d,this.setEventedParent(f),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=u.e({type:"raster"},s),u.e(this,u.F(s,["url","scheme","tileSize"]))}load(){this._loaded=!1,this.fire(new u.k("dataloading",{dataType:"source"})),this._tileJSONRequest=ht(this._options,this.map._requestManager,(r,s)=>{this._tileJSONRequest=null,this._loaded=!0,r?this.fire(new u.j(r)):s&&(u.e(this,s),s.bounds&&(this.tileBounds=new Tt(s.bounds,this.minzoom,this.maxzoom)),this.fire(new u.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new u.k("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}onAdd(r){this.map=r,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}setSourceProperty(r){this._tileJSONRequest&&this._tileJSONRequest.cancel(),r(),this.load()}setTiles(r){return this.setSourceProperty(()=>{this._options.tiles=r}),this}serialize(){return u.e({},this._options)}hasTile(r){return!this.tileBounds||this.tileBounds.contains(r.canonical)}loadTile(r,s){const d=r.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);r.request=oe.getImage(this.map._requestManager.transformRequest(d,$.Tile),(f,_,b)=>{if(delete r.request,r.aborted)r.state="unloaded",s(null);else if(f)r.state="errored",s(f);else if(_){this.map._refreshExpiredTiles&&b&&r.setExpiryData(b);const S=this.map.painter.context,E=S.gl;r.texture=this.map.painter.getTileTexture(_.width),r.texture?r.texture.update(_,{useMipmap:!0}):(r.texture=new Oe(S,_,E.RGBA,{useMipmap:!0}),r.texture.bind(E.LINEAR,E.CLAMP_TO_EDGE,E.LINEAR_MIPMAP_NEAREST),S.extTextureFilterAnisotropic&&E.texParameterf(E.TEXTURE_2D,S.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,S.extTextureFilterAnisotropicMax)),r.state="loaded",s(null)}},this.map._refreshExpiredTiles)}abortTile(r,s){r.request&&(r.request.cancel(),delete r.request),s()}unloadTile(r,s){r.texture&&this.map.painter.saveTileTexture(r.texture),s()}hasTransition(){return!1}}class hn extends Zt{constructor(r,s,d,f){super(r,s,d,f),this.type="raster-dem",this.maxzoom=22,this._options=u.e({type:"raster-dem"},s),this.encoding=s.encoding||"mapbox",this.redFactor=s.redFactor,this.greenFactor=s.greenFactor,this.blueFactor=s.blueFactor,this.baseShift=s.baseShift}loadTile(r,s){const d=r.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),f=this.map._requestManager.transformRequest(d,$.Tile);function _(b,S){b&&(r.state="errored",s(b)),S&&(r.dem=S,r.needsHillshadePrepare=!0,r.needsTerrainPrepare=!0,r.state="loaded",s(null))}r.neighboringTiles=this._getNeighboringTiles(r.tileID),r.request=oe.getImage(f,(b,S,E)=>u._(this,void 0,void 0,function*(){if(delete r.request,r.aborted)r.state="unloaded",s(null);else if(b)r.state="errored",s(b);else if(S){this.map._refreshExpiredTiles&&r.setExpiryData(E);const M=u.a(S)&&u.J()?S:yield function(L){return u._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&u.K()){const N=L.width+2,J=L.height+2;try{return new u.R({width:N,height:J},yield u.M(L,-1,-1,N,J))}catch{}}return u.h.getImageData(L,1)})}(S),z={uid:r.uid,coord:r.tileID,source:this.id,rawImageData:M,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};r.actor&&r.state!=="expired"||(r.actor=this.dispatcher.getActor(),r.actor.send("loadDEMTile",z,_))}}),this.map._refreshExpiredTiles)}_getNeighboringTiles(r){const s=r.canonical,d=Math.pow(2,s.z),f=(s.x-1+d)%d,_=s.x===0?r.wrap-1:r.wrap,b=(s.x+1+d)%d,S=s.x+1===d?r.wrap+1:r.wrap,E={};return E[new u.O(r.overscaledZ,_,s.z,f,s.y).key]={backfilled:!1},E[new u.O(r.overscaledZ,S,s.z,b,s.y).key]={backfilled:!1},s.y>0&&(E[new u.O(r.overscaledZ,_,s.z,f,s.y-1).key]={backfilled:!1},E[new u.O(r.overscaledZ,r.wrap,s.z,s.x,s.y-1).key]={backfilled:!1},E[new u.O(r.overscaledZ,S,s.z,b,s.y-1).key]={backfilled:!1}),s.y+1<d&&(E[new u.O(r.overscaledZ,_,s.z,f,s.y+1).key]={backfilled:!1},E[new u.O(r.overscaledZ,r.wrap,s.z,s.x,s.y+1).key]={backfilled:!1},E[new u.O(r.overscaledZ,S,s.z,b,s.y+1).key]={backfilled:!1}),E}unloadTile(r){r.demTexture&&this.map.painter.saveTileTexture(r.demTexture),r.fbo&&(r.fbo.destroy(),delete r.fbo),r.dem&&delete r.dem,delete r.neighboringTiles,r.state="unloaded",r.actor&&r.actor.send("removeDEMTile",{uid:r.uid,source:this.id})}}class Mn extends u.E{constructor(r,s,d,f){super(),this.load=()=>{this._updateWorkerData()},this.serialize=()=>u.e({},this._options,{type:this.type,data:this._data}),this.id=r,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=d.getActor(),this.setEventedParent(f),this._data=s.data,this._options=u.e({},s),this._collectResourceTiming=s.collectResourceTiming,s.maxzoom!==void 0&&(this.maxzoom=s.maxzoom),s.type&&(this.type=s.type),s.attribution&&(this.attribution=s.attribution),this.promoteId=s.promoteId;const _=u.N/this.tileSize;this.workerOptions=u.e({source:this.id,cluster:s.cluster||!1,geojsonVtOptions:{buffer:(s.buffer!==void 0?s.buffer:128)*_,tolerance:(s.tolerance!==void 0?s.tolerance:.375)*_,extent:u.N,maxZoom:this.maxzoom,lineMetrics:s.lineMetrics||!1,generateId:s.generateId||!1},superclusterOptions:{maxZoom:s.clusterMaxZoom!==void 0?s.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,s.clusterMinPoints||2),extent:u.N,radius:(s.clusterRadius||50)*_,log:!1,generateId:s.generateId||!1},clusterProperties:s.clusterProperties,filter:s.filter},s.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}onAdd(r){this.map=r,this.load()}setData(r){return this._data=r,this._updateWorkerData(),this}updateData(r){return this._updateWorkerData(r),this}setClusterOptions(r){return this.workerOptions.cluster=r.cluster,r&&(r.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=r.clusterRadius),r.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=r.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(r,s){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:r,source:this.id},s),this}getClusterChildren(r,s){return this.actor.send("geojson.getClusterChildren",{clusterId:r,source:this.id},s),this}getClusterLeaves(r,s,d,f){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:r,limit:s,offset:d},f),this}_updateWorkerData(r){const s=u.e({},this.workerOptions);r?s.dataDiff=r:typeof this._data=="string"?(s.request=this.map._requestManager.transformRequest(u.h.resolveURL(this._data),$.Source),s.request.collectResourceTiming=this._collectResourceTiming):s.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new u.k("dataloading",{dataType:"source"})),this.actor.send(`${this.type}.loadData`,s,(d,f)=>{if(this._pendingLoads--,this._removed||f&&f.abandoned)return void this.fire(new u.k("dataabort",{dataType:"source"}));let _=null;if(f&&f.resourceTiming&&f.resourceTiming[this.id]&&(_=f.resourceTiming[this.id].slice(0)),d)return void this.fire(new u.j(d));const b={dataType:"source"};this._collectResourceTiming&&_&&_.length>0&&u.e(b,{resourceTiming:_}),this.fire(new u.k("data",Object.assign(Object.assign({},b),{sourceDataType:"metadata"}))),this.fire(new u.k("data",Object.assign(Object.assign({},b),{sourceDataType:"content"})))})}loaded(){return this._pendingLoads===0}loadTile(r,s){const d=r.actor?"reloadTile":"loadTile";r.actor=this.actor;const f={type:this.type,uid:r.uid,tileID:r.tileID,zoom:r.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};r.request=this.actor.send(d,f,(_,b)=>(delete r.request,r.unloadVectorData(),r.aborted?s(null):_?s(_):(r.loadVectorData(b,this.map.painter,d==="reloadTile"),s(null))))}abortTile(r){r.request&&(r.request.cancel(),delete r.request),r.aborted=!0}unloadTile(r){r.unloadVectorData(),this.actor.send("removeTile",{uid:r.uid,type:this.type,source:this.id})}onRemove(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})}hasTransition(){return!1}}var qn=u.Q([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class tr extends u.E{constructor(r,s,d,f){super(),this.load=(_,b)=>{this._loaded=!1,this.fire(new u.k("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=oe.getImage(this.map._requestManager.transformRequest(this.url,$.Image),(S,E)=>{this._request=null,this._loaded=!0,S?this.fire(new u.j(S)):E&&(this.image=E,_&&(this.coordinates=_),b&&b(),this._finishLoading())})},this.prepare=()=>{if(Object.keys(this.tiles).length===0||!this.image)return;const _=this.map.painter.context,b=_.gl;this.boundsBuffer||(this.boundsBuffer=_.createVertexBuffer(this._boundsArray,qn.members)),this.boundsSegments||(this.boundsSegments=u.S.simpleSegment(0,0,4,2)),this.texture||(this.texture=new Oe(_,this.image,b.RGBA),this.texture.bind(b.LINEAR,b.CLAMP_TO_EDGE));let S=!1;for(const E in this.tiles){const M=this.tiles[E];M.state!=="loaded"&&(M.state="loaded",M.texture=this.texture,S=!0)}S&&this.fire(new u.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))},this.serialize=()=>({type:"image",url:this.options.url,coordinates:this.coordinates}),this.id=r,this.dispatcher=d,this.coordinates=s.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(f),this.options=s}loaded(){return this._loaded}updateImage(r){return r.url?(this._request&&(this._request.cancel(),this._request=null),this.options.url=r.url,this.load(r.coordinates,()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new u.k("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(r){this.map=r,this.load()}onRemove(){this._request&&(this._request.cancel(),this._request=null)}setCoordinates(r){this.coordinates=r;const s=r.map(u.U.fromLngLat);this.tileID=function(f){let _=1/0,b=1/0,S=-1/0,E=-1/0;for(const N of f)_=Math.min(_,N.x),b=Math.min(b,N.y),S=Math.max(S,N.x),E=Math.max(E,N.y);const M=Math.max(S-_,E-b),z=Math.max(0,Math.floor(-Math.log(M)/Math.LN2)),L=Math.pow(2,z);return new u.W(z,Math.floor((_+S)/2*L),Math.floor((b+E)/2*L))}(s),this.minzoom=this.maxzoom=this.tileID.z;const d=s.map(f=>this.tileID.getTilePoint(f)._round());return this._boundsArray=new u.V,this._boundsArray.emplaceBack(d[0].x,d[0].y,0,0),this._boundsArray.emplaceBack(d[1].x,d[1].y,u.N,0),this._boundsArray.emplaceBack(d[3].x,d[3].y,0,u.N),this._boundsArray.emplaceBack(d[2].x,d[2].y,u.N,u.N),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new u.k("data",{dataType:"source",sourceDataType:"content"})),this}loadTile(r,s){this.tileID&&this.tileID.equals(r.tileID.canonical)?(this.tiles[String(r.tileID.wrap)]=r,r.buckets={},s(null)):(r.state="errored",s(null))}hasTransition(){return!1}}class xn extends tr{constructor(r,s,d,f){super(r,s,d,f),this.load=()=>{this._loaded=!1;const _=this.options;this.urls=[];for(const b of _.urls)this.urls.push(this.map._requestManager.transformRequest(b,$.Source).url);u.X(this.urls,(b,S)=>{this._loaded=!0,b?this.fire(new u.j(b)):S&&(this.video=S,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})},this.prepare=()=>{if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const _=this.map.painter.context,b=_.gl;this.boundsBuffer||(this.boundsBuffer=_.createVertexBuffer(this._boundsArray,qn.members)),this.boundsSegments||(this.boundsSegments=u.S.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(b.LINEAR,b.CLAMP_TO_EDGE),b.texSubImage2D(b.TEXTURE_2D,0,0,0,b.RGBA,b.UNSIGNED_BYTE,this.video)):(this.texture=new Oe(_,this.video,b.RGBA),this.texture.bind(b.LINEAR,b.CLAMP_TO_EDGE));let S=!1;for(const E in this.tiles){const M=this.tiles[E];M.state!=="loaded"&&(M.state="loaded",M.texture=this.texture,S=!0)}S&&this.fire(new u.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))},this.serialize=()=>({type:"video",urls:this.urls,coordinates:this.coordinates}),this.roundZoom=!0,this.type="video",this.options=s}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(r){if(this.video){const s=this.video.seekable;r<s.start(0)||r>s.end(0)?this.fire(new u.j(new u.Y(`sources.${this.id}`,null,`Playback for this video can be set only between the ${s.start(0)} and ${s.end(0)}-second mark.`))):this.video.currentTime=r}}getVideo(){return this.video}onAdd(r){this.map||(this.map=r,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}hasTransition(){return this.video&&!this.video.paused}}class Gn extends tr{constructor(r,s,d,f){super(r,s,d,f),this.load=()=>{this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new u.j(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},this.prepare=()=>{let _=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,_=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,_=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const b=this.map.painter.context,S=b.gl;this.boundsBuffer||(this.boundsBuffer=b.createVertexBuffer(this._boundsArray,qn.members)),this.boundsSegments||(this.boundsSegments=u.S.simpleSegment(0,0,4,2)),this.texture?(_||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new Oe(b,this.canvas,S.RGBA,{premultiply:!0});let E=!1;for(const M in this.tiles){const z=this.tiles[M];z.state!=="loaded"&&(z.state="loaded",z.texture=this.texture,E=!0)}E&&this.fire(new u.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))},this.serialize=()=>({type:"canvas",coordinates:this.coordinates}),s.coordinates?Array.isArray(s.coordinates)&&s.coordinates.length===4&&!s.coordinates.some(_=>!Array.isArray(_)||_.length!==2||_.some(b=>typeof b!="number"))||this.fire(new u.j(new u.Y(`sources.${r}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new u.j(new u.Y(`sources.${r}`,null,'missing required property "coordinates"'))),s.animate&&typeof s.animate!="boolean"&&this.fire(new u.j(new u.Y(`sources.${r}`,null,'optional "animate" property must be a boolean value'))),s.canvas?typeof s.canvas=="string"||s.canvas instanceof HTMLCanvasElement||this.fire(new u.j(new u.Y(`sources.${r}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new u.j(new u.Y(`sources.${r}`,null,'missing required property "canvas"'))),this.options=s,this.animate=s.animate===void 0||s.animate}getCanvas(){return this.canvas}onAdd(r){this.map=r,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const r of[this.canvas.width,this.canvas.height])if(isNaN(r)||r<=0)return!0;return!1}}const to={},jr=g=>{switch(g){case"geojson":return Mn;case"image":return tr;case"raster":return Zt;case"raster-dem":return hn;case"vector":return tn;case"video":return xn;case"canvas":return Gn}return to[g]};function wr(g,r){const s=u.Z();return u.$(s,s,[1,1,0]),u.a0(s,s,[.5*g.width,.5*g.height,1]),u.a1(s,s,g.calculatePosMatrix(r.toUnwrapped()))}function wo(g,r,s,d,f,_){const b=function(L,N,J){if(L)for(const Y of L){const te=N[Y];if(te&&te.source===J&&te.type==="fill-extrusion")return!0}else for(const Y in N){const te=N[Y];if(te.source===J&&te.type==="fill-extrusion")return!0}return!1}(f&&f.layers,r,g.id),S=_.maxPitchScaleFactor(),E=g.tilesIn(d,S,b);E.sort(no);const M=[];for(const L of E)M.push({wrappedTileID:L.tileID.wrapped().key,queryResults:L.tile.queryRenderedFeatures(r,s,g._state,L.queryGeometry,L.cameraQueryGeometry,L.scale,f,_,S,wr(g.transform,L.tileID))});const z=function(L){const N={},J={};for(const Y of L){const te=Y.queryResults,K=Y.wrappedTileID,me=J[K]=J[K]||{};for(const Se in te){const ie=te[Se],ge=me[Se]=me[Se]||{},Ee=N[Se]=N[Se]||[];for(const Ie of ie)ge[Ie.featureIndex]||(ge[Ie.featureIndex]=!0,Ee.push(Ie))}}return N}(M);for(const L in z)z[L].forEach(N=>{const J=N.feature,Y=g.getFeatureState(J.layer["source-layer"],J.id);J.source=J.layer.source,J.layer["source-layer"]&&(J.sourceLayer=J.layer["source-layer"]),J.state=Y});return z}function no(g,r){const s=g.tileID,d=r.tileID;return s.overscaledZ-d.overscaledZ||s.canonical.y-d.canonical.y||s.wrap-d.wrap||s.canonical.x-d.canonical.x}class ro{constructor(r,s){this.timeAdded=0,this.fadeEndTime=0,this.tileID=r,this.uid=u.a2(),this.uses=0,this.tileSize=s,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(r){const s=r+this.timeAdded;s<this.fadeEndTime||(this.fadeEndTime=s)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(r){this.demTexture&&r.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(r,s,d){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",r){r.featureIndex&&(this.latestFeatureIndex=r.featureIndex,r.rawTileData?(this.latestRawTileData=r.rawTileData,this.latestFeatureIndex.rawTileData=r.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=r.collisionBoxArray,this.buckets=function(f,_){const b={};if(!_)return b;for(const S of f){const E=S.layerIds.map(M=>_.getLayer(M)).filter(Boolean);if(E.length!==0){S.layers=E,S.stateDependentLayerIds&&(S.stateDependentLayers=S.stateDependentLayerIds.map(M=>E.filter(z=>z.id===M)[0]));for(const M of E)b[M.id]=S}}return b}(r.buckets,s.style),this.hasSymbolBuckets=!1;for(const f in this.buckets){const _=this.buckets[f];if(_ instanceof u.a4){if(this.hasSymbolBuckets=!0,!d)break;_.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const f in this.buckets){const _=this.buckets[f];if(_ instanceof u.a4&&_.hasRTLText){this.hasRTLText=!0,u.a5();break}}this.queryPadding=0;for(const f in this.buckets){const _=this.buckets[f];this.queryPadding=Math.max(this.queryPadding,s.style.getLayer(f).queryRadius(_))}r.imageAtlas&&(this.imageAtlas=r.imageAtlas),r.glyphAtlasImage&&(this.glyphAtlasImage=r.glyphAtlasImage)}else this.collisionBoxArray=new u.a3}unloadVectorData(){for(const r in this.buckets)this.buckets[r].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(r){return this.buckets[r.id]}upload(r){for(const d in this.buckets){const f=this.buckets[d];f.uploadPending()&&f.upload(r)}const s=r.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Oe(r,this.imageAtlas.image,s.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Oe(r,this.glyphAtlasImage,s.ALPHA),this.glyphAtlasImage=null)}prepare(r){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(r,this.imageAtlasTexture)}queryRenderedFeatures(r,s,d,f,_,b,S,E,M,z){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:f,cameraQueryGeometry:_,scale:b,tileSize:this.tileSize,pixelPosMatrix:z,transform:E,params:S,queryPadding:this.queryPadding*M},r,s,d):{}}querySourceFeatures(r,s){const d=this.latestFeatureIndex;if(!d||!d.rawTileData)return;const f=d.loadVTLayers(),_=s&&s.sourceLayer?s.sourceLayer:"",b=f._geojsonTileLayer||f[_];if(!b)return;const S=u.a6(s&&s.filter),{z:E,x:M,y:z}=this.tileID.canonical,L={z:E,x:M,y:z};for(let N=0;N<b.length;N++){const J=b.feature(N);if(S.needGeometry){const K=u.a7(J,!0);if(!S.filter(new u.a8(this.tileID.overscaledZ),K,this.tileID.canonical))continue}else if(!S.filter(new u.a8(this.tileID.overscaledZ),J))continue;const Y=d.getId(J,_),te=new u.a9(J,E,M,z,Y);te.tile=L,r.push(te)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(r){const s=this.expirationTime;if(r.cacheControl){const d=u.aa(r.cacheControl);d["max-age"]&&(this.expirationTime=Date.now()+1e3*d["max-age"])}else r.expires&&(this.expirationTime=new Date(r.expires).getTime());if(this.expirationTime){const d=Date.now();let f=!1;if(this.expirationTime>d)f=!1;else if(s)if(this.expirationTime<s)f=!0;else{const _=this.expirationTime-s;_?this.expirationTime=d+Math.max(_,3e4):f=!0}else f=!0;f?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(r,s){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(r).length===0)return;const d=this.latestFeatureIndex.loadVTLayers();for(const f in this.buckets){if(!s.style.hasLayer(f))continue;const _=this.buckets[f],b=_.layers[0].sourceLayer||"_geojsonTileLayer",S=d[b],E=r[b];if(!S||!E||Object.keys(E).length===0)continue;_.update(E,S,this.imageAtlas&&this.imageAtlas.patternPositions||{});const M=s&&s.style&&s.style.getLayer(f);M&&(this.queryPadding=Math.max(this.queryPadding,M.queryRadius(_)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<u.h.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(r){this.symbolFadeHoldUntil=u.h.now()+r}setDependencies(r,s){const d={};for(const f of s)d[f]=!0;this.dependencies[r]=d}hasDependency(r,s){for(const d of r){const f=this.dependencies[d];if(f){for(const _ of s)if(f[_])return!0}}return!1}}class bo{constructor(r,s){this.max=r,this.onRemove=s,this.reset()}reset(){for(const r in this.data)for(const s of this.data[r])s.timeout&&clearTimeout(s.timeout),this.onRemove(s.value);return this.data={},this.order=[],this}add(r,s,d){const f=r.wrapped().key;this.data[f]===void 0&&(this.data[f]=[]);const _={value:s,timeout:void 0};if(d!==void 0&&(_.timeout=setTimeout(()=>{this.remove(r,_)},d)),this.data[f].push(_),this.order.push(f),this.order.length>this.max){const b=this._getAndRemoveByKey(this.order[0]);b&&this.onRemove(b)}return this}has(r){return r.wrapped().key in this.data}getAndRemove(r){return this.has(r)?this._getAndRemoveByKey(r.wrapped().key):null}_getAndRemoveByKey(r){const s=this.data[r].shift();return s.timeout&&clearTimeout(s.timeout),this.data[r].length===0&&delete this.data[r],this.order.splice(this.order.indexOf(r),1),s.value}getByKey(r){const s=this.data[r];return s?s[0].value:null}get(r){return this.has(r)?this.data[r.wrapped().key][0].value:null}remove(r,s){if(!this.has(r))return this;const d=r.wrapped().key,f=s===void 0?0:this.data[d].indexOf(s),_=this.data[d][f];return this.data[d].splice(f,1),_.timeout&&clearTimeout(_.timeout),this.data[d].length===0&&delete this.data[d],this.onRemove(_.value),this.order.splice(this.order.indexOf(d),1),this}setMaxSize(r){for(this.max=r;this.order.length>this.max;){const s=this._getAndRemoveByKey(this.order[0]);s&&this.onRemove(s)}return this}filter(r){const s=[];for(const d in this.data)for(const f of this.data[d])r(f.value)||s.push(f);for(const d of s)this.remove(d.value.tileID,d)}}class Ae{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(r,s,d){const f=String(s);if(this.stateChanges[r]=this.stateChanges[r]||{},this.stateChanges[r][f]=this.stateChanges[r][f]||{},u.e(this.stateChanges[r][f],d),this.deletedStates[r]===null){this.deletedStates[r]={};for(const _ in this.state[r])_!==f&&(this.deletedStates[r][_]=null)}else if(this.deletedStates[r]&&this.deletedStates[r][f]===null){this.deletedStates[r][f]={};for(const _ in this.state[r][f])d[_]||(this.deletedStates[r][f][_]=null)}else for(const _ in d)this.deletedStates[r]&&this.deletedStates[r][f]&&this.deletedStates[r][f][_]===null&&delete this.deletedStates[r][f][_]}removeFeatureState(r,s,d){if(this.deletedStates[r]===null)return;const f=String(s);if(this.deletedStates[r]=this.deletedStates[r]||{},d&&s!==void 0)this.deletedStates[r][f]!==null&&(this.deletedStates[r][f]=this.deletedStates[r][f]||{},this.deletedStates[r][f][d]=null);else if(s!==void 0)if(this.stateChanges[r]&&this.stateChanges[r][f])for(d in this.deletedStates[r][f]={},this.stateChanges[r][f])this.deletedStates[r][f][d]=null;else this.deletedStates[r][f]=null;else this.deletedStates[r]=null}getState(r,s){const d=String(s),f=u.e({},(this.state[r]||{})[d],(this.stateChanges[r]||{})[d]);if(this.deletedStates[r]===null)return{};if(this.deletedStates[r]){const _=this.deletedStates[r][s];if(_===null)return{};for(const b in _)delete f[b]}return f}initializeTileState(r,s){r.setFeatureState(this.state,s)}coalesceChanges(r,s){const d={};for(const f in this.stateChanges){this.state[f]=this.state[f]||{};const _={};for(const b in this.stateChanges[f])this.state[f][b]||(this.state[f][b]={}),u.e(this.state[f][b],this.stateChanges[f][b]),_[b]=this.state[f][b];d[f]=_}for(const f in this.deletedStates){this.state[f]=this.state[f]||{};const _={};if(this.deletedStates[f]===null)for(const b in this.state[f])_[b]={},this.state[f][b]={};else for(const b in this.deletedStates[f]){if(this.deletedStates[f][b]===null)this.state[f][b]={};else for(const S of Object.keys(this.deletedStates[f][b]))delete this.state[f][b][S];_[b]=this.state[f][b]}d[f]=d[f]||{},u.e(d[f],_)}if(this.stateChanges={},this.deletedStates={},Object.keys(d).length!==0)for(const f in r)r[f].setFeatureState(d,s)}}class Hn extends u.E{constructor(r,s,d){super(),this.id=r,this.dispatcher=d,this.on("data",f=>{f.dataType==="source"&&f.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&f.dataType==="source"&&f.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((f,_,b,S)=>{const E=new(jr(_.type))(f,_,b,S);if(E.id!==f)throw new Error(`Expected Source id to be ${f} instead of ${E.id}`);return E})(r,s,d,this),this._tiles={},this._cache=new bo(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new Ae,this._didEmitContent=!1,this._updated=!1}onAdd(r){this.map=r,this._maxTileCacheSize=r?r._maxTileCacheSize:null,this._maxTileCacheZoomLevels=r?r._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(r)}onRemove(r){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(r)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const r in this._tiles){const s=this._tiles[r];if(s.state!=="loaded"&&s.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const r=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,r&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(r,s){return this._source.loadTile(r,s)}_unloadTile(r){if(this._source.unloadTile)return this._source.unloadTile(r,()=>{})}_abortTile(r){this._source.abortTile&&this._source.abortTile(r,()=>{}),this._source.fire(new u.k("dataabort",{tile:r,coord:r.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(r){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const s in this._tiles){const d=this._tiles[s];d.upload(r),d.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(r=>r.tileID).sort(Ar).map(r=>r.key)}getRenderableIds(r){const s=[];for(const d in this._tiles)this._isIdRenderable(d,r)&&s.push(this._tiles[d]);return r?s.sort((d,f)=>{const _=d.tileID,b=f.tileID,S=new u.P(_.canonical.x,_.canonical.y)._rotate(this.transform.angle),E=new u.P(b.canonical.x,b.canonical.y)._rotate(this.transform.angle);return _.overscaledZ-b.overscaledZ||E.y-S.y||E.x-S.x}).map(d=>d.tileID.key):s.map(d=>d.tileID).sort(Ar).map(d=>d.key)}hasRenderableParent(r){const s=this.findLoadedParent(r,0);return!!s&&this._isIdRenderable(s.tileID.key)}_isIdRenderable(r,s){return this._tiles[r]&&this._tiles[r].hasData()&&!this._coveredTiles[r]&&(s||!this._tiles[r].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const r in this._tiles)this._tiles[r].state!=="errored"&&this._reloadTile(r,"reloading")}}_reloadTile(r,s){const d=this._tiles[r];d&&(d.state!=="loading"&&(d.state=s),this._loadTile(d,this._tileLoaded.bind(this,d,r,s)))}_tileLoaded(r,s,d,f){if(f)return r.state="errored",void(f.status!==404?this._source.fire(new u.j(f,{tile:r})):this.update(this.transform,this.terrain));r.timeAdded=u.h.now(),d==="expired"&&(r.refreshedUponExpiration=!0),this._setTileReloadTimer(s,r),this.getSource().type==="raster-dem"&&r.dem&&this._backfillDEM(r),this._state.initializeTileState(r,this.map?this.map.painter:null),r.aborted||this._source.fire(new u.k("data",{dataType:"source",tile:r,coord:r.tileID}))}_backfillDEM(r){const s=this.getRenderableIds();for(let f=0;f<s.length;f++){const _=s[f];if(r.neighboringTiles&&r.neighboringTiles[_]){const b=this.getTileByID(_);d(r,b),d(b,r)}}function d(f,_){f.needsHillshadePrepare=!0,f.needsTerrainPrepare=!0;let b=_.tileID.canonical.x-f.tileID.canonical.x;const S=_.tileID.canonical.y-f.tileID.canonical.y,E=Math.pow(2,f.tileID.canonical.z),M=_.tileID.key;b===0&&S===0||Math.abs(S)>1||(Math.abs(b)>1&&(Math.abs(b+E)===1?b+=E:Math.abs(b-E)===1&&(b-=E)),_.dem&&f.dem&&(f.dem.backfillBorder(_.dem,b,S),f.neighboringTiles&&f.neighboringTiles[M]&&(f.neighboringTiles[M].backfilled=!0)))}}getTile(r){return this.getTileByID(r.key)}getTileByID(r){return this._tiles[r]}_retainLoadedChildren(r,s,d,f){for(const _ in this._tiles){let b=this._tiles[_];if(f[_]||!b.hasData()||b.tileID.overscaledZ<=s||b.tileID.overscaledZ>d)continue;let S=b.tileID;for(;b&&b.tileID.overscaledZ>s+1;){const M=b.tileID.scaledTo(b.tileID.overscaledZ-1);b=this._tiles[M.key],b&&b.hasData()&&(S=M)}let E=S;for(;E.overscaledZ>s;)if(E=E.scaledTo(E.overscaledZ-1),r[E.key]){f[S.key]=S;break}}}findLoadedParent(r,s){if(r.key in this._loadedParentTiles){const d=this._loadedParentTiles[r.key];return d&&d.tileID.overscaledZ>=s?d:null}for(let d=r.overscaledZ-1;d>=s;d--){const f=r.scaledTo(d),_=this._getLoadedTile(f);if(_)return _}}_getLoadedTile(r){const s=this._tiles[r.key];return s&&s.hasData()?s:this._cache.getByKey(r.wrapped().key)}updateCacheSize(r){const s=Math.ceil(r.width/this._source.tileSize)+1,d=Math.ceil(r.height/this._source.tileSize)+1,f=Math.floor(s*d*(this._maxTileCacheZoomLevels===null?u.c.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),_=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,f):f;this._cache.setMaxSize(_)}handleWrapJump(r){const s=Math.round((r-(this._prevLng===void 0?r:this._prevLng))/360);if(this._prevLng=r,s){const d={};for(const f in this._tiles){const _=this._tiles[f];_.tileID=_.tileID.unwrapTo(_.tileID.wrap+s),d[_.tileID.key]=_}this._tiles=d;for(const f in this._timers)clearTimeout(this._timers[f]),delete this._timers[f];for(const f in this._tiles)this._setTileReloadTimer(f,this._tiles[f])}}update(r,s){if(this.transform=r,this.terrain=s,!this._sourceLoaded||this._paused)return;let d;this.updateCacheSize(r),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?d=r.getVisibleUnwrappedCoordinates(this._source.tileID).map(z=>new u.O(z.canonical.z,z.wrap,z.canonical.z,z.canonical.x,z.canonical.y)):(d=r.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:s}),this._source.hasTile&&(d=d.filter(z=>this._source.hasTile(z)))):d=[];const f=r.coveringZoomLevel(this._source),_=Math.max(f-Hn.maxOverzooming,this._source.minzoom),b=Math.max(f+Hn.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const z={};for(const L of d)if(L.canonical.z>this._source.minzoom){const N=L.scaledTo(L.canonical.z-1);z[N.key]=N;const J=L.scaledTo(Math.max(this._source.minzoom,Math.min(L.canonical.z,5)));z[J.key]=J}d=d.concat(Object.values(z))}const S=d.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,S&&this.fire(new u.k("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const E=this._updateRetainedTiles(d,f);if(nn(this._source.type)){const z={},L={},N=Object.keys(E),J=u.h.now();for(const Y of N){const te=E[Y],K=this._tiles[Y];if(!K||K.fadeEndTime!==0&&K.fadeEndTime<=J)continue;const me=this.findLoadedParent(te,_);me&&(this._addTile(me.tileID),z[me.tileID.key]=me.tileID),L[Y]=te}this._retainLoadedChildren(L,f,b,E);for(const Y in z)E[Y]||(this._coveredTiles[Y]=!0,E[Y]=z[Y]);if(s){const Y={},te={};for(const K of d)this._tiles[K.key].hasData()?Y[K.key]=K:te[K.key]=K;for(const K in te){const me=te[K].children(this._source.maxzoom);this._tiles[me[0].key]&&this._tiles[me[1].key]&&this._tiles[me[2].key]&&this._tiles[me[3].key]&&(Y[me[0].key]=E[me[0].key]=me[0],Y[me[1].key]=E[me[1].key]=me[1],Y[me[2].key]=E[me[2].key]=me[2],Y[me[3].key]=E[me[3].key]=me[3],delete te[K])}for(const K in te){const me=this.findLoadedParent(te[K],this._source.minzoom);if(me){Y[me.tileID.key]=E[me.tileID.key]=me.tileID;for(const Se in Y)Y[Se].isChildOf(me.tileID)&&delete Y[Se]}}for(const K in this._tiles)Y[K]||(this._coveredTiles[K]=!0)}}for(const z in E)this._tiles[z].clearFadeHold();const M=u.ab(this._tiles,E);for(const z of M){const L=this._tiles[z];L.hasSymbolBuckets&&!L.holdingForFade()?L.setHoldDuration(this.map._fadeDuration):L.hasSymbolBuckets&&!L.symbolFadeFinished()||this._removeTile(z)}this._updateLoadedParentTileCache()}releaseSymbolFadeTiles(){for(const r in this._tiles)this._tiles[r].holdingForFade()&&this._removeTile(r)}_updateRetainedTiles(r,s){const d={},f={},_=Math.max(s-Hn.maxOverzooming,this._source.minzoom),b=Math.max(s+Hn.maxUnderzooming,this._source.minzoom),S={};for(const E of r){const M=this._addTile(E);d[E.key]=E,M.hasData()||s<this._source.maxzoom&&(S[E.key]=E)}this._retainLoadedChildren(S,s,b,d);for(const E of r){let M=this._tiles[E.key];if(M.hasData())continue;if(s+1>this._source.maxzoom){const L=E.children(this._source.maxzoom)[0],N=this.getTile(L);if(N&&N.hasData()){d[L.key]=L;continue}}else{const L=E.children(this._source.maxzoom);if(d[L[0].key]&&d[L[1].key]&&d[L[2].key]&&d[L[3].key])continue}let z=M.wasRequested();for(let L=E.overscaledZ-1;L>=_;--L){const N=E.scaledTo(L);if(f[N.key])break;if(f[N.key]=!0,M=this.getTile(N),!M&&z&&(M=this._addTile(N)),M){const J=M.hasData();if((z||J)&&(d[N.key]=N),z=M.wasRequested(),J)break}}}return d}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const r in this._tiles){const s=[];let d,f=this._tiles[r].tileID;for(;f.overscaledZ>0;){if(f.key in this._loadedParentTiles){d=this._loadedParentTiles[f.key];break}s.push(f.key);const _=f.scaledTo(f.overscaledZ-1);if(d=this._getLoadedTile(_),d)break;f=_}for(const _ of s)this._loadedParentTiles[_]=d}}_addTile(r){let s=this._tiles[r.key];if(s)return s;s=this._cache.getAndRemove(r),s&&(this._setTileReloadTimer(r.key,s),s.tileID=r,this._state.initializeTileState(s,this.map?this.map.painter:null),this._cacheTimers[r.key]&&(clearTimeout(this._cacheTimers[r.key]),delete this._cacheTimers[r.key],this._setTileReloadTimer(r.key,s)));const d=s;return s||(s=new ro(r,this._source.tileSize*r.overscaleFactor()),this._loadTile(s,this._tileLoaded.bind(this,s,r.key,s.state))),s.uses++,this._tiles[r.key]=s,d||this._source.fire(new u.k("dataloading",{tile:s,coord:s.tileID,dataType:"source"})),s}_setTileReloadTimer(r,s){r in this._timers&&(clearTimeout(this._timers[r]),delete this._timers[r]);const d=s.getExpiryTimeout();d&&(this._timers[r]=setTimeout(()=>{this._reloadTile(r,"expired"),delete this._timers[r]},d))}_removeTile(r){const s=this._tiles[r];s&&(s.uses--,delete this._tiles[r],this._timers[r]&&(clearTimeout(this._timers[r]),delete this._timers[r]),s.uses>0||(s.hasData()&&s.state!=="reloading"?this._cache.add(s.tileID,s,s.getExpiryTimeout()):(s.aborted=!0,this._abortTile(s),this._unloadTile(s))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const r in this._tiles)this._removeTile(r);this._cache.reset()}tilesIn(r,s,d){const f=[],_=this.transform;if(!_)return f;const b=d?_.getCameraQueryGeometry(r):r,S=r.map(Y=>_.pointCoordinate(Y,this.terrain)),E=b.map(Y=>_.pointCoordinate(Y,this.terrain)),M=this.getIds();let z=1/0,L=1/0,N=-1/0,J=-1/0;for(const Y of E)z=Math.min(z,Y.x),L=Math.min(L,Y.y),N=Math.max(N,Y.x),J=Math.max(J,Y.y);for(let Y=0;Y<M.length;Y++){const te=this._tiles[M[Y]];if(te.holdingForFade())continue;const K=te.tileID,me=Math.pow(2,_.zoom-te.tileID.overscaledZ),Se=s*te.queryPadding*u.N/te.tileSize/me,ie=[K.getTilePoint(new u.U(z,L)),K.getTilePoint(new u.U(N,J))];if(ie[0].x-Se<u.N&&ie[0].y-Se<u.N&&ie[1].x+Se>=0&&ie[1].y+Se>=0){const ge=S.map(Ie=>K.getTilePoint(Ie)),Ee=E.map(Ie=>K.getTilePoint(Ie));f.push({tile:te,tileID:K,queryGeometry:ge,cameraQueryGeometry:Ee,scale:me})}}return f}getVisibleCoordinates(r){const s=this.getRenderableIds(r).map(d=>this._tiles[d].tileID);for(const d of s)d.posMatrix=this.transform.calculatePosMatrix(d.toUnwrapped());return s}hasTransition(){if(this._source.hasTransition())return!0;if(nn(this._source.type)){const r=u.h.now();for(const s in this._tiles)if(this._tiles[s].fadeEndTime>=r)return!0}return!1}setFeatureState(r,s,d){this._state.updateState(r=r||"_geojsonTileLayer",s,d)}removeFeatureState(r,s,d){this._state.removeFeatureState(r=r||"_geojsonTileLayer",s,d)}getFeatureState(r,s){return this._state.getState(r=r||"_geojsonTileLayer",s)}setDependencies(r,s,d){const f=this._tiles[r];f&&f.setDependencies(s,d)}reloadTilesForDependencies(r,s){for(const d in this._tiles)this._tiles[d].hasDependency(r,s)&&this._reloadTile(d,"reloading");this._cache.filter(d=>!d.hasDependency(r,s))}}function Ar(g,r){const s=Math.abs(2*g.wrap)-+(g.wrap<0),d=Math.abs(2*r.wrap)-+(r.wrap<0);return g.overscaledZ-r.overscaledZ||d-s||r.canonical.y-g.canonical.y||r.canonical.x-g.canonical.x}function nn(g){return g==="raster"||g==="image"||g==="video"}Hn.maxOverzooming=10,Hn.maxUnderzooming=3;const Dt="mapboxgl_preloaded_worker_pool";class br{constructor(){this.active={}}acquire(r){if(!this.workers)for(this.workers=[];this.workers.length<br.workerCount;)this.workers.push(new Worker(u.c.WORKER_URL));return this.active[r]=!0,this.workers.slice()}release(r){delete this.active[r],this.numActive()===0&&(this.workers.forEach(s=>{s.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[Dt]}numActive(){return Object.keys(this.active).length}}const So=Math.floor(u.h.hardwareConcurrency/2);let Zr;function Va(){return Zr||(Zr=new br),Zr}br.workerCount=u.ac(globalThis)?Math.max(Math.min(So,3),1):1;class zr{constructor(r,s){this.reset(r,s)}reset(r,s){this.points=r||[],this._distances=[0];for(let d=1;d<this.points.length;d++)this._distances[d]=this._distances[d-1]+this.points[d].dist(this.points[d-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(s||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(r){if(this.points.length===1)return this.points[0];r=u.ad(r,0,1);let s=1,d=this._distances[s];const f=r*this.paddedLength+this.padding;for(;d<f&&s<this._distances.length;)d=this._distances[++s];const _=s-1,b=this._distances[_],S=d-b,E=S>0?(f-b)/S:0;return this.points[_].mult(1-E).add(this.points[s].mult(E))}}function Bi(g,r){let s=!0;return g==="always"||g!=="never"&&r!=="never"||(s=!1),s}class io{constructor(r,s,d){const f=this.boxCells=[],_=this.circleCells=[];this.xCellCount=Math.ceil(r/d),this.yCellCount=Math.ceil(s/d);for(let b=0;b<this.xCellCount*this.yCellCount;b++)f.push([]),_.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=r,this.height=s,this.xScale=this.xCellCount/r,this.yScale=this.yCellCount/s,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(r,s,d,f,_){this._forEachCell(s,d,f,_,this._insertBoxCell,this.boxUid++),this.boxKeys.push(r),this.bboxes.push(s),this.bboxes.push(d),this.bboxes.push(f),this.bboxes.push(_)}insertCircle(r,s,d,f){this._forEachCell(s-f,d-f,s+f,d+f,this._insertCircleCell,this.circleUid++),this.circleKeys.push(r),this.circles.push(s),this.circles.push(d),this.circles.push(f)}_insertBoxCell(r,s,d,f,_,b){this.boxCells[_].push(b)}_insertCircleCell(r,s,d,f,_,b){this.circleCells[_].push(b)}_query(r,s,d,f,_,b,S){if(d<0||r>this.width||f<0||s>this.height)return[];const E=[];if(r<=0&&s<=0&&this.width<=d&&this.height<=f){if(_)return[{key:null,x1:r,y1:s,x2:d,y2:f}];for(let M=0;M<this.boxKeys.length;M++)E.push({key:this.boxKeys[M],x1:this.bboxes[4*M],y1:this.bboxes[4*M+1],x2:this.bboxes[4*M+2],y2:this.bboxes[4*M+3]});for(let M=0;M<this.circleKeys.length;M++){const z=this.circles[3*M],L=this.circles[3*M+1],N=this.circles[3*M+2];E.push({key:this.circleKeys[M],x1:z-N,y1:L-N,x2:z+N,y2:L+N})}}else this._forEachCell(r,s,d,f,this._queryCell,E,{hitTest:_,overlapMode:b,seenUids:{box:{},circle:{}}},S);return E}query(r,s,d,f){return this._query(r,s,d,f,!1,null)}hitTest(r,s,d,f,_,b){return this._query(r,s,d,f,!0,_,b).length>0}hitTestCircle(r,s,d,f,_){const b=r-d,S=r+d,E=s-d,M=s+d;if(S<0||b>this.width||M<0||E>this.height)return!1;const z=[];return this._forEachCell(b,E,S,M,this._queryCellCircle,z,{hitTest:!0,overlapMode:f,circle:{x:r,y:s,radius:d},seenUids:{box:{},circle:{}}},_),z.length>0}_queryCell(r,s,d,f,_,b,S,E){const{seenUids:M,hitTest:z,overlapMode:L}=S,N=this.boxCells[_];if(N!==null){const Y=this.bboxes;for(const te of N)if(!M.box[te]){M.box[te]=!0;const K=4*te,me=this.boxKeys[te];if(r<=Y[K+2]&&s<=Y[K+3]&&d>=Y[K+0]&&f>=Y[K+1]&&(!E||E(me))&&(!z||!Bi(L,me.overlapMode))&&(b.push({key:me,x1:Y[K],y1:Y[K+1],x2:Y[K+2],y2:Y[K+3]}),z))return!0}}const J=this.circleCells[_];if(J!==null){const Y=this.circles;for(const te of J)if(!M.circle[te]){M.circle[te]=!0;const K=3*te,me=this.circleKeys[te];if(this._circleAndRectCollide(Y[K],Y[K+1],Y[K+2],r,s,d,f)&&(!E||E(me))&&(!z||!Bi(L,me.overlapMode))){const Se=Y[K],ie=Y[K+1],ge=Y[K+2];if(b.push({key:me,x1:Se-ge,y1:ie-ge,x2:Se+ge,y2:ie+ge}),z)return!0}}}return!1}_queryCellCircle(r,s,d,f,_,b,S,E){const{circle:M,seenUids:z,overlapMode:L}=S,N=this.boxCells[_];if(N!==null){const Y=this.bboxes;for(const te of N)if(!z.box[te]){z.box[te]=!0;const K=4*te,me=this.boxKeys[te];if(this._circleAndRectCollide(M.x,M.y,M.radius,Y[K+0],Y[K+1],Y[K+2],Y[K+3])&&(!E||E(me))&&!Bi(L,me.overlapMode))return b.push(!0),!0}}const J=this.circleCells[_];if(J!==null){const Y=this.circles;for(const te of J)if(!z.circle[te]){z.circle[te]=!0;const K=3*te,me=this.circleKeys[te];if(this._circlesCollide(Y[K],Y[K+1],Y[K+2],M.x,M.y,M.radius)&&(!E||E(me))&&!Bi(L,me.overlapMode))return b.push(!0),!0}}}_forEachCell(r,s,d,f,_,b,S,E){const M=this._convertToXCellCoord(r),z=this._convertToYCellCoord(s),L=this._convertToXCellCoord(d),N=this._convertToYCellCoord(f);for(let J=M;J<=L;J++)for(let Y=z;Y<=N;Y++)if(_.call(this,r,s,d,f,this.xCellCount*Y+J,b,S,E))return}_convertToXCellCoord(r){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(r*this.xScale)))}_convertToYCellCoord(r){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(r*this.yScale)))}_circlesCollide(r,s,d,f,_,b){const S=f-r,E=_-s,M=d+b;return M*M>S*S+E*E}_circleAndRectCollide(r,s,d,f,_,b,S){const E=(b-f)/2,M=Math.abs(r-(f+E));if(M>E+d)return!1;const z=(S-_)/2,L=Math.abs(s-(_+z));if(L>z+d)return!1;if(M<=E||L<=z)return!0;const N=M-E,J=L-z;return N*N+J*J<=d*d}}function Ne(g,r,s,d,f){const _=u.Z();return r?(u.a0(_,_,[1/f,1/f,1]),s||u.ae(_,_,d.angle)):u.a1(_,d.labelPlaneMatrix,g),_}function wi(g,r,s,d,f){if(r){const _=u.af(g);return u.a0(_,_,[f,f,1]),s||u.ae(_,_,-d.angle),_}return d.glCoordMatrix}function gn(g,r,s){let d;s?(d=[g.x,g.y,s(g.x,g.y),1],u.ag(d,d,r)):(d=[g.x,g.y,0,1],H(d,d,r));const f=d[3];return{point:new u.P(d[0]/f,d[1]/f),signedDistanceFromCamera:f}}function bi(g,r){return .5+g/r*.5}function Si(g,r){const s=g[0]/g[3],d=g[1]/g[3];return s>=-r[0]&&s<=r[0]&&d>=-r[1]&&d<=r[1]}function Ue(g,r,s,d,f,_,b,S,E,M){const z=d?g.textSizeData:g.iconSizeData,L=u.ah(z,s.transform.zoom),N=[256/s.width*2+1,256/s.height*2+1],J=d?g.text.dynamicLayoutVertexArray:g.icon.dynamicLayoutVertexArray;J.clear();const Y=g.lineVertexArray,te=d?g.text.placedSymbolArray:g.icon.placedSymbolArray,K=s.transform.width/s.transform.height;let me=!1;for(let Se=0;Se<te.length;Se++){const ie=te.get(Se);if(ie.hidden||ie.writingMode===u.ai.vertical&&!me){Z(ie.numGlyphs,J);continue}let ge;if(me=!1,M?(ge=[ie.anchorX,ie.anchorY,M(ie.anchorX,ie.anchorY),1],u.ag(ge,ge,r)):(ge=[ie.anchorX,ie.anchorY,0,1],H(ge,ge,r)),!Si(ge,N)){Z(ie.numGlyphs,J);continue}const Ee=bi(s.transform.cameraToCenterDistance,ge[3]),Ie=u.aj(z,L,ie),ze=b?Ie/Ee:Ie*Ee,Re=new u.P(ie.anchorX,ie.anchorY),Le=gn(Re,f,M).point,Ve={projections:{},offsets:{}},rt=fr(ie,ze,!1,S,r,f,_,g.glyphOffsetArray,Y,J,Le,Re,Ve,K,E,M);me=rt.useVertical,(rt.notEnoughRoom||me||rt.needsFlipping&&fr(ie,ze,!0,S,r,f,_,g.glyphOffsetArray,Y,J,Le,Re,Ve,K,E,M).notEnoughRoom)&&Z(ie.numGlyphs,J)}d?g.text.dynamicLayoutVertexBuffer.updateData(J):g.icon.dynamicLayoutVertexBuffer.updateData(J)}function Mt(g,r,s,d,f,_,b,S,E,M,z,L,N){const J=S.glyphStartIndex+S.numGlyphs,Y=S.lineStartIndex,te=S.lineStartIndex+S.lineLength,K=r.getoffsetX(S.glyphStartIndex),me=r.getoffsetX(J-1),Se=P(g*K,s,d,f,_,b,S.segment,Y,te,E,M,z,L,N);if(!Se)return null;const ie=P(g*me,s,d,f,_,b,S.segment,Y,te,E,M,z,L,N);return ie?{first:Se,last:ie}:null}function vt(g,r,s,d){return g===u.ai.horizontal&&Math.abs(s.y-r.y)>Math.abs(s.x-r.x)*d?{useVertical:!0}:(g===u.ai.vertical?r.y<s.y:r.x>s.x)?{needsFlipping:!0}:null}function fr(g,r,s,d,f,_,b,S,E,M,z,L,N,J,Y,te){const K=r/24,me=g.lineOffsetX*K,Se=g.lineOffsetY*K;let ie;if(g.numGlyphs>1){const ge=g.glyphStartIndex+g.numGlyphs,Ee=g.lineStartIndex,Ie=g.lineStartIndex+g.lineLength,ze=Mt(K,S,me,Se,s,z,L,g,E,_,N,Y,te);if(!ze)return{notEnoughRoom:!0};const Re=gn(ze.first.point,b,te).point,Le=gn(ze.last.point,b,te).point;if(d&&!s){const Ve=vt(g.writingMode,Re,Le,J);if(Ve)return Ve}ie=[ze.first];for(let Ve=g.glyphStartIndex+1;Ve<ge-1;Ve++)ie.push(P(K*S.getoffsetX(Ve),me,Se,s,z,L,g.segment,Ee,Ie,E,_,N,Y,te));ie.push(ze.last)}else{if(d&&!s){const Ee=gn(L,f,te).point,Ie=g.lineStartIndex+g.segment+1,ze=new u.P(E.getx(Ie),E.gety(Ie)),Re=gn(ze,f,te),Le=Re.signedDistanceFromCamera>0?Re.point:ii(L,ze,Ee,1,f,te),Ve=vt(g.writingMode,Ee,Le,J);if(Ve)return Ve}const ge=P(K*S.getoffsetX(g.glyphStartIndex),me,Se,s,z,L,g.segment,g.lineStartIndex,g.lineStartIndex+g.lineLength,E,_,N,Y,te);if(!ge)return{notEnoughRoom:!0};ie=[ge]}for(const ge of ie)u.ak(M,ge.point,ge.angle);return{}}function ii(g,r,s,d,f,_){const b=gn(g.add(g.sub(r)._unit()),f,_).point,S=s.sub(b);return s.add(S._mult(d/S.mag()))}function Ct(g,r){const{projectionCache:s,lineVertexArray:d,labelPlaneMatrix:f,tileAnchorPoint:_,distanceFromAnchor:b,getElevation:S,previousVertex:E,direction:M,absOffsetX:z}=r;if(s.projections[g])return s.projections[g];const L=new u.P(d.getx(g),d.gety(g)),N=gn(L,f,S);if(N.signedDistanceFromCamera>0)return s.projections[g]=N.point,N.point;const J=g-M;return ii(b===0?_:new u.P(d.getx(J),d.gety(J)),L,E,z-b+1,f,S)}function xe(g,r,s){return g._unit()._perp()._mult(r*s)}function B(g,r,s,d,f,_,b,S){const{projectionCache:E,direction:M}=S;if(E.offsets[g])return E.offsets[g];const z=s.add(r);if(g+M<d||g+M>=f)return E.offsets[g]=z,z;const L=Ct(g+M,S),N=xe(L.sub(s),b,M),J=s.add(N),Y=L.add(N);return E.offsets[g]=u.al(_,z,J,Y)||z,E.offsets[g]}function P(g,r,s,d,f,_,b,S,E,M,z,L,N,J){const Y=d?g-r:g+r;let te=Y>0?1:-1,K=0;d&&(te*=-1,K=Math.PI),te<0&&(K+=Math.PI);let me,Se,ie=te>0?S+b:S+b+1,ge=f,Ee=f,Ie=0,ze=0;const Re=Math.abs(Y),Le=[];let Ve;for(;Ie+ze<=Re;){if(ie+=te,ie<S||ie>=E)return null;Ie+=ze,Ee=ge,Se=me;const Ge={projectionCache:L,lineVertexArray:M,labelPlaneMatrix:z,tileAnchorPoint:_,distanceFromAnchor:Ie,getElevation:J,previousVertex:Ee,direction:te,absOffsetX:Re};if(ge=Ct(ie,Ge),s===0)Le.push(Ee),Ve=ge.sub(Ee);else{let gt;const ot=ge.sub(Ee);gt=ot.mag()===0?xe(Ct(ie+te,Ge).sub(ge),s,te):xe(ot,s,te),Se||(Se=Ee.add(gt)),me=B(ie,gt,ge,S,E,Se,s,Ge),Le.push(Se),Ve=me.sub(Se)}ze=Ve.mag()}const rt=Ve._mult((Re-Ie)/ze)._add(Se||Ee),Ut=K+Math.atan2(ge.y-Ee.y,ge.x-Ee.x);return Le.push(rt),{point:rt,angle:N?Ut:0,path:Le}}const F=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Z(g,r){for(let s=0;s<g;s++){const d=r.length;r.resize(d+4),r.float32.set(F,3*d)}}function H(g,r,s){const d=r[0],f=r[1];return g[0]=s[0]*d+s[4]*f+s[12],g[1]=s[1]*d+s[5]*f+s[13],g[3]=s[3]*d+s[7]*f+s[15],g}const W=100;class ce{constructor(r,s=new io(r.width+200,r.height+200,25),d=new io(r.width+200,r.height+200,25)){this.transform=r,this.grid=s,this.ignoredGrid=d,this.pitchfactor=Math.cos(r._pitch)*r.cameraToCenterDistance,this.screenRightBoundary=r.width+W,this.screenBottomBoundary=r.height+W,this.gridRightBoundary=r.width+200,this.gridBottomBoundary=r.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(r,s,d,f,_,b){const S=this.projectAndGetPerspectiveRatio(f,r.anchorPointX,r.anchorPointY,b),E=d*S.perspectiveRatio,M=r.x1*E+S.point.x,z=r.y1*E+S.point.y,L=r.x2*E+S.point.x,N=r.y2*E+S.point.y;return!this.isInsideGrid(M,z,L,N)||s!=="always"&&this.grid.hitTest(M,z,L,N,s,_)||S.perspectiveRatio<this.perspectiveRatioCutoff?{box:[],offscreen:!1}:{box:[M,z,L,N],offscreen:this.isOffscreen(M,z,L,N)}}placeCollisionCircles(r,s,d,f,_,b,S,E,M,z,L,N,J,Y){const te=[],K=new u.P(s.anchorX,s.anchorY),me=gn(K,b,Y),Se=bi(this.transform.cameraToCenterDistance,me.signedDistanceFromCamera),ie=(z?_/Se:_*Se)/u.ap,ge=gn(K,S,Y).point,Ee=Mt(ie,f,s.lineOffsetX*ie,s.lineOffsetY*ie,!1,ge,K,s,d,S,{projections:{},offsets:{}},!1,Y);let Ie=!1,ze=!1,Re=!0;if(Ee){const Le=.5*N*Se+J,Ve=new u.P(-100,-100),rt=new u.P(this.screenRightBoundary,this.screenBottomBoundary),Ut=new zr,Ge=Ee.first,gt=Ee.last;let ot=[];for(let At=Ge.path.length-1;At>=1;At--)ot.push(Ge.path[At]);for(let At=1;At<gt.path.length;At++)ot.push(gt.path[At]);const an=2.5*Le;if(E){const At=ot.map($t=>gn($t,E,Y));ot=At.some($t=>$t.signedDistanceFromCamera<=0)?[]:At.map($t=>$t.point)}let Vt=[];if(ot.length>0){const At=ot[0].clone(),$t=ot[0].clone();for(let Rn=1;Rn<ot.length;Rn++)At.x=Math.min(At.x,ot[Rn].x),At.y=Math.min(At.y,ot[Rn].y),$t.x=Math.max($t.x,ot[Rn].x),$t.y=Math.max($t.y,ot[Rn].y);Vt=At.x>=Ve.x&&$t.x<=rt.x&&At.y>=Ve.y&&$t.y<=rt.y?[ot]:$t.x<Ve.x||At.x>rt.x||$t.y<Ve.y||At.y>rt.y?[]:u.am([ot],Ve.x,Ve.y,rt.x,rt.y)}for(const At of Vt){Ut.reset(At,.25*Le);let $t=0;$t=Ut.length<=.5*Le?1:Math.ceil(Ut.paddedLength/an)+1;for(let Rn=0;Rn<$t;Rn++){const pn=Rn/Math.max($t-1,1),gr=Ut.lerp(pn),nr=gr.x+W,Nn=gr.y+W;te.push(nr,Nn,Le,0);const hi=nr-Le,_n=Nn-Le,ao=nr+Le,so=Nn+Le;if(Re=Re&&this.isOffscreen(hi,_n,ao,so),ze=ze||this.isInsideGrid(hi,_n,ao,so),r!=="always"&&this.grid.hitTestCircle(nr,Nn,Le,r,L)&&(Ie=!0,!M))return{circles:[],offscreen:!1,collisionDetected:Ie}}}}return{circles:!M&&Ie||!ze||Se<this.perspectiveRatioCutoff?[]:te,offscreen:Re,collisionDetected:Ie}}queryRenderedSymbols(r){if(r.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const s=[];let d=1/0,f=1/0,_=-1/0,b=-1/0;for(const z of r){const L=new u.P(z.x+W,z.y+W);d=Math.min(d,L.x),f=Math.min(f,L.y),_=Math.max(_,L.x),b=Math.max(b,L.y),s.push(L)}const S=this.grid.query(d,f,_,b).concat(this.ignoredGrid.query(d,f,_,b)),E={},M={};for(const z of S){const L=z.key;if(E[L.bucketInstanceId]===void 0&&(E[L.bucketInstanceId]={}),E[L.bucketInstanceId][L.featureIndex])continue;const N=[new u.P(z.x1,z.y1),new u.P(z.x2,z.y1),new u.P(z.x2,z.y2),new u.P(z.x1,z.y2)];u.an(s,N)&&(E[L.bucketInstanceId][L.featureIndex]=!0,M[L.bucketInstanceId]===void 0&&(M[L.bucketInstanceId]=[]),M[L.bucketInstanceId].push(L.featureIndex))}return M}insertCollisionBox(r,s,d,f,_,b){(d?this.ignoredGrid:this.grid).insert({bucketInstanceId:f,featureIndex:_,collisionGroupID:b,overlapMode:s},r[0],r[1],r[2],r[3])}insertCollisionCircles(r,s,d,f,_,b){const S=d?this.ignoredGrid:this.grid,E={bucketInstanceId:f,featureIndex:_,collisionGroupID:b,overlapMode:s};for(let M=0;M<r.length;M+=4)S.insertCircle(E,r[M],r[M+1],r[M+2])}projectAndGetPerspectiveRatio(r,s,d,f){let _;return f?(_=[s,d,f(s,d),1],u.ag(_,_,r)):(_=[s,d,0,1],H(_,_,r)),{point:new u.P((_[0]/_[3]+1)/2*this.transform.width+W,(-_[1]/_[3]+1)/2*this.transform.height+W),perspectiveRatio:.5+this.transform.cameraToCenterDistance/_[3]*.5}}isOffscreen(r,s,d,f){return d<W||r>=this.screenRightBoundary||f<W||s>this.screenBottomBoundary}isInsideGrid(r,s,d,f){return d>=0&&r<this.gridRightBoundary&&f>=0&&s<this.gridBottomBoundary}getViewportMatrix(){const r=u.ao([]);return u.$(r,r,[-100,-100,0]),r}}function ne(g,r,s){return r*(u.N/(g.tileSize*Math.pow(2,s-g.tileID.overscaledZ)))}class Q{constructor(r,s,d,f){this.opacity=r?Math.max(0,Math.min(1,r.opacity+(r.placed?s:-s))):f&&d?1:0,this.placed=d}isHidden(){return this.opacity===0&&!this.placed}}class fe{constructor(r,s,d,f,_){this.text=new Q(r?r.text:null,s,d,_),this.icon=new Q(r?r.icon:null,s,f,_)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class we{constructor(r,s,d){this.text=r,this.icon=s,this.skipFade=d}}class ke{constructor(){this.invProjMatrix=u.Z(),this.viewportMatrix=u.Z(),this.circles=[]}}class Pe{constructor(r,s,d,f,_){this.bucketInstanceId=r,this.featureIndex=s,this.sourceLayerIndex=d,this.bucketIndex=f,this.tileID=_}}class et{constructor(r){this.crossSourceCollisions=r,this.maxGroupID=0,this.collisionGroups={}}get(r){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[r]){const s=++this.maxGroupID;this.collisionGroups[r]={ID:s,predicate:d=>d.collisionGroupID===s}}return this.collisionGroups[r]}}function nt(g,r,s,d,f){const{horizontalAlign:_,verticalAlign:b}=u.au(g);return new u.P(-(_-.5)*r+d[0]*f,-(b-.5)*s+d[1]*f)}function Ye(g,r,s,d,f,_){const{x1:b,x2:S,y1:E,y2:M,anchorPointX:z,anchorPointY:L}=g,N=new u.P(r,s);return d&&N._rotate(f?_:-_),{x1:b+N.x,y1:E+N.y,x2:S+N.x,y2:M+N.y,anchorPointX:z,anchorPointY:L}}class ut{constructor(r,s,d,f,_){this.transform=r.clone(),this.terrain=s,this.collisionIndex=new ce(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=d,this.retainedQueryData={},this.collisionGroups=new et(f),this.collisionCircleArrays={},this.prevPlacement=_,_&&(_.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(r,s,d,f){const _=d.getBucket(s),b=d.latestFeatureIndex;if(!_||!b||s.id!==_.layerIds[0])return;const S=d.collisionBoxArray,E=_.layers[0].layout,M=Math.pow(2,this.transform.zoom-d.tileID.overscaledZ),z=d.tileSize/u.N,L=this.transform.calculatePosMatrix(d.tileID.toUnwrapped()),N=E.get("text-pitch-alignment")==="map",J=E.get("text-rotation-alignment")==="map",Y=ne(d,1,this.transform.zoom),te=Ne(L,N,J,this.transform,Y);let K=null;if(N){const Se=wi(L,N,J,this.transform,Y);K=u.a1([],this.transform.labelPlaneMatrix,Se)}this.retainedQueryData[_.bucketInstanceId]=new Pe(_.bucketInstanceId,b,_.sourceLayerIndex,_.index,d.tileID);const me={bucket:_,layout:E,posMatrix:L,textLabelPlaneMatrix:te,labelToScreenMatrix:K,scale:M,textPixelRatio:z,holdingForFade:d.holdingForFade(),collisionBoxArray:S,partiallyEvaluatedTextSize:u.ah(_.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(_.sourceID)};if(f)for(const Se of _.sortKeyRanges){const{sortKey:ie,symbolInstanceStart:ge,symbolInstanceEnd:Ee}=Se;r.push({sortKey:ie,symbolInstanceStart:ge,symbolInstanceEnd:Ee,parameters:me})}else r.push({symbolInstanceStart:0,symbolInstanceEnd:_.symbolInstances.length,parameters:me})}attemptAnchorPlacement(r,s,d,f,_,b,S,E,M,z,L,N,J,Y,te,K){const me=u.aq[r.textAnchor],Se=[r.textOffset0,r.textOffset1],ie=nt(me,d,f,Se,_),ge=this.collisionIndex.placeCollisionBox(Ye(s,ie.x,ie.y,b,S,this.transform.angle),L,E,M,z.predicate,K);if((!te||this.collisionIndex.placeCollisionBox(Ye(te,ie.x,ie.y,b,S,this.transform.angle),L,E,M,z.predicate,K).box.length!==0)&&ge.box.length>0){let Ee;if(this.prevPlacement&&this.prevPlacement.variableOffsets[N.crossTileID]&&this.prevPlacement.placements[N.crossTileID]&&this.prevPlacement.placements[N.crossTileID].text&&(Ee=this.prevPlacement.variableOffsets[N.crossTileID].anchor),N.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[N.crossTileID]={textOffset:Se,width:d,height:f,anchor:me,textBoxScale:_,prevAnchor:Ee},this.markUsedJustification(J,me,N,Y),J.allowVerticalPlacement&&(this.markUsedOrientation(J,Y,N),this.placedOrientations[N.crossTileID]=Y),{shift:ie,placedGlyphBoxes:ge}}}placeLayerBucketPart(r,s,d){const{bucket:f,layout:_,posMatrix:b,textLabelPlaneMatrix:S,labelToScreenMatrix:E,textPixelRatio:M,holdingForFade:z,collisionBoxArray:L,partiallyEvaluatedTextSize:N,collisionGroup:J}=r.parameters,Y=_.get("text-optional"),te=_.get("icon-optional"),K=u.ar(_,"text-overlap","text-allow-overlap"),me=K==="always",Se=u.ar(_,"icon-overlap","icon-allow-overlap"),ie=Se==="always",ge=_.get("text-rotation-alignment")==="map",Ee=_.get("text-pitch-alignment")==="map",Ie=_.get("icon-text-fit")!=="none",ze=_.get("symbol-z-order")==="viewport-y",Re=me&&(ie||!f.hasIconData()||te),Le=ie&&(me||!f.hasTextData()||Y);!f.collisionArrays&&L&&f.deserializeCollisionBoxes(L);const Ve=this.retainedQueryData[f.bucketInstanceId].tileID,rt=this.terrain?(Ge,gt)=>this.terrain.getElevation(Ve,Ge,gt):null,Ut=(Ge,gt)=>{var ot,an;if(s[Ge.crossTileID])return;if(z)return void(this.placements[Ge.crossTileID]=new we(!1,!1,!1));let Vt=!1,At=!1,$t=!0,Rn=null,pn={box:null,offscreen:null},gr={box:null,offscreen:null},nr=null,Nn=null,hi=null,_n=0,ao=0,so=0;gt.textFeatureIndex?_n=gt.textFeatureIndex:Ge.useRuntimeCollisionCircles&&(_n=Ge.featureIndex),gt.verticalTextFeatureIndex&&(ao=gt.verticalTextFeatureIndex);const Jo=gt.textBox;if(Jo){const Tr=Fn=>{let rr=u.ai.horizontal;if(f.allowVerticalPlacement&&!Fn&&this.prevPlacement){const Hr=this.prevPlacement.placedOrientations[Ge.crossTileID];Hr&&(this.placedOrientations[Ge.crossTileID]=Hr,rr=Hr,this.markUsedOrientation(f,rr,Ge))}return rr},yr=(Fn,rr)=>{if(f.allowVerticalPlacement&&Ge.numVerticalGlyphVertices>0&&gt.verticalTextBox){for(const Hr of f.writingModes)if(Hr===u.ai.vertical?(pn=rr(),gr=pn):pn=Fn(),pn&&pn.box&&pn.box.length)break}else pn=Fn()},Lr=Ge.textAnchorOffsetStartIndex,_a=Ge.textAnchorOffsetEndIndex;if(_a===Lr){const Fn=(rr,Hr)=>{const On=this.collisionIndex.placeCollisionBox(rr,K,M,b,J.predicate,rt);return On&&On.box&&On.box.length&&(this.markUsedOrientation(f,Hr,Ge),this.placedOrientations[Ge.crossTileID]=Hr),On};yr(()=>Fn(Jo,u.ai.horizontal),()=>{const rr=gt.verticalTextBox;return f.allowVerticalPlacement&&Ge.numVerticalGlyphVertices>0&&rr?Fn(rr,u.ai.vertical):{box:null,offscreen:null}}),Tr(pn&&pn.box&&pn.box.length)}else{let Fn=u.aq[(an=(ot=this.prevPlacement)===null||ot===void 0?void 0:ot.variableOffsets[Ge.crossTileID])===null||an===void 0?void 0:an.anchor];const rr=(On,va,$l)=>{const Ud=On.x2-On.x1,$d=On.y2-On.y1,Pm=Ge.textBoxScale,Mc=Ie&&Se==="never"?va:null;let lo={box:[],offscreen:!1},xa=K==="never"?1:2,uo="never";Fn&&xa++;for(let Mi=0;Mi<xa;Mi++){for(let co=Lr;co<_a;co++){const Pc=f.textAnchorOffsets.get(co);if(Fn&&Pc.textAnchor!==Fn)continue;const Mo=this.attemptAnchorPlacement(Pc,On,Ud,$d,Pm,ge,Ee,M,b,J,uo,Ge,f,$l,Mc,rt);if(Mo&&(lo=Mo.placedGlyphBoxes,lo&&lo.box&&lo.box.length))return Vt=!0,Rn=Mo.shift,lo}Fn?Fn=null:uo=K}return lo};yr(()=>rr(Jo,gt.iconBox,u.ai.horizontal),()=>{const On=gt.verticalTextBox;return f.allowVerticalPlacement&&!(pn&&pn.box&&pn.box.length)&&Ge.numVerticalGlyphVertices>0&&On?rr(On,gt.verticalIconBox,u.ai.vertical):{box:null,offscreen:null}}),pn&&(Vt=pn.box,$t=pn.offscreen);const Hr=Tr(pn&&pn.box);if(!Vt&&this.prevPlacement){const On=this.prevPlacement.variableOffsets[Ge.crossTileID];On&&(this.variableOffsets[Ge.crossTileID]=On,this.markUsedJustification(f,On.anchor,Ge,Hr))}}}if(nr=pn,Vt=nr&&nr.box&&nr.box.length>0,$t=nr&&nr.offscreen,Ge.useRuntimeCollisionCircles){const Tr=f.text.placedSymbolArray.get(Ge.centerJustifiedTextSymbolIndex),yr=u.aj(f.textSizeData,N,Tr),Lr=_.get("text-padding");Nn=this.collisionIndex.placeCollisionCircles(K,Tr,f.lineVertexArray,f.glyphOffsetArray,yr,b,S,E,d,Ee,J.predicate,Ge.collisionCircleDiameter,Lr,rt),Nn.circles.length&&Nn.collisionDetected&&!d&&u.w("Collisions detected, but collision boxes are not shown"),Vt=me||Nn.circles.length>0&&!Nn.collisionDetected,$t=$t&&Nn.offscreen}if(gt.iconFeatureIndex&&(so=gt.iconFeatureIndex),gt.iconBox){const Tr=yr=>{const Lr=Ie&&Rn?Ye(yr,Rn.x,Rn.y,ge,Ee,this.transform.angle):yr;return this.collisionIndex.placeCollisionBox(Lr,Se,M,b,J.predicate,rt)};gr&&gr.box&&gr.box.length&&gt.verticalIconBox?(hi=Tr(gt.verticalIconBox),At=hi.box.length>0):(hi=Tr(gt.iconBox),At=hi.box.length>0),$t=$t&&hi.offscreen}const ya=Y||Ge.numHorizontalGlyphVertices===0&&Ge.numVerticalGlyphVertices===0,Ya=te||Ge.numIconVertices===0;if(ya||Ya?Ya?ya||(At=At&&Vt):Vt=At&&Vt:At=Vt=At&&Vt,Vt&&nr&&nr.box&&this.collisionIndex.insertCollisionBox(nr.box,K,_.get("text-ignore-placement"),f.bucketInstanceId,gr&&gr.box&&ao?ao:_n,J.ID),At&&hi&&this.collisionIndex.insertCollisionBox(hi.box,Se,_.get("icon-ignore-placement"),f.bucketInstanceId,so,J.ID),Nn&&(Vt&&this.collisionIndex.insertCollisionCircles(Nn.circles,K,_.get("text-ignore-placement"),f.bucketInstanceId,_n,J.ID),d)){const Tr=f.bucketInstanceId;let yr=this.collisionCircleArrays[Tr];yr===void 0&&(yr=this.collisionCircleArrays[Tr]=new ke);for(let Lr=0;Lr<Nn.circles.length;Lr+=4)yr.circles.push(Nn.circles[Lr+0]),yr.circles.push(Nn.circles[Lr+1]),yr.circles.push(Nn.circles[Lr+2]),yr.circles.push(Nn.collisionDetected?1:0)}if(Ge.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(f.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[Ge.crossTileID]=new we(Vt||Re,At||Le,$t||f.justReloaded),s[Ge.crossTileID]=!0};if(ze){if(r.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const Ge=f.getSortedSymbolIndexes(this.transform.angle);for(let gt=Ge.length-1;gt>=0;--gt){const ot=Ge[gt];Ut(f.symbolInstances.get(ot),f.collisionArrays[ot])}}else for(let Ge=r.symbolInstanceStart;Ge<r.symbolInstanceEnd;Ge++)Ut(f.symbolInstances.get(Ge),f.collisionArrays[Ge]);if(d&&f.bucketInstanceId in this.collisionCircleArrays){const Ge=this.collisionCircleArrays[f.bucketInstanceId];u.as(Ge.invProjMatrix,b),Ge.viewportMatrix=this.collisionIndex.getViewportMatrix()}f.justReloaded=!1}markUsedJustification(r,s,d,f){let _;_=f===u.ai.vertical?d.verticalPlacedTextSymbolIndex:{left:d.leftJustifiedTextSymbolIndex,center:d.centerJustifiedTextSymbolIndex,right:d.rightJustifiedTextSymbolIndex}[u.at(s)];const b=[d.leftJustifiedTextSymbolIndex,d.centerJustifiedTextSymbolIndex,d.rightJustifiedTextSymbolIndex,d.verticalPlacedTextSymbolIndex];for(const S of b)S>=0&&(r.text.placedSymbolArray.get(S).crossTileID=_>=0&&S!==_?0:d.crossTileID)}markUsedOrientation(r,s,d){const f=s===u.ai.horizontal||s===u.ai.horizontalOnly?s:0,_=s===u.ai.vertical?s:0,b=[d.leftJustifiedTextSymbolIndex,d.centerJustifiedTextSymbolIndex,d.rightJustifiedTextSymbolIndex];for(const S of b)r.text.placedSymbolArray.get(S).placedOrientation=f;d.verticalPlacedTextSymbolIndex&&(r.text.placedSymbolArray.get(d.verticalPlacedTextSymbolIndex).placedOrientation=_)}commit(r){this.commitTime=r,this.zoomAtLastRecencyCheck=this.transform.zoom;const s=this.prevPlacement;let d=!1;this.prevZoomAdjustment=s?s.zoomAdjustment(this.transform.zoom):0;const f=s?s.symbolFadeChange(r):1,_=s?s.opacities:{},b=s?s.variableOffsets:{},S=s?s.placedOrientations:{};for(const E in this.placements){const M=this.placements[E],z=_[E];z?(this.opacities[E]=new fe(z,f,M.text,M.icon),d=d||M.text!==z.text.placed||M.icon!==z.icon.placed):(this.opacities[E]=new fe(null,f,M.text,M.icon,M.skipFade),d=d||M.text||M.icon)}for(const E in _){const M=_[E];if(!this.opacities[E]){const z=new fe(M,f,!1,!1);z.isHidden()||(this.opacities[E]=z,d=d||M.text.placed||M.icon.placed)}}for(const E in b)this.variableOffsets[E]||!this.opacities[E]||this.opacities[E].isHidden()||(this.variableOffsets[E]=b[E]);for(const E in S)this.placedOrientations[E]||!this.opacities[E]||this.opacities[E].isHidden()||(this.placedOrientations[E]=S[E]);if(s&&s.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");d?this.lastPlacementChangeTime=r:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=s?s.lastPlacementChangeTime:r)}updateLayerOpacities(r,s){const d={};for(const f of s){const _=f.getBucket(r);_&&f.latestFeatureIndex&&r.id===_.layerIds[0]&&this.updateBucketOpacities(_,d,f.collisionBoxArray)}}updateBucketOpacities(r,s,d){r.hasTextData()&&(r.text.opacityVertexArray.clear(),r.text.hasVisibleVertices=!1),r.hasIconData()&&(r.icon.opacityVertexArray.clear(),r.icon.hasVisibleVertices=!1),r.hasIconCollisionBoxData()&&r.iconCollisionBox.collisionVertexArray.clear(),r.hasTextCollisionBoxData()&&r.textCollisionBox.collisionVertexArray.clear();const f=r.layers[0],_=f.layout,b=new fe(null,0,!1,!1,!0),S=_.get("text-allow-overlap"),E=_.get("icon-allow-overlap"),M=f._unevaluatedLayout.hasValue("text-variable-anchor")||f._unevaluatedLayout.hasValue("text-variable-anchor-offset"),z=_.get("text-rotation-alignment")==="map",L=_.get("text-pitch-alignment")==="map",N=_.get("icon-text-fit")!=="none",J=new fe(null,0,S&&(E||!r.hasIconData()||_.get("icon-optional")),E&&(S||!r.hasTextData()||_.get("text-optional")),!0);!r.collisionArrays&&d&&(r.hasIconCollisionBoxData()||r.hasTextCollisionBoxData())&&r.deserializeCollisionBoxes(d);const Y=(te,K,me)=>{for(let Se=0;Se<K/4;Se++)te.opacityVertexArray.emplaceBack(me);te.hasVisibleVertices=te.hasVisibleVertices||me!==Wt};for(let te=0;te<r.symbolInstances.length;te++){const K=r.symbolInstances.get(te),{numHorizontalGlyphVertices:me,numVerticalGlyphVertices:Se,crossTileID:ie}=K;let ge=this.opacities[ie];s[ie]?ge=b:ge||(ge=J,this.opacities[ie]=ge),s[ie]=!0;const Ee=K.numIconVertices>0,Ie=this.placedOrientations[K.crossTileID],ze=Ie===u.ai.vertical,Re=Ie===u.ai.horizontal||Ie===u.ai.horizontalOnly;if(me>0||Se>0){const Le=Pt(ge.text);Y(r.text,me,ze?Wt:Le),Y(r.text,Se,Re?Wt:Le);const Ve=ge.text.isHidden();[K.rightJustifiedTextSymbolIndex,K.centerJustifiedTextSymbolIndex,K.leftJustifiedTextSymbolIndex].forEach(Ge=>{Ge>=0&&(r.text.placedSymbolArray.get(Ge).hidden=Ve||ze?1:0)}),K.verticalPlacedTextSymbolIndex>=0&&(r.text.placedSymbolArray.get(K.verticalPlacedTextSymbolIndex).hidden=Ve||Re?1:0);const rt=this.variableOffsets[K.crossTileID];rt&&this.markUsedJustification(r,rt.anchor,K,Ie);const Ut=this.placedOrientations[K.crossTileID];Ut&&(this.markUsedJustification(r,"left",K,Ut),this.markUsedOrientation(r,Ut,K))}if(Ee){const Le=Pt(ge.icon),Ve=!(N&&K.verticalPlacedIconSymbolIndex&&ze);K.placedIconSymbolIndex>=0&&(Y(r.icon,K.numIconVertices,Ve?Le:Wt),r.icon.placedSymbolArray.get(K.placedIconSymbolIndex).hidden=ge.icon.isHidden()),K.verticalPlacedIconSymbolIndex>=0&&(Y(r.icon,K.numVerticalIconVertices,Ve?Wt:Le),r.icon.placedSymbolArray.get(K.verticalPlacedIconSymbolIndex).hidden=ge.icon.isHidden())}if(r.hasIconCollisionBoxData()||r.hasTextCollisionBoxData()){const Le=r.collisionArrays[te];if(Le){let Ve=new u.P(0,0);if(Le.textBox||Le.verticalTextBox){let Ut=!0;if(M){const Ge=this.variableOffsets[ie];Ge?(Ve=nt(Ge.anchor,Ge.width,Ge.height,Ge.textOffset,Ge.textBoxScale),z&&Ve._rotate(L?this.transform.angle:-this.transform.angle)):Ut=!1}Le.textBox&&yt(r.textCollisionBox.collisionVertexArray,ge.text.placed,!Ut||ze,Ve.x,Ve.y),Le.verticalTextBox&&yt(r.textCollisionBox.collisionVertexArray,ge.text.placed,!Ut||Re,Ve.x,Ve.y)}const rt=!!(!Re&&Le.verticalIconBox);Le.iconBox&&yt(r.iconCollisionBox.collisionVertexArray,ge.icon.placed,rt,N?Ve.x:0,N?Ve.y:0),Le.verticalIconBox&&yt(r.iconCollisionBox.collisionVertexArray,ge.icon.placed,!rt,N?Ve.x:0,N?Ve.y:0)}}}if(r.sortFeatures(this.transform.angle),this.retainedQueryData[r.bucketInstanceId]&&(this.retainedQueryData[r.bucketInstanceId].featureSortOrder=r.featureSortOrder),r.hasTextData()&&r.text.opacityVertexBuffer&&r.text.opacityVertexBuffer.updateData(r.text.opacityVertexArray),r.hasIconData()&&r.icon.opacityVertexBuffer&&r.icon.opacityVertexBuffer.updateData(r.icon.opacityVertexArray),r.hasIconCollisionBoxData()&&r.iconCollisionBox.collisionVertexBuffer&&r.iconCollisionBox.collisionVertexBuffer.updateData(r.iconCollisionBox.collisionVertexArray),r.hasTextCollisionBoxData()&&r.textCollisionBox.collisionVertexBuffer&&r.textCollisionBox.collisionVertexBuffer.updateData(r.textCollisionBox.collisionVertexArray),r.text.opacityVertexArray.length!==r.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${r.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${r.text.layoutVertexArray.length}) / 4`);if(r.icon.opacityVertexArray.length!==r.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${r.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${r.icon.layoutVertexArray.length}) / 4`);if(r.bucketInstanceId in this.collisionCircleArrays){const te=this.collisionCircleArrays[r.bucketInstanceId];r.placementInvProjMatrix=te.invProjMatrix,r.placementViewportMatrix=te.viewportMatrix,r.collisionCircleArray=te.circles,delete this.collisionCircleArrays[r.bucketInstanceId]}}symbolFadeChange(r){return this.fadeDuration===0?1:(r-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(r){return Math.max(0,(this.transform.zoom-r)/1.5)}hasTransitions(r){return this.stale||r-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(r,s){const d=this.zoomAtLastRecencyCheck===s?1-this.zoomAdjustment(s):1;return this.zoomAtLastRecencyCheck=s,this.commitTime+this.fadeDuration*d>r}setStale(){this.stale=!0}}function yt(g,r,s,d,f){g.emplaceBack(r?1:0,s?1:0,d||0,f||0),g.emplaceBack(r?1:0,s?1:0,d||0,f||0),g.emplaceBack(r?1:0,s?1:0,d||0,f||0),g.emplaceBack(r?1:0,s?1:0,d||0,f||0)}const Ot=Math.pow(2,25),Ht=Math.pow(2,24),Nt=Math.pow(2,17),Bt=Math.pow(2,16),Wn=Math.pow(2,9),Xt=Math.pow(2,8),wn=Math.pow(2,1);function Pt(g){if(g.opacity===0&&!g.placed)return 0;if(g.opacity===1&&g.placed)return 4294967295;const r=g.placed?1:0,s=Math.floor(127*g.opacity);return s*Ot+r*Ht+s*Nt+r*Bt+s*Wn+r*Xt+s*wn+r}const Wt=0;class oi{constructor(r){this._sortAcrossTiles=r.layout.get("symbol-z-order")!=="viewport-y"&&!r.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(r,s,d,f,_){const b=this._bucketParts;for(;this._currentTileIndex<r.length;)if(s.getBucketParts(b,f,r[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,_())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,b.sort((S,E)=>S.sortKey-E.sortKey));this._currentPartIndex<b.length;)if(s.placeLayerBucketPart(b[this._currentPartIndex],this._seenCrossTileIDs,d),this._currentPartIndex++,_())return!0;return!1}}class Vi{constructor(r,s,d,f,_,b,S,E){this.placement=new ut(r,s,b,S,E),this._currentPlacementIndex=d.length-1,this._forceFullPlacement=f,this._showCollisionBoxes=_,this._done=!1}isDone(){return this._done}continuePlacement(r,s,d){const f=u.h.now(),_=()=>!this._forceFullPlacement&&u.h.now()-f>2;for(;this._currentPlacementIndex>=0;){const b=s[r[this._currentPlacementIndex]],S=this.placement.collisionIndex.transform.zoom;if(b.type==="symbol"&&(!b.minzoom||b.minzoom<=S)&&(!b.maxzoom||b.maxzoom>S)){if(this._inProgressLayer||(this._inProgressLayer=new oi(b)),this._inProgressLayer.continuePlacement(d[b.source],this.placement,this._showCollisionBoxes,b,_))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(r){return this.placement.commit(r),this.placement}}const qo=512/u.N/2;class pm{constructor(r,s,d){this.tileID=r,this.bucketInstanceId=d,this._symbolsByKey={};const f=new Map;for(let _=0;_<s.length;_++){const b=s.get(_),S=b.key,E=f.get(S);E?E.push(b):f.set(S,[b])}for(const[_,b]of f){const S={positions:b.map(E=>({x:Math.floor(E.anchorX*qo),y:Math.floor(E.anchorY*qo)})),crossTileIDs:b.map(E=>E.crossTileID)};if(S.positions.length>128){const E=new u.av(S.positions.length,16,Uint16Array);for(const{x:M,y:z}of S.positions)E.add(M,z);E.finish(),delete S.positions,S.index=E}this._symbolsByKey[_]=S}}getScaledCoordinates(r,s){const{x:d,y:f,z:_}=this.tileID.canonical,{x:b,y:S,z:E}=s.canonical,M=qo/Math.pow(2,E-_),z=(S*u.N+r.anchorY)*M,L=f*u.N*qo;return{x:Math.floor((b*u.N+r.anchorX)*M-d*u.N*qo),y:Math.floor(z-L)}}findMatches(r,s,d){const f=this.tileID.canonical.z<s.canonical.z?1:Math.pow(2,this.tileID.canonical.z-s.canonical.z);for(let _=0;_<r.length;_++){const b=r.get(_);if(b.crossTileID)continue;const S=this._symbolsByKey[b.key];if(!S)continue;const E=this.getScaledCoordinates(b,s);if(S.index){const M=S.index.range(E.x-f,E.y-f,E.x+f,E.y+f).sort();for(const z of M){const L=S.crossTileIDs[z];if(!d[L]){d[L]=!0,b.crossTileID=L;break}}}else if(S.positions)for(let M=0;M<S.positions.length;M++){const z=S.positions[M],L=S.crossTileIDs[M];if(Math.abs(z.x-E.x)<=f&&Math.abs(z.y-E.y)<=f&&!d[L]){d[L]=!0,b.crossTileID=L;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:r})=>r)}}class on{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class $u{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(r){const s=Math.round((r-this.lng)/360);if(s!==0)for(const d in this.indexes){const f=this.indexes[d],_={};for(const b in f){const S=f[b];S.tileID=S.tileID.unwrapTo(S.tileID.wrap+s),_[S.tileID.key]=S}this.indexes[d]=_}this.lng=r}addBucket(r,s,d){if(this.indexes[r.overscaledZ]&&this.indexes[r.overscaledZ][r.key]){if(this.indexes[r.overscaledZ][r.key].bucketInstanceId===s.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(r.overscaledZ,this.indexes[r.overscaledZ][r.key])}for(let _=0;_<s.symbolInstances.length;_++)s.symbolInstances.get(_).crossTileID=0;this.usedCrossTileIDs[r.overscaledZ]||(this.usedCrossTileIDs[r.overscaledZ]={});const f=this.usedCrossTileIDs[r.overscaledZ];for(const _ in this.indexes){const b=this.indexes[_];if(Number(_)>r.overscaledZ)for(const S in b){const E=b[S];E.tileID.isChildOf(r)&&E.findMatches(s.symbolInstances,r,f)}else{const S=b[r.scaledTo(Number(_)).key];S&&S.findMatches(s.symbolInstances,r,f)}}for(let _=0;_<s.symbolInstances.length;_++){const b=s.symbolInstances.get(_);b.crossTileID||(b.crossTileID=d.generate(),f[b.crossTileID]=!0)}return this.indexes[r.overscaledZ]===void 0&&(this.indexes[r.overscaledZ]={}),this.indexes[r.overscaledZ][r.key]=new pm(r,s.symbolInstances,s.bucketInstanceId),!0}removeBucketCrossTileIDs(r,s){for(const d of s.getCrossTileIDsLists())for(const f of d)delete this.usedCrossTileIDs[r][f]}removeStaleBuckets(r){let s=!1;for(const d in this.indexes){const f=this.indexes[d];for(const _ in f)r[f[_].bucketInstanceId]||(this.removeBucketCrossTileIDs(d,f[_]),delete f[_],s=!0)}return s}}class fl{constructor(){this.layerIndexes={},this.crossTileIDs=new on,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(r,s,d){let f=this.layerIndexes[r.id];f===void 0&&(f=this.layerIndexes[r.id]=new $u);let _=!1;const b={};f.handleWrapJump(d);for(const S of s){const E=S.getBucket(r);E&&r.id===E.layerIds[0]&&(E.bucketInstanceId||(E.bucketInstanceId=++this.maxBucketInstanceId),f.addBucket(S.tileID,E,this.crossTileIDs)&&(_=!0),b[E.bucketInstanceId]=!0)}return f.removeStaleBuckets(b)&&(_=!0),_}pruneUnusedLayers(r){const s={};r.forEach(d=>{s[d]=!0});for(const d in this.layerIndexes)s[d]||delete this.layerIndexes[d]}}const Sr=(g,r)=>u.x(g,r&&r.filter(s=>s.identifier!=="source.canvas")),ai=u.F(u.ax,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setGlyphs","setSprite"]),fm=u.F(u.ax,["setCenter","setZoom","setBearing","setPitch"]),Ti=u.aw();class mr extends u.E{constructor(r,s={}){super(),this.map=r,this.dispatcher=new kt(Va(),this,r._getMapId()),this.imageManager=new bt,this.imageManager.setEventedParent(this),this.glyphManager=new zt(r._requestManager,s.localIdeographFontFamily),this.lineAtlas=new dt(256,512),this.crossTileSymbolIndex=new fl,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new u.ay,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",u.az());const d=this;this._rtlTextPluginCallback=mr.registerForPluginStateChange(f=>{d.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:f.pluginStatus,pluginURL:f.pluginURL},(_,b)=>{if(u.aA(_),b&&b.every(S=>S))for(const S in d.sourceCaches){const E=d.sourceCaches[S].getSource().type;E!=="vector"&&E!=="geojson"||d.sourceCaches[S].reload()}})}),this.on("data",f=>{if(f.dataType!=="source"||f.sourceDataType!=="metadata")return;const _=this.sourceCaches[f.sourceId];if(!_)return;const b=_.getSource();if(b&&b.vectorLayerIds)for(const S in this._layers){const E=this._layers[S];E.source===b.id&&this._validateLayer(E)}})}loadURL(r,s={},d){this.fire(new u.k("dataloading",{dataType:"style"})),s.validate=typeof s.validate!="boolean"||s.validate;const f=this.map._requestManager.transformRequest(r,$.Style);this._request=u.f(f,(_,b)=>{this._request=null,_?this.fire(new u.j(_)):b&&this._load(b,s,d)})}loadJSON(r,s={},d){this.fire(new u.k("dataloading",{dataType:"style"})),this._request=u.h.frame(()=>{this._request=null,s.validate=s.validate!==!1,this._load(r,s,d)})}loadEmpty(){this.fire(new u.k("dataloading",{dataType:"style"})),this._load(Ti,{validate:!1})}_load(r,s,d){var f;const _=s.transformStyle?s.transformStyle(d,r):r;if(!s.validate||!Sr(this,u.y(_))){this._loaded=!0,this.stylesheet=_;for(const b in _.sources)this.addSource(b,_.sources[b],{validate:!1});_.sprite?this._loadSprite(_.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(_.glyphs),this._createLayers(),this.light=new lt(this.stylesheet.light),this.map.setTerrain((f=this.stylesheet.terrain)!==null&&f!==void 0?f:null),this.fire(new u.k("data",{dataType:"style"})),this.fire(new u.k("style.load"))}}_createLayers(){const r=u.aB(this.stylesheet.layers);this.dispatcher.broadcast("setLayers",r),this._order=r.map(s=>s.id),this._layers={},this._serializedLayers=null;for(const s of r){const d=u.aC(s);d.setEventedParent(this,{layer:{id:s.id}}),this._layers[s.id]=d}}_loadSprite(r,s=!1,d=void 0){this.imageManager.setLoaded(!1),this._spriteRequest=function(f,_,b,S){const E=Me(f),M=E.length,z=b>1?"@2x":"",L={},N={},J={};for(const{id:Y,url:te}of E){const K=_.transformRequest(_.normalizeSpriteURL(te,z,".json"),$.SpriteJSON),me=`${Y}_${K.url}`;L[me]=u.f(K,(ge,Ee)=>{delete L[me],N[Y]=Ee,Ze(S,N,J,ge,M)});const Se=_.transformRequest(_.normalizeSpriteURL(te,z,".png"),$.SpriteImage),ie=`${Y}_${Se.url}`;L[ie]=oe.getImage(Se,(ge,Ee)=>{delete L[ie],J[Y]=Ee,Ze(S,N,J,ge,M)})}return{cancel(){for(const Y of Object.values(L))Y.cancel()}}}(r,this.map._requestManager,this.map.getPixelRatio(),(f,_)=>{if(this._spriteRequest=null,f)this.fire(new u.j(f));else if(_)for(const b in _){this._spritesImagesIds[b]=[];const S=this._spritesImagesIds[b]?this._spritesImagesIds[b].filter(E=>!(E in _)):[];for(const E of S)this.imageManager.removeImage(E),this._changedImages[E]=!0;for(const E in _[b]){const M=b==="default"?E:`${b}:${E}`;this._spritesImagesIds[b].push(M),M in this.imageManager.images?this.imageManager.updateImage(M,_[b][E],!1):this.imageManager.addImage(M,_[b][E]),s&&(this._changedImages[M]=!0)}}this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),s&&(this._changed=!0),this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new u.k("data",{dataType:"style"})),d&&d(f)})}_unloadSprite(){for(const r of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(r),this._changedImages[r]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new u.k("data",{dataType:"style"}))}_validateLayer(r){const s=this.sourceCaches[r.source];if(!s)return;const d=r.sourceLayer;if(!d)return;const f=s.getSource();(f.type==="geojson"||f.vectorLayerIds&&f.vectorLayerIds.indexOf(d)===-1)&&this.fire(new u.j(new Error(`Source layer "${d}" does not exist on source "${f.id}" as specified by style layer "${r.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const r in this.sourceCaches)if(!this.sourceCaches[r].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(r){const s=this._serializedAllLayers();if(!r||r.length===0)return Object.values(s);const d=[];for(const f of r)s[f]&&d.push(s[f]);return d}_serializedAllLayers(){let r=this._serializedLayers;if(r)return r;r=this._serializedLayers={};const s=Object.keys(this._layers);for(const d of s){const f=this._layers[d];f.type!=="custom"&&(r[d]=f.serialize())}return r}hasTransitions(){if(this.light&&this.light.hasTransition())return!0;for(const r in this.sourceCaches)if(this.sourceCaches[r].hasTransition())return!0;for(const r in this._layers)if(this._layers[r].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(r){if(!this._loaded)return;const s=this._changed;if(this._changed){const f=Object.keys(this._updatedLayers),_=Object.keys(this._removedLayers);(f.length||_.length)&&this._updateWorkerLayers(f,_);for(const b in this._updatedSources){const S=this._updatedSources[b];if(S==="reload")this._reloadSource(b);else{if(S!=="clear")throw new Error(`Invalid action ${S}`);this._clearSource(b)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const b in this._updatedPaintProps)this._layers[b].updateTransitions(r);this.light.updateTransitions(r),this._resetUpdates()}const d={};for(const f in this.sourceCaches){const _=this.sourceCaches[f];d[f]=_.used,_.used=!1}for(const f of this._order){const _=this._layers[f];_.recalculate(r,this._availableImages),!_.isHidden(r.zoom)&&_.source&&(this.sourceCaches[_.source].used=!0)}for(const f in d){const _=this.sourceCaches[f];d[f]!==_.used&&_.fire(new u.k("data",{sourceDataType:"visibility",dataType:"source",sourceId:f}))}this.light.recalculate(r),this.z=r.zoom,s&&this.fire(new u.k("data",{dataType:"style"}))}_updateTilesForChangedImages(){const r=Object.keys(this._changedImages);if(r.length){for(const s in this.sourceCaches)this.sourceCaches[s].reloadTilesForDependencies(["icons","patterns"],r);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const r in this.sourceCaches)this.sourceCaches[r].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(r,s){this.dispatcher.broadcast("updateLayers",{layers:this._serializeByIds(r),removedIds:s})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(r,s={}){this._checkLoaded();const d=this.serialize();if(r=s.transformStyle?s.transformStyle(d,r):r,Sr(this,u.y(r)))return!1;(r=u.aD(r)).layers=u.aB(r.layers);const f=u.aE(d,r).filter(b=>!(b.command in fm));if(f.length===0)return!1;const _=f.filter(b=>!(b.command in ai));if(_.length>0)throw new Error(`Unimplemented: ${_.map(b=>b.command).join(", ")}.`);for(const b of f)b.command!=="setTransition"&&this[b.command].apply(this,b.args);return this.stylesheet=r,this._serializedLayers=null,!0}addImage(r,s){if(this.getImage(r))return this.fire(new u.j(new Error(`An image named "${r}" already exists.`)));this.imageManager.addImage(r,s),this._afterImageUpdated(r)}updateImage(r,s){this.imageManager.updateImage(r,s)}getImage(r){return this.imageManager.getImage(r)}removeImage(r){if(!this.getImage(r))return this.fire(new u.j(new Error(`An image named "${r}" does not exist.`)));this.imageManager.removeImage(r),this._afterImageUpdated(r)}_afterImageUpdated(r){this._availableImages=this.imageManager.listImages(),this._changedImages[r]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new u.k("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(r,s,d={}){if(this._checkLoaded(),this.sourceCaches[r]!==void 0)throw new Error(`Source "${r}" already exists.`);if(!s.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(s).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(s.type)>=0&&this._validate(u.y.source,`sources.${r}`,s,null,d))return;this.map&&this.map._collectResourceTiming&&(s.collectResourceTiming=!0);const f=this.sourceCaches[r]=new Hn(r,s,this.dispatcher);f.style=this,f.setEventedParent(this,()=>({isSourceLoaded:f.loaded(),source:f.serialize(),sourceId:r})),f.onAdd(this.map),this._changed=!0}removeSource(r){if(this._checkLoaded(),this.sourceCaches[r]===void 0)throw new Error("There is no source with this ID");for(const d in this._layers)if(this._layers[d].source===r)return this.fire(new u.j(new Error(`Source "${r}" cannot be removed while layer "${d}" is using it.`)));const s=this.sourceCaches[r];delete this.sourceCaches[r],delete this._updatedSources[r],s.fire(new u.k("data",{sourceDataType:"metadata",dataType:"source",sourceId:r})),s.setEventedParent(null),s.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(r,s){if(this._checkLoaded(),this.sourceCaches[r]===void 0)throw new Error(`There is no source with this ID=${r}`);const d=this.sourceCaches[r].getSource();if(d.type!=="geojson")throw new Error(`geojsonSource.type is ${d.type}, which is !== 'geojson`);d.setData(s),this._changed=!0}getSource(r){return this.sourceCaches[r]&&this.sourceCaches[r].getSource()}addLayer(r,s,d={}){this._checkLoaded();const f=r.id;if(this.getLayer(f))return void this.fire(new u.j(new Error(`Layer "${f}" already exists on this map.`)));let _;if(r.type==="custom"){if(Sr(this,u.aF(r)))return;_=u.aC(r)}else{if("source"in r&&typeof r.source=="object"&&(this.addSource(f,r.source),r=u.aD(r),r=u.e(r,{source:f})),this._validate(u.y.layer,`layers.${f}`,r,{arrayIndex:-1},d))return;_=u.aC(r),this._validateLayer(_),_.setEventedParent(this,{layer:{id:f}})}const b=s?this._order.indexOf(s):this._order.length;if(s&&b===-1)this.fire(new u.j(new Error(`Cannot add layer "${f}" before non-existing layer "${s}".`)));else{if(this._order.splice(b,0,f),this._layerOrderChanged=!0,this._layers[f]=_,this._removedLayers[f]&&_.source&&_.type!=="custom"){const S=this._removedLayers[f];delete this._removedLayers[f],S.type!==_.type?this._updatedSources[_.source]="clear":(this._updatedSources[_.source]="reload",this.sourceCaches[_.source].pause())}this._updateLayer(_),_.onAdd&&_.onAdd(this.map)}}moveLayer(r,s){if(this._checkLoaded(),this._changed=!0,!this._layers[r])return void this.fire(new u.j(new Error(`The layer '${r}' does not exist in the map's style and cannot be moved.`)));if(r===s)return;const d=this._order.indexOf(r);this._order.splice(d,1);const f=s?this._order.indexOf(s):this._order.length;s&&f===-1?this.fire(new u.j(new Error(`Cannot move layer "${r}" before non-existing layer "${s}".`))):(this._order.splice(f,0,r),this._layerOrderChanged=!0)}removeLayer(r){this._checkLoaded();const s=this._layers[r];if(!s)return void this.fire(new u.j(new Error(`Cannot remove non-existing layer "${r}".`)));s.setEventedParent(null);const d=this._order.indexOf(r);this._order.splice(d,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[r]=s,delete this._layers[r],this._serializedLayers&&delete this._serializedLayers[r],delete this._updatedLayers[r],delete this._updatedPaintProps[r],s.onRemove&&s.onRemove(this.map)}getLayer(r){return this._layers[r]}getLayersOrder(){return[...this._order]}hasLayer(r){return r in this._layers}setLayerZoomRange(r,s,d){this._checkLoaded();const f=this.getLayer(r);f?f.minzoom===s&&f.maxzoom===d||(s!=null&&(f.minzoom=s),d!=null&&(f.maxzoom=d),this._updateLayer(f)):this.fire(new u.j(new Error(`Cannot set the zoom range of non-existing layer "${r}".`)))}setFilter(r,s,d={}){this._checkLoaded();const f=this.getLayer(r);if(f){if(!u.aG(f.filter,s))return s==null?(f.filter=void 0,void this._updateLayer(f)):void(this._validate(u.y.filter,`layers.${f.id}.filter`,s,null,d)||(f.filter=u.aD(s),this._updateLayer(f)))}else this.fire(new u.j(new Error(`Cannot filter non-existing layer "${r}".`)))}getFilter(r){return u.aD(this.getLayer(r).filter)}setLayoutProperty(r,s,d,f={}){this._checkLoaded();const _=this.getLayer(r);_?u.aG(_.getLayoutProperty(s),d)||(_.setLayoutProperty(s,d,f),this._updateLayer(_)):this.fire(new u.j(new Error(`Cannot style non-existing layer "${r}".`)))}getLayoutProperty(r,s){const d=this.getLayer(r);if(d)return d.getLayoutProperty(s);this.fire(new u.j(new Error(`Cannot get style of non-existing layer "${r}".`)))}setPaintProperty(r,s,d,f={}){this._checkLoaded();const _=this.getLayer(r);_?u.aG(_.getPaintProperty(s),d)||(_.setPaintProperty(s,d,f)&&this._updateLayer(_),this._changed=!0,this._updatedPaintProps[r]=!0):this.fire(new u.j(new Error(`Cannot style non-existing layer "${r}".`)))}getPaintProperty(r,s){return this.getLayer(r).getPaintProperty(s)}setFeatureState(r,s){this._checkLoaded();const d=r.source,f=r.sourceLayer,_=this.sourceCaches[d];if(_===void 0)return void this.fire(new u.j(new Error(`The source '${d}' does not exist in the map's style.`)));const b=_.getSource().type;b==="geojson"&&f?this.fire(new u.j(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):b!=="vector"||f?(r.id===void 0&&this.fire(new u.j(new Error("The feature id parameter must be provided."))),_.setFeatureState(f,r.id,s)):this.fire(new u.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(r,s){this._checkLoaded();const d=r.source,f=this.sourceCaches[d];if(f===void 0)return void this.fire(new u.j(new Error(`The source '${d}' does not exist in the map's style.`)));const _=f.getSource().type,b=_==="vector"?r.sourceLayer:void 0;_!=="vector"||b?s&&typeof r.id!="string"&&typeof r.id!="number"?this.fire(new u.j(new Error("A feature id is required to remove its specific state property."))):f.removeFeatureState(b,r.id,s):this.fire(new u.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(r){this._checkLoaded();const s=r.source,d=r.sourceLayer,f=this.sourceCaches[s];if(f!==void 0)return f.getSource().type!=="vector"||d?(r.id===void 0&&this.fire(new u.j(new Error("The feature id parameter must be provided."))),f.getFeatureState(d,r.id)):void this.fire(new u.j(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new u.j(new Error(`The source '${s}' does not exist in the map's style.`)))}getTransition(){return u.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const r=u.aH(this.sourceCaches,_=>_.serialize()),s=this._serializeByIds(this._order),d=this.map.getTerrain()||void 0,f=this.stylesheet;return u.aI({version:f.version,name:f.name,metadata:f.metadata,light:f.light,center:f.center,zoom:f.zoom,bearing:f.bearing,pitch:f.pitch,sprite:f.sprite,glyphs:f.glyphs,transition:f.transition,sources:r,layers:s,terrain:d},_=>_!==void 0)}_updateLayer(r){this._updatedLayers[r.id]=!0,r.source&&!this._updatedSources[r.source]&&this.sourceCaches[r.source].getSource().type!=="raster"&&(this._updatedSources[r.source]="reload",this.sourceCaches[r.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(r){const s=b=>this._layers[b].type==="fill-extrusion",d={},f=[];for(let b=this._order.length-1;b>=0;b--){const S=this._order[b];if(s(S)){d[S]=b;for(const E of r){const M=E[S];if(M)for(const z of M)f.push(z)}}}f.sort((b,S)=>S.intersectionZ-b.intersectionZ);const _=[];for(let b=this._order.length-1;b>=0;b--){const S=this._order[b];if(s(S))for(let E=f.length-1;E>=0;E--){const M=f[E].feature;if(d[M.layer.id]<b)break;_.push(M),f.pop()}else for(const E of r){const M=E[S];if(M)for(const z of M)_.push(z.feature)}}return _}queryRenderedFeatures(r,s,d){s&&s.filter&&this._validate(u.y.filter,"queryRenderedFeatures.filter",s.filter,null,s);const f={};if(s&&s.layers){if(!Array.isArray(s.layers))return this.fire(new u.j(new Error("parameters.layers must be an Array."))),[];for(const S of s.layers){const E=this._layers[S];if(!E)return this.fire(new u.j(new Error(`The layer '${S}' does not exist in the map's style and cannot be queried for features.`))),[];f[E.source]=!0}}const _=[];s.availableImages=this._availableImages;const b=this._serializedAllLayers();for(const S in this.sourceCaches)s.layers&&!f[S]||_.push(wo(this.sourceCaches[S],this._layers,b,r,s,d));return this.placement&&_.push(function(S,E,M,z,L,N,J){const Y={},te=N.queryRenderedSymbols(z),K=[];for(const me of Object.keys(te).map(Number))K.push(J[me]);K.sort(no);for(const me of K){const Se=me.featureIndex.lookupSymbolFeatures(te[me.bucketInstanceId],E,me.bucketIndex,me.sourceLayerIndex,L.filter,L.layers,L.availableImages,S);for(const ie in Se){const ge=Y[ie]=Y[ie]||[],Ee=Se[ie];Ee.sort((Ie,ze)=>{const Re=me.featureSortOrder;if(Re){const Le=Re.indexOf(Ie.featureIndex);return Re.indexOf(ze.featureIndex)-Le}return ze.featureIndex-Ie.featureIndex});for(const Ie of Ee)ge.push(Ie)}}for(const me in Y)Y[me].forEach(Se=>{const ie=Se.feature,ge=M[S[me].source].getFeatureState(ie.layer["source-layer"],ie.id);ie.source=ie.layer.source,ie.layer["source-layer"]&&(ie.sourceLayer=ie.layer["source-layer"]),ie.state=ge});return Y}(this._layers,b,this.sourceCaches,r,s,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(_)}querySourceFeatures(r,s){s&&s.filter&&this._validate(u.y.filter,"querySourceFeatures.filter",s.filter,null,s);const d=this.sourceCaches[r];return d?function(f,_){const b=f.getRenderableIds().map(M=>f.getTileByID(M)),S=[],E={};for(let M=0;M<b.length;M++){const z=b[M],L=z.tileID.canonical.key;E[L]||(E[L]=!0,z.querySourceFeatures(S,_))}return S}(d,s):[]}addSourceType(r,s,d){return jr(r)?d(new Error(`A source type called "${r}" already exists.`)):(((f,_)=>{to[f]=_})(r,s),s.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:r,url:s.workerSourceURL},d):d(null,null))}getLight(){return this.light.getLight()}setLight(r,s={}){this._checkLoaded();const d=this.light.getLight();let f=!1;for(const b in r)if(!u.aG(r[b],d[b])){f=!0;break}if(!f)return;const _={now:u.h.now(),transition:u.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(r,s),this.light.updateTransitions(_)}_validate(r,s,d,f,_={}){return(!_||_.validate!==!1)&&Sr(this,r.call(u.y,u.e({key:s,style:this.serialize(),value:d,styleSpec:u.v},f)))}_remove(r=!0){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),u.aJ.off("pluginStateChange",this._rtlTextPluginCallback);for(const s in this._layers)this._layers[s].setEventedParent(null);for(const s in this.sourceCaches){const d=this.sourceCaches[s];d.setEventedParent(null),d.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove(r)}_clearSource(r){this.sourceCaches[r].clearTiles()}_reloadSource(r){this.sourceCaches[r].resume(),this.sourceCaches[r].reload()}_updateSources(r){for(const s in this.sourceCaches)this.sourceCaches[s].update(r,this.map.terrain)}_generateCollisionBoxes(){for(const r in this.sourceCaches)this._reloadSource(r)}_updatePlacement(r,s,d,f,_=!1){let b=!1,S=!1;const E={};for(const M of this._order){const z=this._layers[M];if(z.type!=="symbol")continue;if(!E[z.source]){const N=this.sourceCaches[z.source];E[z.source]=N.getRenderableIds(!0).map(J=>N.getTileByID(J)).sort((J,Y)=>Y.tileID.overscaledZ-J.tileID.overscaledZ||(J.tileID.isLessThan(Y.tileID)?-1:1))}const L=this.crossTileSymbolIndex.addLayer(z,E[z.source],r.center.lng);b=b||L}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((_=_||this._layerOrderChanged||d===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(u.h.now(),r.zoom))&&(this.pauseablePlacement=new Vi(r,this.map.terrain,this._order,_,s,d,f,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,E),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(u.h.now()),S=!0),b&&this.pauseablePlacement.placement.setStale()),S||b)for(const M of this._order){const z=this._layers[M];z.type==="symbol"&&this.placement.updateLayerOpacities(z,E[z.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(u.h.now())}_releaseSymbolFadeTiles(){for(const r in this.sourceCaches)this.sourceCaches[r].releaseSymbolFadeTiles()}getImages(r,s,d){this.imageManager.getImages(s.icons,d),this._updateTilesForChangedImages();const f=this.sourceCaches[s.source];f&&f.setDependencies(s.tileID.key,s.type,s.icons)}getGlyphs(r,s,d){this.glyphManager.getGlyphs(s.stacks,d);const f=this.sourceCaches[s.source];f&&f.setDependencies(s.tileID.key,s.type,[""])}getResource(r,s,d){return u.m(s,d)}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(r,s={}){this._checkLoaded(),r&&this._validate(u.y.glyphs,"glyphs",r,null,s)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=r,this.glyphManager.entries={},this.glyphManager.setURL(r))}addSprite(r,s,d={},f){this._checkLoaded();const _=[{id:r,url:s}],b=[...Me(this.stylesheet.sprite),..._];this._validate(u.y.sprite,"sprite",b,null,d)||(this.stylesheet.sprite=b,this._loadSprite(_,!0,f))}removeSprite(r){this._checkLoaded();const s=Me(this.stylesheet.sprite);if(s.find(d=>d.id===r)){if(this._spritesImagesIds[r])for(const d of this._spritesImagesIds[r])this.imageManager.removeImage(d),this._changedImages[d]=!0;s.splice(s.findIndex(d=>d.id===r),1),this.stylesheet.sprite=s.length>0?s:void 0,delete this._spritesImagesIds[r],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new u.k("data",{dataType:"style"}))}else this.fire(new u.j(new Error(`Sprite "${r}" doesn't exists on this map.`)))}getSprite(){return Me(this.stylesheet.sprite)}setSprite(r,s={},d){this._checkLoaded(),r&&this._validate(u.y.sprite,"sprite",r,null,s)||(this.stylesheet.sprite=r,r?this._loadSprite(r,!0,d):(this._unloadSprite(),d&&d(null)))}}mr.registerForPluginStateChange=u.aK;var ml=u.Q([{name:"a_pos",type:"Int16",components:2}]),Na="attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;varying float v_depth;void main() {float extent=8192.0;float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/extent;gl_Position=u_matrix*vec4(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta,1.0);v_depth=gl_Position.z/gl_Position.w;}";const Tn={prelude:Jt(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}`),background:Jt(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:Jt(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:Jt(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:Jt("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Jt(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),heatmapTexture:Jt(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:Jt("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,get_elevation(a_pos),1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:Jt("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:Jt("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:Jt(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),fillOutline:Jt(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillOutlinePattern:Jt(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillPattern:Jt(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:Jt(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:Jt(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:Jt(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Jt(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:Jt(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:Jt(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:Jt(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:Jt(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:Jt(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:Jt(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),z,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:Jt(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:Jt(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:Jt("uniform sampler2D u_texture;varying vec2 v_texture_pos;void main() {gl_FragColor=texture2D(u_texture,v_texture_pos);}",Na),terrainDepth:Jt("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}",Na),terrainCoords:Jt("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}",Na)};function Jt(g,r){const s=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,d=r.match(/attribute ([\w]+) ([\w]+)/g),f=g.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),_=r.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),b=_?_.concat(f):f,S={};return{fragmentSource:g=g.replace(s,(E,M,z,L,N)=>(S[N]=!0,M==="define"?`
#ifndef HAS_UNIFORM_u_${N}
varying ${z} ${L} ${N};
#else
uniform ${z} ${L} u_${N};
#endif
`:`
#ifdef HAS_UNIFORM_u_${N}
    ${z} ${L} ${N} = u_${N};
#endif
`)),vertexSource:r=r.replace(s,(E,M,z,L,N)=>{const J=L==="float"?"vec2":"vec4",Y=N.match(/color/)?"color":J;return S[N]?M==="define"?`
#ifndef HAS_UNIFORM_u_${N}
uniform lowp float u_${N}_t;
attribute ${z} ${J} a_${N};
varying ${z} ${L} ${N};
#else
uniform ${z} ${L} u_${N};
#endif
`:Y==="vec4"?`
#ifndef HAS_UNIFORM_u_${N}
    ${N} = a_${N};
#else
    ${z} ${L} ${N} = u_${N};
#endif
`:`
#ifndef HAS_UNIFORM_u_${N}
    ${N} = unpack_mix_${Y}(a_${N}, u_${N}_t);
#else
    ${z} ${L} ${N} = u_${N};
#endif
`:M==="define"?`
#ifndef HAS_UNIFORM_u_${N}
uniform lowp float u_${N}_t;
attribute ${z} ${J} a_${N};
#else
uniform ${z} ${L} u_${N};
#endif
`:Y==="vec4"?`
#ifndef HAS_UNIFORM_u_${N}
    ${z} ${L} ${N} = a_${N};
#else
    ${z} ${L} ${N} = u_${N};
#endif
`:`
#ifndef HAS_UNIFORM_u_${N}
    ${z} ${L} ${N} = unpack_mix_${Y}(a_${N}, u_${N}_t);
#else
    ${z} ${L} ${N} = u_${N};
#endif
`}),staticAttributes:d,staticUniforms:b}}class ua{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(r,s,d,f,_,b,S,E,M){this.context=r;let z=this.boundPaintVertexBuffers.length!==f.length;for(let L=0;!z&&L<f.length;L++)this.boundPaintVertexBuffers[L]!==f[L]&&(z=!0);!this.vao||this.boundProgram!==s||this.boundLayoutVertexBuffer!==d||z||this.boundIndexBuffer!==_||this.boundVertexOffset!==b||this.boundDynamicVertexBuffer!==S||this.boundDynamicVertexBuffer2!==E||this.boundDynamicVertexBuffer3!==M?this.freshBind(s,d,f,_,b,S,E,M):(r.bindVertexArray.set(this.vao),S&&S.bind(),_&&_.dynamicDraw&&_.bind(),E&&E.bind(),M&&M.bind())}freshBind(r,s,d,f,_,b,S,E){const M=r.numAttributes,z=this.context,L=z.gl;this.vao&&this.destroy(),this.vao=z.createVertexArray(),z.bindVertexArray.set(this.vao),this.boundProgram=r,this.boundLayoutVertexBuffer=s,this.boundPaintVertexBuffers=d,this.boundIndexBuffer=f,this.boundVertexOffset=_,this.boundDynamicVertexBuffer=b,this.boundDynamicVertexBuffer2=S,this.boundDynamicVertexBuffer3=E,s.enableAttributes(L,r);for(const N of d)N.enableAttributes(L,r);b&&b.enableAttributes(L,r),S&&S.enableAttributes(L,r),E&&E.enableAttributes(L,r),s.bind(),s.setVertexAttribPointers(L,r,_);for(const N of d)N.bind(),N.setVertexAttribPointers(L,r,_);b&&(b.bind(),b.setVertexAttribPointers(L,r,_)),f&&f.bind(),S&&(S.bind(),S.setVertexAttribPointers(L,r,_)),E&&(E.bind(),E.setVertexAttribPointers(L,r,_)),z.currentNumAttributes=M}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}function Pn(g){const r=[];for(let s=0;s<g.length;s++){if(g[s]===null)continue;const d=g[s].split(" ");r.push(d.pop())}return r}class gl{constructor(r,s,d,f,_,b){const S=r.gl;this.program=S.createProgram();const E=Pn(s.staticAttributes),M=d?d.getBinderAttributes():[],z=E.concat(M),L=Tn.prelude.staticUniforms?Pn(Tn.prelude.staticUniforms):[],N=s.staticUniforms?Pn(s.staticUniforms):[],J=d?d.getBinderUniforms():[],Y=L.concat(N).concat(J),te=[];for(const Ie of Y)te.indexOf(Ie)<0&&te.push(Ie);const K=d?d.defines():[];_&&K.push("#define OVERDRAW_INSPECTOR;"),b&&K.push("#define TERRAIN3D;");const me=K.concat(Tn.prelude.fragmentSource,s.fragmentSource).join(`
`),Se=K.concat(Tn.prelude.vertexSource,s.vertexSource).join(`
`),ie=S.createShader(S.FRAGMENT_SHADER);if(S.isContextLost())return void(this.failedToCreate=!0);if(S.shaderSource(ie,me),S.compileShader(ie),!S.getShaderParameter(ie,S.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${S.getShaderInfoLog(ie)}`);S.attachShader(this.program,ie);const ge=S.createShader(S.VERTEX_SHADER);if(S.isContextLost())return void(this.failedToCreate=!0);if(S.shaderSource(ge,Se),S.compileShader(ge),!S.getShaderParameter(ge,S.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${S.getShaderInfoLog(ge)}`);S.attachShader(this.program,ge),this.attributes={};const Ee={};this.numAttributes=z.length;for(let Ie=0;Ie<this.numAttributes;Ie++)z[Ie]&&(S.bindAttribLocation(this.program,Ie,z[Ie]),this.attributes[z[Ie]]=Ie);if(S.linkProgram(this.program),!S.getProgramParameter(this.program,S.LINK_STATUS))throw new Error(`Program failed to link: ${S.getProgramInfoLog(this.program)}`);S.deleteShader(ge),S.deleteShader(ie);for(let Ie=0;Ie<te.length;Ie++){const ze=te[Ie];if(ze&&!Ee[ze]){const Re=S.getUniformLocation(this.program,ze);Re&&(Ee[ze]=Re)}}this.fixedUniforms=f(r,Ee),this.terrainUniforms=((Ie,ze)=>({u_depth:new u.aL(Ie,ze.u_depth),u_terrain:new u.aL(Ie,ze.u_terrain),u_terrain_dim:new u.aM(Ie,ze.u_terrain_dim),u_terrain_matrix:new u.aN(Ie,ze.u_terrain_matrix),u_terrain_unpack:new u.aO(Ie,ze.u_terrain_unpack),u_terrain_exaggeration:new u.aM(Ie,ze.u_terrain_exaggeration)}))(r,Ee),this.binderUniforms=d?d.getUniforms(r,Ee):[]}draw(r,s,d,f,_,b,S,E,M,z,L,N,J,Y,te,K,me,Se){const ie=r.gl;if(this.failedToCreate)return;if(r.program.set(this.program),r.setDepthMode(d),r.setStencilMode(f),r.setColorMode(_),r.setCullFace(b),E){r.activeTexture.set(ie.TEXTURE2),ie.bindTexture(ie.TEXTURE_2D,E.depthTexture),r.activeTexture.set(ie.TEXTURE3),ie.bindTexture(ie.TEXTURE_2D,E.texture);for(const Ee in this.terrainUniforms)this.terrainUniforms[Ee].set(E[Ee])}for(const Ee in this.fixedUniforms)this.fixedUniforms[Ee].set(S[Ee]);te&&te.setUniforms(r,this.binderUniforms,J,{zoom:Y});let ge=0;switch(s){case ie.LINES:ge=2;break;case ie.TRIANGLES:ge=3;break;case ie.LINE_STRIP:ge=1}for(const Ee of N.get()){const Ie=Ee.vaos||(Ee.vaos={});(Ie[M]||(Ie[M]=new ua)).bind(r,this,z,te?te.getPaintVertexBuffers():[],L,Ee.vertexOffset,K,me,Se),ie.drawElements(s,Ee.primitiveLength*ge,ie.UNSIGNED_SHORT,Ee.primitiveOffset*ge*2)}}}function Ci(g,r,s){const d=1/ne(s,1,r.transform.tileZoom),f=Math.pow(2,s.tileID.overscaledZ),_=s.tileSize*Math.pow(2,r.transform.tileZoom)/f,b=_*(s.tileID.canonical.x+s.tileID.wrap*f),S=_*s.tileID.canonical.y;return{u_image:0,u_texsize:s.imageAtlasTexture.size,u_scale:[d,g.fromScale,g.toScale],u_fade:g.t,u_pixel_coord_upper:[b>>16,S>>16],u_pixel_coord_lower:[65535&b,65535&S]}}const ju=(g,r,s,d)=>{const f=r.style.light,_=f.properties.get("position"),b=[_.x,_.y,_.z],S=function(){var M=new u.A(9);return u.A!=Float32Array&&(M[1]=0,M[2]=0,M[3]=0,M[5]=0,M[6]=0,M[7]=0),M[0]=1,M[4]=1,M[8]=1,M}();f.properties.get("anchor")==="viewport"&&function(M,z){var L=Math.sin(z),N=Math.cos(z);M[0]=N,M[1]=L,M[2]=0,M[3]=-L,M[4]=N,M[5]=0,M[6]=0,M[7]=0,M[8]=1}(S,-r.transform.angle),function(M,z,L){var N=z[0],J=z[1],Y=z[2];M[0]=N*L[0]+J*L[3]+Y*L[6],M[1]=N*L[1]+J*L[4]+Y*L[7],M[2]=N*L[2]+J*L[5]+Y*L[8]}(b,b,S);const E=f.properties.get("color");return{u_matrix:g,u_lightpos:b,u_lightintensity:f.properties.get("intensity"),u_lightcolor:[E.r,E.g,E.b],u_vertical_gradient:+s,u_opacity:d}},Go=(g,r,s,d,f,_,b)=>u.e(ju(g,r,s,d),Ci(_,r,b),{u_height_factor:-Math.pow(2,f.overscaledZ)/b.tileSize/8}),id=g=>({u_matrix:g}),Zu=(g,r,s,d)=>u.e(id(g),Ci(s,r,d)),yl=(g,r)=>({u_matrix:g,u_world:r}),_l=(g,r,s,d,f)=>u.e(Zu(g,r,s,d),{u_world:f}),Ho=(g,r,s,d)=>{const f=g.transform;let _,b;if(d.paint.get("circle-pitch-alignment")==="map"){const S=ne(s,1,f.zoom);_=!0,b=[S,S]}else _=!1,b=f.pixelsToGLUnits;return{u_camera_to_center_distance:f.cameraToCenterDistance,u_scale_with_map:+(d.paint.get("circle-pitch-scale")==="map"),u_matrix:g.translatePosMatrix(r.posMatrix,s,d.paint.get("circle-translate"),d.paint.get("circle-translate-anchor")),u_pitch_with_map:+_,u_device_pixel_ratio:g.pixelRatio,u_extrude_scale:b}},qu=(g,r,s)=>{const d=ne(s,1,r.zoom),f=Math.pow(2,r.zoom-s.tileID.overscaledZ),_=s.tileID.overscaleFactor();return{u_matrix:g,u_camera_to_center_distance:r.cameraToCenterDistance,u_pixels_to_tile_units:d,u_extrude_scale:[r.pixelsToGLUnits[0]/(d*f),r.pixelsToGLUnits[1]/(d*f)],u_overscale_factor:_}},Es=(g,r,s=1)=>({u_matrix:g,u_color:r,u_overlay:0,u_overlay_scale:s}),od=g=>({u_matrix:g}),mm=(g,r,s,d)=>({u_matrix:g,u_extrude_scale:ne(r,1,s),u_intensity:d});function Gu(g,r){const s=Math.pow(2,r.canonical.z),d=r.canonical.y;return[new u.U(0,d/s).toLngLat().lat,new u.U(0,(d+1)/s).toLngLat().lat]}const Hu=(g,r,s,d)=>{const f=g.transform;return{u_matrix:vl(g,r,s,d),u_ratio:1/ne(r,1,f.zoom),u_device_pixel_ratio:g.pixelRatio,u_units_to_pixels:[1/f.pixelsToGLUnits[0],1/f.pixelsToGLUnits[1]]}},ad=(g,r,s,d,f)=>u.e(Hu(g,r,s,f),{u_image:0,u_image_height:d}),gm=(g,r,s,d,f)=>{const _=g.transform,b=ld(r,_);return{u_matrix:vl(g,r,s,f),u_texsize:r.imageAtlasTexture.size,u_ratio:1/ne(r,1,_.zoom),u_device_pixel_ratio:g.pixelRatio,u_image:0,u_scale:[b,d.fromScale,d.toScale],u_fade:d.t,u_units_to_pixels:[1/_.pixelsToGLUnits[0],1/_.pixelsToGLUnits[1]]}},sd=(g,r,s,d,f,_)=>{const b=g.lineAtlas,S=ld(r,g.transform),E=s.layout.get("line-cap")==="round",M=b.getDash(d.from,E),z=b.getDash(d.to,E),L=M.width*f.fromScale,N=z.width*f.toScale;return u.e(Hu(g,r,s,_),{u_patternscale_a:[S/L,-M.height/2],u_patternscale_b:[S/N,-z.height/2],u_sdfgamma:b.width/(256*Math.min(L,N)*g.pixelRatio)/2,u_image:0,u_tex_y_a:M.y,u_tex_y_b:z.y,u_mix:f.t})};function ld(g,r){return 1/ne(g,1,r.tileZoom)}function vl(g,r,s,d){return g.translatePosMatrix(d?d.posMatrix:r.tileID.posMatrix,r,s.paint.get("line-translate"),s.paint.get("line-translate-anchor"))}const ud=(g,r,s,d,f)=>{return{u_matrix:g,u_tl_parent:r,u_scale_parent:s,u_buffer_scale:1,u_fade_t:d.mix,u_opacity:d.opacity*f.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:f.paint.get("raster-brightness-min"),u_brightness_high:f.paint.get("raster-brightness-max"),u_saturation_factor:(b=f.paint.get("raster-saturation"),b>0?1-1/(1.001-b):-b),u_contrast_factor:(_=f.paint.get("raster-contrast"),_>0?1/(1-_):1+_),u_spin_weights:cd(f.paint.get("raster-hue-rotate"))};var _,b};function cd(g){g*=Math.PI/180;const r=Math.sin(g),s=Math.cos(g);return[(2*s+1)/3,(-Math.sqrt(3)*r-s+1)/3,(Math.sqrt(3)*r-s+1)/3]}const Wu=(g,r,s,d,f,_,b,S,E,M)=>{const z=f.transform;return{u_is_size_zoom_constant:+(g==="constant"||g==="source"),u_is_size_feature_constant:+(g==="constant"||g==="camera"),u_size_t:r?r.uSizeT:0,u_size:r?r.uSize:0,u_camera_to_center_distance:z.cameraToCenterDistance,u_pitch:z.pitch/360*2*Math.PI,u_rotate_symbol:+s,u_aspect_ratio:z.width/z.height,u_fade_change:f.options.fadeDuration?f.symbolFadeChange:1,u_matrix:_,u_label_plane_matrix:b,u_coord_matrix:S,u_is_text:+E,u_pitch_with_map:+d,u_texsize:M,u_texture:0}},Ku=(g,r,s,d,f,_,b,S,E,M,z)=>{const L=f.transform;return u.e(Wu(g,r,s,d,f,_,b,S,E,M),{u_gamma_scale:d?Math.cos(L._pitch)*L.cameraToCenterDistance:1,u_device_pixel_ratio:f.pixelRatio,u_is_halo:+z})},ca=(g,r,s,d,f,_,b,S,E,M)=>u.e(Ku(g,r,s,d,f,_,b,S,!0,E,!0),{u_texsize_icon:M,u_texture_icon:1}),xl=(g,r,s)=>({u_matrix:g,u_opacity:r,u_color:s}),Ei=(g,r,s,d,f,_)=>u.e(function(b,S,E,M){const z=E.imageManager.getPattern(b.from.toString()),L=E.imageManager.getPattern(b.to.toString()),{width:N,height:J}=E.imageManager.getPixelSize(),Y=Math.pow(2,M.tileID.overscaledZ),te=M.tileSize*Math.pow(2,E.transform.tileZoom)/Y,K=te*(M.tileID.canonical.x+M.tileID.wrap*Y),me=te*M.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:z.tl,u_pattern_br_a:z.br,u_pattern_tl_b:L.tl,u_pattern_br_b:L.br,u_texsize:[N,J],u_mix:S.t,u_pattern_size_a:z.displaySize,u_pattern_size_b:L.displaySize,u_scale_a:S.fromScale,u_scale_b:S.toScale,u_tile_units_to_pixels:1/ne(M,1,E.transform.tileZoom),u_pixel_coord_upper:[K>>16,me>>16],u_pixel_coord_lower:[65535&K,65535&me]}}(d,_,s,f),{u_matrix:g,u_opacity:r}),wl={fillExtrusion:(g,r)=>({u_matrix:new u.aN(g,r.u_matrix),u_lightpos:new u.aP(g,r.u_lightpos),u_lightintensity:new u.aM(g,r.u_lightintensity),u_lightcolor:new u.aP(g,r.u_lightcolor),u_vertical_gradient:new u.aM(g,r.u_vertical_gradient),u_opacity:new u.aM(g,r.u_opacity)}),fillExtrusionPattern:(g,r)=>({u_matrix:new u.aN(g,r.u_matrix),u_lightpos:new u.aP(g,r.u_lightpos),u_lightintensity:new u.aM(g,r.u_lightintensity),u_lightcolor:new u.aP(g,r.u_lightcolor),u_vertical_gradient:new u.aM(g,r.u_vertical_gradient),u_height_factor:new u.aM(g,r.u_height_factor),u_image:new u.aL(g,r.u_image),u_texsize:new u.aQ(g,r.u_texsize),u_pixel_coord_upper:new u.aQ(g,r.u_pixel_coord_upper),u_pixel_coord_lower:new u.aQ(g,r.u_pixel_coord_lower),u_scale:new u.aP(g,r.u_scale),u_fade:new u.aM(g,r.u_fade),u_opacity:new u.aM(g,r.u_opacity)}),fill:(g,r)=>({u_matrix:new u.aN(g,r.u_matrix)}),fillPattern:(g,r)=>({u_matrix:new u.aN(g,r.u_matrix),u_image:new u.aL(g,r.u_image),u_texsize:new u.aQ(g,r.u_texsize),u_pixel_coord_upper:new u.aQ(g,r.u_pixel_coord_upper),u_pixel_coord_lower:new u.aQ(g,r.u_pixel_coord_lower),u_scale:new u.aP(g,r.u_scale),u_fade:new u.aM(g,r.u_fade)}),fillOutline:(g,r)=>({u_matrix:new u.aN(g,r.u_matrix),u_world:new u.aQ(g,r.u_world)}),fillOutlinePattern:(g,r)=>({u_matrix:new u.aN(g,r.u_matrix),u_world:new u.aQ(g,r.u_world),u_image:new u.aL(g,r.u_image),u_texsize:new u.aQ(g,r.u_texsize),u_pixel_coord_upper:new u.aQ(g,r.u_pixel_coord_upper),u_pixel_coord_lower:new u.aQ(g,r.u_pixel_coord_lower),u_scale:new u.aP(g,r.u_scale),u_fade:new u.aM(g,r.u_fade)}),circle:(g,r)=>({u_camera_to_center_distance:new u.aM(g,r.u_camera_to_center_distance),u_scale_with_map:new u.aL(g,r.u_scale_with_map),u_pitch_with_map:new u.aL(g,r.u_pitch_with_map),u_extrude_scale:new u.aQ(g,r.u_extrude_scale),u_device_pixel_ratio:new u.aM(g,r.u_device_pixel_ratio),u_matrix:new u.aN(g,r.u_matrix)}),collisionBox:(g,r)=>({u_matrix:new u.aN(g,r.u_matrix),u_camera_to_center_distance:new u.aM(g,r.u_camera_to_center_distance),u_pixels_to_tile_units:new u.aM(g,r.u_pixels_to_tile_units),u_extrude_scale:new u.aQ(g,r.u_extrude_scale),u_overscale_factor:new u.aM(g,r.u_overscale_factor)}),collisionCircle:(g,r)=>({u_matrix:new u.aN(g,r.u_matrix),u_inv_matrix:new u.aN(g,r.u_inv_matrix),u_camera_to_center_distance:new u.aM(g,r.u_camera_to_center_distance),u_viewport_size:new u.aQ(g,r.u_viewport_size)}),debug:(g,r)=>({u_color:new u.aR(g,r.u_color),u_matrix:new u.aN(g,r.u_matrix),u_overlay:new u.aL(g,r.u_overlay),u_overlay_scale:new u.aM(g,r.u_overlay_scale)}),clippingMask:(g,r)=>({u_matrix:new u.aN(g,r.u_matrix)}),heatmap:(g,r)=>({u_extrude_scale:new u.aM(g,r.u_extrude_scale),u_intensity:new u.aM(g,r.u_intensity),u_matrix:new u.aN(g,r.u_matrix)}),heatmapTexture:(g,r)=>({u_matrix:new u.aN(g,r.u_matrix),u_world:new u.aQ(g,r.u_world),u_image:new u.aL(g,r.u_image),u_color_ramp:new u.aL(g,r.u_color_ramp),u_opacity:new u.aM(g,r.u_opacity)}),hillshade:(g,r)=>({u_matrix:new u.aN(g,r.u_matrix),u_image:new u.aL(g,r.u_image),u_latrange:new u.aQ(g,r.u_latrange),u_light:new u.aQ(g,r.u_light),u_shadow:new u.aR(g,r.u_shadow),u_highlight:new u.aR(g,r.u_highlight),u_accent:new u.aR(g,r.u_accent)}),hillshadePrepare:(g,r)=>({u_matrix:new u.aN(g,r.u_matrix),u_image:new u.aL(g,r.u_image),u_dimension:new u.aQ(g,r.u_dimension),u_zoom:new u.aM(g,r.u_zoom),u_unpack:new u.aO(g,r.u_unpack)}),line:(g,r)=>({u_matrix:new u.aN(g,r.u_matrix),u_ratio:new u.aM(g,r.u_ratio),u_device_pixel_ratio:new u.aM(g,r.u_device_pixel_ratio),u_units_to_pixels:new u.aQ(g,r.u_units_to_pixels)}),lineGradient:(g,r)=>({u_matrix:new u.aN(g,r.u_matrix),u_ratio:new u.aM(g,r.u_ratio),u_device_pixel_ratio:new u.aM(g,r.u_device_pixel_ratio),u_units_to_pixels:new u.aQ(g,r.u_units_to_pixels),u_image:new u.aL(g,r.u_image),u_image_height:new u.aM(g,r.u_image_height)}),linePattern:(g,r)=>({u_matrix:new u.aN(g,r.u_matrix),u_texsize:new u.aQ(g,r.u_texsize),u_ratio:new u.aM(g,r.u_ratio),u_device_pixel_ratio:new u.aM(g,r.u_device_pixel_ratio),u_image:new u.aL(g,r.u_image),u_units_to_pixels:new u.aQ(g,r.u_units_to_pixels),u_scale:new u.aP(g,r.u_scale),u_fade:new u.aM(g,r.u_fade)}),lineSDF:(g,r)=>({u_matrix:new u.aN(g,r.u_matrix),u_ratio:new u.aM(g,r.u_ratio),u_device_pixel_ratio:new u.aM(g,r.u_device_pixel_ratio),u_units_to_pixels:new u.aQ(g,r.u_units_to_pixels),u_patternscale_a:new u.aQ(g,r.u_patternscale_a),u_patternscale_b:new u.aQ(g,r.u_patternscale_b),u_sdfgamma:new u.aM(g,r.u_sdfgamma),u_image:new u.aL(g,r.u_image),u_tex_y_a:new u.aM(g,r.u_tex_y_a),u_tex_y_b:new u.aM(g,r.u_tex_y_b),u_mix:new u.aM(g,r.u_mix)}),raster:(g,r)=>({u_matrix:new u.aN(g,r.u_matrix),u_tl_parent:new u.aQ(g,r.u_tl_parent),u_scale_parent:new u.aM(g,r.u_scale_parent),u_buffer_scale:new u.aM(g,r.u_buffer_scale),u_fade_t:new u.aM(g,r.u_fade_t),u_opacity:new u.aM(g,r.u_opacity),u_image0:new u.aL(g,r.u_image0),u_image1:new u.aL(g,r.u_image1),u_brightness_low:new u.aM(g,r.u_brightness_low),u_brightness_high:new u.aM(g,r.u_brightness_high),u_saturation_factor:new u.aM(g,r.u_saturation_factor),u_contrast_factor:new u.aM(g,r.u_contrast_factor),u_spin_weights:new u.aP(g,r.u_spin_weights)}),symbolIcon:(g,r)=>({u_is_size_zoom_constant:new u.aL(g,r.u_is_size_zoom_constant),u_is_size_feature_constant:new u.aL(g,r.u_is_size_feature_constant),u_size_t:new u.aM(g,r.u_size_t),u_size:new u.aM(g,r.u_size),u_camera_to_center_distance:new u.aM(g,r.u_camera_to_center_distance),u_pitch:new u.aM(g,r.u_pitch),u_rotate_symbol:new u.aL(g,r.u_rotate_symbol),u_aspect_ratio:new u.aM(g,r.u_aspect_ratio),u_fade_change:new u.aM(g,r.u_fade_change),u_matrix:new u.aN(g,r.u_matrix),u_label_plane_matrix:new u.aN(g,r.u_label_plane_matrix),u_coord_matrix:new u.aN(g,r.u_coord_matrix),u_is_text:new u.aL(g,r.u_is_text),u_pitch_with_map:new u.aL(g,r.u_pitch_with_map),u_texsize:new u.aQ(g,r.u_texsize),u_texture:new u.aL(g,r.u_texture)}),symbolSDF:(g,r)=>({u_is_size_zoom_constant:new u.aL(g,r.u_is_size_zoom_constant),u_is_size_feature_constant:new u.aL(g,r.u_is_size_feature_constant),u_size_t:new u.aM(g,r.u_size_t),u_size:new u.aM(g,r.u_size),u_camera_to_center_distance:new u.aM(g,r.u_camera_to_center_distance),u_pitch:new u.aM(g,r.u_pitch),u_rotate_symbol:new u.aL(g,r.u_rotate_symbol),u_aspect_ratio:new u.aM(g,r.u_aspect_ratio),u_fade_change:new u.aM(g,r.u_fade_change),u_matrix:new u.aN(g,r.u_matrix),u_label_plane_matrix:new u.aN(g,r.u_label_plane_matrix),u_coord_matrix:new u.aN(g,r.u_coord_matrix),u_is_text:new u.aL(g,r.u_is_text),u_pitch_with_map:new u.aL(g,r.u_pitch_with_map),u_texsize:new u.aQ(g,r.u_texsize),u_texture:new u.aL(g,r.u_texture),u_gamma_scale:new u.aM(g,r.u_gamma_scale),u_device_pixel_ratio:new u.aM(g,r.u_device_pixel_ratio),u_is_halo:new u.aL(g,r.u_is_halo)}),symbolTextAndIcon:(g,r)=>({u_is_size_zoom_constant:new u.aL(g,r.u_is_size_zoom_constant),u_is_size_feature_constant:new u.aL(g,r.u_is_size_feature_constant),u_size_t:new u.aM(g,r.u_size_t),u_size:new u.aM(g,r.u_size),u_camera_to_center_distance:new u.aM(g,r.u_camera_to_center_distance),u_pitch:new u.aM(g,r.u_pitch),u_rotate_symbol:new u.aL(g,r.u_rotate_symbol),u_aspect_ratio:new u.aM(g,r.u_aspect_ratio),u_fade_change:new u.aM(g,r.u_fade_change),u_matrix:new u.aN(g,r.u_matrix),u_label_plane_matrix:new u.aN(g,r.u_label_plane_matrix),u_coord_matrix:new u.aN(g,r.u_coord_matrix),u_is_text:new u.aL(g,r.u_is_text),u_pitch_with_map:new u.aL(g,r.u_pitch_with_map),u_texsize:new u.aQ(g,r.u_texsize),u_texsize_icon:new u.aQ(g,r.u_texsize_icon),u_texture:new u.aL(g,r.u_texture),u_texture_icon:new u.aL(g,r.u_texture_icon),u_gamma_scale:new u.aM(g,r.u_gamma_scale),u_device_pixel_ratio:new u.aM(g,r.u_device_pixel_ratio),u_is_halo:new u.aL(g,r.u_is_halo)}),background:(g,r)=>({u_matrix:new u.aN(g,r.u_matrix),u_opacity:new u.aM(g,r.u_opacity),u_color:new u.aR(g,r.u_color)}),backgroundPattern:(g,r)=>({u_matrix:new u.aN(g,r.u_matrix),u_opacity:new u.aM(g,r.u_opacity),u_image:new u.aL(g,r.u_image),u_pattern_tl_a:new u.aQ(g,r.u_pattern_tl_a),u_pattern_br_a:new u.aQ(g,r.u_pattern_br_a),u_pattern_tl_b:new u.aQ(g,r.u_pattern_tl_b),u_pattern_br_b:new u.aQ(g,r.u_pattern_br_b),u_texsize:new u.aQ(g,r.u_texsize),u_mix:new u.aM(g,r.u_mix),u_pattern_size_a:new u.aQ(g,r.u_pattern_size_a),u_pattern_size_b:new u.aQ(g,r.u_pattern_size_b),u_scale_a:new u.aM(g,r.u_scale_a),u_scale_b:new u.aM(g,r.u_scale_b),u_pixel_coord_upper:new u.aQ(g,r.u_pixel_coord_upper),u_pixel_coord_lower:new u.aQ(g,r.u_pixel_coord_lower),u_tile_units_to_pixels:new u.aM(g,r.u_tile_units_to_pixels)}),terrain:(g,r)=>({u_matrix:new u.aN(g,r.u_matrix),u_texture:new u.aL(g,r.u_texture),u_ele_delta:new u.aM(g,r.u_ele_delta)}),terrainDepth:(g,r)=>({u_matrix:new u.aN(g,r.u_matrix),u_ele_delta:new u.aM(g,r.u_ele_delta)}),terrainCoords:(g,r)=>({u_matrix:new u.aN(g,r.u_matrix),u_texture:new u.aL(g,r.u_texture),u_terrain_coords_id:new u.aM(g,r.u_terrain_coords_id),u_ele_delta:new u.aM(g,r.u_ele_delta)})};class bl{constructor(r,s,d){this.context=r;const f=r.gl;this.buffer=f.createBuffer(),this.dynamicDraw=!!d,this.context.unbindVAO(),r.bindElementBuffer.set(this.buffer),f.bufferData(f.ELEMENT_ARRAY_BUFFER,s.arrayBuffer,this.dynamicDraw?f.DYNAMIC_DRAW:f.STATIC_DRAW),this.dynamicDraw||delete s.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(r){const s=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),s.bufferSubData(s.ELEMENT_ARRAY_BUFFER,0,r.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Is={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Sl{constructor(r,s,d,f){this.length=s.length,this.attributes=d,this.itemSize=s.bytesPerElement,this.dynamicDraw=f,this.context=r;const _=r.gl;this.buffer=_.createBuffer(),r.bindVertexBuffer.set(this.buffer),_.bufferData(_.ARRAY_BUFFER,s.arrayBuffer,this.dynamicDraw?_.DYNAMIC_DRAW:_.STATIC_DRAW),this.dynamicDraw||delete s.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(r){if(r.length!==this.length)throw new Error(`Length of new data is ${r.length}, which doesn't match current length of ${this.length}`);const s=this.context.gl;this.bind(),s.bufferSubData(s.ARRAY_BUFFER,0,r.arrayBuffer)}enableAttributes(r,s){for(let d=0;d<this.attributes.length;d++){const f=s.attributes[this.attributes[d].name];f!==void 0&&r.enableVertexAttribArray(f)}}setVertexAttribPointers(r,s,d){for(let f=0;f<this.attributes.length;f++){const _=this.attributes[f],b=s.attributes[_.name];b!==void 0&&r.vertexAttribPointer(b,_.components,r[Is[_.type]],!1,this.itemSize,_.offset+this.itemSize*(d||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Ua=new WeakMap;function Wo(g){var r;if(Ua.has(g))return Ua.get(g);{const s=(r=g.getParameter(g.VERSION))===null||r===void 0?void 0:r.startsWith("WebGL 2.0");return Ua.set(g,s),s}}class qt{constructor(r){this.gl=r.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(r){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Tl extends qt{getDefault(){return u.aT.transparent}set(r){const s=this.current;(r.r!==s.r||r.g!==s.g||r.b!==s.b||r.a!==s.a||this.dirty)&&(this.gl.clearColor(r.r,r.g,r.b,r.a),this.current=r,this.dirty=!1)}}class si extends qt{getDefault(){return 1}set(r){(r!==this.current||this.dirty)&&(this.gl.clearDepth(r),this.current=r,this.dirty=!1)}}class li extends qt{getDefault(){return 0}set(r){(r!==this.current||this.dirty)&&(this.gl.clearStencil(r),this.current=r,this.dirty=!1)}}class Xu extends qt{getDefault(){return[!0,!0,!0,!0]}set(r){const s=this.current;(r[0]!==s[0]||r[1]!==s[1]||r[2]!==s[2]||r[3]!==s[3]||this.dirty)&&(this.gl.colorMask(r[0],r[1],r[2],r[3]),this.current=r,this.dirty=!1)}}class Cl extends qt{getDefault(){return!0}set(r){(r!==this.current||this.dirty)&&(this.gl.depthMask(r),this.current=r,this.dirty=!1)}}class El extends qt{getDefault(){return 255}set(r){(r!==this.current||this.dirty)&&(this.gl.stencilMask(r),this.current=r,this.dirty=!1)}}class Yu extends qt{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(r){const s=this.current;(r.func!==s.func||r.ref!==s.ref||r.mask!==s.mask||this.dirty)&&(this.gl.stencilFunc(r.func,r.ref,r.mask),this.current=r,this.dirty=!1)}}class Ju extends qt{getDefault(){const r=this.gl;return[r.KEEP,r.KEEP,r.KEEP]}set(r){const s=this.current;(r[0]!==s[0]||r[1]!==s[1]||r[2]!==s[2]||this.dirty)&&(this.gl.stencilOp(r[0],r[1],r[2]),this.current=r,this.dirty=!1)}}class Il extends qt{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const s=this.gl;r?s.enable(s.STENCIL_TEST):s.disable(s.STENCIL_TEST),this.current=r,this.dirty=!1}}class Qu extends qt{getDefault(){return[0,1]}set(r){const s=this.current;(r[0]!==s[0]||r[1]!==s[1]||this.dirty)&&(this.gl.depthRange(r[0],r[1]),this.current=r,this.dirty=!1)}}class ec extends qt{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const s=this.gl;r?s.enable(s.DEPTH_TEST):s.disable(s.DEPTH_TEST),this.current=r,this.dirty=!1}}class kl extends qt{getDefault(){return this.gl.LESS}set(r){(r!==this.current||this.dirty)&&(this.gl.depthFunc(r),this.current=r,this.dirty=!1)}}class hd extends qt{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const s=this.gl;r?s.enable(s.BLEND):s.disable(s.BLEND),this.current=r,this.dirty=!1}}class dd extends qt{getDefault(){const r=this.gl;return[r.ONE,r.ZERO]}set(r){const s=this.current;(r[0]!==s[0]||r[1]!==s[1]||this.dirty)&&(this.gl.blendFunc(r[0],r[1]),this.current=r,this.dirty=!1)}}class $a extends qt{getDefault(){return u.aT.transparent}set(r){const s=this.current;(r.r!==s.r||r.g!==s.g||r.b!==s.b||r.a!==s.a||this.dirty)&&(this.gl.blendColor(r.r,r.g,r.b,r.a),this.current=r,this.dirty=!1)}}class ym extends qt{getDefault(){return this.gl.FUNC_ADD}set(r){(r!==this.current||this.dirty)&&(this.gl.blendEquation(r),this.current=r,this.dirty=!1)}}class _m extends qt{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const s=this.gl;r?s.enable(s.CULL_FACE):s.disable(s.CULL_FACE),this.current=r,this.dirty=!1}}class vm extends qt{getDefault(){return this.gl.BACK}set(r){(r!==this.current||this.dirty)&&(this.gl.cullFace(r),this.current=r,this.dirty=!1)}}class xm extends qt{getDefault(){return this.gl.CCW}set(r){(r!==this.current||this.dirty)&&(this.gl.frontFace(r),this.current=r,this.dirty=!1)}}class wm extends qt{getDefault(){return null}set(r){(r!==this.current||this.dirty)&&(this.gl.useProgram(r),this.current=r,this.dirty=!1)}}class bm extends qt{getDefault(){return this.gl.TEXTURE0}set(r){(r!==this.current||this.dirty)&&(this.gl.activeTexture(r),this.current=r,this.dirty=!1)}}class tc extends qt{getDefault(){const r=this.gl;return[0,0,r.drawingBufferWidth,r.drawingBufferHeight]}set(r){const s=this.current;(r[0]!==s[0]||r[1]!==s[1]||r[2]!==s[2]||r[3]!==s[3]||this.dirty)&&(this.gl.viewport(r[0],r[1],r[2],r[3]),this.current=r,this.dirty=!1)}}class Ml extends qt{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const s=this.gl;s.bindFramebuffer(s.FRAMEBUFFER,r),this.current=r,this.dirty=!1}}class nc extends qt{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const s=this.gl;s.bindRenderbuffer(s.RENDERBUFFER,r),this.current=r,this.dirty=!1}}class rc extends qt{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const s=this.gl;s.bindTexture(s.TEXTURE_2D,r),this.current=r,this.dirty=!1}}class ja extends qt{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const s=this.gl;s.bindBuffer(s.ARRAY_BUFFER,r),this.current=r,this.dirty=!1}}class pd extends qt{getDefault(){return null}set(r){const s=this.gl;s.bindBuffer(s.ELEMENT_ARRAY_BUFFER,r),this.current=r,this.dirty=!1}}class fd extends qt{getDefault(){return null}set(r){var s;if(r===this.current&&!this.dirty)return;const d=this.gl;Wo(d)?d.bindVertexArray(r):(s=d.getExtension("OES_vertex_array_object"))===null||s===void 0||s.bindVertexArrayOES(r),this.current=r,this.dirty=!1}}class ic extends qt{getDefault(){return 4}set(r){if(r===this.current&&!this.dirty)return;const s=this.gl;s.pixelStorei(s.UNPACK_ALIGNMENT,r),this.current=r,this.dirty=!1}}class ha extends qt{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const s=this.gl;s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r),this.current=r,this.dirty=!1}}class md extends qt{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const s=this.gl;s.pixelStorei(s.UNPACK_FLIP_Y_WEBGL,r),this.current=r,this.dirty=!1}}class Ko extends qt{constructor(r,s){super(r),this.context=r,this.parent=s}getDefault(){return null}}class Za extends Ko{setDirty(){this.dirty=!0}set(r){if(r===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const s=this.gl;s.framebufferTexture2D(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.TEXTURE_2D,r,0),this.current=r,this.dirty=!1}}class gd extends Ko{set(r){if(r===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const s=this.gl;s.framebufferRenderbuffer(s.FRAMEBUFFER,s.DEPTH_ATTACHMENT,s.RENDERBUFFER,r),this.current=r,this.dirty=!1}}class oc extends Ko{set(r){if(r===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const s=this.gl;s.framebufferRenderbuffer(s.FRAMEBUFFER,s.DEPTH_STENCIL_ATTACHMENT,s.RENDERBUFFER,r),this.current=r,this.dirty=!1}}class Qt{constructor(r,s,d,f,_){this.context=r,this.width=s,this.height=d;const b=r.gl,S=this.framebuffer=b.createFramebuffer();if(this.colorAttachment=new Za(r,S),f)this.depthAttachment=_?new oc(r,S):new gd(r,S);else if(_)throw new Error("Stencil cannot be setted without depth");if(b.checkFramebufferStatus(b.FRAMEBUFFER)!==b.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){const r=this.context.gl,s=this.colorAttachment.get();if(s&&r.deleteTexture(s),this.depthAttachment){const d=this.depthAttachment.get();d&&r.deleteRenderbuffer(d)}r.deleteFramebuffer(this.framebuffer)}}class Cn{constructor(r,s,d){this.blendFunction=r,this.blendColor=s,this.mask=d}}Cn.Replace=[1,0],Cn.disabled=new Cn(Cn.Replace,u.aT.transparent,[!1,!1,!1,!1]),Cn.unblended=new Cn(Cn.Replace,u.aT.transparent,[!0,!0,!0,!0]),Cn.alphaBlended=new Cn([1,771],u.aT.transparent,[!0,!0,!0,!0]);class Sm{constructor(r){var s,d;if(this.gl=r,this.clearColor=new Tl(this),this.clearDepth=new si(this),this.clearStencil=new li(this),this.colorMask=new Xu(this),this.depthMask=new Cl(this),this.stencilMask=new El(this),this.stencilFunc=new Yu(this),this.stencilOp=new Ju(this),this.stencilTest=new Il(this),this.depthRange=new Qu(this),this.depthTest=new ec(this),this.depthFunc=new kl(this),this.blend=new hd(this),this.blendFunc=new dd(this),this.blendColor=new $a(this),this.blendEquation=new ym(this),this.cullFace=new _m(this),this.cullFaceSide=new vm(this),this.frontFace=new xm(this),this.program=new wm(this),this.activeTexture=new bm(this),this.viewport=new tc(this),this.bindFramebuffer=new Ml(this),this.bindRenderbuffer=new nc(this),this.bindTexture=new rc(this),this.bindVertexBuffer=new ja(this),this.bindElementBuffer=new pd(this),this.bindVertexArray=new fd(this),this.pixelStoreUnpack=new ic(this),this.pixelStoreUnpackPremultiplyAlpha=new ha(this),this.pixelStoreUnpackFlipY=new md(this),this.extTextureFilterAnisotropic=r.getExtension("EXT_texture_filter_anisotropic")||r.getExtension("MOZ_EXT_texture_filter_anisotropic")||r.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=r.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=r.getParameter(r.MAX_TEXTURE_SIZE),Wo(r)){this.HALF_FLOAT=r.HALF_FLOAT;const f=r.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(s=r.RGBA16F)!==null&&s!==void 0?s:f==null?void 0:f.RGBA16F_EXT,this.RGB16F=(d=r.RGB16F)!==null&&d!==void 0?d:f==null?void 0:f.RGB16F_EXT,r.getExtension("EXT_color_buffer_float")}else{r.getExtension("EXT_color_buffer_half_float"),r.getExtension("OES_texture_half_float_linear");const f=r.getExtension("OES_texture_half_float");this.HALF_FLOAT=f==null?void 0:f.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(r,s){return new bl(this,r,s)}createVertexBuffer(r,s,d){return new Sl(this,r,s,d)}createRenderbuffer(r,s,d){const f=this.gl,_=f.createRenderbuffer();return this.bindRenderbuffer.set(_),f.renderbufferStorage(f.RENDERBUFFER,r,s,d),this.bindRenderbuffer.set(null),_}createFramebuffer(r,s,d,f){return new Qt(this,r,s,d,f)}clear({color:r,depth:s,stencil:d}){const f=this.gl;let _=0;r&&(_|=f.COLOR_BUFFER_BIT,this.clearColor.set(r),this.colorMask.set([!0,!0,!0,!0])),s!==void 0&&(_|=f.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(s),this.depthMask.set(!0)),d!==void 0&&(_|=f.STENCIL_BUFFER_BIT,this.clearStencil.set(d),this.stencilMask.set(255)),f.clear(_)}setCullFace(r){r.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(r.mode),this.frontFace.set(r.frontFace))}setDepthMode(r){r.func!==this.gl.ALWAYS||r.mask?(this.depthTest.set(!0),this.depthFunc.set(r.func),this.depthMask.set(r.mask),this.depthRange.set(r.range)):this.depthTest.set(!1)}setStencilMode(r){r.test.func!==this.gl.ALWAYS||r.mask?(this.stencilTest.set(!0),this.stencilMask.set(r.mask),this.stencilOp.set([r.fail,r.depthFail,r.pass]),this.stencilFunc.set({func:r.test.func,ref:r.ref,mask:r.test.mask})):this.stencilTest.set(!1)}setColorMode(r){u.aG(r.blendFunction,Cn.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(r.blendFunction),this.blendColor.set(r.blendColor)),this.colorMask.set(r.mask)}createVertexArray(){var r;return Wo(this.gl)?this.gl.createVertexArray():(r=this.gl.getExtension("OES_vertex_array_object"))===null||r===void 0?void 0:r.createVertexArrayOES()}deleteVertexArray(r){var s;return Wo(this.gl)?this.gl.deleteVertexArray(r):(s=this.gl.getExtension("OES_vertex_array_object"))===null||s===void 0?void 0:s.deleteVertexArrayOES(r)}unbindVAO(){this.bindVertexArray.set(null)}}class Gt{constructor(r,s,d){this.func=r,this.mask=s,this.range=d}}Gt.ReadOnly=!1,Gt.ReadWrite=!0,Gt.disabled=new Gt(519,Gt.ReadOnly,[0,1]);const da=7680;class En{constructor(r,s,d,f,_,b){this.test=r,this.ref=s,this.mask=d,this.fail=f,this.depthFail=_,this.pass=b}}En.disabled=new En({func:519,mask:0},0,0,da,da,da);class bn{constructor(r,s,d){this.enable=r,this.mode=s,this.frontFace=d}}let ks;function yd(g,r,s,d,f,_,b){const S=g.context,E=S.gl,M=g.useProgram("collisionBox"),z=[];let L=0,N=0;for(let ie=0;ie<d.length;ie++){const ge=d[ie],Ee=r.getTile(ge),Ie=Ee.getBucket(s);if(!Ie)continue;let ze=ge.posMatrix;f[0]===0&&f[1]===0||(ze=g.translatePosMatrix(ge.posMatrix,Ee,f,_));const Re=b?Ie.textCollisionBox:Ie.iconCollisionBox,Le=Ie.collisionCircleArray;if(Le.length>0){const Ve=u.Z(),rt=ze;u.aU(Ve,Ie.placementInvProjMatrix,g.transform.glCoordMatrix),u.aU(Ve,Ve,Ie.placementViewportMatrix),z.push({circleArray:Le,circleOffset:N,transform:rt,invTransform:Ve,coord:ge}),L+=Le.length/4,N=L}Re&&M.draw(S,E.LINES,Gt.disabled,En.disabled,g.colorModeForRenderPass(),bn.disabled,qu(ze,g.transform,Ee),g.style.map.terrain&&g.style.map.terrain.getTerrainData(ge),s.id,Re.layoutVertexBuffer,Re.indexBuffer,Re.segments,null,g.transform.zoom,null,null,Re.collisionVertexBuffer)}if(!b||!z.length)return;const J=g.useProgram("collisionCircle"),Y=new u.aV;Y.resize(4*L),Y._trim();let te=0;for(const ie of z)for(let ge=0;ge<ie.circleArray.length/4;ge++){const Ee=4*ge,Ie=ie.circleArray[Ee+0],ze=ie.circleArray[Ee+1],Re=ie.circleArray[Ee+2],Le=ie.circleArray[Ee+3];Y.emplace(te++,Ie,ze,Re,Le,0),Y.emplace(te++,Ie,ze,Re,Le,1),Y.emplace(te++,Ie,ze,Re,Le,2),Y.emplace(te++,Ie,ze,Re,Le,3)}(!ks||ks.length<2*L)&&(ks=function(ie){const ge=2*ie,Ee=new u.aX;Ee.resize(ge),Ee._trim();for(let Ie=0;Ie<ge;Ie++){const ze=6*Ie;Ee.uint16[ze+0]=4*Ie+0,Ee.uint16[ze+1]=4*Ie+1,Ee.uint16[ze+2]=4*Ie+2,Ee.uint16[ze+3]=4*Ie+2,Ee.uint16[ze+4]=4*Ie+3,Ee.uint16[ze+5]=4*Ie+0}return Ee}(L));const K=S.createIndexBuffer(ks,!0),me=S.createVertexBuffer(Y,u.aW.members,!0);for(const ie of z){const ge={u_matrix:ie.transform,u_inv_matrix:ie.invTransform,u_camera_to_center_distance:(Se=g.transform).cameraToCenterDistance,u_viewport_size:[Se.width,Se.height]};J.draw(S,E.TRIANGLES,Gt.disabled,En.disabled,g.colorModeForRenderPass(),bn.disabled,ge,g.style.map.terrain&&g.style.map.terrain.getTerrainData(ie.coord),s.id,me,K,u.S.simpleSegment(0,2*ie.circleOffset,ie.circleArray.length,ie.circleArray.length/2),null,g.transform.zoom,null,null,null)}var Se;me.destroy(),K.destroy()}bn.disabled=new bn(!1,1029,2305),bn.backCCW=new bn(!0,1029,2305);const ac=u.ao(new Float32Array(16));function Pl(g,r,s,d,f,_){const{horizontalAlign:b,verticalAlign:S}=u.au(g);return new u.P((-(b-.5)*r/f+d[0])*_,(-(S-.5)*s/f+d[1])*_)}function Al(g,r,s,d,f,_,b,S,E,M,z){const L=g.text.placedSymbolArray,N=g.text.dynamicLayoutVertexArray,J=g.icon.dynamicLayoutVertexArray,Y={};N.clear();for(let te=0;te<L.length;te++){const K=L.get(te),me=K.hidden||!K.crossTileID||g.allowVerticalPlacement&&!K.placedOrientation?null:d[K.crossTileID];if(me){const Se=new u.P(K.anchorX,K.anchorY),ie=gn(Se,s?b:_,z),ge=bi(f.cameraToCenterDistance,ie.signedDistanceFromCamera);let Ee=u.aj(g.textSizeData,E,K)*ge/u.ap;s&&(Ee*=g.tilePixelRatio/S);const{width:Ie,height:ze,anchor:Re,textOffset:Le,textBoxScale:Ve}=me,rt=Pl(Re,Ie,ze,Le,Ve,Ee),Ut=s?gn(Se.add(rt),_,z).point:ie.point.add(r?rt.rotate(-f.angle):rt),Ge=g.allowVerticalPlacement&&K.placedOrientation===u.ai.vertical?Math.PI/2:0;for(let gt=0;gt<K.numGlyphs;gt++)u.ak(N,Ut,Ge);M&&K.associatedIconIndex>=0&&(Y[K.associatedIconIndex]={shiftedAnchor:Ut,angle:Ge})}else Z(K.numGlyphs,N)}if(M){J.clear();const te=g.icon.placedSymbolArray;for(let K=0;K<te.length;K++){const me=te.get(K);if(me.hidden)Z(me.numGlyphs,J);else{const Se=Y[K];if(Se)for(let ie=0;ie<me.numGlyphs;ie++)u.ak(J,Se.shiftedAnchor,Se.angle);else Z(me.numGlyphs,J)}}g.icon.dynamicLayoutVertexBuffer.updateData(J)}g.text.dynamicLayoutVertexBuffer.updateData(N)}function sc(g,r,s){return s.iconsInText&&r?"symbolTextAndIcon":g?"symbolSDF":"symbolIcon"}function zl(g,r,s,d,f,_,b,S,E,M,z,L){const N=g.context,J=N.gl,Y=g.transform,te=S==="map",K=E==="map",me=S!=="viewport"&&s.layout.get("symbol-placement")!=="point",Se=te&&!K&&!me,ie=!s.layout.get("symbol-sort-key").isConstant();let ge=!1;const Ee=g.depthModeForSublayer(0,Gt.ReadOnly),Ie=s._unevaluatedLayout.hasValue("text-variable-anchor")||s._unevaluatedLayout.hasValue("text-variable-anchor-offset"),ze=[];for(const Re of d){const Le=r.getTile(Re),Ve=Le.getBucket(s);if(!Ve)continue;const rt=f?Ve.text:Ve.icon;if(!rt||!rt.segments.get().length||!rt.hasVisibleVertices)continue;const Ut=rt.programConfigurations.get(s.id),Ge=f||Ve.sdfIcons,gt=f?Ve.textSizeData:Ve.iconSizeData,ot=K||Y.pitch!==0,an=g.useProgram(sc(Ge,f,Ve),Ut),Vt=u.ah(gt,Y.zoom),At=g.style.map.terrain&&g.style.map.terrain.getTerrainData(Re);let $t,Rn,pn,gr,nr=[0,0],Nn=null;if(f)Rn=Le.glyphAtlasTexture,pn=J.LINEAR,$t=Le.glyphAtlasTexture.size,Ve.iconsInText&&(nr=Le.imageAtlasTexture.size,Nn=Le.imageAtlasTexture,gr=ot||g.options.rotating||g.options.zooming||gt.kind==="composite"||gt.kind==="camera"?J.LINEAR:J.NEAREST);else{const Fn=s.layout.get("icon-size").constantOr(0)!==1||Ve.iconsNeedLinear;Rn=Le.imageAtlasTexture,pn=Ge||g.options.rotating||g.options.zooming||Fn||ot?J.LINEAR:J.NEAREST,$t=Le.imageAtlasTexture.size}const hi=ne(Le,1,g.transform.zoom),_n=Ne(Re.posMatrix,K,te,g.transform,hi),ao=wi(Re.posMatrix,K,te,g.transform,hi),so=Ie&&Ve.hasTextData(),Jo=s.layout.get("icon-text-fit")!=="none"&&so&&Ve.hasIconData();if(me){const Fn=g.style.map.terrain?(Hr,On)=>g.style.map.terrain.getElevation(Re,Hr,On):null,rr=s.layout.get("text-rotation-alignment")==="map";Ue(Ve,Re.posMatrix,g,f,_n,ao,K,M,rr,Fn)}const ya=g.translatePosMatrix(Re.posMatrix,Le,_,b),Ya=me||f&&Ie||Jo?ac:_n,Tr=g.translatePosMatrix(ao,Le,_,b,!0),yr=Ge&&s.paint.get(f?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let Lr;Lr=Ge?Ve.iconsInText?ca(gt.kind,Vt,Se,K,g,ya,Ya,Tr,$t,nr):Ku(gt.kind,Vt,Se,K,g,ya,Ya,Tr,f,$t,!0):Wu(gt.kind,Vt,Se,K,g,ya,Ya,Tr,f,$t);const _a={program:an,buffers:rt,uniformValues:Lr,atlasTexture:Rn,atlasTextureIcon:Nn,atlasInterpolation:pn,atlasInterpolationIcon:gr,isSDF:Ge,hasHalo:yr};if(ie&&Ve.canOverlap){ge=!0;const Fn=rt.segments.get();for(const rr of Fn)ze.push({segments:new u.S([rr]),sortKey:rr.sortKey,state:_a,terrainData:At})}else ze.push({segments:rt.segments,sortKey:0,state:_a,terrainData:At})}ge&&ze.sort((Re,Le)=>Re.sortKey-Le.sortKey);for(const Re of ze){const Le=Re.state;if(N.activeTexture.set(J.TEXTURE0),Le.atlasTexture.bind(Le.atlasInterpolation,J.CLAMP_TO_EDGE),Le.atlasTextureIcon&&(N.activeTexture.set(J.TEXTURE1),Le.atlasTextureIcon&&Le.atlasTextureIcon.bind(Le.atlasInterpolationIcon,J.CLAMP_TO_EDGE)),Le.isSDF){const Ve=Le.uniformValues;Le.hasHalo&&(Ve.u_is_halo=1,lc(Le.buffers,Re.segments,s,g,Le.program,Ee,z,L,Ve,Re.terrainData)),Ve.u_is_halo=0}lc(Le.buffers,Re.segments,s,g,Le.program,Ee,z,L,Le.uniformValues,Re.terrainData)}}function lc(g,r,s,d,f,_,b,S,E,M){const z=d.context;f.draw(z,z.gl.TRIANGLES,_,b,S,bn.disabled,E,M,s.id,g.layoutVertexBuffer,g.indexBuffer,r,s.paint,d.transform.zoom,g.programConfigurations.get(s.id),g.dynamicLayoutVertexBuffer,g.opacityVertexBuffer)}function Ms(g,r,s,d,f){if(!s||!d||!d.imageAtlas)return;const _=d.imageAtlas.patternPositions;let b=_[s.to.toString()],S=_[s.from.toString()];if(!b&&S&&(b=S),!S&&b&&(S=b),!b||!S){const E=f.getPaintProperty(r);b=_[E],S=_[E]}b&&S&&g.setConstantPatternPositions(b,S)}function Ps(g,r,s,d,f,_,b){const S=g.context.gl,E="fill-pattern",M=s.paint.get(E),z=M&&M.constantOr(1),L=s.getCrossfadeParameters();let N,J,Y,te,K;b?(J=z&&!s.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",N=S.LINES):(J=z?"fillPattern":"fill",N=S.TRIANGLES);const me=M.constantOr(null);for(const Se of d){const ie=r.getTile(Se);if(z&&!ie.patternsLoaded())continue;const ge=ie.getBucket(s);if(!ge)continue;const Ee=ge.programConfigurations.get(s.id),Ie=g.useProgram(J,Ee),ze=g.style.map.terrain&&g.style.map.terrain.getTerrainData(Se);z&&(g.context.activeTexture.set(S.TEXTURE0),ie.imageAtlasTexture.bind(S.LINEAR,S.CLAMP_TO_EDGE),Ee.updatePaintBuffers(L)),Ms(Ee,E,me,ie,s);const Re=ze?Se:null,Le=g.translatePosMatrix(Re?Re.posMatrix:Se.posMatrix,ie,s.paint.get("fill-translate"),s.paint.get("fill-translate-anchor"));if(b){te=ge.indexBuffer2,K=ge.segments2;const Ve=[S.drawingBufferWidth,S.drawingBufferHeight];Y=J==="fillOutlinePattern"&&z?_l(Le,g,L,ie,Ve):yl(Le,Ve)}else te=ge.indexBuffer,K=ge.segments,Y=z?Zu(Le,g,L,ie):id(Le);Ie.draw(g.context,N,f,g.stencilModeForClipping(Se),_,bn.disabled,Y,ze,s.id,ge.layoutVertexBuffer,te,K,s.paint,g.transform.zoom,Ee)}}function As(g,r,s,d,f,_,b){const S=g.context,E=S.gl,M="fill-extrusion-pattern",z=s.paint.get(M),L=z.constantOr(1),N=s.getCrossfadeParameters(),J=s.paint.get("fill-extrusion-opacity"),Y=z.constantOr(null);for(const te of d){const K=r.getTile(te),me=K.getBucket(s);if(!me)continue;const Se=g.style.map.terrain&&g.style.map.terrain.getTerrainData(te),ie=me.programConfigurations.get(s.id),ge=g.useProgram(L?"fillExtrusionPattern":"fillExtrusion",ie);L&&(g.context.activeTexture.set(E.TEXTURE0),K.imageAtlasTexture.bind(E.LINEAR,E.CLAMP_TO_EDGE),ie.updatePaintBuffers(N)),Ms(ie,M,Y,K,s);const Ee=g.translatePosMatrix(te.posMatrix,K,s.paint.get("fill-extrusion-translate"),s.paint.get("fill-extrusion-translate-anchor")),Ie=s.paint.get("fill-extrusion-vertical-gradient"),ze=L?Go(Ee,g,Ie,J,te,N,K):ju(Ee,g,Ie,J);ge.draw(S,S.gl.TRIANGLES,f,_,b,bn.backCCW,ze,Se,s.id,me.layoutVertexBuffer,me.indexBuffer,me.segments,s.paint,g.transform.zoom,ie,g.style.map.terrain&&me.centroidVertexBuffer)}}function Tm(g,r,s,d,f,_,b){const S=g.context,E=S.gl,M=s.fbo;if(!M)return;const z=g.useProgram("hillshade"),L=g.style.map.terrain&&g.style.map.terrain.getTerrainData(r);S.activeTexture.set(E.TEXTURE0),E.bindTexture(E.TEXTURE_2D,M.colorAttachment.get()),z.draw(S,E.TRIANGLES,f,_,b,bn.disabled,((N,J,Y,te)=>{const K=Y.paint.get("hillshade-shadow-color"),me=Y.paint.get("hillshade-highlight-color"),Se=Y.paint.get("hillshade-accent-color");let ie=Y.paint.get("hillshade-illumination-direction")*(Math.PI/180);Y.paint.get("hillshade-illumination-anchor")==="viewport"&&(ie-=N.transform.angle);const ge=!N.options.moving;return{u_matrix:te?te.posMatrix:N.transform.calculatePosMatrix(J.tileID.toUnwrapped(),ge),u_image:0,u_latrange:Gu(0,J.tileID),u_light:[Y.paint.get("hillshade-exaggeration"),ie],u_shadow:K,u_highlight:me,u_accent:Se}})(g,s,d,L?r:null),L,d.id,g.rasterBoundsBuffer,g.quadTriangleIndexBuffer,g.rasterBoundsSegments)}function uc(g,r,s,d,f,_){const b=g.context,S=b.gl,E=r.dem;if(E&&E.data){const M=E.dim,z=E.stride,L=E.getPixels();if(b.activeTexture.set(S.TEXTURE1),b.pixelStoreUnpackPremultiplyAlpha.set(!1),r.demTexture=r.demTexture||g.getTileTexture(z),r.demTexture){const J=r.demTexture;J.update(L,{premultiply:!1}),J.bind(S.NEAREST,S.CLAMP_TO_EDGE)}else r.demTexture=new Oe(b,L,S.RGBA,{premultiply:!1}),r.demTexture.bind(S.NEAREST,S.CLAMP_TO_EDGE);b.activeTexture.set(S.TEXTURE0);let N=r.fbo;if(!N){const J=new Oe(b,{width:M,height:M,data:null},S.RGBA);J.bind(S.LINEAR,S.CLAMP_TO_EDGE),N=r.fbo=b.createFramebuffer(M,M,!0,!1),N.colorAttachment.set(J.texture)}b.bindFramebuffer.set(N.framebuffer),b.viewport.set([0,0,M,M]),g.useProgram("hillshadePrepare").draw(b,S.TRIANGLES,d,f,_,bn.disabled,((J,Y)=>{const te=Y.stride,K=u.Z();return u.aS(K,0,u.N,-u.N,0,0,1),u.$(K,K,[0,-u.N,0]),{u_matrix:K,u_image:1,u_dimension:[te,te],u_zoom:J.overscaledZ,u_unpack:Y.getUnpackVector()}})(r.tileID,E),null,s.id,g.rasterBoundsBuffer,g.quadTriangleIndexBuffer,g.rasterBoundsSegments),r.needsHillshadePrepare=!1}}function Cm(g,r,s,d,f,_){const b=d.paint.get("raster-fade-duration");if(!_&&b>0){const S=u.h.now(),E=(S-g.timeAdded)/b,M=r?(S-r.timeAdded)/b:-1,z=s.getSource(),L=f.coveringZoomLevel({tileSize:z.tileSize,roundZoom:z.roundZoom}),N=!r||Math.abs(r.tileID.overscaledZ-L)>Math.abs(g.tileID.overscaledZ-L),J=N&&g.refreshedUponExpiration?1:u.ad(N?E:1-M,0,1);return g.refreshedUponExpiration&&E>=1&&(g.refreshedUponExpiration=!1),r?{opacity:1,mix:1-J}:{opacity:J,mix:0}}return{opacity:1,mix:0}}const _d=new u.aT(1,0,0,1),Dl=new u.aT(0,1,0,1),cc=new u.aT(0,0,1,1),vd=new u.aT(1,0,1,1),xd=new u.aT(0,1,1,1);function zs(g,r,s,d){Rl(g,0,r+s/2,g.transform.width,s,d)}function Ll(g,r,s,d){Rl(g,r-s/2,0,s,g.transform.height,d)}function Rl(g,r,s,d,f,_){const b=g.context,S=b.gl;S.enable(S.SCISSOR_TEST),S.scissor(r*g.pixelRatio,s*g.pixelRatio,d*g.pixelRatio,f*g.pixelRatio),b.clear({color:_}),S.disable(S.SCISSOR_TEST)}function wd(g,r,s){const d=g.context,f=d.gl,_=s.posMatrix,b=g.useProgram("debug"),S=Gt.disabled,E=En.disabled,M=g.colorModeForRenderPass(),z="$debug",L=g.style.map.terrain&&g.style.map.terrain.getTerrainData(s);d.activeTexture.set(f.TEXTURE0);const N=r.getTileByID(s.key).latestRawTileData,J=Math.floor((N&&N.byteLength||0)/1024),Y=r.getTile(s).tileSize,te=512/Math.min(Y,512)*(s.overscaledZ/g.transform.zoom)*.5;let K=s.canonical.toString();s.overscaledZ!==s.canonical.z&&(K+=` => ${s.overscaledZ}`),function(me,Se){me.initDebugOverlayCanvas();const ie=me.debugOverlayCanvas,ge=me.context.gl,Ee=me.debugOverlayCanvas.getContext("2d");Ee.clearRect(0,0,ie.width,ie.height),Ee.shadowColor="white",Ee.shadowBlur=2,Ee.lineWidth=1.5,Ee.strokeStyle="white",Ee.textBaseline="top",Ee.font="bold 36px Open Sans, sans-serif",Ee.fillText(Se,5,5),Ee.strokeText(Se,5,5),me.debugOverlayTexture.update(ie),me.debugOverlayTexture.bind(ge.LINEAR,ge.CLAMP_TO_EDGE)}(g,`${K} ${J}kB`),b.draw(d,f.TRIANGLES,S,E,Cn.alphaBlended,bn.disabled,Es(_,u.aT.transparent,te),null,z,g.debugBuffer,g.quadTriangleIndexBuffer,g.debugSegments),b.draw(d,f.LINE_STRIP,S,E,M,bn.disabled,Es(_,u.aT.red),L,z,g.debugBuffer,g.tileBorderIndexBuffer,g.debugSegments)}function An(g,r,s){const d=g.context,f=d.gl,_=g.colorModeForRenderPass(),b=new Gt(f.LEQUAL,Gt.ReadWrite,g.depthRangeFor3D),S=g.useProgram("terrain"),E=r.getTerrainMesh();d.bindFramebuffer.set(null),d.viewport.set([0,0,g.width,g.height]);for(const M of s){const z=g.renderToTexture.getTexture(M),L=r.getTerrainData(M.tileID);d.activeTexture.set(f.TEXTURE0),f.bindTexture(f.TEXTURE_2D,z.texture);const N={u_matrix:g.transform.calculatePosMatrix(M.tileID.toUnwrapped()),u_texture:0,u_ele_delta:r.getMeshFrameDelta(g.transform.zoom)};S.draw(d,f.TRIANGLES,b,En.disabled,_,bn.backCCW,N,L,"terrain",E.vertexBuffer,E.indexBuffer,E.segments)}}class pa{constructor(r,s){this.context=new Sm(r),this.transform=s,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:u.Z(),renderTime:0},this.setup(),this.numSublayers=Hn.maxUnderzooming+Hn.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new fl}resize(r,s,d){if(this.width=Math.floor(r*d),this.height=Math.floor(s*d),this.pixelRatio=d,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const f of this.style._order)this.style._layers[f].resize()}setup(){const r=this.context,s=new u.a_;s.emplaceBack(0,0),s.emplaceBack(u.N,0),s.emplaceBack(0,u.N),s.emplaceBack(u.N,u.N),this.tileExtentBuffer=r.createVertexBuffer(s,ml.members),this.tileExtentSegments=u.S.simpleSegment(0,0,4,2);const d=new u.a_;d.emplaceBack(0,0),d.emplaceBack(u.N,0),d.emplaceBack(0,u.N),d.emplaceBack(u.N,u.N),this.debugBuffer=r.createVertexBuffer(d,ml.members),this.debugSegments=u.S.simpleSegment(0,0,4,5);const f=new u.V;f.emplaceBack(0,0,0,0),f.emplaceBack(u.N,0,u.N,0),f.emplaceBack(0,u.N,0,u.N),f.emplaceBack(u.N,u.N,u.N,u.N),this.rasterBoundsBuffer=r.createVertexBuffer(f,qn.members),this.rasterBoundsSegments=u.S.simpleSegment(0,0,4,2);const _=new u.a_;_.emplaceBack(0,0),_.emplaceBack(1,0),_.emplaceBack(0,1),_.emplaceBack(1,1),this.viewportBuffer=r.createVertexBuffer(_,ml.members),this.viewportSegments=u.S.simpleSegment(0,0,4,2);const b=new u.a$;b.emplaceBack(0),b.emplaceBack(1),b.emplaceBack(3),b.emplaceBack(2),b.emplaceBack(0),this.tileBorderIndexBuffer=r.createIndexBuffer(b);const S=new u.b0;S.emplaceBack(0,1,2),S.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=r.createIndexBuffer(S);const E=this.context.gl;this.stencilClearMode=new En({func:E.ALWAYS,mask:0},0,255,E.ZERO,E.ZERO,E.ZERO)}clearStencil(){const r=this.context,s=r.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const d=u.Z();u.aS(d,0,this.width,this.height,0,0,1),u.a0(d,d,[s.drawingBufferWidth,s.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(r,s.TRIANGLES,Gt.disabled,this.stencilClearMode,Cn.disabled,bn.disabled,od(d),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(r,s){if(this.currentStencilSource===r.source||!r.isTileClipped()||!s||!s.length)return;this.currentStencilSource=r.source;const d=this.context,f=d.gl;this.nextStencilID+s.length>256&&this.clearStencil(),d.setColorMode(Cn.disabled),d.setDepthMode(Gt.disabled);const _=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const b of s){const S=this._tileClippingMaskIDs[b.key]=this.nextStencilID++,E=this.style.map.terrain&&this.style.map.terrain.getTerrainData(b);_.draw(d,f.TRIANGLES,Gt.disabled,new En({func:f.ALWAYS,mask:0},S,255,f.KEEP,f.KEEP,f.REPLACE),Cn.disabled,bn.disabled,od(b.posMatrix),E,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const r=this.nextStencilID++,s=this.context.gl;return new En({func:s.NOTEQUAL,mask:255},r,255,s.KEEP,s.KEEP,s.REPLACE)}stencilModeForClipping(r){const s=this.context.gl;return new En({func:s.EQUAL,mask:255},this._tileClippingMaskIDs[r.key],0,s.KEEP,s.KEEP,s.REPLACE)}stencilConfigForOverlap(r){const s=this.context.gl,d=r.sort((b,S)=>S.overscaledZ-b.overscaledZ),f=d[d.length-1].overscaledZ,_=d[0].overscaledZ-f+1;if(_>1){this.currentStencilSource=void 0,this.nextStencilID+_>256&&this.clearStencil();const b={};for(let S=0;S<_;S++)b[S+f]=new En({func:s.GEQUAL,mask:255},S+this.nextStencilID,255,s.KEEP,s.KEEP,s.REPLACE);return this.nextStencilID+=_,[b,d]}return[{[f]:En.disabled},d]}colorModeForRenderPass(){const r=this.context.gl;return this._showOverdrawInspector?new Cn([r.CONSTANT_COLOR,r.ONE],new u.aT(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Cn.unblended:Cn.alphaBlended}depthModeForSublayer(r,s,d){if(!this.opaquePassEnabledForLayer())return Gt.disabled;const f=1-((1+this.currentLayer)*this.numSublayers+r)*this.depthEpsilon;return new Gt(d||this.context.gl.LEQUAL,s,[f,f])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(r,s){this.style=r,this.options=s,this.lineAtlas=r.lineAtlas,this.imageManager=r.imageManager,this.glyphManager=r.glyphManager,this.symbolFadeChange=r.placement.symbolFadeChange(u.h.now()),this.imageManager.beginFrame();const d=this.style._order,f=this.style.sourceCaches,_={},b={},S={};for(const E in f){const M=f[E];M.used&&M.prepare(this.context),_[E]=M.getVisibleCoordinates(),b[E]=_[E].slice().reverse(),S[E]=M.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let E=0;E<d.length;E++)if(this.style._layers[d[E]].is3D()){this.opaquePassCutoff=E;break}if(this.renderToTexture){this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0;const E=this.style.map.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime);(this.terrainFacilitator.dirty||!u.b1(this.terrainFacilitator.matrix,this.transform.projMatrix)||E.length)&&(u.b2(this.terrainFacilitator.matrix,this.transform.projMatrix),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(M,z){const L=M.context,N=L.gl,J=Cn.unblended,Y=new Gt(N.LEQUAL,Gt.ReadWrite,[0,1]),te=z.getTerrainMesh(),K=z.sourceCache.getRenderableTiles(),me=M.useProgram("terrainDepth");L.bindFramebuffer.set(z.getFramebuffer("depth").framebuffer),L.viewport.set([0,0,M.width/devicePixelRatio,M.height/devicePixelRatio]),L.clear({color:u.aT.transparent,depth:1});for(const Se of K){const ie=z.getTerrainData(Se.tileID),ge={u_matrix:M.transform.calculatePosMatrix(Se.tileID.toUnwrapped()),u_ele_delta:z.getMeshFrameDelta(M.transform.zoom)};me.draw(L,N.TRIANGLES,Y,En.disabled,J,bn.backCCW,ge,ie,"terrain",te.vertexBuffer,te.indexBuffer,te.segments)}L.bindFramebuffer.set(null),L.viewport.set([0,0,M.width,M.height])}(this,this.style.map.terrain),function(M,z){const L=M.context,N=L.gl,J=Cn.unblended,Y=new Gt(N.LEQUAL,Gt.ReadWrite,[0,1]),te=z.getTerrainMesh(),K=z.getCoordsTexture(),me=z.sourceCache.getRenderableTiles(),Se=M.useProgram("terrainCoords");L.bindFramebuffer.set(z.getFramebuffer("coords").framebuffer),L.viewport.set([0,0,M.width/devicePixelRatio,M.height/devicePixelRatio]),L.clear({color:u.aT.transparent,depth:1}),z.coordsIndex=[];for(const ie of me){const ge=z.getTerrainData(ie.tileID);L.activeTexture.set(N.TEXTURE0),N.bindTexture(N.TEXTURE_2D,K.texture);const Ee={u_matrix:M.transform.calculatePosMatrix(ie.tileID.toUnwrapped()),u_terrain_coords_id:(255-z.coordsIndex.length)/255,u_texture:0,u_ele_delta:z.getMeshFrameDelta(M.transform.zoom)};Se.draw(L,N.TRIANGLES,Y,En.disabled,J,bn.backCCW,Ee,ge,"terrain",te.vertexBuffer,te.indexBuffer,te.segments),z.coordsIndex.push(ie.tileID.key)}L.bindFramebuffer.set(null),L.viewport.set([0,0,M.width,M.height])}(this,this.style.map.terrain))}this.renderPass="offscreen";for(const E of d){const M=this.style._layers[E];if(!M.hasOffscreenPass()||M.isHidden(this.transform.zoom))continue;const z=b[M.source];(M.type==="custom"||z.length)&&this.renderLayer(this,f[M.source],M,z)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:s.showOverdrawInspector?u.aT.black:u.aT.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=s.showOverdrawInspector,this.depthRangeFor3D=[0,1-(r._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=d.length-1;this.currentLayer>=0;this.currentLayer--){const E=this.style._layers[d[this.currentLayer]],M=f[E.source],z=_[E.source];this._renderTileClippingMasks(E,z),this.renderLayer(this,M,E,z)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<d.length;this.currentLayer++){const E=this.style._layers[d[this.currentLayer]],M=f[E.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(E))continue;const z=(E.type==="symbol"?S:b)[E.source];this._renderTileClippingMasks(E,_[E.source]),this.renderLayer(this,M,E,z)}if(this.options.showTileBoundaries){const E=function(M,z){let L=null;const N=Object.values(M._layers).flatMap(K=>K.source&&!K.isHidden(z)?[M.sourceCaches[K.source]]:[]),J=N.filter(K=>K.getSource().type==="vector"),Y=N.filter(K=>K.getSource().type!=="vector"),te=K=>{(!L||L.getSource().maxzoom<K.getSource().maxzoom)&&(L=K)};return J.forEach(K=>te(K)),L||Y.forEach(K=>te(K)),L}(this.style,this.transform.zoom);E&&function(M,z,L){for(let N=0;N<L.length;N++)wd(M,z,L[N])}(this,E,E.getVisibleCoordinates())}this.options.showPadding&&function(E){const M=E.transform.padding;zs(E,E.transform.height-(M.top||0),3,_d),zs(E,M.bottom||0,3,Dl),Ll(E,M.left||0,3,cc),Ll(E,E.transform.width-(M.right||0),3,vd);const z=E.transform.centerPoint;(function(L,N,J,Y){Rl(L,N-1,J-10,2,20,Y),Rl(L,N-10,J-1,20,2,Y)})(E,z.x,E.transform.height-z.y,xd)}(this),this.context.setDefault()}renderLayer(r,s,d,f){if(!d.isHidden(this.transform.zoom)&&(d.type==="background"||d.type==="custom"||(f||[]).length))switch(this.id=d.id,d.type){case"symbol":(function(_,b,S,E,M){if(_.renderPass!=="translucent")return;const z=En.disabled,L=_.colorModeForRenderPass();(S._unevaluatedLayout.hasValue("text-variable-anchor")||S._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(N,J,Y,te,K,me,Se){const ie=J.transform,ge=K==="map",Ee=me==="map";for(const Ie of N){const ze=te.getTile(Ie),Re=ze.getBucket(Y);if(!Re||!Re.text||!Re.text.segments.get().length)continue;const Le=u.ah(Re.textSizeData,ie.zoom),Ve=ne(ze,1,J.transform.zoom),rt=Ne(Ie.posMatrix,Ee,ge,J.transform,Ve),Ut=Y.layout.get("icon-text-fit")!=="none"&&Re.hasIconData();if(Le){const Ge=Math.pow(2,ie.zoom-ze.tileID.overscaledZ);Al(Re,ge,Ee,Se,ie,rt,Ie.posMatrix,Ge,Le,Ut,J.style.map.terrain?(gt,ot)=>J.style.map.terrain.getElevation(Ie,gt,ot):null)}}}(E,_,S,b,S.layout.get("text-rotation-alignment"),S.layout.get("text-pitch-alignment"),M),S.paint.get("icon-opacity").constantOr(1)!==0&&zl(_,b,S,E,!1,S.paint.get("icon-translate"),S.paint.get("icon-translate-anchor"),S.layout.get("icon-rotation-alignment"),S.layout.get("icon-pitch-alignment"),S.layout.get("icon-keep-upright"),z,L),S.paint.get("text-opacity").constantOr(1)!==0&&zl(_,b,S,E,!0,S.paint.get("text-translate"),S.paint.get("text-translate-anchor"),S.layout.get("text-rotation-alignment"),S.layout.get("text-pitch-alignment"),S.layout.get("text-keep-upright"),z,L),b.map.showCollisionBoxes&&(yd(_,b,S,E,S.paint.get("text-translate"),S.paint.get("text-translate-anchor"),!0),yd(_,b,S,E,S.paint.get("icon-translate"),S.paint.get("icon-translate-anchor"),!1))})(r,s,d,f,this.style.placement.variableOffsets);break;case"circle":(function(_,b,S,E){if(_.renderPass!=="translucent")return;const M=S.paint.get("circle-opacity"),z=S.paint.get("circle-stroke-width"),L=S.paint.get("circle-stroke-opacity"),N=!S.layout.get("circle-sort-key").isConstant();if(M.constantOr(1)===0&&(z.constantOr(1)===0||L.constantOr(1)===0))return;const J=_.context,Y=J.gl,te=_.depthModeForSublayer(0,Gt.ReadOnly),K=En.disabled,me=_.colorModeForRenderPass(),Se=[];for(let ie=0;ie<E.length;ie++){const ge=E[ie],Ee=b.getTile(ge),Ie=Ee.getBucket(S);if(!Ie)continue;const ze=Ie.programConfigurations.get(S.id),Re=_.useProgram("circle",ze),Le=Ie.layoutVertexBuffer,Ve=Ie.indexBuffer,rt=_.style.map.terrain&&_.style.map.terrain.getTerrainData(ge),Ut={programConfiguration:ze,program:Re,layoutVertexBuffer:Le,indexBuffer:Ve,uniformValues:Ho(_,ge,Ee,S),terrainData:rt};if(N){const Ge=Ie.segments.get();for(const gt of Ge)Se.push({segments:new u.S([gt]),sortKey:gt.sortKey,state:Ut})}else Se.push({segments:Ie.segments,sortKey:0,state:Ut})}N&&Se.sort((ie,ge)=>ie.sortKey-ge.sortKey);for(const ie of Se){const{programConfiguration:ge,program:Ee,layoutVertexBuffer:Ie,indexBuffer:ze,uniformValues:Re,terrainData:Le}=ie.state;Ee.draw(J,Y.TRIANGLES,te,K,me,bn.disabled,Re,Le,S.id,Ie,ze,ie.segments,S.paint,_.transform.zoom,ge)}})(r,s,d,f);break;case"heatmap":(function(_,b,S,E){if(S.paint.get("heatmap-opacity")!==0)if(_.renderPass==="offscreen"){const M=_.context,z=M.gl,L=En.disabled,N=new Cn([z.ONE,z.ONE],u.aT.transparent,[!0,!0,!0,!0]);(function(J,Y,te){const K=J.gl;J.activeTexture.set(K.TEXTURE1),J.viewport.set([0,0,Y.width/4,Y.height/4]);let me=te.heatmapFbo;if(me)K.bindTexture(K.TEXTURE_2D,me.colorAttachment.get()),J.bindFramebuffer.set(me.framebuffer);else{const Se=K.createTexture();K.bindTexture(K.TEXTURE_2D,Se),K.texParameteri(K.TEXTURE_2D,K.TEXTURE_WRAP_S,K.CLAMP_TO_EDGE),K.texParameteri(K.TEXTURE_2D,K.TEXTURE_WRAP_T,K.CLAMP_TO_EDGE),K.texParameteri(K.TEXTURE_2D,K.TEXTURE_MIN_FILTER,K.LINEAR),K.texParameteri(K.TEXTURE_2D,K.TEXTURE_MAG_FILTER,K.LINEAR),me=te.heatmapFbo=J.createFramebuffer(Y.width/4,Y.height/4,!1,!1),function(ie,ge,Ee,Ie){var ze,Re;const Le=ie.gl,Ve=(ze=ie.HALF_FLOAT)!==null&&ze!==void 0?ze:Le.UNSIGNED_BYTE,rt=(Re=ie.RGBA16F)!==null&&Re!==void 0?Re:Le.RGBA;Le.texImage2D(Le.TEXTURE_2D,0,rt,ge.width/4,ge.height/4,0,Le.RGBA,Ve,null),Ie.colorAttachment.set(Ee)}(J,Y,Se,me)}})(M,_,S),M.clear({color:u.aT.transparent});for(let J=0;J<E.length;J++){const Y=E[J];if(b.hasRenderableParent(Y))continue;const te=b.getTile(Y),K=te.getBucket(S);if(!K)continue;const me=K.programConfigurations.get(S.id),Se=_.useProgram("heatmap",me),{zoom:ie}=_.transform;Se.draw(M,z.TRIANGLES,Gt.disabled,L,N,bn.disabled,mm(Y.posMatrix,te,ie,S.paint.get("heatmap-intensity")),null,S.id,K.layoutVertexBuffer,K.indexBuffer,K.segments,S.paint,_.transform.zoom,me)}M.viewport.set([0,0,_.width,_.height])}else _.renderPass==="translucent"&&(_.context.setColorMode(_.colorModeForRenderPass()),function(M,z){const L=M.context,N=L.gl,J=z.heatmapFbo;if(!J)return;L.activeTexture.set(N.TEXTURE0),N.bindTexture(N.TEXTURE_2D,J.colorAttachment.get()),L.activeTexture.set(N.TEXTURE1);let Y=z.colorRampTexture;Y||(Y=z.colorRampTexture=new Oe(L,z.colorRamp,N.RGBA)),Y.bind(N.LINEAR,N.CLAMP_TO_EDGE),M.useProgram("heatmapTexture").draw(L,N.TRIANGLES,Gt.disabled,En.disabled,M.colorModeForRenderPass(),bn.disabled,((te,K,me,Se)=>{const ie=u.Z();u.aS(ie,0,te.width,te.height,0,0,1);const ge=te.context.gl;return{u_matrix:ie,u_world:[ge.drawingBufferWidth,ge.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:K.paint.get("heatmap-opacity")}})(M,z),null,z.id,M.viewportBuffer,M.quadTriangleIndexBuffer,M.viewportSegments,z.paint,M.transform.zoom)}(_,S))})(r,s,d,f);break;case"line":(function(_,b,S,E){if(_.renderPass!=="translucent")return;const M=S.paint.get("line-opacity"),z=S.paint.get("line-width");if(M.constantOr(1)===0||z.constantOr(1)===0)return;const L=_.depthModeForSublayer(0,Gt.ReadOnly),N=_.colorModeForRenderPass(),J=S.paint.get("line-dasharray"),Y=S.paint.get("line-pattern"),te=Y.constantOr(1),K=S.paint.get("line-gradient"),me=S.getCrossfadeParameters(),Se=te?"linePattern":J?"lineSDF":K?"lineGradient":"line",ie=_.context,ge=ie.gl;let Ee=!0;for(const Ie of E){const ze=b.getTile(Ie);if(te&&!ze.patternsLoaded())continue;const Re=ze.getBucket(S);if(!Re)continue;const Le=Re.programConfigurations.get(S.id),Ve=_.context.program.get(),rt=_.useProgram(Se,Le),Ut=Ee||rt.program!==Ve,Ge=_.style.map.terrain&&_.style.map.terrain.getTerrainData(Ie),gt=Y.constantOr(null);if(gt&&ze.imageAtlas){const Vt=ze.imageAtlas,At=Vt.patternPositions[gt.to.toString()],$t=Vt.patternPositions[gt.from.toString()];At&&$t&&Le.setConstantPatternPositions(At,$t)}const ot=Ge?Ie:null,an=te?gm(_,ze,S,me,ot):J?sd(_,ze,S,J,me,ot):K?ad(_,ze,S,Re.lineClipsArray.length,ot):Hu(_,ze,S,ot);if(te)ie.activeTexture.set(ge.TEXTURE0),ze.imageAtlasTexture.bind(ge.LINEAR,ge.CLAMP_TO_EDGE),Le.updatePaintBuffers(me);else if(J&&(Ut||_.lineAtlas.dirty))ie.activeTexture.set(ge.TEXTURE0),_.lineAtlas.bind(ie);else if(K){const Vt=Re.gradients[S.id];let At=Vt.texture;if(S.gradientVersion!==Vt.version){let $t=256;if(S.stepInterpolant){const Rn=b.getSource().maxzoom,pn=Ie.canonical.z===Rn?Math.ceil(1<<_.transform.maxZoom-Ie.canonical.z):1;$t=u.ad(u.aY(Re.maxLineLength/u.N*1024*pn),256,ie.maxTextureSize)}Vt.gradient=u.aZ({expression:S.gradientExpression(),evaluationKey:"lineProgress",resolution:$t,image:Vt.gradient||void 0,clips:Re.lineClipsArray}),Vt.texture?Vt.texture.update(Vt.gradient):Vt.texture=new Oe(ie,Vt.gradient,ge.RGBA),Vt.version=S.gradientVersion,At=Vt.texture}ie.activeTexture.set(ge.TEXTURE0),At.bind(S.stepInterpolant?ge.NEAREST:ge.LINEAR,ge.CLAMP_TO_EDGE)}rt.draw(ie,ge.TRIANGLES,L,_.stencilModeForClipping(Ie),N,bn.disabled,an,Ge,S.id,Re.layoutVertexBuffer,Re.indexBuffer,Re.segments,S.paint,_.transform.zoom,Le,Re.layoutVertexBuffer2),Ee=!1}})(r,s,d,f);break;case"fill":(function(_,b,S,E){const M=S.paint.get("fill-color"),z=S.paint.get("fill-opacity");if(z.constantOr(1)===0)return;const L=_.colorModeForRenderPass(),N=S.paint.get("fill-pattern"),J=_.opaquePassEnabledForLayer()&&!N.constantOr(1)&&M.constantOr(u.aT.transparent).a===1&&z.constantOr(0)===1?"opaque":"translucent";if(_.renderPass===J){const Y=_.depthModeForSublayer(1,_.renderPass==="opaque"?Gt.ReadWrite:Gt.ReadOnly);Ps(_,b,S,E,Y,L,!1)}if(_.renderPass==="translucent"&&S.paint.get("fill-antialias")){const Y=_.depthModeForSublayer(S.getPaintProperty("fill-outline-color")?2:0,Gt.ReadOnly);Ps(_,b,S,E,Y,L,!0)}})(r,s,d,f);break;case"fill-extrusion":(function(_,b,S,E){const M=S.paint.get("fill-extrusion-opacity");if(M!==0&&_.renderPass==="translucent"){const z=new Gt(_.context.gl.LEQUAL,Gt.ReadWrite,_.depthRangeFor3D);if(M!==1||S.paint.get("fill-extrusion-pattern").constantOr(1))As(_,b,S,E,z,En.disabled,Cn.disabled),As(_,b,S,E,z,_.stencilModeFor3D(),_.colorModeForRenderPass());else{const L=_.colorModeForRenderPass();As(_,b,S,E,z,En.disabled,L)}}})(r,s,d,f);break;case"hillshade":(function(_,b,S,E){if(_.renderPass!=="offscreen"&&_.renderPass!=="translucent")return;const M=_.context,z=_.depthModeForSublayer(0,Gt.ReadOnly),L=_.colorModeForRenderPass(),[N,J]=_.renderPass==="translucent"?_.stencilConfigForOverlap(E):[{},E];for(const Y of J){const te=b.getTile(Y);te.needsHillshadePrepare!==void 0&&te.needsHillshadePrepare&&_.renderPass==="offscreen"?uc(_,te,S,z,En.disabled,L):_.renderPass==="translucent"&&Tm(_,Y,te,S,z,N[Y.overscaledZ],L)}M.viewport.set([0,0,_.width,_.height])})(r,s,d,f);break;case"raster":(function(_,b,S,E){if(_.renderPass!=="translucent"||S.paint.get("raster-opacity")===0||!E.length)return;const M=_.context,z=M.gl,L=b.getSource(),N=_.useProgram("raster"),J=_.colorModeForRenderPass(),[Y,te]=L instanceof tr?[{},E]:_.stencilConfigForOverlap(E),K=te[te.length-1].overscaledZ,me=!_.options.moving;for(const Se of te){const ie=_.depthModeForSublayer(Se.overscaledZ-K,S.paint.get("raster-opacity")===1?Gt.ReadWrite:Gt.ReadOnly,z.LESS),ge=b.getTile(Se);ge.registerFadeDuration(S.paint.get("raster-fade-duration"));const Ee=b.findLoadedParent(Se,0),Ie=Cm(ge,Ee,b,S,_.transform,_.style.map.terrain);let ze,Re;const Le=S.paint.get("raster-resampling")==="nearest"?z.NEAREST:z.LINEAR;M.activeTexture.set(z.TEXTURE0),ge.texture.bind(Le,z.CLAMP_TO_EDGE,z.LINEAR_MIPMAP_NEAREST),M.activeTexture.set(z.TEXTURE1),Ee?(Ee.texture.bind(Le,z.CLAMP_TO_EDGE,z.LINEAR_MIPMAP_NEAREST),ze=Math.pow(2,Ee.tileID.overscaledZ-ge.tileID.overscaledZ),Re=[ge.tileID.canonical.x*ze%1,ge.tileID.canonical.y*ze%1]):ge.texture.bind(Le,z.CLAMP_TO_EDGE,z.LINEAR_MIPMAP_NEAREST);const Ve=_.style.map.terrain&&_.style.map.terrain.getTerrainData(Se),rt=Ve?Se:null,Ut=rt?rt.posMatrix:_.transform.calculatePosMatrix(Se.toUnwrapped(),me),Ge=ud(Ut,Re||[0,0],ze||1,Ie,S);L instanceof tr?N.draw(M,z.TRIANGLES,ie,En.disabled,J,bn.disabled,Ge,Ve,S.id,L.boundsBuffer,_.quadTriangleIndexBuffer,L.boundsSegments):N.draw(M,z.TRIANGLES,ie,Y[Se.overscaledZ],J,bn.disabled,Ge,Ve,S.id,_.rasterBoundsBuffer,_.quadTriangleIndexBuffer,_.rasterBoundsSegments)}})(r,s,d,f);break;case"background":(function(_,b,S,E){const M=S.paint.get("background-color"),z=S.paint.get("background-opacity");if(z===0)return;const L=_.context,N=L.gl,J=_.transform,Y=J.tileSize,te=S.paint.get("background-pattern");if(_.isPatternMissing(te))return;const K=!te&&M.a===1&&z===1&&_.opaquePassEnabledForLayer()?"opaque":"translucent";if(_.renderPass!==K)return;const me=En.disabled,Se=_.depthModeForSublayer(0,K==="opaque"?Gt.ReadWrite:Gt.ReadOnly),ie=_.colorModeForRenderPass(),ge=_.useProgram(te?"backgroundPattern":"background"),Ee=E||J.coveringTiles({tileSize:Y,terrain:_.style.map.terrain});te&&(L.activeTexture.set(N.TEXTURE0),_.imageManager.bind(_.context));const Ie=S.getCrossfadeParameters();for(const ze of Ee){const Re=E?ze.posMatrix:_.transform.calculatePosMatrix(ze.toUnwrapped()),Le=te?Ei(Re,z,_,te,{tileID:ze,tileSize:Y},Ie):xl(Re,z,M),Ve=_.style.map.terrain&&_.style.map.terrain.getTerrainData(ze);ge.draw(L,N.TRIANGLES,Se,me,ie,bn.disabled,Le,Ve,S.id,_.tileExtentBuffer,_.quadTriangleIndexBuffer,_.tileExtentSegments)}})(r,0,d,f);break;case"custom":(function(_,b,S){const E=_.context,M=S.implementation;if(_.renderPass==="offscreen"){const z=M.prerender;z&&(_.setCustomLayerDefaults(),E.setColorMode(_.colorModeForRenderPass()),z.call(M,E.gl,_.transform.customLayerMatrix()),E.setDirty(),_.setBaseState())}else if(_.renderPass==="translucent"){_.setCustomLayerDefaults(),E.setColorMode(_.colorModeForRenderPass()),E.setStencilMode(En.disabled);const z=M.renderingMode==="3d"?new Gt(_.context.gl.LEQUAL,Gt.ReadWrite,_.depthRangeFor3D):_.depthModeForSublayer(0,Gt.ReadOnly);E.setDepthMode(z),M.render(E.gl,_.transform.customLayerMatrix()),E.setDirty(),_.setBaseState(),E.bindFramebuffer.set(null)}})(r,0,d)}}translatePosMatrix(r,s,d,f,_){if(!d[0]&&!d[1])return r;const b=_?f==="map"?this.transform.angle:0:f==="viewport"?-this.transform.angle:0;if(b){const M=Math.sin(b),z=Math.cos(b);d=[d[0]*z-d[1]*M,d[0]*M+d[1]*z]}const S=[_?d[0]:ne(s,d[0],this.transform.zoom),_?d[1]:ne(s,d[1],this.transform.zoom),0],E=new Float32Array(16);return u.$(E,r,S),E}saveTileTexture(r){const s=this._tileTextures[r.size[0]];s?s.push(r):this._tileTextures[r.size[0]]=[r]}getTileTexture(r){const s=this._tileTextures[r];return s&&s.length>0?s.pop():null}isPatternMissing(r){if(!r)return!1;if(!r.from||!r.to)return!0;const s=this.imageManager.getPattern(r.from.toString()),d=this.imageManager.getPattern(r.to.toString());return!s||!d}useProgram(r,s){this.cache=this.cache||{};const d=r+(s?s.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.map.terrain?"/terrain":"");return this.cache[d]||(this.cache[d]=new gl(this.context,Tn[r],s,wl[r],this._showOverdrawInspector,this.style.map.terrain)),this.cache[d]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const r=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(r.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new Oe(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:r,drawingBufferHeight:s}=this.context.gl;return this.width!==r||this.height!==s}}class qr{constructor(r,s){this.points=r,this.planes=s}static fromInvProjectionMatrix(r,s,d){const f=Math.pow(2,d),_=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(S=>{const E=1/(S=u.ag([],S,r))[3]/s*f;return u.b3(S,S,[E,E,1/S[3],E])}),b=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(S=>{const E=function(N,J){var Y=J[0],te=J[1],K=J[2],me=Y*Y+te*te+K*K;return me>0&&(me=1/Math.sqrt(me)),N[0]=J[0]*me,N[1]=J[1]*me,N[2]=J[2]*me,N}([],function(N,J,Y){var te=J[0],K=J[1],me=J[2],Se=Y[0],ie=Y[1],ge=Y[2];return N[0]=K*ge-me*ie,N[1]=me*Se-te*ge,N[2]=te*ie-K*Se,N}([],de([],_[S[0]],_[S[1]]),de([],_[S[2]],_[S[1]]))),M=-((z=E)[0]*(L=_[S[1]])[0]+z[1]*L[1]+z[2]*L[2]);var z,L;return E.concat(M)});return new qr(_,b)}}class qa{constructor(r,s){this.min=r,this.max=s,this.center=function(d,f,_){return d[0]=.5*f[0],d[1]=.5*f[1],d[2]=.5*f[2],d}([],function(d,f,_){return d[0]=f[0]+_[0],d[1]=f[1]+_[1],d[2]=f[2]+_[2],d}([],this.min,this.max))}quadrant(r){const s=[r%2==0,r<2],d=_e(this.min),f=_e(this.max);for(let _=0;_<s.length;_++)d[_]=s[_]?this.min[_]:this.center[_],f[_]=s[_]?this.center[_]:this.max[_];return f[2]=this.max[2],new qa(d,f)}distanceX(r){return Math.max(Math.min(this.max[0],r[0]),this.min[0])-r[0]}distanceY(r){return Math.max(Math.min(this.max[1],r[1]),this.min[1])-r[1]}intersects(r){const s=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let d=!0;for(let f=0;f<r.planes.length;f++){const _=r.planes[f];let b=0;for(let S=0;S<s.length;S++)u.b4(_,s[S])>=0&&b++;if(b===0)return 0;b!==s.length&&(d=!1)}if(d)return 2;for(let f=0;f<3;f++){let _=Number.MAX_VALUE,b=-Number.MAX_VALUE;for(let S=0;S<r.points.length;S++){const E=r.points[S][f]-this.min[f];_=Math.min(_,E),b=Math.max(b,E)}if(b<0||_>this.max[f]-this.min[f])return 0}return 1}}class Ds{constructor(r=0,s=0,d=0,f=0){if(isNaN(r)||r<0||isNaN(s)||s<0||isNaN(d)||d<0||isNaN(f)||f<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=r,this.bottom=s,this.left=d,this.right=f}interpolate(r,s,d){return s.top!=null&&r.top!=null&&(this.top=u.B.number(r.top,s.top,d)),s.bottom!=null&&r.bottom!=null&&(this.bottom=u.B.number(r.bottom,s.bottom,d)),s.left!=null&&r.left!=null&&(this.left=u.B.number(r.left,s.left,d)),s.right!=null&&r.right!=null&&(this.right=u.B.number(r.right,s.right,d)),this}getCenter(r,s){const d=u.ad((this.left+r-this.right)/2,0,r),f=u.ad((this.top+s-this.bottom)/2,0,s);return new u.P(d,f)}equals(r){return this.top===r.top&&this.bottom===r.bottom&&this.left===r.left&&this.right===r.right}clone(){return new Ds(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}class Fl{constructor(r,s,d,f,_){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=_===void 0||!!_,this._minZoom=r||0,this._maxZoom=s||22,this._minPitch=d??0,this._maxPitch=f??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new u.L(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new Ds,this._posMatrixCache={},this._alignedPosMatrixCache={},this._minEleveationForCurrentTile=0}clone(){const r=new Fl(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return r.apply(this),r}apply(r){this.tileSize=r.tileSize,this.latRange=r.latRange,this.width=r.width,this.height=r.height,this._center=r._center,this._elevation=r._elevation,this._minEleveationForCurrentTile=r._minEleveationForCurrentTile,this.zoom=r.zoom,this.angle=r.angle,this._fov=r._fov,this._pitch=r._pitch,this._unmodified=r._unmodified,this._edgeInsets=r._edgeInsets.clone(),this._calcMatrices()}get minZoom(){return this._minZoom}set minZoom(r){this._minZoom!==r&&(this._minZoom=r,this.zoom=Math.max(this.zoom,r))}get maxZoom(){return this._maxZoom}set maxZoom(r){this._maxZoom!==r&&(this._maxZoom=r,this.zoom=Math.min(this.zoom,r))}get minPitch(){return this._minPitch}set minPitch(r){this._minPitch!==r&&(this._minPitch=r,this.pitch=Math.max(this.pitch,r))}get maxPitch(){return this._maxPitch}set maxPitch(r){this._maxPitch!==r&&(this._maxPitch=r,this.pitch=Math.min(this.pitch,r))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(r){r===void 0?r=!0:r===null&&(r=!1),this._renderWorldCopies=r}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new u.P(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(r){const s=-u.b5(r,-180,180)*Math.PI/180;this.angle!==s&&(this._unmodified=!1,this.angle=s,this._calcMatrices(),this.rotationMatrix=function(){var d=new u.A(4);return u.A!=Float32Array&&(d[1]=0,d[2]=0),d[0]=1,d[3]=1,d}(),function(d,f,_){var b=f[0],S=f[1],E=f[2],M=f[3],z=Math.sin(_),L=Math.cos(_);d[0]=b*L+E*z,d[1]=S*L+M*z,d[2]=b*-z+E*L,d[3]=S*-z+M*L}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(r){const s=u.ad(r,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==s&&(this._unmodified=!1,this._pitch=s,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(r){r=Math.max(.01,Math.min(60,r)),this._fov!==r&&(this._unmodified=!1,this._fov=r/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(r){const s=Math.min(Math.max(r,this.minZoom),this.maxZoom);this._zoom!==s&&(this._unmodified=!1,this._zoom=s,this.tileZoom=Math.max(0,Math.floor(s)),this.scale=this.zoomScale(s),this._constrain(),this._calcMatrices())}get center(){return this._center}set center(r){r.lat===this._center.lat&&r.lng===this._center.lng||(this._unmodified=!1,this._center=r,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(r){r!==this._elevation&&(this._elevation=r,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(r){this._edgeInsets.equals(r)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,r,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(r){return this._edgeInsets.equals(r)}interpolatePadding(r,s,d){this._unmodified=!1,this._edgeInsets.interpolate(r,s,d),this._constrain(),this._calcMatrices()}coveringZoomLevel(r){const s=(r.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/r.tileSize));return Math.max(0,s)}getVisibleUnwrappedCoordinates(r){const s=[new u.b6(0,r)];if(this._renderWorldCopies){const d=this.pointCoordinate(new u.P(0,0)),f=this.pointCoordinate(new u.P(this.width,0)),_=this.pointCoordinate(new u.P(this.width,this.height)),b=this.pointCoordinate(new u.P(0,this.height)),S=Math.floor(Math.min(d.x,f.x,_.x,b.x)),E=Math.floor(Math.max(d.x,f.x,_.x,b.x)),M=1;for(let z=S-M;z<=E+M;z++)z!==0&&s.push(new u.b6(z,r))}return s}coveringTiles(r){var s,d;let f=this.coveringZoomLevel(r);const _=f;if(r.minzoom!==void 0&&f<r.minzoom)return[];r.maxzoom!==void 0&&f>r.maxzoom&&(f=r.maxzoom);const b=this.pointCoordinate(this.getCameraPoint()),S=u.U.fromLngLat(this.center),E=Math.pow(2,f),M=[E*b.x,E*b.y,0],z=[E*S.x,E*S.y,0],L=qr.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,f);let N=r.minzoom||0;!r.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(N=f);const J=r.terrain?2/Math.min(this.tileSize,r.tileSize)*this.tileSize:3,Y=ie=>({aabb:new qa([ie*E,0,0],[(ie+1)*E,E,0]),zoom:0,x:0,y:0,wrap:ie,fullyVisible:!1}),te=[],K=[],me=f,Se=r.reparseOverscaled?_:f;if(this._renderWorldCopies)for(let ie=1;ie<=3;ie++)te.push(Y(-ie)),te.push(Y(ie));for(te.push(Y(0));te.length>0;){const ie=te.pop(),ge=ie.x,Ee=ie.y;let Ie=ie.fullyVisible;if(!Ie){const rt=ie.aabb.intersects(L);if(rt===0)continue;Ie=rt===2}const ze=r.terrain?M:z,Re=ie.aabb.distanceX(ze),Le=ie.aabb.distanceY(ze),Ve=Math.max(Math.abs(Re),Math.abs(Le));if(ie.zoom===me||Ve>J+(1<<me-ie.zoom)-2&&ie.zoom>=N){const rt=me-ie.zoom,Ut=M[0]-.5-(ge<<rt),Ge=M[1]-.5-(Ee<<rt);K.push({tileID:new u.O(ie.zoom===me?Se:ie.zoom,ie.wrap,ie.zoom,ge,Ee),distanceSq:be([z[0]-.5-ge,z[1]-.5-Ee]),tileDistanceToCamera:Math.sqrt(Ut*Ut+Ge*Ge)})}else for(let rt=0;rt<4;rt++){const Ut=(ge<<1)+rt%2,Ge=(Ee<<1)+(rt>>1),gt=ie.zoom+1;let ot=ie.aabb.quadrant(rt);if(r.terrain){const an=new u.O(gt,ie.wrap,gt,Ut,Ge),Vt=r.terrain.getMinMaxElevation(an),At=(s=Vt.minElevation)!==null&&s!==void 0?s:this.elevation,$t=(d=Vt.maxElevation)!==null&&d!==void 0?d:this.elevation;ot=new qa([ot.min[0],ot.min[1],At],[ot.max[0],ot.max[1],$t])}te.push({aabb:ot,zoom:gt,x:Ut,y:Ge,wrap:ie.wrap,fullyVisible:Ie})}}return K.sort((ie,ge)=>ie.distanceSq-ge.distanceSq).map(ie=>ie.tileID)}resize(r,s){this.width=r,this.height=s,this.pixelsToGLUnits=[2/r,-2/s],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(r){return Math.pow(2,r)}scaleZoom(r){return Math.log(r)/Math.LN2}project(r){const s=u.ad(r.lat,-this.maxValidLatitude,this.maxValidLatitude);return new u.P(u.G(r.lng)*this.worldSize,u.H(s)*this.worldSize)}unproject(r){return new u.U(r.x/this.worldSize,r.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(r){const s=this.pointLocation(this.centerPoint,r),d=r.getElevationForLngLatZoom(s,this.tileZoom);if(!(this.elevation-d))return;const f=this.getCameraPosition(),_=u.U.fromLngLat(f.lngLat,f.altitude),b=u.U.fromLngLat(s,d),S=_.x-b.x,E=_.y-b.y,M=_.z-b.z,z=Math.sqrt(S*S+E*E+M*M),L=this.scaleZoom(this.cameraToCenterDistance/z/this.tileSize);this._elevation=d,this._center=s,this.zoom=L}setLocationAtPoint(r,s){const d=this.pointCoordinate(s),f=this.pointCoordinate(this.centerPoint),_=this.locationCoordinate(r),b=new u.U(_.x-(d.x-f.x),_.y-(d.y-f.y));this.center=this.coordinateLocation(b),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(r,s){return s?this.coordinatePoint(this.locationCoordinate(r),s.getElevationForLngLatZoom(r,this.tileZoom),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(r))}pointLocation(r,s){return this.coordinateLocation(this.pointCoordinate(r,s))}locationCoordinate(r){return u.U.fromLngLat(r)}coordinateLocation(r){return r&&r.toLngLat()}pointCoordinate(r,s){if(s){const N=s.pointCoordinate(r);if(N!=null)return N}const d=[r.x,r.y,0,1],f=[r.x,r.y,1,1];u.ag(d,d,this.pixelMatrixInverse),u.ag(f,f,this.pixelMatrixInverse);const _=d[3],b=f[3],S=d[1]/_,E=f[1]/b,M=d[2]/_,z=f[2]/b,L=M===z?0:(0-M)/(z-M);return new u.U(u.B.number(d[0]/_,f[0]/b,L)/this.worldSize,u.B.number(S,E,L)/this.worldSize)}coordinatePoint(r,s=0,d=this.pixelMatrix){const f=[r.x*this.worldSize,r.y*this.worldSize,s,1];return u.ag(f,f,d),new u.P(f[0]/f[3],f[1]/f[3])}getBounds(){const r=Math.max(0,this.height/2-this.getHorizon());return new _t().extend(this.pointLocation(new u.P(0,r))).extend(this.pointLocation(new u.P(this.width,r))).extend(this.pointLocation(new u.P(this.width,this.height))).extend(this.pointLocation(new u.P(0,this.height)))}getMaxBounds(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new _t([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(r){r?(this.lngRange=[r.getWest(),r.getEast()],this.latRange=[r.getSouth(),r.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])}calculatePosMatrix(r,s=!1){const d=r.key,f=s?this._alignedPosMatrixCache:this._posMatrixCache;if(f[d])return f[d];const _=r.canonical,b=this.worldSize/this.zoomScale(_.z),S=_.x+Math.pow(2,_.z)*r.wrap,E=u.ao(new Float64Array(16));return u.$(E,E,[S*b,_.y*b,0]),u.a0(E,E,[b/u.N,b/u.N,1]),u.a1(E,s?this.alignedProjMatrix:this.projMatrix,E),f[d]=new Float32Array(E),f[d]}customLayerMatrix(){return this.mercatorMatrix.slice()}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;let r,s,d,f,_=-90,b=90,S=-180,E=180;const M=this.size,z=this._unmodified;if(this.latRange){const J=this.latRange;_=u.H(J[1])*this.worldSize,b=u.H(J[0])*this.worldSize,r=b-_<M.y?M.y/(b-_):0}if(this.lngRange){const J=this.lngRange;S=u.b5(u.G(J[0])*this.worldSize,0,this.worldSize),E=u.b5(u.G(J[1])*this.worldSize,0,this.worldSize),E<S&&(E+=this.worldSize),s=E-S<M.x?M.x/(E-S):0}const L=this.point,N=Math.max(s||0,r||0);if(N)return this.center=this.unproject(new u.P(s?(E+S)/2:L.x,r?(b+_)/2:L.y)),this.zoom+=this.scaleZoom(N),this._unmodified=z,void(this._constraining=!1);if(this.latRange){const J=L.y,Y=M.y/2;J-Y<_&&(f=_+Y),J+Y>b&&(f=b-Y)}if(this.lngRange){const J=(S+E)/2,Y=u.b5(L.x,J-this.worldSize/2,J+this.worldSize/2),te=M.x/2;Y-te<S&&(d=S+te),Y+te>E&&(d=E-te)}d===void 0&&f===void 0||(this.center=this.unproject(new u.P(d!==void 0?d:L.x,f!==void 0?f:L.y)).wrap()),this._unmodified=z,this._constraining=!1}_calcMatrices(){if(!this.height)return;const r=this.centerOffset,s=this.point.x,d=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=u.b7(1,this.center.lat)*this.worldSize;let f=u.ao(new Float64Array(16));u.a0(f,f,[this.width/2,-this.height/2,1]),u.$(f,f,[1,-1,0]),this.labelPlaneMatrix=f,f=u.ao(new Float64Array(16)),u.a0(f,f,[1,-1,1]),u.$(f,f,[-1,-1,0]),u.a0(f,f,[2/this.width,2/this.height,1]),this.glCoordMatrix=f;const _=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch),b=Math.min(this.elevation,this._minEleveationForCurrentTile),S=_-b*this._pixelPerMeter/Math.cos(this._pitch),E=b<0?S:_,M=Math.PI/2+this._pitch,z=this._fov*(.5+r.y/this.height),L=Math.sin(z)*E/Math.sin(u.ad(Math.PI-M-z,.01,Math.PI-.01)),N=this.getHorizon(),J=2*Math.atan(N/this.cameraToCenterDistance)*(.5+r.y/(2*N)),Y=Math.sin(J)*E/Math.sin(u.ad(Math.PI-M-J,.01,Math.PI-.01)),te=Math.min(L,Y),K=1.01*(Math.cos(Math.PI/2-this._pitch)*te+E),me=this.height/50;f=new Float64Array(16),u.b8(f,this._fov,this.width/this.height,me,K),f[8]=2*-r.x/this.width,f[9]=2*r.y/this.height,u.a0(f,f,[1,-1,1]),u.$(f,f,[0,0,-this.cameraToCenterDistance]),u.b9(f,f,this._pitch),u.ae(f,f,this.angle),u.$(f,f,[-s,-d,0]),this.mercatorMatrix=u.a0([],f,[this.worldSize,this.worldSize,this.worldSize]),u.a0(f,f,[1,1,this._pixelPerMeter]),this.pixelMatrix=u.a1(new Float64Array(16),this.labelPlaneMatrix,f),u.$(f,f,[0,0,-this.elevation]),this.projMatrix=f,this.invProjMatrix=u.as([],f),this.pixelMatrix3D=u.a1(new Float64Array(16),this.labelPlaneMatrix,f);const Se=this.width%2/2,ie=this.height%2/2,ge=Math.cos(this.angle),Ee=Math.sin(this.angle),Ie=s-Math.round(s)+ge*Se+Ee*ie,ze=d-Math.round(d)+ge*ie+Ee*Se,Re=new Float64Array(f);if(u.$(Re,Re,[Ie>.5?Ie-1:Ie,ze>.5?ze-1:ze,0]),this.alignedProjMatrix=Re,f=u.as(new Float64Array(16),this.pixelMatrix),!f)throw new Error("failed to invert matrix");this.pixelMatrixInverse=f,this._posMatrixCache={},this._alignedPosMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const r=this.pointCoordinate(new u.P(0,0)),s=[r.x*this.worldSize,r.y*this.worldSize,0,1];return u.ag(s,s,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const r=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new u.P(0,r))}getCameraQueryGeometry(r){const s=this.getCameraPoint();if(r.length===1)return[r[0],s];{let d=s.x,f=s.y,_=s.x,b=s.y;for(const S of r)d=Math.min(d,S.x),f=Math.min(f,S.y),_=Math.max(_,S.x),b=Math.max(b,S.y);return[new u.P(d,f),new u.P(_,f),new u.P(_,b),new u.P(d,b),new u.P(d,f)]}}}function fa(g,r){let s,d=!1,f=null,_=null;const b=()=>{f=null,d&&(g.apply(_,s),f=setTimeout(b,r),d=!1)};return(...S)=>(d=!0,_=this,s=S,f||b(),f)}class Ls{constructor(r){this._getCurrentHash=()=>{const s=window.location.hash.replace("#","");if(this._hashName){let d;return s.split("&").map(f=>f.split("=")).forEach(f=>{f[0]===this._hashName&&(d=f)}),(d&&d[1]||"").split("/")}return s.split("/")},this._onHashChange=()=>{const s=this._getCurrentHash();if(s.length>=3&&!s.some(d=>isNaN(d))){const d=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(s[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+s[2],+s[1]],zoom:+s[0],bearing:d,pitch:+(s[4]||0)}),!0}return!1},this._updateHashUnthrottled=()=>{const s=window.location.href.replace(/(#.+)?$/,this.getHashString());try{window.history.replaceState(window.history.state,null,s)}catch{}},this._updateHash=fa(this._updateHashUnthrottled,300),this._hashName=r&&encodeURIComponent(r)}addTo(r){return this._map=r,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(r){const s=this._map.getCenter(),d=Math.round(100*this._map.getZoom())/100,f=Math.ceil((d*Math.LN2+Math.log(512/360/.5))/Math.LN10),_=Math.pow(10,f),b=Math.round(s.lng*_)/_,S=Math.round(s.lat*_)/_,E=this._map.getBearing(),M=this._map.getPitch();let z="";if(z+=r?`/${b}/${S}/${d}`:`${d}/${S}/${b}`,(E||M)&&(z+="/"+Math.round(10*E)/10),M&&(z+=`/${Math.round(M)}`),this._hashName){const L=this._hashName;let N=!1;const J=window.location.hash.slice(1).split("&").map(Y=>{const te=Y.split("=")[0];return te===L?(N=!0,`${te}=${z}`):Y}).filter(Y=>Y);return N||J.push(`${L}=${z}`),`#${J.join("&")}`}return`#${z}`}}const Ga={linearity:.3,easing:u.ba(0,0,.3,1)},bd=u.e({deceleration:2500,maxSpeed:1400},Ga),Sd=u.e({deceleration:20,maxSpeed:1400},Ga),Td=u.e({deceleration:1e3,maxSpeed:360},Ga),Cd=u.e({deceleration:1e3,maxSpeed:90},Ga);class Ed{constructor(r){this._map=r,this.clear()}clear(){this._inertiaBuffer=[]}record(r){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:u.h.now(),settings:r})}_drainInertiaBuffer(){const r=this._inertiaBuffer,s=u.h.now();for(;r.length>0&&s-r[0].time>160;)r.shift()}_onMoveEnd(r){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const s={zoom:0,bearing:0,pitch:0,pan:new u.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:_}of this._inertiaBuffer)s.zoom+=_.zoomDelta||0,s.bearing+=_.bearingDelta||0,s.pitch+=_.pitchDelta||0,_.panDelta&&s.pan._add(_.panDelta),_.around&&(s.around=_.around),_.pinchAround&&(s.pinchAround=_.pinchAround);const d=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,f={};if(s.pan.mag()){const _=Rs(s.pan.mag(),d,u.e({},bd,r||{}));f.offset=s.pan.mult(_.amount/s.pan.mag()),f.center=this._map.transform.center,oo(f,_)}if(s.zoom){const _=Rs(s.zoom,d,Sd);f.zoom=this._map.transform.zoom+_.amount,oo(f,_)}if(s.bearing){const _=Rs(s.bearing,d,Td);f.bearing=this._map.transform.bearing+u.ad(_.amount,-179,179),oo(f,_)}if(s.pitch){const _=Rs(s.pitch,d,Cd);f.pitch=this._map.transform.pitch+_.amount,oo(f,_)}if(f.zoom||f.bearing){const _=s.pinchAround===void 0?s.around:s.pinchAround;f.around=_?this._map.unproject(_):this._map.getCenter()}return this.clear(),u.e(f,{noMoveStart:!0})}}function oo(g,r){(!g.duration||g.duration<r.duration)&&(g.duration=r.duration,g.easing=r.easing)}function Rs(g,r,s){const{maxSpeed:d,linearity:f,deceleration:_}=s,b=u.ad(g*f/(r/1e3),-d,d),S=Math.abs(b)/(_*f);return{easing:s.easing,duration:1e3*S,amount:b*(S/2)}}class ui extends u.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(r,s,d,f={}){const _=I.mousePos(s.getCanvasContainer(),d),b=s.unproject(_);super(r,u.e({point:_,lngLat:b,originalEvent:d},f)),this._defaultPrevented=!1,this.target=s}}class Fs extends u.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(r,s,d){const f=r==="touchend"?d.changedTouches:d.touches,_=I.touchPos(s.getCanvasContainer(),f),b=_.map(E=>s.unproject(E)),S=_.reduce((E,M,z,L)=>E.add(M.div(L.length)),new u.P(0,0));super(r,{points:_,point:S,lngLats:b,lngLat:s.unproject(S),originalEvent:d}),this._defaultPrevented=!1}}class Id extends u.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(r,s,d){super(r,{originalEvent:d}),this._defaultPrevented=!1}}class kd{constructor(r,s){this._map=r,this._clickTolerance=s.clickTolerance}reset(){delete this._mousedownPos}wheel(r){return this._firePreventable(new Id(r.type,this._map,r))}mousedown(r,s){return this._mousedownPos=s,this._firePreventable(new ui(r.type,this._map,r))}mouseup(r){this._map.fire(new ui(r.type,this._map,r))}click(r,s){this._mousedownPos&&this._mousedownPos.dist(s)>=this._clickTolerance||this._map.fire(new ui(r.type,this._map,r))}dblclick(r){return this._firePreventable(new ui(r.type,this._map,r))}mouseover(r){this._map.fire(new ui(r.type,this._map,r))}mouseout(r){this._map.fire(new ui(r.type,this._map,r))}touchstart(r){return this._firePreventable(new Fs(r.type,this._map,r))}touchmove(r){this._map.fire(new Fs(r.type,this._map,r))}touchend(r){this._map.fire(new Fs(r.type,this._map,r))}touchcancel(r){this._map.fire(new Fs(r.type,this._map,r))}_firePreventable(r){if(this._map.fire(r),r.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Md{constructor(r){this._map=r}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(r){this._map.fire(new ui(r.type,this._map,r))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new ui("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(r){this._delayContextMenu?this._contextMenuEvent=r:this._ignoreContextMenu||this._map.fire(new ui(r.type,this._map,r)),this._map.listens("contextmenu")&&r.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class To{constructor(r){this._map=r}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(r){return this.transform.pointLocation(u.P.convert(r),this._map.terrain)}}class Pd{constructor(r,s){this._map=r,this._tr=new To(r),this._el=r.getCanvasContainer(),this._container=r.getContainer(),this._clickTolerance=s.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(r,s){this.isEnabled()&&r.shiftKey&&r.button===0&&(I.disableDrag(),this._startPos=this._lastPos=s,this._active=!0)}mousemoveWindow(r,s){if(!this._active)return;const d=s;if(this._lastPos.equals(d)||!this._box&&d.dist(this._startPos)<this._clickTolerance)return;const f=this._startPos;this._lastPos=d,this._box||(this._box=I.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",r));const _=Math.min(f.x,d.x),b=Math.max(f.x,d.x),S=Math.min(f.y,d.y),E=Math.max(f.y,d.y);I.setTransform(this._box,`translate(${_}px,${S}px)`),this._box.style.width=b-_+"px",this._box.style.height=E-S+"px"}mouseupWindow(r,s){if(!this._active||r.button!==0)return;const d=this._startPos,f=s;if(this.reset(),I.suppressClick(),d.x!==f.x||d.y!==f.y)return this._map.fire(new u.k("boxzoomend",{originalEvent:r})),{cameraAnimation:_=>_.fitScreenCoordinates(d,f,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",r)}keydown(r){this._active&&r.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",r))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(I.remove(this._box),this._box=null),I.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(r,s){return this._map.fire(new u.k(r,{originalEvent:s}))}}function Ii(g,r){if(g.length!==r.length)throw new Error(`The number of touches and points are not equal - touches ${g.length}, points ${r.length}`);const s={};for(let d=0;d<g.length;d++)s[g[d].identifier]=r[d];return s}class Co{constructor(r){this.reset(),this.numTouches=r.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(r,s,d){(this.centroid||d.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=r.timeStamp),d.length===this.numTouches&&(this.centroid=function(f){const _=new u.P(0,0);for(const b of f)_._add(b);return _.div(f.length)}(s),this.touches=Ii(d,s)))}touchmove(r,s,d){if(this.aborted||!this.centroid)return;const f=Ii(d,s);for(const _ in this.touches){const b=f[_];(!b||b.dist(this.touches[_])>30)&&(this.aborted=!0)}}touchend(r,s,d){if((!this.centroid||r.timeStamp-this.startTime>500)&&(this.aborted=!0),d.length===0){const f=!this.aborted&&this.centroid;if(this.reset(),f)return f}}}class Ol{constructor(r){this.singleTap=new Co(r),this.numTaps=r.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(r,s,d){this.singleTap.touchstart(r,s,d)}touchmove(r,s,d){this.singleTap.touchmove(r,s,d)}touchend(r,s,d){const f=this.singleTap.touchend(r,s,d);if(f){const _=r.timeStamp-this.lastTime<500,b=!this.lastTap||this.lastTap.dist(f)<30;if(_&&b||this.reset(),this.count++,this.lastTime=r.timeStamp,this.lastTap=f,this.count===this.numTaps)return this.reset(),f}}}class Eo{constructor(r){this._tr=new To(r),this._zoomIn=new Ol({numTouches:1,numTaps:2}),this._zoomOut=new Ol({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(r,s,d){this._zoomIn.touchstart(r,s,d),this._zoomOut.touchstart(r,s,d)}touchmove(r,s,d){this._zoomIn.touchmove(r,s,d),this._zoomOut.touchmove(r,s,d)}touchend(r,s,d){const f=this._zoomIn.touchend(r,s,d),_=this._zoomOut.touchend(r,s,d),b=this._tr;return f?(this._active=!0,r.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:S=>S.easeTo({duration:300,zoom:b.zoom+1,around:b.unproject(f)},{originalEvent:r})}):_?(this._active=!0,r.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:S=>S.easeTo({duration:300,zoom:b.zoom-1,around:b.unproject(_)},{originalEvent:r})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Io{constructor(r){this._enabled=!!r.enable,this._moveStateManager=r.moveStateManager,this._clickTolerance=r.clickTolerance||1,this._moveFunction=r.move,this._activateOnStart=!!r.activateOnStart,r.assignEvents(this),this.reset()}reset(r){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(r)}_move(...r){const s=this._moveFunction(...r);if(s.bearingDelta||s.pitchDelta||s.around||s.panDelta)return this._active=!0,s}dragStart(r,s){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(r)&&(this._moveStateManager.startMove(r),this._lastPoint=s.length?s[0]:s,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(r,s){if(!this.isEnabled())return;const d=this._lastPoint;if(!d)return;if(r.preventDefault(),!this._moveStateManager.isValidMoveEvent(r))return void this.reset(r);const f=s.length?s[0]:s;return!this._moved&&f.dist(d)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=f,this._move(d,f))}dragEnd(r){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(r)&&(this._moved&&I.suppressClick(),this.reset(r))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const Em={0:1,2:2};class hc{constructor(r){this._correctEvent=r.checkCorrectEvent}startMove(r){const s=I.mouseButton(r);this._eventButton=s}endMove(r){delete this._eventButton}isValidStartEvent(r){return this._correctEvent(r)}isValidMoveEvent(r){return!function(s,d){const f=Em[d];return s.buttons===void 0||(s.buttons&f)!==f}(r,this._eventButton)}isValidEndEvent(r){return I.mouseButton(r)===this._eventButton}}class Ad{constructor(){this._firstTouch=void 0}_isOneFingerTouch(r){return r.targetTouches.length===1}_isSameTouchEvent(r){return r.targetTouches[0].identifier===this._firstTouch}startMove(r){this._firstTouch=r.targetTouches[0].identifier}endMove(r){delete this._firstTouch}isValidStartEvent(r){return this._isOneFingerTouch(r)}isValidMoveEvent(r){return this._isOneFingerTouch(r)&&this._isSameTouchEvent(r)}isValidEndEvent(r){return this._isOneFingerTouch(r)&&this._isSameTouchEvent(r)}}const Bl=g=>{g.mousedown=g.dragStart,g.mousemoveWindow=g.dragMove,g.mouseup=g.dragEnd,g.contextmenu=function(r){r.preventDefault()}},Ha=({enable:g,clickTolerance:r,bearingDegreesPerPixelMoved:s=.8})=>{const d=new hc({checkCorrectEvent:f=>I.mouseButton(f)===0&&f.ctrlKey||I.mouseButton(f)===2});return new Io({clickTolerance:r,move:(f,_)=>({bearingDelta:(_.x-f.x)*s}),moveStateManager:d,enable:g,assignEvents:Bl})},ko=({enable:g,clickTolerance:r,pitchDegreesPerPixelMoved:s=-.5})=>{const d=new hc({checkCorrectEvent:f=>I.mouseButton(f)===0&&f.ctrlKey||I.mouseButton(f)===2});return new Io({clickTolerance:r,move:(f,_)=>({pitchDelta:(_.y-f.y)*s}),moveStateManager:d,enable:g,assignEvents:Bl})};class Je{constructor(r,s){this._minTouches=r.cooperativeGestures?2:1,this._clickTolerance=r.clickTolerance||1,this._map=s,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new u.P(0,0),setTimeout(()=>{this._cancelCooperativeMessage=!1},200)}touchstart(r,s,d){return this._calculateTransform(r,s,d)}touchmove(r,s,d){if(this._map._cooperativeGestures&&(this._minTouches===2&&d.length<2&&!this._cancelCooperativeMessage?this._map._onCooperativeGesture(r,!1,d.length):this._cancelCooperativeMessage||(this._cancelCooperativeMessage=!0)),this._active&&!(d.length<this._minTouches))return r.preventDefault(),this._calculateTransform(r,s,d)}touchend(r,s,d){this._calculateTransform(r,s,d),this._active&&d.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(r,s,d){d.length>0&&(this._active=!0);const f=Ii(d,s),_=new u.P(0,0),b=new u.P(0,0);let S=0;for(const M in f){const z=f[M],L=this._touches[M];L&&(_._add(z),b._add(z.sub(L)),S++,f[M]=z)}if(this._touches=f,S<this._minTouches||!b.mag())return;const E=b.div(S);return this._sum._add(E),this._sum.mag()<this._clickTolerance?void 0:{around:_.div(S),panDelta:E}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Vl{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(r,s,d){this._firstTwoTouches||d.length<2||(this._firstTwoTouches=[d[0].identifier,d[1].identifier],this._start([s[0],s[1]]))}touchmove(r,s,d){if(!this._firstTwoTouches)return;r.preventDefault();const[f,_]=this._firstTwoTouches,b=Xo(d,s,f),S=Xo(d,s,_);if(!b||!S)return;const E=this._aroundCenter?null:b.add(S).div(2);return this._move([b,S],E,r)}touchend(r,s,d){if(!this._firstTwoTouches)return;const[f,_]=this._firstTwoTouches,b=Xo(d,s,f),S=Xo(d,s,_);b&&S||(this._active&&I.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(r){this._enabled=!0,this._aroundCenter=!!r&&r.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Xo(g,r,s){for(let d=0;d<g.length;d++)if(g[d].identifier===s)return r[d]}function Wa(g,r){return Math.log(g/r)/Math.LN2}class zd extends Vl{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(r){this._startDistance=this._distance=r[0].dist(r[1])}_move(r,s){const d=this._distance;if(this._distance=r[0].dist(r[1]),this._active||!(Math.abs(Wa(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Wa(this._distance,d),pinchAround:s}}}function Ke(g,r){return 180*g.angleWith(r)/Math.PI}class dc extends Vl{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(r){this._startVector=this._vector=r[0].sub(r[1]),this._minDiameter=r[0].dist(r[1])}_move(r,s){const d=this._vector;if(this._vector=r[0].sub(r[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Ke(this._vector,d),pinchAround:s}}_isBelowThreshold(r){this._minDiameter=Math.min(this._minDiameter,r.mag());const s=25/(Math.PI*this._minDiameter)*360,d=Ke(r,this._startVector);return Math.abs(d)<s}}function pc(g){return Math.abs(g.y)>Math.abs(g.x)}class Im extends Vl{constructor(r){super(),this._map=r}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(r,s,d){super.touchstart(r,s,d),this._currentTouchCount=d.length}_start(r){this._lastPoints=r,pc(r[0].sub(r[1]))&&(this._valid=!1)}_move(r,s,d){if(this._map._cooperativeGestures&&this._currentTouchCount<3)return;const f=r[0].sub(this._lastPoints[0]),_=r[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(f,_,d.timeStamp),this._valid?(this._lastPoints=r,this._active=!0,{pitchDelta:(f.y+_.y)/2*-.5}):void 0}gestureBeginsVertically(r,s,d){if(this._valid!==void 0)return this._valid;const f=r.mag()>=2,_=s.mag()>=2;if(!f&&!_)return;if(!f||!_)return this._firstMove===void 0&&(this._firstMove=d),d-this._firstMove<100&&void 0;const b=r.y>0==s.y>0;return pc(r)&&pc(s)&&b}}const fc={panStep:100,bearingStep:15,pitchStep:10};class Dd{constructor(r){this._tr=new To(r);const s=fc;this._panStep=s.panStep,this._bearingStep=s.bearingStep,this._pitchStep=s.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(r){if(r.altKey||r.ctrlKey||r.metaKey)return;let s=0,d=0,f=0,_=0,b=0;switch(r.keyCode){case 61:case 107:case 171:case 187:s=1;break;case 189:case 109:case 173:s=-1;break;case 37:r.shiftKey?d=-1:(r.preventDefault(),_=-1);break;case 39:r.shiftKey?d=1:(r.preventDefault(),_=1);break;case 38:r.shiftKey?f=1:(r.preventDefault(),b=-1);break;case 40:r.shiftKey?f=-1:(r.preventDefault(),b=1);break;default:return}return this._rotationDisabled&&(d=0,f=0),{cameraAnimation:S=>{const E=this._tr;S.easeTo({duration:300,easeId:"keyboardHandler",easing:Ld,zoom:s?Math.round(E.zoom)+s*(r.shiftKey?2:1):E.zoom,bearing:E.bearing+d*this._bearingStep,pitch:E.pitch+f*this._pitchStep,offset:[-_*this._panStep,-b*this._panStep],center:E.center},{originalEvent:r})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Ld(g){return g*(2-g)}const Rd=4.000244140625;class km{constructor(r,s){this._onTimeout=d=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(d)},this._map=r,this._tr=new To(r),this._el=r.getCanvasContainer(),this._triggerRenderFrame=s,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222}setZoomRate(r){this._defaultZoomRate=r}setWheelZoomRate(r){this._wheelZoomRate=r}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(r){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!r&&r.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}wheel(r){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!r[this._map._metaKey])return;r.preventDefault()}let s=r.deltaMode===WheelEvent.DOM_DELTA_LINE?40*r.deltaY:r.deltaY;const d=u.h.now(),f=d-(this._lastWheelEventTime||0);this._lastWheelEventTime=d,s!==0&&s%Rd==0?this._type="wheel":s!==0&&Math.abs(s)<4?this._type="trackpad":f>400?(this._type=null,this._lastValue=s,this._timeout=setTimeout(this._onTimeout,40,r)):this._type||(this._type=Math.abs(f*s)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,s+=this._lastValue)),r.shiftKey&&s&&(s/=4),this._type&&(this._lastWheelEvent=r,this._delta-=s,this._active||this._start(r)),r.preventDefault()}_start(r){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const s=I.mousePos(this._el,r),d=this._tr;this._around=u.L.convert(this._aroundCenter?d.center:d.unproject(s)),this._aroundPoint=d.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const r=this._tr.transform;if(this._delta!==0){const S=this._type==="wheel"&&Math.abs(this._delta)>Rd?this._wheelZoomRate:this._defaultZoomRate;let E=2/(1+Math.exp(-Math.abs(this._delta*S)));this._delta<0&&E!==0&&(E=1/E);const M=typeof this._targetZoom=="number"?r.zoomScale(this._targetZoom):r.scale;this._targetZoom=Math.min(r.maxZoom,Math.max(r.minZoom,r.scaleZoom(M*E))),this._type==="wheel"&&(this._startZoom=r.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const s=typeof this._targetZoom=="number"?this._targetZoom:r.zoom,d=this._startZoom,f=this._easing;let _,b=!1;if(this._type==="wheel"&&d&&f){const S=Math.min((u.h.now()-this._lastWheelEventTime)/200,1),E=f(S);_=u.B.number(d,s,E),S<1?this._frameId||(this._frameId=!0):b=!0}else _=s,b=!0;return this._active=!0,b&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!b,zoomDelta:_-r.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(r){let s=u.bb;if(this._prevEase){const d=this._prevEase,f=(u.h.now()-d.start)/d.duration,_=d.easing(f+.01)-d.easing(f),b=.27/Math.sqrt(_*_+1e-4)*.01,S=Math.sqrt(.0729-b*b);s=u.ba(b,S,.25,1)}return this._prevEase={start:u.h.now(),duration:r,easing:s},s}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class mc{constructor(r,s){this._clickZoom=r,this._tapZoom=s}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class gc{constructor(r){this._tr=new To(r),this.reset()}reset(){this._active=!1}dblclick(r,s){return r.preventDefault(),{cameraAnimation:d=>{d.easeTo({duration:300,zoom:this._tr.zoom+(r.shiftKey?-1:1),around:this._tr.unproject(s)},{originalEvent:r})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class yc{constructor(){this._tap=new Ol({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(r,s,d){if(!this._swipePoint)if(this._tapTime){const f=s[0],_=r.timeStamp-this._tapTime<500,b=this._tapPoint.dist(f)<30;_&&b?d.length>0&&(this._swipePoint=f,this._swipeTouch=d[0].identifier):this.reset()}else this._tap.touchstart(r,s,d)}touchmove(r,s,d){if(this._tapTime){if(this._swipePoint){if(d[0].identifier!==this._swipeTouch)return;const f=s[0],_=f.y-this._swipePoint.y;return this._swipePoint=f,r.preventDefault(),this._active=!0,{zoomDelta:_/128}}}else this._tap.touchmove(r,s,d)}touchend(r,s,d){if(this._tapTime)this._swipePoint&&d.length===0&&this.reset();else{const f=this._tap.touchend(r,s,d);f&&(this._tapTime=r.timeStamp,this._tapPoint=f)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class _c{constructor(r,s,d){this._el=r,this._mousePan=s,this._touchPan=d}enable(r){this._inertiaOptions=r||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Gr{constructor(r,s,d){this._pitchWithRotate=r.pitchWithRotate,this._mouseRotate=s,this._mousePitch=d}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class Yo{constructor(r,s,d,f){this._el=r,this._touchZoom=s,this._touchRotate=d,this._tapDragZoom=f,this._rotationDisabled=!1,this._enabled=!0}enable(r){this._touchZoom.enable(r),this._rotationDisabled||this._touchRotate.enable(r),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Os=g=>g.zoom||g.drag||g.pitch||g.rotate;class vc extends u.k{}function Bs(g){return g.panDelta&&g.panDelta.mag()||g.zoomDelta||g.bearingDelta||g.pitchDelta}class xc{constructor(r,s){this.handleWindowEvent=f=>{this.handleEvent(f,`${f.type}Window`)},this.handleEvent=(f,_)=>{if(f.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const b=f.type==="renderFrame"?void 0:f,S={needsRenderFrame:!1},E={},M={},z=f.touches,L=z?this._getMapTouches(z):void 0,N=L?I.touchPos(this._el,L):I.mousePos(this._el,f);for(const{handlerName:te,handler:K,allowed:me}of this._handlers){if(!K.isEnabled())continue;let Se;this._blockedByActive(M,me,te)?K.reset():K[_||f.type]&&(Se=K[_||f.type](f,N,L),this.mergeHandlerResult(S,E,Se,te,b),Se&&Se.needsRenderFrame&&this._triggerRenderFrame()),(Se||K.isActive())&&(M[te]=K)}const J={};for(const te in this._previousActiveHandlers)M[te]||(J[te]=b);this._previousActiveHandlers=M,(Object.keys(J).length||Bs(S))&&(this._changes.push([S,E,J]),this._triggerRenderFrame()),(Object.keys(M).length||Bs(S))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:Y}=S;Y&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],Y(this._map))},this._map=r,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Ed(r),this._bearingSnap=s.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(s);const d=this._el;this._listeners=[[d,"touchstart",{passive:!0}],[d,"touchmove",{passive:!1}],[d,"touchend",void 0],[d,"touchcancel",void 0],[d,"mousedown",void 0],[d,"mousemove",void 0],[d,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[d,"mouseover",void 0],[d,"mouseout",void 0],[d,"dblclick",void 0],[d,"click",void 0],[d,"keydown",{capture:!1}],[d,"keyup",void 0],[d,"wheel",{passive:!1}],[d,"contextmenu",void 0],[window,"blur",void 0]];for(const[f,_,b]of this._listeners)I.addEventListener(f,_,f===document?this.handleWindowEvent:this.handleEvent,b)}destroy(){for(const[r,s,d]of this._listeners)I.removeEventListener(r,s,r===document?this.handleWindowEvent:this.handleEvent,d)}_addDefaultHandlers(r){const s=this._map,d=s.getCanvasContainer();this._add("mapEvent",new kd(s,r));const f=s.boxZoom=new Pd(s,r);this._add("boxZoom",f),r.interactive&&r.boxZoom&&f.enable();const _=new Eo(s),b=new gc(s);s.doubleClickZoom=new mc(b,_),this._add("tapZoom",_),this._add("clickZoom",b),r.interactive&&r.doubleClickZoom&&s.doubleClickZoom.enable();const S=new yc;this._add("tapDragZoom",S);const E=s.touchPitch=new Im(s);this._add("touchPitch",E),r.interactive&&r.touchPitch&&s.touchPitch.enable(r.touchPitch);const M=Ha(r),z=ko(r);s.dragRotate=new Gr(r,M,z),this._add("mouseRotate",M,["mousePitch"]),this._add("mousePitch",z,["mouseRotate"]),r.interactive&&r.dragRotate&&s.dragRotate.enable();const L=(({enable:me,clickTolerance:Se})=>{const ie=new hc({checkCorrectEvent:ge=>I.mouseButton(ge)===0&&!ge.ctrlKey});return new Io({clickTolerance:Se,move:(ge,Ee)=>({around:Ee,panDelta:Ee.sub(ge)}),activateOnStart:!0,moveStateManager:ie,enable:me,assignEvents:Bl})})(r),N=new Je(r,s);s.dragPan=new _c(d,L,N),this._add("mousePan",L),this._add("touchPan",N,["touchZoom","touchRotate"]),r.interactive&&r.dragPan&&s.dragPan.enable(r.dragPan);const J=new dc,Y=new zd;s.touchZoomRotate=new Yo(d,Y,J,S),this._add("touchRotate",J,["touchPan","touchZoom"]),this._add("touchZoom",Y,["touchPan","touchRotate"]),r.interactive&&r.touchZoomRotate&&s.touchZoomRotate.enable(r.touchZoomRotate);const te=s.scrollZoom=new km(s,()=>this._triggerRenderFrame());this._add("scrollZoom",te,["mousePan"]),r.interactive&&r.scrollZoom&&s.scrollZoom.enable(r.scrollZoom);const K=s.keyboard=new Dd(s);this._add("keyboard",K),r.interactive&&r.keyboard&&s.keyboard.enable(),this._add("blockableMapEvent",new Md(s))}_add(r,s,d){this._handlers.push({handlerName:r,handler:s,allowed:d}),this._handlersById[r]=s}stop(r){if(!this._updatingCamera){for(const{handler:s}of this._handlers)s.reset();this._inertia.clear(),this._fireEvents({},{},r),this._changes=[]}}isActive(){for(const{handler:r}of this._handlers)if(r.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Os(this._eventsInProgress)||this.isZooming()}_blockedByActive(r,s,d){for(const f in r)if(f!==d&&(!s||s.indexOf(f)<0))return!0;return!1}_getMapTouches(r){const s=[];for(const d of r)this._el.contains(d.target)&&s.push(d);return s}mergeHandlerResult(r,s,d,f,_){if(!d)return;u.e(r,d);const b={handlerName:f,originalEvent:d.originalEvent||_};d.zoomDelta!==void 0&&(s.zoom=b),d.panDelta!==void 0&&(s.drag=b),d.pitchDelta!==void 0&&(s.pitch=b),d.bearingDelta!==void 0&&(s.rotate=b)}_applyChanges(){const r={},s={},d={};for(const[f,_,b]of this._changes)f.panDelta&&(r.panDelta=(r.panDelta||new u.P(0,0))._add(f.panDelta)),f.zoomDelta&&(r.zoomDelta=(r.zoomDelta||0)+f.zoomDelta),f.bearingDelta&&(r.bearingDelta=(r.bearingDelta||0)+f.bearingDelta),f.pitchDelta&&(r.pitchDelta=(r.pitchDelta||0)+f.pitchDelta),f.around!==void 0&&(r.around=f.around),f.pinchAround!==void 0&&(r.pinchAround=f.pinchAround),f.noInertia&&(r.noInertia=f.noInertia),u.e(s,_),u.e(d,b);this._updateMapTransform(r,s,d),this._changes=[]}_updateMapTransform(r,s,d){const f=this._map,_=f._getTransformForUpdate(),b=f.terrain;if(!(Bs(r)||b&&this._terrainMovement))return this._fireEvents(s,d,!0);let{panDelta:S,zoomDelta:E,bearingDelta:M,pitchDelta:z,around:L,pinchAround:N}=r;N!==void 0&&(L=N),f._stop(!0),L=L||f.transform.centerPoint;const J=_.pointLocation(S?L.sub(S):L);M&&(_.bearing+=M),z&&(_.pitch+=z),E&&(_.zoom+=E),b?this._terrainMovement||!s.drag&&!s.zoom?s.drag&&this._terrainMovement?_.center=_.pointLocation(_.centerPoint.sub(S)):_.setLocationAtPoint(J,L):(this._terrainMovement=!0,this._map._elevationFreeze=!0,_.setLocationAtPoint(J,L),this._map.once("moveend",()=>{this._map._elevationFreeze=!1,this._terrainMovement=!1,_.recalculateZoom(f.terrain)})):_.setLocationAtPoint(J,L),f._applyUpdatedTransform(_),this._map._update(),r.noInertia||this._inertia.record(r),this._fireEvents(s,d,!0)}_fireEvents(r,s,d){const f=Os(this._eventsInProgress),_=Os(r),b={};for(const z in r){const{originalEvent:L}=r[z];this._eventsInProgress[z]||(b[`${z}start`]=L),this._eventsInProgress[z]=r[z]}!f&&_&&this._fireEvent("movestart",_.originalEvent);for(const z in b)this._fireEvent(z,b[z]);_&&this._fireEvent("move",_.originalEvent);for(const z in r){const{originalEvent:L}=r[z];this._fireEvent(z,L)}const S={};let E;for(const z in this._eventsInProgress){const{handlerName:L,originalEvent:N}=this._eventsInProgress[z];this._handlersById[L].isActive()||(delete this._eventsInProgress[z],E=s[L]||N,S[`${z}end`]=E)}for(const z in S)this._fireEvent(z,S[z]);const M=Os(this._eventsInProgress);if(d&&(f||_)&&!M){this._updatingCamera=!0;const z=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),L=N=>N!==0&&-this._bearingSnap<N&&N<this._bearingSnap;!z||!z.essential&&u.h.prefersReducedMotion?(this._map.fire(new u.k("moveend",{originalEvent:E})),L(this._map.getBearing())&&this._map.resetNorth()):(L(z.bearing||this._map.getBearing())&&(z.bearing=0),z.freezeElevation=!0,this._map.easeTo(z,{originalEvent:E})),this._updatingCamera=!1}}_fireEvent(r,s){this._map.fire(new u.k(r,s?{originalEvent:s}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(r=>{delete this._frameId,this.handleEvent(new vc("renderFrame",{timeStamp:r})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class Fd extends u.E{constructor(r,s){super(),this._renderFrameCallback=()=>{const d=Math.min((u.h.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(d)),d<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=r,this._bearingSnap=s.bearingSnap,this.on("moveend",()=>{delete this._requestedCameraState})}getCenter(){return new u.L(this.transform.center.lng,this.transform.center.lat)}setCenter(r,s){return this.jumpTo({center:r},s)}panBy(r,s,d){return r=u.P.convert(r).mult(-1),this.panTo(this.transform.center,u.e({offset:r},s),d)}panTo(r,s,d){return this.easeTo(u.e({center:r},s),d)}getZoom(){return this.transform.zoom}setZoom(r,s){return this.jumpTo({zoom:r},s),this}zoomTo(r,s,d){return this.easeTo(u.e({zoom:r},s),d)}zoomIn(r,s){return this.zoomTo(this.getZoom()+1,r,s),this}zoomOut(r,s){return this.zoomTo(this.getZoom()-1,r,s),this}getBearing(){return this.transform.bearing}setBearing(r,s){return this.jumpTo({bearing:r},s),this}getPadding(){return this.transform.padding}setPadding(r,s){return this.jumpTo({padding:r},s),this}rotateTo(r,s,d){return this.easeTo(u.e({bearing:r},s),d)}resetNorth(r,s){return this.rotateTo(0,u.e({duration:1e3},r),s),this}resetNorthPitch(r,s){return this.easeTo(u.e({bearing:0,pitch:0,duration:1e3},r),s),this}snapToNorth(r,s){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(r,s):this}getPitch(){return this.transform.pitch}setPitch(r,s){return this.jumpTo({pitch:r},s),this}cameraForBounds(r,s){r=_t.convert(r);const d=s&&s.bearing||0;return this._cameraForBoxAndBearing(r.getNorthWest(),r.getSouthEast(),d,s)}_cameraForBoxAndBearing(r,s,d,f){const _={top:0,bottom:0,right:0,left:0};if(typeof(f=u.e({padding:_,offset:[0,0],maxZoom:this.transform.maxZoom},f)).padding=="number"){const Ee=f.padding;f.padding={top:Ee,bottom:Ee,right:Ee,left:Ee}}f.padding=u.e(_,f.padding);const b=this.transform,S=b.padding,E=b.project(u.L.convert(r)),M=b.project(u.L.convert(s)),z=E.rotate(-d*Math.PI/180),L=M.rotate(-d*Math.PI/180),N=new u.P(Math.max(z.x,L.x),Math.max(z.y,L.y)),J=new u.P(Math.min(z.x,L.x),Math.min(z.y,L.y)),Y=N.sub(J),te=(b.width-(S.left+S.right+f.padding.left+f.padding.right))/Y.x,K=(b.height-(S.top+S.bottom+f.padding.top+f.padding.bottom))/Y.y;if(K<0||te<0)return void u.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const me=Math.min(b.scaleZoom(b.scale*Math.min(te,K)),f.maxZoom),Se=u.P.convert(f.offset),ie=new u.P((f.padding.left-f.padding.right)/2,(f.padding.top-f.padding.bottom)/2).rotate(d*Math.PI/180),ge=Se.add(ie).mult(b.scale/b.zoomScale(me));return{center:b.unproject(E.add(M).div(2).sub(ge)),zoom:me,bearing:d}}fitBounds(r,s,d){return this._fitInternal(this.cameraForBounds(r,s),s,d)}fitScreenCoordinates(r,s,d,f,_){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(u.P.convert(r)),this.transform.pointLocation(u.P.convert(s)),d,f),f,_)}_fitInternal(r,s,d){return r?(delete(s=u.e(r,s)).padding,s.linear?this.easeTo(s,d):this.flyTo(s,d)):this}jumpTo(r,s){this.stop();const d=this._getTransformForUpdate();let f=!1,_=!1,b=!1;return"zoom"in r&&d.zoom!==+r.zoom&&(f=!0,d.zoom=+r.zoom),r.center!==void 0&&(d.center=u.L.convert(r.center)),"bearing"in r&&d.bearing!==+r.bearing&&(_=!0,d.bearing=+r.bearing),"pitch"in r&&d.pitch!==+r.pitch&&(b=!0,d.pitch=+r.pitch),r.padding==null||d.isPaddingEqual(r.padding)||(d.padding=r.padding),this._applyUpdatedTransform(d),this.fire(new u.k("movestart",s)).fire(new u.k("move",s)),f&&this.fire(new u.k("zoomstart",s)).fire(new u.k("zoom",s)).fire(new u.k("zoomend",s)),_&&this.fire(new u.k("rotatestart",s)).fire(new u.k("rotate",s)).fire(new u.k("rotateend",s)),b&&this.fire(new u.k("pitchstart",s)).fire(new u.k("pitch",s)).fire(new u.k("pitchend",s)),this.fire(new u.k("moveend",s))}calculateCameraOptionsFromTo(r,s,d,f=0){const _=u.U.fromLngLat(r,s),b=u.U.fromLngLat(d,f),S=b.x-_.x,E=b.y-_.y,M=b.z-_.z,z=Math.hypot(S,E,M);if(z===0)throw new Error("Can't calculate camera options with same From and To");const L=Math.hypot(S,E),N=this.transform.scaleZoom(this.transform.cameraToCenterDistance/z/this.transform.tileSize),J=180*Math.atan2(S,-E)/Math.PI;let Y=180*Math.acos(L/z)/Math.PI;return Y=M<0?90-Y:90+Y,{center:b.toLngLat(),zoom:N,pitch:Y,bearing:J}}easeTo(r,s){this._stop(!1,r.easeId),((r=u.e({offset:[0,0],duration:500,easing:u.bb},r)).animate===!1||!r.essential&&u.h.prefersReducedMotion)&&(r.duration=0);const d=this._getTransformForUpdate(),f=this.getZoom(),_=this.getBearing(),b=this.getPitch(),S=this.getPadding(),E="zoom"in r?+r.zoom:f,M="bearing"in r?this._normalizeBearing(r.bearing,_):_,z="pitch"in r?+r.pitch:b,L="padding"in r?r.padding:d.padding,N=u.P.convert(r.offset);let J=d.centerPoint.add(N);const Y=d.pointLocation(J),te=u.L.convert(r.center||Y);this._normalizeCenter(te);const K=d.project(Y),me=d.project(te).sub(K),Se=d.zoomScale(E-f);let ie,ge;r.around&&(ie=u.L.convert(r.around),ge=d.locationPoint(ie));const Ee={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||E!==f,this._rotating=this._rotating||_!==M,this._pitching=this._pitching||z!==b,this._padding=!d.isPaddingEqual(L),this._easeId=r.easeId,this._prepareEase(s,r.noMoveStart,Ee),this.terrain&&this._prepareElevation(te),this._ease(Ie=>{if(this._zooming&&(d.zoom=u.B.number(f,E,Ie)),this._rotating&&(d.bearing=u.B.number(_,M,Ie)),this._pitching&&(d.pitch=u.B.number(b,z,Ie)),this._padding&&(d.interpolatePadding(S,L,Ie),J=d.centerPoint.add(N)),this.terrain&&!r.freezeElevation&&this._updateElevation(Ie),ie)d.setLocationAtPoint(ie,ge);else{const ze=d.zoomScale(d.zoom-f),Re=E>f?Math.min(2,Se):Math.max(.5,Se),Le=Math.pow(Re,1-Ie),Ve=d.unproject(K.add(me.mult(Ie*Le)).mult(ze));d.setLocationAtPoint(d.renderWorldCopies?Ve.wrap():Ve,J)}this._applyUpdatedTransform(d),this._fireMoveEvents(s)},Ie=>{this.terrain&&this._finalizeElevation(),this._afterEase(s,Ie)},r),this}_prepareEase(r,s,d={}){this._moving=!0,s||d.moving||this.fire(new u.k("movestart",r)),this._zooming&&!d.zooming&&this.fire(new u.k("zoomstart",r)),this._rotating&&!d.rotating&&this.fire(new u.k("rotatestart",r)),this._pitching&&!d.pitching&&this.fire(new u.k("pitchstart",r))}_prepareElevation(r){this._elevationCenter=r,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(r,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(r){this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);const s=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(r<1&&s!==this._elevationTarget){const d=this._elevationTarget-this._elevationStart;this._elevationStart+=r*(d-(s-(d*r+this._elevationStart))/(1-r)),this._elevationTarget=s}this.transform.elevation=u.B.number(this._elevationStart,this._elevationTarget,r)}_finalizeElevation(){this._elevationFreeze=!1,this.transform.recalculateZoom(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_applyUpdatedTransform(r){if(!this.transformCameraUpdate)return;const s=r.clone(),{center:d,zoom:f,pitch:_,bearing:b,elevation:S}=this.transformCameraUpdate(s);d&&(s.center=d),f!==void 0&&(s.zoom=f),_!==void 0&&(s.pitch=_),b!==void 0&&(s.bearing=b),S!==void 0&&(s.elevation=S),this.transform.apply(s)}_fireMoveEvents(r){this.fire(new u.k("move",r)),this._zooming&&this.fire(new u.k("zoom",r)),this._rotating&&this.fire(new u.k("rotate",r)),this._pitching&&this.fire(new u.k("pitch",r))}_afterEase(r,s){if(this._easeId&&s&&this._easeId===s)return;delete this._easeId;const d=this._zooming,f=this._rotating,_=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,d&&this.fire(new u.k("zoomend",r)),f&&this.fire(new u.k("rotateend",r)),_&&this.fire(new u.k("pitchend",r)),this.fire(new u.k("moveend",r))}flyTo(r,s){if(!r.essential&&u.h.prefersReducedMotion){const ot=u.F(r,["center","zoom","bearing","pitch","around"]);return this.jumpTo(ot,s)}this.stop(),r=u.e({offset:[0,0],speed:1.2,curve:1.42,easing:u.bb},r);const d=this._getTransformForUpdate(),f=this.getZoom(),_=this.getBearing(),b=this.getPitch(),S=this.getPadding(),E="zoom"in r?u.ad(+r.zoom,d.minZoom,d.maxZoom):f,M="bearing"in r?this._normalizeBearing(r.bearing,_):_,z="pitch"in r?+r.pitch:b,L="padding"in r?r.padding:d.padding,N=d.zoomScale(E-f),J=u.P.convert(r.offset);let Y=d.centerPoint.add(J);const te=d.pointLocation(Y),K=u.L.convert(r.center||te);this._normalizeCenter(K);const me=d.project(te),Se=d.project(K).sub(me);let ie=r.curve;const ge=Math.max(d.width,d.height),Ee=ge/N,Ie=Se.mag();if("minZoom"in r){const ot=u.ad(Math.min(r.minZoom,f,E),d.minZoom,d.maxZoom),an=ge/d.zoomScale(ot-f);ie=Math.sqrt(an/Ie*2)}const ze=ie*ie;function Re(ot){const an=(Ee*Ee-ge*ge+(ot?-1:1)*ze*ze*Ie*Ie)/(2*(ot?Ee:ge)*ze*Ie);return Math.log(Math.sqrt(an*an+1)-an)}function Le(ot){return(Math.exp(ot)-Math.exp(-ot))/2}function Ve(ot){return(Math.exp(ot)+Math.exp(-ot))/2}const rt=Re(!1);let Ut=function(ot){return Ve(rt)/Ve(rt+ie*ot)},Ge=function(ot){return ge*((Ve(rt)*(Le(an=rt+ie*ot)/Ve(an))-Le(rt))/ze)/Ie;var an},gt=(Re(!0)-rt)/ie;if(Math.abs(Ie)<1e-6||!isFinite(gt)){if(Math.abs(ge-Ee)<1e-6)return this.easeTo(r,s);const ot=Ee<ge?-1:1;gt=Math.abs(Math.log(Ee/ge))/ie,Ge=function(){return 0},Ut=function(an){return Math.exp(ot*ie*an)}}return r.duration="duration"in r?+r.duration:1e3*gt/("screenSpeed"in r?+r.screenSpeed/ie:+r.speed),r.maxDuration&&r.duration>r.maxDuration&&(r.duration=0),this._zooming=!0,this._rotating=_!==M,this._pitching=z!==b,this._padding=!d.isPaddingEqual(L),this._prepareEase(s,!1),this.terrain&&this._prepareElevation(K),this._ease(ot=>{const an=ot*gt,Vt=1/Ut(an);d.zoom=ot===1?E:f+d.scaleZoom(Vt),this._rotating&&(d.bearing=u.B.number(_,M,ot)),this._pitching&&(d.pitch=u.B.number(b,z,ot)),this._padding&&(d.interpolatePadding(S,L,ot),Y=d.centerPoint.add(J)),this.terrain&&!r.freezeElevation&&this._updateElevation(ot);const At=ot===1?K:d.unproject(me.add(Se.mult(Ge(an))).mult(Vt));d.setLocationAtPoint(d.renderWorldCopies?At.wrap():At,Y),this._applyUpdatedTransform(d),this._fireMoveEvents(s)},()=>{this.terrain&&this._finalizeElevation(),this._afterEase(s)},r),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(r,s){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const d=this._onEaseEnd;delete this._onEaseEnd,d.call(this,s)}if(!r){const d=this.handlers;d&&d.stop(!1)}return this}_ease(r,s,d){d.animate===!1||d.duration===0?(r(1),s()):(this._easeStart=u.h.now(),this._easeOptions=d,this._onEaseFrame=r,this._onEaseEnd=s,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(r,s){r=u.b5(r,-180,180);const d=Math.abs(r-s);return Math.abs(r-360-s)<d&&(r-=360),Math.abs(r+360-s)<d&&(r+=360),r}_normalizeCenter(r){const s=this.transform;if(!s.renderWorldCopies||s.lngRange)return;const d=r.lng-s.center.lng;r.lng+=d>180?-360:d<-180?360:0}queryTerrainElevation(r){return this.terrain?this.terrain.getElevationForLngLatZoom(u.L.convert(r),this.transform.tileZoom)-this.transform.elevation:null}}class ci{constructor(r={}){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=s=>{!s||s.sourceDataType!=="metadata"&&s.sourceDataType!=="visibility"&&s.dataType!=="style"&&s.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=r}getDefaultPosition(){return"bottom-right"}onAdd(r){return this._map=r,this._compact=this.options&&this.options.compact,this._container=I.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=I.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=I.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){I.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(r,s){const d=this._map._getUIString(`AttributionControl.${s}`);r.title=d,r.setAttribute("aria-label",d)}_updateAttributions(){if(!this._map.style)return;let r=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?r=r.concat(this.options.customAttribution.map(f=>typeof f!="string"?"":f)):typeof this.options.customAttribution=="string"&&r.push(this.options.customAttribution)),this._map.style.stylesheet){const f=this._map.style.stylesheet;this.styleOwner=f.owner,this.styleId=f.id}const s=this._map.style.sourceCaches;for(const f in s){const _=s[f];if(_.used||_.usedForTerrain){const b=_.getSource();b.attribution&&r.indexOf(b.attribution)<0&&r.push(b.attribution)}}r=r.filter(f=>String(f).trim()),r.sort((f,_)=>f.length-_.length),r=r.filter((f,_)=>{for(let b=_+1;b<r.length;b++)if(r[b].indexOf(f)>=0)return!1;return!0});const d=r.join(" | ");d!==this._attribHTML&&(this._attribHTML=d,r.length?(this._innerContainer.innerHTML=d,this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class yn{constructor(r={}){this._updateCompact=()=>{const s=this._container.children;if(s.length){const d=s[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&d.classList.add("maplibregl-compact"):d.classList.remove("maplibregl-compact")}},this.options=r}getDefaultPosition(){return"bottom-left"}onAdd(r){this._map=r,this._compact=this.options&&this.options.compact,this._container=I.create("div","maplibregl-ctrl");const s=I.create("a","maplibregl-ctrl-logo");return s.target="_blank",s.rel="noopener nofollow",s.href="https://maplibre.org/",s.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),s.setAttribute("rel","noopener nofollow"),this._container.appendChild(s),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){I.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class Nl{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(r){const s=++this._id;return this._queue.push({callback:r,id:s,cancelled:!1}),s}remove(r){const s=this._currentlyRunning,d=s?this._queue.concat(s):this._queue;for(const f of d)if(f.id===r)return void(f.cancelled=!0)}run(r=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const s=this._currentlyRunning=this._queue;this._queue=[];for(const d of s)if(!d.cancelled&&(d.callback(r),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}const wc={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.enableTerrain":"Enable terrain","TerrainControl.disableTerrain":"Disable terrain"};var Od=u.Q([{name:"a_pos3d",type:"Int16",components:3}]);class Bd extends u.E{constructor(r){super(),this.sourceCache=r,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,r.usedForTerrain=!0,r.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(r,s){this.sourceCache.update(r,s),this._renderableTilesKeys=[];const d={};for(const f of r.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:s}))d[f.key]=!0,this._renderableTilesKeys.push(f.key),this._tiles[f.key]||(f.posMatrix=new Float64Array(16),u.aS(f.posMatrix,0,u.N,0,u.N,0,1),this._tiles[f.key]=new ro(f,this.tileSize));for(const f in this._tiles)d[f]||delete this._tiles[f]}freeRtt(r){for(const s in this._tiles){const d=this._tiles[s];(!r||d.tileID.equals(r)||d.tileID.isChildOf(r)||r.isChildOf(d.tileID))&&(d.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(r=>this.getTileByID(r))}getTileByID(r){return this._tiles[r]}getTerrainCoords(r){const s={};for(const d of this._renderableTilesKeys){const f=this._tiles[d].tileID;if(f.canonical.equals(r.canonical)){const _=r.clone();_.posMatrix=new Float64Array(16),u.aS(_.posMatrix,0,u.N,0,u.N,0,1),s[d]=_}else if(f.canonical.isChildOf(r.canonical)){const _=r.clone();_.posMatrix=new Float64Array(16);const b=f.canonical.z-r.canonical.z,S=f.canonical.x-(f.canonical.x>>b<<b),E=f.canonical.y-(f.canonical.y>>b<<b),M=u.N>>b;u.aS(_.posMatrix,0,M,0,M,0,1),u.$(_.posMatrix,_.posMatrix,[-S*M,-E*M,0]),s[d]=_}else if(r.canonical.isChildOf(f.canonical)){const _=r.clone();_.posMatrix=new Float64Array(16);const b=r.canonical.z-f.canonical.z,S=r.canonical.x-(r.canonical.x>>b<<b),E=r.canonical.y-(r.canonical.y>>b<<b),M=u.N>>b;u.aS(_.posMatrix,0,u.N,0,u.N,0,1),u.$(_.posMatrix,_.posMatrix,[S*M,E*M,0]),u.a0(_.posMatrix,_.posMatrix,[1/2**b,1/2**b,0]),s[d]=_}}return s}getSourceTile(r,s){const d=this.sourceCache._source;let f=r.overscaledZ-this.deltaZoom;if(f>d.maxzoom&&(f=d.maxzoom),f<d.minzoom)return null;this._sourceTileCache[r.key]||(this._sourceTileCache[r.key]=r.scaledTo(f).key);let _=this.sourceCache.getTileByID(this._sourceTileCache[r.key]);if((!_||!_.dem)&&s)for(;f>=d.minzoom&&(!_||!_.dem);)_=this.sourceCache.getTileByID(r.scaledTo(f--).key);return _}tilesAfterTime(r=Date.now()){return Object.values(this._tiles).filter(s=>s.timeAdded>=r)}}class Vd{constructor(r,s,d){this.painter=r,this.sourceCache=new Bd(s),this.options=d,this.exaggeration=typeof d.exaggeration=="number"?d.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(r,s,d,f=u.N){var _;if(!(s>=0&&s<f&&d>=0&&d<f))return 0;const b=this.getTerrainData(r),S=(_=b.tile)===null||_===void 0?void 0:_.dem;if(!S)return 0;const E=function(Y,te,K){var me=te[0],Se=te[1];return Y[0]=K[0]*me+K[4]*Se+K[12],Y[1]=K[1]*me+K[5]*Se+K[13],Y}([],[s/f*u.N,d/f*u.N],b.u_terrain_matrix),M=[E[0]*S.dim,E[1]*S.dim],z=Math.floor(M[0]),L=Math.floor(M[1]),N=M[0]-z,J=M[1]-L;return S.get(z,L)*(1-N)*(1-J)+S.get(z+1,L)*N*(1-J)+S.get(z,L+1)*(1-N)*J+S.get(z+1,L+1)*N*J}getElevationForLngLatZoom(r,s){const{tileID:d,mercatorX:f,mercatorY:_}=this._getOverscaledTileIDFromLngLatZoom(r,s);return this.getElevation(d,f%u.N,_%u.N,u.N)}getElevation(r,s,d,f=u.N){return this.getDEMElevation(r,s,d,f)*this.exaggeration}getTerrainData(r){if(!this._emptyDemTexture){const f=this.painter.context,_=new u.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new Oe(f,_,f.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new Oe(f,new u.R({width:1,height:1}),f.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(f.gl.NEAREST,f.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=u.ao([])}const s=this.sourceCache.getSourceTile(r,!0);if(s&&s.dem&&(!s.demTexture||s.needsTerrainPrepare)){const f=this.painter.context;s.demTexture=this.painter.getTileTexture(s.dem.stride),s.demTexture?s.demTexture.update(s.dem.getPixels(),{premultiply:!1}):s.demTexture=new Oe(f,s.dem.getPixels(),f.gl.RGBA,{premultiply:!1}),s.demTexture.bind(f.gl.NEAREST,f.gl.CLAMP_TO_EDGE),s.needsTerrainPrepare=!1}const d=s&&s+s.tileID.key+r.key;if(d&&!this._demMatrixCache[d]){const f=this.sourceCache.sourceCache._source.maxzoom;let _=r.canonical.z-s.tileID.canonical.z;r.overscaledZ>r.canonical.z&&(r.canonical.z>=f?_=r.canonical.z-f:u.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const b=r.canonical.x-(r.canonical.x>>_<<_),S=r.canonical.y-(r.canonical.y>>_<<_),E=u.bc(new Float64Array(16),[1/(u.N<<_),1/(u.N<<_),0]);u.$(E,E,[b*u.N,S*u.N,0]),this._demMatrixCache[r.key]={matrix:E,coord:r}}return{u_depth:2,u_terrain:3,u_terrain_dim:s&&s.dem&&s.dem.dim||1,u_terrain_matrix:d?this._demMatrixCache[r.key].matrix:this._emptyDemMatrix,u_terrain_unpack:s&&s.dem&&s.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(s&&s.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:s}}getFramebuffer(r){const s=this.painter,d=s.width/devicePixelRatio,f=s.height/devicePixelRatio;return!this._fbo||this._fbo.width===d&&this._fbo.height===f||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new Oe(s.context,{width:d,height:f,data:null},s.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(s.context.gl.NEAREST,s.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new Oe(s.context,{width:d,height:f,data:null},s.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(s.context.gl.NEAREST,s.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=s.context.createFramebuffer(d,f,!0,!1),this._fbo.depthAttachment.set(s.context.createRenderbuffer(s.context.gl.DEPTH_COMPONENT16,d,f))),this._fbo.colorAttachment.set(r==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const r=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const s=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let _=0,b=0;_<this._coordsTextureSize;_++)for(let S=0;S<this._coordsTextureSize;S++,b+=4)s[b+0]=255&S,s[b+1]=255&_,s[b+2]=S>>8<<4|_>>8,s[b+3]=0;const d=new u.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(s.buffer)),f=new Oe(r,d,r.gl.RGBA,{premultiply:!1});return f.bind(r.gl.NEAREST,r.gl.CLAMP_TO_EDGE),this._coordsTexture=f,f}pointCoordinate(r){const s=new Uint8Array(4),d=this.painter.context,f=d.gl;d.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),f.readPixels(r.x,this.painter.height/devicePixelRatio-r.y-1,1,1,f.RGBA,f.UNSIGNED_BYTE,s),d.bindFramebuffer.set(null);const _=s[0]+(s[2]>>4<<8),b=s[1]+((15&s[2])<<8),S=this.coordsIndex[255-s[3]],E=S&&this.sourceCache.getTileByID(S);if(!E)return null;const M=this._coordsTextureSize,z=(1<<E.tileID.canonical.z)*M;return new u.U(this._allowMercatorOverflow(r,(E.tileID.canonical.x*M+_)/z),(E.tileID.canonical.y*M+b)/z,this.getElevation(E.tileID,_,b,M))}getTerrainMesh(){if(this._mesh)return this._mesh;const r=this.painter.context,s=new u.bd,d=new u.b0,f=this.meshSize,_=u.N/f,b=f*f;for(let L=0;L<=f;L++)for(let N=0;N<=f;N++)s.emplaceBack(N*_,L*_,0);for(let L=0;L<b;L+=f+1)for(let N=0;N<f;N++)d.emplaceBack(N+L,f+N+L+1,f+N+L+2),d.emplaceBack(N+L,f+N+L+2,N+L+1);const S=s.length,E=S+2*(f+1);for(const L of[0,1])for(let N=0;N<=f;N++)for(const J of[0,1])s.emplaceBack(N*_,L*u.N,J);for(let L=0;L<2*f;L+=2)d.emplaceBack(E+L,E+L+1,E+L+3),d.emplaceBack(E+L,E+L+3,E+L+2),d.emplaceBack(S+L,S+L+3,S+L+1),d.emplaceBack(S+L,S+L+2,S+L+3);const M=s.length,z=M+2*(f+1);for(const L of[0,1])for(let N=0;N<=f;N++)for(const J of[0,1])s.emplaceBack(L*u.N,N*_,J);for(let L=0;L<2*f;L+=2)d.emplaceBack(M+L,M+L+1,M+L+3),d.emplaceBack(M+L,M+L+3,M+L+2),d.emplaceBack(z+L,z+L+3,z+L+1),d.emplaceBack(z+L,z+L+2,z+L+3);return this._mesh={indexBuffer:r.createIndexBuffer(d),vertexBuffer:r.createVertexBuffer(s,Od.members),segments:u.S.simpleSegment(0,0,s.length,d.length)},this._mesh}getMeshFrameDelta(r){return 2*Math.PI*u.be/Math.pow(2,r)/5}getMinTileElevationForLngLatZoom(r,s){var d;const{tileID:f}=this._getOverscaledTileIDFromLngLatZoom(r,s);return(d=this.getMinMaxElevation(f).minElevation)!==null&&d!==void 0?d:0}getMinMaxElevation(r){const s=this.getTerrainData(r).tile,d={minElevation:null,maxElevation:null};return s&&s.dem&&(d.minElevation=s.dem.min*this.exaggeration,d.maxElevation=s.dem.max*this.exaggeration),d}_getOverscaledTileIDFromLngLatZoom(r,s){const d=u.U.fromLngLat(r.wrap()),f=(1<<s)*u.N,_=d.x*f,b=d.y*f,S=Math.floor(_/u.N),E=Math.floor(b/u.N);return{tileID:new u.O(s,0,s,S,E),mercatorX:_,mercatorY:b}}_allowMercatorOverflow(r,s){const d=r.x<this.painter.width/2;let f=u.bf(s);const _=this.painter.transform.center.lng;return d&&Math.sign(f)>0&&Math.sign(_)<0||!d&&Math.sign(f)<0&&Math.sign(_)>0?(f=360*Math.sign(_)+f,u.G(f)):s}}class Mm{constructor(r,s,d){this._context=r,this._size=s,this._tileSize=d,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const r of this._objects)r.texture.destroy(),r.fbo.destroy()}_createObject(r){const s=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),d=new Oe(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return d.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),s.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),s.colorAttachment.set(d.texture),{id:r,fbo:s,texture:d,stamp:-1,inUse:!1}}getObjectForId(r){return this._objects[r]}useObject(r){r.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(s=>r.id!==s),this._recentlyUsed.push(r.id)}stampObject(r){r.stamp=++this._stamp}getOrCreateFreeObject(){for(const s of this._recentlyUsed)if(!this._objects[s].inUse)return this._objects[s];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const r=this._createObject(this._objects.length);return this._objects.push(r),r}freeObject(r){r.inUse=!1}freeAllObjects(){for(const r of this._objects)this.freeObject(r)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(r=>!r.inUse)===!1}}const Dr={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class Ul{constructor(r,s){this.painter=r,this.terrain=s,this.pool=new Mm(r.context,30,s.sourceCache.tileSize*s.qualityFactor)}destruct(){this.pool.destruct()}getTexture(r){return this.pool.getObjectForId(r.rtt[this._stacks.length-1].id).texture}prepareForRender(r,s){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=r._order.filter(d=>!r._layers[d].isHidden(s)),this._coordsDescendingInv={};for(const d in r.sourceCaches){this._coordsDescendingInv[d]={};const f=r.sourceCaches[d].getVisibleCoordinates();for(const _ of f){const b=this.terrain.sourceCache.getTerrainCoords(_);for(const S in b)this._coordsDescendingInv[d][S]||(this._coordsDescendingInv[d][S]=[]),this._coordsDescendingInv[d][S].push(b[S])}}this._coordsDescendingInvStr={};for(const d of r._order){const f=r._layers[d],_=f.source;if(Dr[f.type]&&!this._coordsDescendingInvStr[_]){this._coordsDescendingInvStr[_]={};for(const b in this._coordsDescendingInv[_])this._coordsDescendingInvStr[_][b]=this._coordsDescendingInv[_][b].map(S=>S.key).sort().join()}}for(const d of this._renderableTiles)for(const f in this._coordsDescendingInvStr){const _=this._coordsDescendingInvStr[f][d.tileID.key];_&&_!==d.rttCoords[f]&&(d.rtt=[])}}renderLayer(r){if(r.isHidden(this.painter.transform.zoom))return!1;const s=r.type,d=this.painter,f=this._renderableLayerIds[this._renderableLayerIds.length-1]===r.id;if(Dr[s]&&(this._prevType&&Dr[this._prevType]||this._stacks.push([]),this._prevType=s,this._stacks[this._stacks.length-1].push(r.id),!f))return!0;if(Dr[this._prevType]||Dr[s]&&f){this._prevType=s;const _=this._stacks.length-1,b=this._stacks[_]||[];for(const S of this._renderableTiles){if(this.pool.isFull()&&(An(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(S),S.rtt[_]){const M=this.pool.getObjectForId(S.rtt[_].id);if(M.stamp===S.rtt[_].stamp){this.pool.useObject(M);continue}}const E=this.pool.getOrCreateFreeObject();this.pool.useObject(E),this.pool.stampObject(E),S.rtt[_]={id:E.id,stamp:E.stamp},d.context.bindFramebuffer.set(E.fbo.framebuffer),d.context.clear({color:u.aT.transparent,stencil:0}),d.currentStencilSource=void 0;for(let M=0;M<b.length;M++){const z=d.style._layers[b[M]],L=z.source?this._coordsDescendingInv[z.source][S.tileID.key]:[S.tileID];d.context.viewport.set([0,0,E.fbo.width,E.fbo.height]),d._renderTileClippingMasks(z,L),d.renderLayer(d,d.style.sourceCaches[z.source],z,L),z.source&&(S.rttCoords[z.source]=this._coordsDescendingInvStr[z.source][S.tileID.key])}}return An(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects(),Dr[s]}return!1}}const st=C,mt={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:void 0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:u.c.MAX_TILE_CACHE_ZOOM_LEVELS,localIdeographFontFamily:"sans-serif",transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,validateStyle:!0,maxCanvasSize:[4096,4096]},Vs=g=>{g.touchstart=g.dragStart,g.touchmoveWindow=g.dragMove,g.touchend=g.dragEnd},bc={showCompass:!0,showZoom:!0,visualizePitch:!1};class Sc{constructor(r,s,d=!1){this.mousedown=b=>{this.startMouse(u.e({},b,{ctrlKey:!0,preventDefault:()=>b.preventDefault()}),I.mousePos(this.element,b)),I.addEventListener(window,"mousemove",this.mousemove),I.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=b=>{this.moveMouse(b,I.mousePos(this.element,b))},this.mouseup=b=>{this.mouseRotate.dragEnd(b),this.mousePitch&&this.mousePitch.dragEnd(b),this.offTemp()},this.touchstart=b=>{b.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=I.touchPos(this.element,b.targetTouches)[0],this.startTouch(b,this._startPos),I.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),I.addEventListener(window,"touchend",this.touchend))},this.touchmove=b=>{b.targetTouches.length!==1?this.reset():(this._lastPos=I.touchPos(this.element,b.targetTouches)[0],this.moveTouch(b,this._lastPos))},this.touchend=b=>{b.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),this.touchRotate.reset(),this.touchPitch&&this.touchPitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10;const f=r.dragRotate._mouseRotate.getClickTolerance(),_=r.dragRotate._mousePitch.getClickTolerance();this.element=s,this.mouseRotate=Ha({clickTolerance:f,enable:!0}),this.touchRotate=(({enable:b,clickTolerance:S,bearingDegreesPerPixelMoved:E=.8})=>{const M=new Ad;return new Io({clickTolerance:S,move:(z,L)=>({bearingDelta:(L.x-z.x)*E}),moveStateManager:M,enable:b,assignEvents:Vs})})({clickTolerance:f,enable:!0}),this.map=r,d&&(this.mousePitch=ko({clickTolerance:_,enable:!0}),this.touchPitch=(({enable:b,clickTolerance:S,pitchDegreesPerPixelMoved:E=-.5})=>{const M=new Ad;return new Io({clickTolerance:S,move:(z,L)=>({pitchDelta:(L.y-z.y)*E}),moveStateManager:M,enable:b,assignEvents:Vs})})({clickTolerance:_,enable:!0})),I.addEventListener(s,"mousedown",this.mousedown),I.addEventListener(s,"touchstart",this.touchstart,{passive:!1}),I.addEventListener(s,"touchcancel",this.reset)}startMouse(r,s){this.mouseRotate.dragStart(r,s),this.mousePitch&&this.mousePitch.dragStart(r,s),I.disableDrag()}startTouch(r,s){this.touchRotate.dragStart(r,s),this.touchPitch&&this.touchPitch.dragStart(r,s),I.disableDrag()}moveMouse(r,s){const d=this.map,{bearingDelta:f}=this.mouseRotate.dragMove(r,s)||{};if(f&&d.setBearing(d.getBearing()+f),this.mousePitch){const{pitchDelta:_}=this.mousePitch.dragMove(r,s)||{};_&&d.setPitch(d.getPitch()+_)}}moveTouch(r,s){const d=this.map,{bearingDelta:f}=this.touchRotate.dragMove(r,s)||{};if(f&&d.setBearing(d.getBearing()+f),this.touchPitch){const{pitchDelta:_}=this.touchPitch.dragMove(r,s)||{};_&&d.setPitch(d.getPitch()+_)}}off(){const r=this.element;I.removeEventListener(r,"mousedown",this.mousedown),I.removeEventListener(r,"touchstart",this.touchstart,{passive:!1}),I.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),I.removeEventListener(window,"touchend",this.touchend),I.removeEventListener(r,"touchcancel",this.reset),this.offTemp()}offTemp(){I.enableDrag(),I.removeEventListener(window,"mousemove",this.mousemove),I.removeEventListener(window,"mouseup",this.mouseup),I.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),I.removeEventListener(window,"touchend",this.touchend)}}let Vn;function Tc(g,r,s){if(g=new u.L(g.lng,g.lat),r){const d=new u.L(g.lng-360,g.lat),f=new u.L(g.lng+360,g.lat),_=s.locationPoint(g).distSqr(r);s.locationPoint(d).distSqr(r)<_?g=d:s.locationPoint(f).distSqr(r)<_&&(g=f)}for(;Math.abs(g.lng-s.center.lng)>180;){const d=s.locationPoint(g);if(d.x>=0&&d.y>=0&&d.x<=s.width&&d.y<=s.height)break;g.lng>s.center.lng?g.lng-=360:g.lng+=360}return g}const ki={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Nd(g,r,s){const d=g.classList;for(const f in ki)d.remove(`maplibregl-${s}-anchor-${f}`);d.add(`maplibregl-${s}-anchor-${r}`)}class ma extends u.E{constructor(r){if(super(),this._onKeyPress=s=>{const d=s.code,f=s.charCode||s.keyCode;d!=="Space"&&d!=="Enter"&&f!==32&&f!==13||this.togglePopup()},this._onMapClick=s=>{const d=s.originalEvent.target,f=this._element;this._popup&&(d===f||f.contains(d))&&this.togglePopup()},this._update=s=>{if(!this._map)return;const d=this._map.loaded()&&!this._map.isMoving();((s==null?void 0:s.type)==="terrain"||(s==null?void 0:s.type)==="render"&&!d)&&this._map.once("render",this._update),this._map.transform.renderWorldCopies&&(this._lngLat=Tc(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);let f="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?f=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(f=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let _="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?_="rotateX(0deg)":this._pitchAlignment==="map"&&(_=`rotateX(${this._map.getPitch()}deg)`),s&&s.type!=="moveend"||(this._pos=this._pos.round()),I.setTransform(this._element,`${ki[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${_} ${f}`),this._map.terrain&&!this._opacityTimeout&&(this._opacityTimeout=setTimeout(()=>{const b=this._map.unproject(this._pos),S=40075016686e-3*Math.abs(Math.cos(this._lngLat.lat*Math.PI/180))/Math.pow(2,this._map.transform.tileZoom+8);this._element.style.opacity=b.distanceTo(this._lngLat)>20*S?"0.2":"1.0",this._opacityTimeout=null},100))},this._onMove=s=>{if(!this._isDragging){const d=this._clickTolerance||this._map._clickTolerance;this._isDragging=s.point.dist(this._pointerdownPos)>=d}this._isDragging&&(this._pos=s.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new u.k("dragstart"))),this.fire(new u.k("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new u.k("dragend")),this._state="inactive"},this._addDragHandler=s=>{this._element.contains(s.originalEvent.target)&&(s.preventDefault(),this._positionDelta=s.point.sub(this._pos).add(this._offset),this._pointerdownPos=s.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=r&&r.anchor||"center",this._color=r&&r.color||"#3FB1CE",this._scale=r&&r.scale||1,this._draggable=r&&r.draggable||!1,this._clickTolerance=r&&r.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=r&&r.rotation||0,this._rotationAlignment=r&&r.rotationAlignment||"auto",this._pitchAlignment=r&&r.pitchAlignment&&r.pitchAlignment!=="auto"?r.pitchAlignment:this._rotationAlignment,r&&r.element)this._element=r.element,this._offset=u.P.convert(r&&r.offset||[0,0]);else{this._defaultMarker=!0,this._element=I.create("div"),this._element.setAttribute("aria-label","Map marker");const s=I.createNS("http://www.w3.org/2000/svg","svg"),d=41,f=27;s.setAttributeNS(null,"display","block"),s.setAttributeNS(null,"height",`${d}px`),s.setAttributeNS(null,"width",`${f}px`),s.setAttributeNS(null,"viewBox",`0 0 ${f} ${d}`);const _=I.createNS("http://www.w3.org/2000/svg","g");_.setAttributeNS(null,"stroke","none"),_.setAttributeNS(null,"stroke-width","1"),_.setAttributeNS(null,"fill","none"),_.setAttributeNS(null,"fill-rule","evenodd");const b=I.createNS("http://www.w3.org/2000/svg","g");b.setAttributeNS(null,"fill-rule","nonzero");const S=I.createNS("http://www.w3.org/2000/svg","g");S.setAttributeNS(null,"transform","translate(3.0, 29.0)"),S.setAttributeNS(null,"fill","#000000");const E=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const me of E){const Se=I.createNS("http://www.w3.org/2000/svg","ellipse");Se.setAttributeNS(null,"opacity","0.04"),Se.setAttributeNS(null,"cx","10.5"),Se.setAttributeNS(null,"cy","5.80029008"),Se.setAttributeNS(null,"rx",me.rx),Se.setAttributeNS(null,"ry",me.ry),S.appendChild(Se)}const M=I.createNS("http://www.w3.org/2000/svg","g");M.setAttributeNS(null,"fill",this._color);const z=I.createNS("http://www.w3.org/2000/svg","path");z.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),M.appendChild(z);const L=I.createNS("http://www.w3.org/2000/svg","g");L.setAttributeNS(null,"opacity","0.25"),L.setAttributeNS(null,"fill","#000000");const N=I.createNS("http://www.w3.org/2000/svg","path");N.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),L.appendChild(N);const J=I.createNS("http://www.w3.org/2000/svg","g");J.setAttributeNS(null,"transform","translate(6.0, 7.0)"),J.setAttributeNS(null,"fill","#FFFFFF");const Y=I.createNS("http://www.w3.org/2000/svg","g");Y.setAttributeNS(null,"transform","translate(8.0, 8.0)");const te=I.createNS("http://www.w3.org/2000/svg","circle");te.setAttributeNS(null,"fill","#000000"),te.setAttributeNS(null,"opacity","0.25"),te.setAttributeNS(null,"cx","5.5"),te.setAttributeNS(null,"cy","5.5"),te.setAttributeNS(null,"r","5.4999962");const K=I.createNS("http://www.w3.org/2000/svg","circle");K.setAttributeNS(null,"fill","#FFFFFF"),K.setAttributeNS(null,"cx","5.5"),K.setAttributeNS(null,"cy","5.5"),K.setAttributeNS(null,"r","5.4999962"),Y.appendChild(te),Y.appendChild(K),b.appendChild(S),b.appendChild(M),b.appendChild(L),b.appendChild(J),b.appendChild(Y),s.appendChild(b),s.setAttributeNS(null,"height",d*this._scale+"px"),s.setAttributeNS(null,"width",f*this._scale+"px"),this._element.appendChild(s),this._offset=u.P.convert(r&&r.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",s=>{s.preventDefault()}),this._element.addEventListener("mousedown",s=>{s.preventDefault()}),Nd(this._element,this._anchor,"marker"),r&&r.className)for(const s of r.className.split(" "))this._element.classList.add(s);this._popup=null}addTo(r){return this.remove(),this._map=r,r.getCanvasContainer().appendChild(this._element),r.on("move",this._update),r.on("moveend",this._update),r.on("terrain",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),I.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(r){return this._lngLat=u.L.convert(r),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(r){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),r){if(!("offset"in r.options)){const f=Math.abs(13.5)/Math.SQRT2;r.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[f,-1*(38.1-13.5+f)],"bottom-right":[-f,-1*(38.1-13.5+f)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=r,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}getPopup(){return this._popup}togglePopup(){const r=this._popup;return r?(r.isOpen()?r.remove():r.addTo(this._map),this):this}getOffset(){return this._offset}setOffset(r){return this._offset=u.P.convert(r),this._update(),this}addClassName(r){this._element.classList.add(r)}removeClassName(r){this._element.classList.remove(r)}toggleClassName(r){return this._element.classList.toggle(r)}setDraggable(r){return this._draggable=!!r,this._map&&(r?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(r){return this._rotation=r||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(r){return this._rotationAlignment=r||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(r){return this._pitchAlignment=r&&r!=="auto"?r:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}}const zn={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let In=0,Ka=!1;const Ns={maxWidth:100,unit:"metric"};function Us(g,r,s){const d=s&&s.maxWidth||100,f=g._container.clientHeight/2,_=g.unproject([0,f]),b=g.unproject([d,f]),S=_.distanceTo(b);if(s&&s.unit==="imperial"){const E=3.2808*S;E>5280?ga(r,d,E/5280,g._getUIString("ScaleControl.Miles")):ga(r,d,E,g._getUIString("ScaleControl.Feet"))}else s&&s.unit==="nautical"?ga(r,d,S/1852,g._getUIString("ScaleControl.NauticalMiles")):S>=1e3?ga(r,d,S/1e3,g._getUIString("ScaleControl.Kilometers")):ga(r,d,S,g._getUIString("ScaleControl.Meters"))}function ga(g,r,s,d){const f=function(_){const b=Math.pow(10,`${Math.floor(_)}`.length-1);let S=_/b;return S=S>=10?10:S>=5?5:S>=3?3:S>=2?2:S>=1?1:function(E){const M=Math.pow(10,Math.ceil(-Math.log(E)/Math.LN10));return Math.round(E*M)/M}(S),b*S}(s);g.style.width=r*(f/s)+"px",g.innerHTML=`${f}&nbsp;${d}`}const Cc={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Ec=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Xa(g){if(g){if(typeof g=="number"){const r=Math.round(Math.abs(g)/Math.SQRT2);return{center:new u.P(0,0),top:new u.P(0,g),"top-left":new u.P(r,r),"top-right":new u.P(-r,r),bottom:new u.P(0,-g),"bottom-left":new u.P(r,-r),"bottom-right":new u.P(-r,-r),left:new u.P(g,0),right:new u.P(-g,0)}}if(g instanceof u.P||Array.isArray(g)){const r=u.P.convert(g);return{center:r,top:r,"top-left":r,"top-right":r,bottom:r,"bottom-left":r,"bottom-right":r,left:r,right:r}}return{center:u.P.convert(g.center||[0,0]),top:u.P.convert(g.top||[0,0]),"top-left":u.P.convert(g["top-left"]||[0,0]),"top-right":u.P.convert(g["top-right"]||[0,0]),bottom:u.P.convert(g.bottom||[0,0]),"bottom-left":u.P.convert(g["bottom-left"]||[0,0]),"bottom-right":u.P.convert(g["bottom-right"]||[0,0]),left:u.P.convert(g.left||[0,0]),right:u.P.convert(g.right||[0,0])}}return Xa(new u.P(0,0))}const Ic={extend:(g,...r)=>u.e(g,...r),run(g){g()},logToElement(g,r=!1,s="log"){const d=window.document.getElementById(s);d&&(r&&(d.innerHTML=""),d.innerHTML+=`<br>${g}`)}},kc=C;class en{static get version(){return kc}static get workerCount(){return br.workerCount}static set workerCount(r){br.workerCount=r}static get maxParallelImageRequests(){return u.c.MAX_PARALLEL_IMAGE_REQUESTS}static set maxParallelImageRequests(r){u.c.MAX_PARALLEL_IMAGE_REQUESTS=r}static get workerUrl(){return u.c.WORKER_URL}static set workerUrl(r){u.c.WORKER_URL=r}static addProtocol(r,s){u.c.REGISTERED_PROTOCOLS[r]=s}static removeProtocol(r){delete u.c.REGISTERED_PROTOCOLS[r]}}return en.Map=class extends Fd{constructor(g){if(u.bg.mark(u.bh.create),(g=u.e({},mt,g)).minZoom!=null&&g.maxZoom!=null&&g.minZoom>g.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(g.minPitch!=null&&g.maxPitch!=null&&g.minPitch>g.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(g.minPitch!=null&&g.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(g.maxPitch!=null&&g.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new Fl(g.minZoom,g.maxZoom,g.minPitch,g.maxPitch,g.renderWorldCopies),{bearingSnap:g.bearingSnap}),this._cooperativeGesturesOnWheel=r=>{this._onCooperativeGesture(r,r[this._metaKey],1)},this._contextLost=r=>{r.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new u.k("webglcontextlost",{originalEvent:r}))},this._contextRestored=r=>{this._setupPainter(),this.resize(),this._update(),this.fire(new u.k("webglcontextrestored",{originalEvent:r}))},this._onMapScroll=r=>{if(r.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=g.interactive,this._cooperativeGestures=g.cooperativeGestures,this._metaKey=navigator.platform.indexOf("Mac")===0?"metaKey":"ctrlKey",this._maxTileCacheSize=g.maxTileCacheSize,this._maxTileCacheZoomLevels=g.maxTileCacheZoomLevels,this._failIfMajorPerformanceCaveat=g.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=g.preserveDrawingBuffer,this._antialias=g.antialias,this._trackResize=g.trackResize,this._bearingSnap=g.bearingSnap,this._refreshExpiredTiles=g.refreshExpiredTiles,this._fadeDuration=g.fadeDuration,this._crossSourceCollisions=g.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=g.collectResourceTiming,this._renderTaskQueue=new Nl,this._controls=[],this._mapId=u.a2(),this._locale=u.e({},wc,g.locale),this._clickTolerance=g.clickTolerance,this._overridePixelRatio=g.pixelRatio,this._maxCanvasSize=g.maxCanvasSize,this.transformCameraUpdate=g.transformCameraUpdate,this._imageQueueHandle=oe.addThrottleControl(()=>this.isMoving()),this._requestManager=new G(g.transformRequest),typeof g.container=="string"){if(this._container=document.getElementById(g.container),!this._container)throw new Error(`Container '${g.container}' not found.`)}else{if(!(g.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=g.container}if(g.maxBounds&&this.setMaxBounds(g.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),this.once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let r=!1;const s=fa(d=>{this._trackResize&&!this._removed&&this.resize(d)._update()},50);this._resizeObserver=new ResizeObserver(d=>{r?s(d):r=!0}),this._resizeObserver.observe(this._container)}this.handlers=new xc(this,g),this._cooperativeGestures&&this._setupCooperativeGestures(),this._hash=g.hash&&new Ls(typeof g.hash=="string"&&g.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:g.center,zoom:g.zoom,bearing:g.bearing,pitch:g.pitch}),g.bounds&&(this.resize(),this.fitBounds(g.bounds,u.e({},g.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=g.localIdeographFontFamily,this._validateStyle=g.validateStyle,g.style&&this.setStyle(g.style,{localIdeographFontFamily:g.localIdeographFontFamily}),g.attributionControl&&this.addControl(new ci({customAttribution:g.customAttribution})),g.maplibreLogo&&this.addControl(new yn,g.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",r=>{this._update(r.dataType==="style"),this.fire(new u.k(`${r.dataType}data`,r))}),this.on("dataloading",r=>{this.fire(new u.k(`${r.dataType}dataloading`,r))}),this.on("dataabort",r=>{this.fire(new u.k("sourcedataabort",r))})}_getMapId(){return this._mapId}addControl(g,r){if(r===void 0&&(r=g.getDefaultPosition?g.getDefaultPosition():"top-right"),!g||!g.onAdd)return this.fire(new u.j(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const s=g.onAdd(this);this._controls.push(g);const d=this._controlPositions[r];return r.indexOf("bottom")!==-1?d.insertBefore(s,d.firstChild):d.appendChild(s),this}removeControl(g){if(!g||!g.onRemove)return this.fire(new u.j(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const r=this._controls.indexOf(g);return r>-1&&this._controls.splice(r,1),g.onRemove(this),this}hasControl(g){return this._controls.indexOf(g)>-1}calculateCameraOptionsFromTo(g,r,s,d){return d==null&&this.terrain&&(d=this.terrain.getElevationForLngLatZoom(s,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(g,r,s,d)}resize(g){var r;const s=this._containerDimensions(),d=s[0],f=s[1],_=this._getClampedPixelRatio(d,f);if(this._resizeCanvas(d,f,_),this.painter.resize(d,f,_),this.painter.overLimit()){const S=this.painter.context.gl;this._maxCanvasSize=[S.drawingBufferWidth,S.drawingBufferHeight];const E=this._getClampedPixelRatio(d,f);this._resizeCanvas(d,f,E),this.painter.resize(d,f,E)}this.transform.resize(d,f),(r=this._requestedCameraState)===null||r===void 0||r.resize(d,f);const b=!this._moving;return b&&(this.stop(),this.fire(new u.k("movestart",g)).fire(new u.k("move",g))),this.fire(new u.k("resize",g)),b&&this.fire(new u.k("moveend",g)),this}_getClampedPixelRatio(g,r){const{0:s,1:d}=this._maxCanvasSize,f=this.getPixelRatio(),_=g*f,b=r*f;return Math.min(_>s?s/_:1,b>d?d/b:1)*f}getPixelRatio(){var g;return(g=this._overridePixelRatio)!==null&&g!==void 0?g:devicePixelRatio}setPixelRatio(g){this._overridePixelRatio=g,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(g){return this.transform.setMaxBounds(_t.convert(g)),this._update()}setMinZoom(g){if((g=g??-2)>=-2&&g<=this.transform.maxZoom)return this.transform.minZoom=g,this._update(),this.getZoom()<g&&this.setZoom(g),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(g){if((g=g??22)>=this.transform.minZoom)return this.transform.maxZoom=g,this._update(),this.getZoom()>g&&this.setZoom(g),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(g){if((g=g??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(g>=0&&g<=this.transform.maxPitch)return this.transform.minPitch=g,this._update(),this.getPitch()<g&&this.setPitch(g),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(g){if((g=g??60)>85)throw new Error("maxPitch must be less than or equal to 85");if(g>=this.transform.minPitch)return this.transform.maxPitch=g,this._update(),this.getPitch()>g&&this.setPitch(g),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(g){return this.transform.renderWorldCopies=g,this._update()}getCooperativeGestures(){return this._cooperativeGestures}setCooperativeGestures(g){return this._cooperativeGestures=g,this._cooperativeGestures?this._setupCooperativeGestures():this._destroyCooperativeGestures(),this}project(g){return this.transform.locationPoint(u.L.convert(g),this.style&&this.terrain)}unproject(g){return this.transform.pointLocation(u.P.convert(g),this.terrain)}isMoving(){var g;return this._moving||((g=this.handlers)===null||g===void 0?void 0:g.isMoving())}isZooming(){var g;return this._zooming||((g=this.handlers)===null||g===void 0?void 0:g.isZooming())}isRotating(){var g;return this._rotating||((g=this.handlers)===null||g===void 0?void 0:g.isRotating())}_createDelegatedListener(g,r,s){if(g==="mouseenter"||g==="mouseover"){let d=!1;return{layer:r,listener:s,delegates:{mousemove:_=>{const b=this.getLayer(r)?this.queryRenderedFeatures(_.point,{layers:[r]}):[];b.length?d||(d=!0,s.call(this,new ui(g,this,_.originalEvent,{features:b}))):d=!1},mouseout:()=>{d=!1}}}}if(g==="mouseleave"||g==="mouseout"){let d=!1;return{layer:r,listener:s,delegates:{mousemove:b=>{(this.getLayer(r)?this.queryRenderedFeatures(b.point,{layers:[r]}):[]).length?d=!0:d&&(d=!1,s.call(this,new ui(g,this,b.originalEvent)))},mouseout:b=>{d&&(d=!1,s.call(this,new ui(g,this,b.originalEvent)))}}}}{const d=f=>{const _=this.getLayer(r)?this.queryRenderedFeatures(f.point,{layers:[r]}):[];_.length&&(f.features=_,s.call(this,f),delete f.features)};return{layer:r,listener:s,delegates:{[g]:d}}}}on(g,r,s){if(s===void 0)return super.on(g,r);const d=this._createDelegatedListener(g,r,s);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[g]=this._delegatedListeners[g]||[],this._delegatedListeners[g].push(d);for(const f in d.delegates)this.on(f,d.delegates[f]);return this}once(g,r,s){if(s===void 0)return super.once(g,r);const d=this._createDelegatedListener(g,r,s);for(const f in d.delegates)this.once(f,d.delegates[f]);return this}off(g,r,s){return s===void 0?super.off(g,r):(this._delegatedListeners&&this._delegatedListeners[g]&&(d=>{const f=this._delegatedListeners[g];for(let _=0;_<f.length;_++){const b=f[_];if(b.layer===r&&b.listener===s){for(const S in b.delegates)this.off(S,b.delegates[S]);return f.splice(_,1),this}}})(),this)}queryRenderedFeatures(g,r){if(!this.style)return[];let s;const d=g instanceof u.P||Array.isArray(g),f=d?g:[[0,0],[this.transform.width,this.transform.height]];if(r=r||(d?{}:g)||{},f instanceof u.P||typeof f[0]=="number")s=[u.P.convert(f)];else{const _=u.P.convert(f[0]),b=u.P.convert(f[1]);s=[_,new u.P(b.x,_.y),b,new u.P(_.x,b.y),_]}return this.style.queryRenderedFeatures(s,r,this.transform)}querySourceFeatures(g,r){return this.style.querySourceFeatures(g,r)}setStyle(g,r){return(r=u.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},r)).diff!==!1&&r.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&g?(this._diffStyle(g,r),this):(this._localIdeographFontFamily=r.localIdeographFontFamily,this._updateStyle(g,r))}setTransformRequest(g){return this._requestManager.setTransformRequest(g),this}_getUIString(g){const r=this._locale[g];if(r==null)throw new Error(`Missing UI string '${g}'`);return r}_updateStyle(g,r){if(r.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(g,r));const s=this.style&&r.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!g)),g?(this.style=new mr(this,r||{}),this.style.setEventedParent(this,{style:this.style}),typeof g=="string"?this.style.loadURL(g,r,s):this.style.loadJSON(g,r,s),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new mr(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(g,r){if(typeof g=="string"){const s=this._requestManager.transformRequest(g,$.Style);u.f(s,(d,f)=>{d?this.fire(new u.j(d)):f&&this._updateDiff(f,r)})}else typeof g=="object"&&this._updateDiff(g,r)}_updateDiff(g,r){try{this.style.setState(g,r)&&this._update(!0)}catch(s){u.w(`Unable to perform style diff: ${s.message||s.error||s}.  Rebuilding the style from scratch.`),this._updateStyle(g,r)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():u.w("There is no style added to the map.")}addSource(g,r){return this._lazyInitEmptyStyle(),this.style.addSource(g,r),this._update(!0)}isSourceLoaded(g){const r=this.style&&this.style.sourceCaches[g];if(r!==void 0)return r.loaded();this.fire(new u.j(new Error(`There is no source with ID '${g}'`)))}setTerrain(g){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),g){const r=this.style.sourceCaches[g.source];if(!r)throw new Error(`cannot load terrain, because there exists no source with ID: ${g.source}`);for(const s in this.style._layers){const d=this.style._layers[s];d.type==="hillshade"&&d.source===g.source&&u.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new Vd(this.painter,r,g),this.painter.renderToTexture=new Ul(this.painter,this.terrain),this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._terrainDataCallback=s=>{s.dataType==="style"?this.terrain.sourceCache.freeRtt():s.dataType==="source"&&s.tile&&(s.sourceId!==g.source||this._elevationFreeze||(this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.terrain.sourceCache.freeRtt(s.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform._minEleveationForCurrentTile=0,this.transform.elevation=0;return this.fire(new u.k("terrain",{terrain:g})),this}getTerrain(){var g,r;return(r=(g=this.terrain)===null||g===void 0?void 0:g.options)!==null&&r!==void 0?r:null}areTilesLoaded(){const g=this.style&&this.style.sourceCaches;for(const r in g){const s=g[r]._tiles;for(const d in s){const f=s[d];if(f.state!=="loaded"&&f.state!=="errored")return!1}}return!0}addSourceType(g,r,s){return this._lazyInitEmptyStyle(),this.style.addSourceType(g,r,s)}removeSource(g){return this.style.removeSource(g),this._update(!0)}getSource(g){return this.style.getSource(g)}addImage(g,r,s={}){const{pixelRatio:d=1,sdf:f=!1,stretchX:_,stretchY:b,content:S}=s;if(this._lazyInitEmptyStyle(),!(r instanceof HTMLImageElement||u.a(r))){if(r.width===void 0||r.height===void 0)return this.fire(new u.j(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:E,height:M,data:z}=r,L=r;return this.style.addImage(g,{data:new u.R({width:E,height:M},new Uint8Array(z)),pixelRatio:d,stretchX:_,stretchY:b,content:S,sdf:f,version:0,userImage:L}),L.onAdd&&L.onAdd(this,g),this}}{const{width:E,height:M,data:z}=u.h.getImageData(r);this.style.addImage(g,{data:new u.R({width:E,height:M},z),pixelRatio:d,stretchX:_,stretchY:b,content:S,sdf:f,version:0})}}updateImage(g,r){const s=this.style.getImage(g);if(!s)return this.fire(new u.j(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const d=r instanceof HTMLImageElement||u.a(r)?u.h.getImageData(r):r,{width:f,height:_,data:b}=d;if(f===void 0||_===void 0)return this.fire(new u.j(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(f!==s.data.width||_!==s.data.height)return this.fire(new u.j(new Error("The width and height of the updated image must be that same as the previous version of the image")));const S=!(r instanceof HTMLImageElement||u.a(r));return s.data.replace(b,S),this.style.updateImage(g,s),this}getImage(g){return this.style.getImage(g)}hasImage(g){return g?!!this.style.getImage(g):(this.fire(new u.j(new Error("Missing required image id"))),!1)}removeImage(g){this.style.removeImage(g)}loadImage(g,r){oe.getImage(this._requestManager.transformRequest(g,$.Image),r)}listImages(){return this.style.listImages()}addLayer(g,r){return this._lazyInitEmptyStyle(),this.style.addLayer(g,r),this._update(!0)}moveLayer(g,r){return this.style.moveLayer(g,r),this._update(!0)}removeLayer(g){return this.style.removeLayer(g),this._update(!0)}getLayer(g){return this.style.getLayer(g)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(g,r,s){return this.style.setLayerZoomRange(g,r,s),this._update(!0)}setFilter(g,r,s={}){return this.style.setFilter(g,r,s),this._update(!0)}getFilter(g){return this.style.getFilter(g)}setPaintProperty(g,r,s,d={}){return this.style.setPaintProperty(g,r,s,d),this._update(!0)}getPaintProperty(g,r){return this.style.getPaintProperty(g,r)}setLayoutProperty(g,r,s,d={}){return this.style.setLayoutProperty(g,r,s,d),this._update(!0)}getLayoutProperty(g,r){return this.style.getLayoutProperty(g,r)}setGlyphs(g,r={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(g,r),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(g,r,s={}){return this._lazyInitEmptyStyle(),this.style.addSprite(g,r,s,d=>{d||this._update(!0)}),this}removeSprite(g){return this._lazyInitEmptyStyle(),this.style.removeSprite(g),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(g,r={}){return this._lazyInitEmptyStyle(),this.style.setSprite(g,r,s=>{s||this._update(!0)}),this}setLight(g,r={}){return this._lazyInitEmptyStyle(),this.style.setLight(g,r),this._update(!0)}getLight(){return this.style.getLight()}setFeatureState(g,r){return this.style.setFeatureState(g,r),this._update()}removeFeatureState(g,r){return this.style.removeFeatureState(g,r),this._update()}getFeatureState(g){return this.style.getFeatureState(g)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let g=0,r=0;return this._container&&(g=this._container.clientWidth||400,r=this._container.clientHeight||300),[g,r]}_setupContainer(){const g=this._container;g.classList.add("maplibregl-map");const r=this._canvasContainer=I.create("div","maplibregl-canvas-container",g);this._interactive&&r.classList.add("maplibregl-interactive"),this._canvas=I.create("canvas","maplibregl-canvas",r),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");const s=this._containerDimensions(),d=this._getClampedPixelRatio(s[0],s[1]);this._resizeCanvas(s[0],s[1],d);const f=this._controlContainer=I.create("div","maplibregl-control-container",g),_=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(b=>{_[b]=I.create("div",`maplibregl-ctrl-${b} `,f)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_setupCooperativeGestures(){this._cooperativeGesturesScreen=I.create("div","maplibregl-cooperative-gesture-screen",this._container);let g=typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.windowsHelpText?this._cooperativeGestures.windowsHelpText:"Use Ctrl + scroll to zoom the map";navigator.platform.indexOf("Mac")===0&&(g=typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.macHelpText?this._cooperativeGestures.macHelpText:"Use ⌘ + scroll to zoom the map"),this._cooperativeGesturesScreen.innerHTML=`
            <div class="maplibregl-desktop-message">${g}</div>
            <div class="maplibregl-mobile-message">${typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.mobileHelpText?this._cooperativeGestures.mobileHelpText:"Use two fingers to move the map"}</div>
        `,this._cooperativeGesturesScreen.setAttribute("aria-hidden","true"),this._canvasContainer.addEventListener("wheel",this._cooperativeGesturesOnWheel,!1),this._canvasContainer.classList.add("maplibregl-cooperative-gestures")}_destroyCooperativeGestures(){I.remove(this._cooperativeGesturesScreen),this._canvasContainer.removeEventListener("wheel",this._cooperativeGesturesOnWheel,!1),this._canvasContainer.classList.remove("maplibregl-cooperative-gestures")}_resizeCanvas(g,r,s){this._canvas.width=Math.floor(s*g),this._canvas.height=Math.floor(s*r),this._canvas.style.width=`${g}px`,this._canvas.style.height=`${r}px`}_setupPainter(){const g={alpha:!0,stencil:!0,depth:!0,failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1};let r=null;this._canvas.addEventListener("webglcontextcreationerror",d=>{r={requestedAttributes:g},d&&(r.statusMessage=d.statusMessage,r.type=d.type)},{once:!0});const s=this._canvas.getContext("webgl2",g)||this._canvas.getContext("webgl",g);if(!s){const d="Failed to initialize WebGL";throw r?(r.message=d,new Error(JSON.stringify(r))):new Error(d)}this.painter=new pa(s,this.transform),D.testSupport(s)}_onCooperativeGesture(g,r,s){return!r&&s<2&&(this._cooperativeGesturesScreen.classList.add("maplibregl-show"),setTimeout(()=>{this._cooperativeGesturesScreen.classList.remove("maplibregl-show")},100)),!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(g){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||g,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(g){return this._update(),this._renderTaskQueue.add(g)}_cancelRenderFrame(g){this._renderTaskQueue.remove(g)}_render(g){const r=this._idleTriggered?this._fadeDuration:0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(g),this._removed)return;let s=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const f=this.transform.zoom,_=u.h.now();this.style.zoomHistory.update(f,_);const b=new u.a8(f,{now:_,fadeDuration:r,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),S=b.crossFadingFactor();S===1&&S===this._crossFadingFactor||(s=!0,this._crossFadingFactor=S),this.style.update(b)}this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._elevationFreeze||(this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform._minEleveationForCurrentTile=0,this.transform.elevation=0),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,r,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:r,showPadding:this.showPadding}),this.fire(new u.k("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,u.bg.mark(u.bh.load),this.fire(new u.k("load"))),this.style&&(this.style.hasTransitions()||s)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const d=this._sourcesDirty||this._styleDirty||this._placementDirty;return d||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new u.k("idle")),!this._loaded||this._fullyLoaded||d||(this._fullyLoaded=!0,u.bg.mark(u.bh.fullLoad)),this}redraw(){return this.style&&(this._frame&&(this._frame.cancel(),this._frame=null),this._render(0)),this}remove(){var g;this._hash&&this._hash.remove();for(const s of this._controls)s.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),oe.removeThrottleControl(this._imageQueueHandle),(g=this._resizeObserver)===null||g===void 0||g.disconnect();const r=this.painter.context.gl.getExtension("WEBGL_lose_context");r&&r.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),I.remove(this._canvasContainer),I.remove(this._controlContainer),this._cooperativeGestures&&this._destroyCooperativeGestures(),this._container.classList.remove("maplibregl-map"),u.bg.clearMetrics(),this._removed=!0,this.fire(new u.k("remove"))}triggerRepaint(){this.style&&!this._frame&&(this._frame=u.h.frame(g=>{u.bg.frame(g),this._frame=null,this._render(g)}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(g){this._showTileBoundaries!==g&&(this._showTileBoundaries=g,this._update())}get showPadding(){return!!this._showPadding}set showPadding(g){this._showPadding!==g&&(this._showPadding=g,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(g){this._showCollisionBoxes!==g&&(this._showCollisionBoxes=g,g?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(g){this._showOverdrawInspector!==g&&(this._showOverdrawInspector=g,this._update())}get repaint(){return!!this._repaint}set repaint(g){this._repaint!==g&&(this._repaint=g,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(g){this._vertices=g,this._update()}get version(){return st}getCameraTargetElevation(){return this.transform.elevation}},en.NavigationControl=class{constructor(g){this._updateZoomButtons=()=>{const r=this._map.getZoom(),s=r===this._map.getMaxZoom(),d=r===this._map.getMinZoom();this._zoomInButton.disabled=s,this._zoomOutButton.disabled=d,this._zoomInButton.setAttribute("aria-disabled",s.toString()),this._zoomOutButton.setAttribute("aria-disabled",d.toString())},this._rotateCompassArrow=()=>{const r=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=r},this._setButtonTitle=(r,s)=>{const d=this._map._getUIString(`NavigationControl.${s}`);r.title=d,r.setAttribute("aria-label",d)},this.options=u.e({},bc,g),this._container=I.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",r=>r.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",r=>this._map.zoomIn({},{originalEvent:r})),I.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",r=>this._map.zoomOut({},{originalEvent:r})),I.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",r=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:r}):this._map.resetNorth({},{originalEvent:r})}),this._compassIcon=I.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(g){return this._map=g,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Sc(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){I.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(g,r){const s=I.create("button",g,this._container);return s.type="button",s.addEventListener("click",r),s}},en.GeolocateControl=class extends u.E{constructor(g){super(),this._onSuccess=r=>{if(this._map){if(this._isOutOfMapMaxBounds(r))return this._setErrorState(),this.fire(new u.k("outofmaxbounds",r)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=r,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(r),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(r),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new u.k("geolocate",r)),this._finish()}},this._updateCamera=r=>{const s=new u.L(r.coords.longitude,r.coords.latitude),d=r.coords.accuracy,f=this._map.getBearing(),_=u.e({bearing:f},this.options.fitBoundsOptions),b=_t.fromLngLat(s,d);this._map.fitBounds(b,_,{geolocateSource:!0})},this._updateMarker=r=>{if(r){const s=new u.L(r.coords.longitude,r.coords.latitude);this._accuracyCircleMarker.setLngLat(s).addTo(this._map),this._userLocationDotMarker.setLngLat(s).addTo(this._map),this._accuracy=r.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=r=>{if(this._map){if(this.options.trackUserLocation)if(r.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const s=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=s,this._geolocateButton.setAttribute("aria-label",s),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(r.code===3&&Ka)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new u.k("error",r)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=r=>{if(this._map){if(this._container.addEventListener("contextmenu",s=>s.preventDefault()),this._geolocateButton=I.create("button","maplibregl-ctrl-geolocate",this._container),I.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",r===!1){u.w("Geolocation support is not available so the GeolocateControl will be disabled.");const s=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=s,this._geolocateButton.setAttribute("aria-label",s)}else{const s=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=s,this._geolocateButton.setAttribute("aria-label",s)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=I.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new ma({element:this._dotElement}),this._circleElement=I.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new ma({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",s=>{s.geolocateSource||this._watchState!=="ACTIVE_LOCK"||s.originalEvent&&s.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new u.k("trackuserlocationend")))})}},this.options=u.e({},zn,g)}onAdd(g){return this._map=g,this._container=I.create("div","maplibregl-ctrl maplibregl-ctrl-group"),function(r,s=!1){Vn===void 0||s?window.navigator.permissions!==void 0?window.navigator.permissions.query({name:"geolocation"}).then(d=>{Vn=d.state!=="denied",r(Vn)}).catch(()=>{Vn=!!window.navigator.geolocation,r(Vn)}):(Vn=!!window.navigator.geolocation,r(Vn)):r(Vn)}(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),I.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,In=0,Ka=!1}_isOutOfMapMaxBounds(g){const r=this._map.getMaxBounds(),s=g.coords;return r&&(s.longitude<r.getWest()||s.longitude>r.getEast()||s.latitude<r.getSouth()||s.latitude>r.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const g=this._map.getBounds(),r=g.getSouthEast(),s=g.getNorthEast(),d=r.distanceTo(s),f=Math.ceil(this._accuracy/(d/this._map._container.clientHeight)*2);this._circleElement.style.width=`${f}px`,this._circleElement.style.height=`${f}px`}trigger(){if(!this._setup)return u.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new u.k("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":In--,Ka=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new u.k("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new u.k("trackuserlocationstart"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let g;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),In++,In>1?(g={maximumAge:6e5,timeout:0},Ka=!0):(g=this.options.positionOptions,Ka=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,g)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},en.AttributionControl=ci,en.LogoControl=yn,en.ScaleControl=class{constructor(g){this._onMove=()=>{Us(this._map,this._container,this.options)},this.setUnit=r=>{this.options.unit=r,Us(this._map,this._container,this.options)},this.options=u.e({},Ns,g)}getDefaultPosition(){return"bottom-left"}onAdd(g){return this._map=g,this._container=I.create("div","maplibregl-ctrl maplibregl-ctrl-scale",g.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){I.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},en.FullscreenControl=class extends u.E{constructor(g={}){super(),this._onFullscreenChange=()=>{(window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement)===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,g&&g.container&&(g.container instanceof HTMLElement?this._container=g.container:u.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(g){return this._map=g,this._container||(this._container=this._map.getContainer()),this._controlContainer=I.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){I.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const g=this._fullscreenButton=I.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);I.create("span","maplibregl-ctrl-icon",g).setAttribute("aria-hidden","true"),g.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const g=this._getTitle();this._fullscreenButton.setAttribute("aria-label",g),this._fullscreenButton.title=g}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new u.k("fullscreenstart")),this._map._cooperativeGestures&&(this._prevCooperativeGestures=this._map._cooperativeGestures,this._map.setCooperativeGestures())):(this.fire(new u.k("fullscreenend")),this._prevCooperativeGestures&&(this._map.setCooperativeGestures(this._prevCooperativeGestures),delete this._prevCooperativeGestures))}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},en.TerrainControl=class{constructor(g){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.disableTerrain")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.enableTerrain"))},this.options=g}onAdd(g){return this._map=g,this._container=I.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=I.create("button","maplibregl-ctrl-terrain",this._container),I.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){I.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},en.Popup=class extends u.E{constructor(g){super(),this.remove=()=>(this._content&&I.remove(this._content),this._container&&(I.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new u.k("close")),this),this._onMouseUp=r=>{this._update(r.point)},this._onMouseMove=r=>{this._update(r.point)},this._onDrag=r=>{this._update(r.point)},this._update=r=>{if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=I.create("div","maplibregl-popup",this._map.getContainer()),this._tip=I.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const b of this.options.className.split(" "))this._container.classList.add(b);this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Tc(this._lngLat,this._pos,this._map.transform)),this._trackPointer&&!r)return;const s=this._pos=this._trackPointer&&r?r:this._map.project(this._lngLat);let d=this.options.anchor;const f=Xa(this.options.offset);if(!d){const b=this._container.offsetWidth,S=this._container.offsetHeight;let E;E=s.y+f.bottom.y<S?["top"]:s.y>this._map.transform.height-S?["bottom"]:[],s.x<b/2?E.push("left"):s.x>this._map.transform.width-b/2&&E.push("right"),d=E.length===0?"bottom":E.join("-")}const _=s.add(f[d]).round();I.setTransform(this._container,`${ki[d]} translate(${_.x}px,${_.y}px)`),Nd(this._container,d,"popup")},this._onClose=()=>{this.remove()},this.options=u.e(Object.create(Cc),g)}addTo(g){return this._map&&this.remove(),this._map=g,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new u.k("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(g){return this._lngLat=u.L.convert(g),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(g){return this.setDOMContent(document.createTextNode(g))}setHTML(g){const r=document.createDocumentFragment(),s=document.createElement("body");let d;for(s.innerHTML=g;d=s.firstChild,d;)r.appendChild(d);return this.setDOMContent(r)}getMaxWidth(){var g;return(g=this._container)===null||g===void 0?void 0:g.style.maxWidth}setMaxWidth(g){return this.options.maxWidth=g,this._update(),this}setDOMContent(g){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=I.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(g),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(g){this._container&&this._container.classList.add(g)}removeClassName(g){this._container&&this._container.classList.remove(g)}setOffset(g){return this.options.offset=g,this._update(),this}toggleClassName(g){if(this._container)return this._container.classList.toggle(g)}_createCloseButton(){this.options.closeButton&&(this._closeButton=I.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const g=this._container.querySelector(Ec);g&&g.focus()}},en.Marker=ma,en.Style=mr,en.LngLat=u.L,en.LngLatBounds=_t,en.Point=u.P,en.MercatorCoordinate=u.U,en.Evented=u.E,en.AJAXError=u.bi,en.config=u.c,en.CanvasSource=Gn,en.GeoJSONSource=Mn,en.ImageSource=tr,en.RasterDEMTileSource=hn,en.RasterTileSource=Zt,en.VectorTileSource=tn,en.VideoSource=xn,en.setRTLTextPlugin=u.bj,en.getRTLTextPluginStatus=u.bk,en.prewarm=function(){Va().acquire(Dt)},en.clearPrewarmedResources=function(){const g=Zr;g&&(g.isPreloaded()&&g.numActive()===1?(g.release(Dt),Zr=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},Ic.extend(en,{isSafari:u.ac,getPerformanceMetrics:u.bg.getPerformanceMetrics}),en});var x=c;return x})})(fS);var gS=fS.exports;const _v=x_(gS),yP=v_({__proto__:null,default:_v},[gS]);var yi=(e,t,o)=>new Promise((l,c)=>{var m=C=>{try{u(o.next(C))}catch(I){c(I)}},x=C=>{try{u(o.throw(C))}catch(I){c(I)}},u=C=>C.done?l(C.value):Promise.resolve(C.value).then(m,x);u((o=o.apply(e,t)).next())}),Gi=Uint8Array,gu=Uint16Array,_P=Int32Array,yS=new Gi([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),_S=new Gi([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),vP=new Gi([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),vS=function(e,t){for(var o=new gu(31),l=0;l<31;++l)o[l]=t+=1<<e[l-1];for(var c=new _P(o[30]),l=1;l<30;++l)for(var m=o[l];m<o[l+1];++m)c[m]=m-o[l]<<5|l;return{b:o,r:c}},xS=vS(yS,2),wS=xS.b,xP=xS.r;wS[28]=258,xP[258]=28;var wP=vS(_S,0),bP=wP.b,l_=new gu(32768);for(cn=0;cn<32768;++cn)Ca=(cn&43690)>>1|(cn&21845)<<1,Ca=(Ca&52428)>>2|(Ca&13107)<<2,Ca=(Ca&61680)>>4|(Ca&3855)<<4,l_[cn]=((Ca&65280)>>8|(Ca&255)<<8)>>1;var Ca,cn,Eh=function(e,t,o){for(var l=e.length,c=0,m=new gu(t);c<l;++c)e[c]&&++m[e[c]-1];var x=new gu(t);for(c=1;c<t;++c)x[c]=x[c-1]+m[c-1]<<1;var u;if(o){u=new gu(1<<t);var C=15-t;for(c=0;c<l;++c)if(e[c])for(var I=c<<4|e[c],D=t-e[c],O=x[e[c]-1]++<<D,U=O|(1<<D)-1;O<=U;++O)u[l_[O]>>C]=I}else for(u=new gu(l),c=0;c<l;++c)e[c]&&(u[c]=l_[x[e[c]-1]++]>>15-e[c]);return u},td=new Gi(288);for(cn=0;cn<144;++cn)td[cn]=8;var cn;for(cn=144;cn<256;++cn)td[cn]=9;var cn;for(cn=256;cn<280;++cn)td[cn]=7;var cn;for(cn=280;cn<288;++cn)td[cn]=8;var cn,bS=new Gi(32);for(cn=0;cn<32;++cn)bS[cn]=5;var cn,SP=Eh(td,9,1),TP=Eh(bS,5,1),Kg=function(e){for(var t=e[0],o=1;o<e.length;++o)e[o]>t&&(t=e[o]);return t},Ro=function(e,t,o){var l=t/8|0;return(e[l]|e[l+1]<<8)>>(t&7)&o},Xg=function(e,t){var o=t/8|0;return(e[o]|e[o+1]<<8|e[o+2]<<16)>>(t&7)},CP=function(e){return(e+7)/8|0},EP=function(e,t,o){(t==null||t<0)&&(t=0),(o==null||o>e.length)&&(o=e.length);var l=new Gi(o-t);return l.set(e.subarray(t,o)),l},IP=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],qi=function(e,t,o){var l=new Error(t||IP[e]);if(l.code=e,Error.captureStackTrace&&Error.captureStackTrace(l,qi),!o)throw l;return l},vv=function(e,t,o,l){var c=e.length,m=l?l.length:0;if(!c||t.f&&!t.l)return o||new Gi(0);var x=!o||t.i!=2,u=t.i;o||(o=new Gi(c*3));var C=function(tr){var xn=o.length;if(tr>xn){var Gn=new Gi(Math.max(xn*2,tr));Gn.set(o),o=Gn}},I=t.f||0,D=t.p||0,O=t.b||0,U=t.l,le=t.d,ue=t.m,ae=t.n,oe=c*8;do{if(!U){I=Ro(e,D,1);var $=Ro(e,D+1,3);if(D+=3,$)if($==1)U=SP,le=TP,ue=9,ae=5;else if($==2){var Ce=Ro(e,D,31)+257,de=Ro(e,D+10,15)+4,be=Ce+Ro(e,D+5,31)+1;D+=14;for(var Me=new Gi(be),Ze=new Gi(19),Oe=0;Oe<de;++Oe)Ze[vP[Oe]]=Ro(e,D+Oe*3,7);D+=de*3;for(var ft=Kg(Ze),bt=(1<<ft)-1,Rt=Eh(Ze,ft,1),Oe=0;Oe<be;){var Ft=Rt[Ro(e,D,bt)];D+=Ft&15;var G=Ft>>4;if(G<16)Me[Oe++]=G;else{var It=0,zt=0;for(G==16?(zt=3+Ro(e,D,3),D+=2,It=Me[Oe-1]):G==17?(zt=3+Ro(e,D,7),D+=3):G==18&&(zt=11+Ro(e,D,127),D+=7);zt--;)Me[Oe++]=It}}var xt=Me.subarray(0,Ce),Be=Me.subarray(Ce);ue=Kg(xt),ae=Kg(Be),U=Eh(xt,ue,1),le=Eh(Be,ae,1)}else qi(1);else{var G=CP(D)+4,ee=e[G-4]|e[G-3]<<8,_e=G+ee;if(_e>c){u&&qi(0);break}x&&C(O+ee),o.set(e.subarray(G,_e),O),t.b=O+=ee,t.p=D=_e*8,t.f=I;continue}if(D>oe){u&&qi(0);break}}x&&C(O+131072);for(var lt=(1<<ue)-1,dt=(1<<ae)-1,kt=D;;kt=D){var It=U[Xg(e,D)&lt],ht=It>>4;if(D+=It&15,D>oe){u&&qi(0);break}if(It||qi(2),ht<256)o[O++]=ht;else if(ht==256){kt=D,U=null;break}else{var _t=ht-254;if(ht>264){var Oe=ht-257,Tt=yS[Oe];_t=Ro(e,D,(1<<Tt)-1)+wS[Oe],D+=Tt}var tn=le[Xg(e,D)&dt],Zt=tn>>4;tn||qi(3),D+=tn&15;var Be=bP[Zt];if(Zt>3){var Tt=_S[Zt];Be+=Xg(e,D)&(1<<Tt)-1,D+=Tt}if(D>oe){u&&qi(0);break}x&&C(O+131072);var hn=O+_t;if(O<Be){var Mn=m-Be,qn=Math.min(Be,hn);for(Mn+O<0&&qi(3);O<qn;++O)o[O]=l[Mn+O]}for(;O<hn;O+=4)o[O]=o[O-Be],o[O+1]=o[O+1-Be],o[O+2]=o[O+2-Be],o[O+3]=o[O+3-Be];O=hn}}t.l=U,t.p=kt,t.b=O,t.f=I,U&&(I=1,t.m=ue,t.d=le,t.n=ae)}while(!I);return O==o.length?o:EP(o,0,O)},kP=new Gi(0),MP=function(e){(e[0]!=31||e[1]!=139||e[2]!=8)&&qi(6,"invalid gzip data");var t=e[3],o=10;t&4&&(o+=(e[10]|e[11]<<8)+2);for(var l=(t>>3&1)+(t>>4&1);l>0;l-=!e[o++]);return o+(t&2)},PP=function(e){var t=e.length;return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0},AP=function(e,t){return((e[0]&15)!=8||e[0]>>4>7||(e[0]<<8|e[1])%31)&&qi(6,"invalid zlib data"),(e[1]>>5&1)==+!t&&qi(6,"invalid zlib data: "+(e[1]&32?"need":"unexpected")+" dictionary"),(e[1]>>3&4)+2};function zP(e,t){return vv(e,{i:2},t&&t.out,t&&t.dictionary)}function DP(e,t){var o=MP(e);return o+8>e.length&&qi(6,"invalid gzip data"),vv(e.subarray(o,-8),{i:2},t&&t.out||new Gi(PP(e)),t&&t.dictionary)}function LP(e,t){return vv(e.subarray(AP(e,t&&t.dictionary),-4),{i:2},t&&t.out,t&&t.dictionary)}function u_(e,t){return e[0]==31&&e[1]==139&&e[2]==8?DP(e,t):(e[0]&15)!=8||e[0]>>4>7||(e[0]<<8|e[1])%31?zP(e,t):LP(e,t)}var RP=typeof TextDecoder<"u"&&new TextDecoder,FP=0;try{RP.decode(kP,{stream:!0}),FP=1}catch{}var SS=(e,t)=>e*Math.pow(2,t),sh=(e,t)=>Math.floor(e/Math.pow(2,t)),wf=(e,t)=>SS(e.getUint16(t+1,!0),8)+e.getUint8(t),TS=(e,t)=>SS(e.getUint32(t+2,!0),16)+e.getUint16(t,!0),OP=(e,t,o,l,c)=>{if(e!=l.getUint8(c))return e-l.getUint8(c);const m=wf(l,c+1);if(t!=m)return t-m;const x=wf(l,c+4);return o!=x?o-x:0},BP=(e,t,o,l)=>{const c=CS(e,t|128,o,l);return c?{z:t,x:o,y:l,offset:c[0],length:c[1],is_dir:!0}:null},q1=(e,t,o,l)=>{const c=CS(e,t,o,l);return c?{z:t,x:o,y:l,offset:c[0],length:c[1],is_dir:!1}:null},CS=(e,t,o,l)=>{let c=0,m=e.byteLength/17-1;for(;c<=m;){const x=m+c>>1,u=OP(t,o,l,e,x*17);if(u>0)c=x+1;else if(u<0)m=x-1;else return[TS(e,x*17+7),e.getUint32(x*17+13,!0)]}return null},VP=(e,t)=>e.is_dir&&!t.is_dir?1:!e.is_dir&&t.is_dir?-1:e.z!==t.z?e.z-t.z:e.x!==t.x?e.x-t.x:e.y-t.y,ES=(e,t)=>{const o=e.getUint8(t*17);return{z:o&127,x:wf(e,t*17+1),y:wf(e,t*17+4),offset:TS(e,t*17+7),length:e.getUint32(t*17+13,!0),is_dir:o>>7===1}},G1=e=>{const t=[],o=new DataView(e);for(let l=0;l<o.byteLength/17;l++)t.push(ES(o,l));return NP(t)},NP=e=>{e.sort(VP);const t=new ArrayBuffer(17*e.length),o=new Uint8Array(t);for(let l=0;l<e.length;l++){const c=e[l];let m=c.z;c.is_dir&&(m=m|128),o[l*17]=m,o[l*17+1]=c.x&255,o[l*17+2]=c.x>>8&255,o[l*17+3]=c.x>>16&255,o[l*17+4]=c.y&255,o[l*17+5]=c.y>>8&255,o[l*17+6]=c.y>>16&255,o[l*17+7]=c.offset&255,o[l*17+8]=sh(c.offset,8)&255,o[l*17+9]=sh(c.offset,16)&255,o[l*17+10]=sh(c.offset,24)&255,o[l*17+11]=sh(c.offset,32)&255,o[l*17+12]=sh(c.offset,48)&255,o[l*17+13]=c.length&255,o[l*17+14]=c.length>>8&255,o[l*17+15]=c.length>>16&255,o[l*17+16]=c.length>>24&255}return t},UP=(e,t)=>{if(e.byteLength<17)return null;const o=e.byteLength/17,l=ES(e,o-1);if(l.is_dir){const c=l.z,m=t.z-c,x=Math.trunc(t.x/(1<<m)),u=Math.trunc(t.y/(1<<m));return{z:c,x,y:u}}return null};function $P(e){return yi(this,null,function*(){const t=yield e.getBytes(0,512e3),o=new DataView(t.data),l=o.getUint32(4,!0),c=o.getUint16(8,!0),m=new TextDecoder("utf-8"),x=JSON.parse(m.decode(new DataView(t.data,10,l)));let u=0;x.compression==="gzip"&&(u=2);let C=0;"minzoom"in x&&(C=+x.minzoom);let I=0;"maxzoom"in x&&(I=+x.maxzoom);let D=0,O=0,U=0,le=-180,ue=-85,ae=180,oe=85;if(x.bounds){const G=x.bounds.split(",");le=+G[0],ue=+G[1],ae=+G[2],oe=+G[3]}if(x.center){const G=x.center.split(",");D=+G[0],O=+G[1],U=+G[2]}return{specVersion:o.getUint16(2,!0),rootDirectoryOffset:10+l,rootDirectoryLength:c*17,jsonMetadataOffset:10,jsonMetadataLength:l,leafDirectoryOffset:0,leafDirectoryLength:void 0,tileDataOffset:0,tileDataLength:void 0,numAddressedTiles:0,numTileEntries:0,numTileContents:0,clustered:!1,internalCompression:1,tileCompression:u,tileType:1,minZoom:C,maxZoom:I,minLon:le,minLat:ue,maxLon:ae,maxLat:oe,centerZoom:U,centerLon:D,centerLat:O,etag:t.etag}})}function jP(e,t,o,l,c,m,x){return yi(this,null,function*(){let u=yield o.getArrayBuffer(t,e.rootDirectoryOffset,e.rootDirectoryLength,e);e.specVersion===1&&(u=G1(u));const C=q1(new DataView(u),l,c,m);if(C){let O=(yield t.getBytes(C.offset,C.length,x)).data;const U=new DataView(O);return U.getUint8(0)==31&&U.getUint8(1)==139&&(O=u_(new Uint8Array(O))),{data:O}}const I=UP(new DataView(u),{z:l,x:c,y:m});if(I){const D=BP(new DataView(u),I.z,I.x,I.y);if(D){let O=yield o.getArrayBuffer(t,D.offset,D.length,e);e.specVersion===1&&(O=G1(O));const U=q1(new DataView(O),l,c,m);if(U){let ue=(yield t.getBytes(U.offset,U.length,x)).data;const ae=new DataView(ue);return ae.getUint8(0)==31&&ae.getUint8(1)==139&&(ue=u_(new Uint8Array(ue))),{data:ue}}}}})}var IS={getHeader:$P,getZxy:jP},kS=class{constructor(){this.tile=(e,t)=>{if(e.type=="json"){const o=e.url.substr(10);let l=this.tiles.get(o);return l||(l=new H1(o),this.tiles.set(o,l)),l.getHeader().then(c=>{const m={tiles:[e.url+"/{z}/{x}/{y}"],minzoom:c.minZoom,maxzoom:c.maxZoom,bounds:[c.minLon,c.minLat,c.maxLon,c.maxLat]};t(null,m,null,null)}).catch(c=>{t(c,null,null,null)}),{cancel:()=>{}}}else{const o=new RegExp(/pmtiles:\/\/(.+)\/(\d+)\/(\d+)\/(\d+)/),l=e.url.match(o);if(!l)throw new Error("Invalid PMTiles protocol URL");const c=l[1];let m=this.tiles.get(c);m||(m=new H1(c),this.tiles.set(c,m));const x=l[2],u=l[3],C=l[4],I=new AbortController,D=I.signal;let O=()=>{I.abort()};return m.getHeader().then(U=>{m.getZxy(+x,+u,+C,D).then(le=>{le?t(null,new Uint8Array(le.data),le.cacheControl,le.expires):U.tileType==1?t(null,new Uint8Array,null,null):t(null,null,null,null)}).catch(le=>{le.name!=="AbortError"&&t(le,null,null,null)})}),{cancel:O}}},this.tiles=new Map}add(e){this.tiles.set(e.source.getKey(),e)}get(e){return this.tiles.get(e)}};function eu(e,t){return(t>>>0)*4294967296+(e>>>0)}function ZP(e,t){const o=t.buf;let l,c;if(c=o[t.pos++],l=(c&112)>>4,c<128||(c=o[t.pos++],l|=(c&127)<<3,c<128)||(c=o[t.pos++],l|=(c&127)<<10,c<128)||(c=o[t.pos++],l|=(c&127)<<17,c<128)||(c=o[t.pos++],l|=(c&127)<<24,c<128)||(c=o[t.pos++],l|=(c&1)<<31,c<128))return eu(e,l);throw new Error("Expected varint not more than 10 bytes")}function lh(e){const t=e.buf;let o,l;return l=t[e.pos++],o=l&127,l<128||(l=t[e.pos++],o|=(l&127)<<7,l<128)||(l=t[e.pos++],o|=(l&127)<<14,l<128)||(l=t[e.pos++],o|=(l&127)<<21,l<128)?o:(l=t[e.pos],o|=(l&15)<<28,ZP(o,e))}function qP(e,t,o,l){if(l==0){o==1&&(t[0]=e-1-t[0],t[1]=e-1-t[1]);const c=t[0];t[0]=t[1],t[1]=c}}var GP=[0,1,5,21,85,341,1365,5461,21845,87381,349525,1398101,5592405,22369621,89478485,357913941,1431655765,5726623061,22906492245,91625968981,366503875925,1466015503701,5864062014805,23456248059221,93824992236885,375299968947541,0x5555555555555];function HP(e,t,o){if(e>26)throw Error("Tile zoom level exceeds max safe number limit (26)");if(t>Math.pow(2,e)-1||o>Math.pow(2,e)-1)throw Error("tile x/y outside zoom level bounds");const l=GP[e],c=Math.pow(2,e);let m=0,x=0,u=0;const C=[t,o];let I=c/2;for(;I>0;)m=(C[0]&I)>0?1:0,x=(C[1]&I)>0?1:0,u+=I*I*(3*m^x),qP(I,C,m,x),I=I/2;return l+u}function MS(e,t){return yi(this,null,function*(){if(t===1||t===0)return e;if(t===2){if(typeof globalThis.DecompressionStream>"u")return u_(new Uint8Array(e));{let l=new Response(e).body.pipeThrough(new globalThis.DecompressionStream("gzip"));return new Response(l).arrayBuffer()}}else throw Error("Compression method not supported")})}var WP=127;function KP(e,t){let o=0,l=e.length-1;for(;o<=l;){const c=l+o>>1,m=t-e[c].tileId;if(m>0)o=c+1;else if(m<0)l=c-1;else return e[c]}return l>=0&&(e[l].runLength===0||t-e[l].tileId<e[l].runLength)?e[l]:null}var XP=class{constructor(e,t=new Headers){this.url=e,this.customHeaders=t}getKey(){return this.url}setHeaders(e){this.customHeaders=e}getBytes(e,t,o){return yi(this,null,function*(){let l;o||(l=new AbortController,o=l.signal);const c=new Headers(this.customHeaders);c.set("Range","bytes="+e+"-"+(e+t-1));let m=yield fetch(this.url,{signal:o,headers:c});if(m.status===416&&e===0){const C=m.headers.get("Content-Range");if(!C||!C.startsWith("bytes */"))throw Error("Missing content-length on 416 response");const I=+C.substr(8);m=yield fetch(this.url,{signal:o,headers:{Range:"bytes=0-"+(I-1)}})}if(m.status>=300)throw Error("Bad response code: "+m.status);const x=m.headers.get("Content-Length");if(m.status===200&&(!x||+x>t))throw l&&l.abort(),Error("Server returned no content-length header or content-length exceeding request. Check that your storage backend supports HTTP Byte Serving.");return{data:yield m.arrayBuffer(),etag:m.headers.get("ETag")||void 0,cacheControl:m.headers.get("Cache-Control")||void 0,expires:m.headers.get("Expires")||void 0}})}};function Fo(e,t){const o=e.getUint32(t+4,!0),l=e.getUint32(t+0,!0);return o*Math.pow(2,32)+l}function YP(e,t){const o=new DataView(e),l=o.getUint8(7);if(l>3)throw Error(`Archive is spec version ${l} but this library supports up to spec version 3`);return{specVersion:l,rootDirectoryOffset:Fo(o,8),rootDirectoryLength:Fo(o,16),jsonMetadataOffset:Fo(o,24),jsonMetadataLength:Fo(o,32),leafDirectoryOffset:Fo(o,40),leafDirectoryLength:Fo(o,48),tileDataOffset:Fo(o,56),tileDataLength:Fo(o,64),numAddressedTiles:Fo(o,72),numTileEntries:Fo(o,80),numTileContents:Fo(o,88),clustered:o.getUint8(96)===1,internalCompression:o.getUint8(97),tileCompression:o.getUint8(98),tileType:o.getUint8(99),minZoom:o.getUint8(100),maxZoom:o.getUint8(101),minLon:o.getInt32(102,!0)/1e7,minLat:o.getInt32(106,!0)/1e7,maxLon:o.getInt32(110,!0)/1e7,maxLat:o.getInt32(114,!0)/1e7,centerZoom:o.getUint8(118),centerLon:o.getInt32(119,!0)/1e7,centerLat:o.getInt32(123,!0)/1e7,etag:t}}function PS(e){const t={buf:new Uint8Array(e),pos:0},o=lh(t),l=[];let c=0;for(let m=0;m<o;m++){const x=lh(t);l.push({tileId:c+x,offset:0,length:0,runLength:1}),c+=x}for(let m=0;m<o;m++)l[m].runLength=lh(t);for(let m=0;m<o;m++)l[m].length=lh(t);for(let m=0;m<o;m++){const x=lh(t);x===0&&m>0?l[m].offset=l[m-1].offset+l[m-1].length:l[m].offset=x-1}return l}function JP(e){const t=new DataView(e);return t.getUint16(2,!0)===2?(console.warn("PMTiles spec version 2 has been deprecated; please see github.com/protomaps/PMTiles for tools to upgrade"),2):t.getUint16(2,!0)===1?(console.warn("PMTiles spec version 1 has been deprecated; please see github.com/protomaps/PMTiles for tools to upgrade"),1):3}var yu=class extends Error{};function QP(e,t,o,l){return yi(this,null,function*(){const c=yield e.getBytes(0,16384);if(new DataView(c.data).getUint16(0,!0)!==19792)throw new Error("Wrong magic number for PMTiles archive");if(JP(c.data)<3)return[yield IS.getHeader(e)];const x=c.data.slice(0,WP);let u=c.etag;l&&c.etag!=l&&(console.warn("ETag conflict detected; your HTTP server might not support content-based ETag headers. ETags disabled for "+e.getKey()),u=void 0);const C=YP(x,u);if(o){const I=c.data.slice(C.rootDirectoryOffset,C.rootDirectoryOffset+C.rootDirectoryLength),D=e.getKey()+"|"+(C.etag||"")+"|"+C.rootDirectoryOffset+"|"+C.rootDirectoryLength,O=PS(yield t(I,C.internalCompression));return[C,[D,O.length,O]]}return[C,void 0]})}function eA(e,t,o,l,c){return yi(this,null,function*(){const m=yield e.getBytes(o,l);if(c.etag&&c.etag!==m.etag)throw new yu(m.etag);const x=yield t(m.data,c.internalCompression),u=PS(x);if(u.length===0)throw new Error("Empty directory is invalid");return u})}var tA=class{constructor(e=100,t=!0,o=MS){this.cache=new Map,this.maxCacheEntries=e,this.counter=1,this.prefetch=t,this.decompress=o}getHeader(e,t){return yi(this,null,function*(){const o=e.getKey();if(this.cache.has(o))return this.cache.get(o).lastUsed=this.counter++,yield this.cache.get(o).data;const l=new Promise((c,m)=>{QP(e,this.decompress,this.prefetch,t).then(x=>{x[1]&&this.cache.set(x[1][0],{lastUsed:this.counter++,data:Promise.resolve(x[1][2])}),c(x[0]),this.prune()}).catch(x=>{m(x)})});return this.cache.set(o,{lastUsed:this.counter++,data:l}),l})}getDirectory(e,t,o,l){return yi(this,null,function*(){const c=e.getKey()+"|"+(l.etag||"")+"|"+t+"|"+o;if(this.cache.has(c))return this.cache.get(c).lastUsed=this.counter++,yield this.cache.get(c).data;const m=new Promise((x,u)=>{eA(e,this.decompress,t,o,l).then(C=>{x(C),this.prune()}).catch(C=>{u(C)})});return this.cache.set(c,{lastUsed:this.counter++,data:m}),m})}getArrayBuffer(e,t,o,l){return yi(this,null,function*(){const c=e.getKey()+"|"+(l.etag||"")+"|"+t+"|"+o;if(this.cache.has(c))return this.cache.get(c).lastUsed=this.counter++,yield this.cache.get(c).data;const m=new Promise((x,u)=>{e.getBytes(t,o).then(C=>{if(l.etag&&l.etag!==C.etag)throw new yu(C.etag);x(C.data),this.cache.has(c),this.prune()}).catch(C=>{u(C)})});return this.cache.set(c,{lastUsed:this.counter++,data:m}),m})}prune(){if(this.cache.size>=this.maxCacheEntries){let e=1/0,t;this.cache.forEach((o,l)=>{o.lastUsed<e&&(e=o.lastUsed,t=l)}),t&&this.cache.delete(t)}}invalidate(e,t){return yi(this,null,function*(){this.cache.delete(e.getKey()),yield this.getHeader(e,t)})}},H1=class{constructor(e,t,o){typeof e=="string"?this.source=new XP(e):this.source=e,o?this.decompress=o:this.decompress=MS,t?this.cache=t:this.cache=new tA}getHeader(){return yi(this,null,function*(){return yield this.cache.getHeader(this.source)})}getZxyAttempt(e,t,o,l){return yi(this,null,function*(){const c=HP(e,t,o),m=yield this.cache.getHeader(this.source);if(m.specVersion<3)return IS.getZxy(m,this.source,this.cache,e,t,o,l);if(e<m.minZoom||e>m.maxZoom)return;let x=m.rootDirectoryOffset,u=m.rootDirectoryLength;for(let C=0;C<=3;C++){const I=yield this.cache.getDirectory(this.source,x,u,m),D=KP(I,c);if(D)if(D.runLength>0){const O=yield this.source.getBytes(m.tileDataOffset+D.offset,D.length,l);if(m.etag&&m.etag!==O.etag)throw new yu(O.etag);return{data:yield this.decompress(O.data,m.tileCompression),cacheControl:O.cacheControl,expires:O.expires}}else x=m.leafDirectoryOffset+D.offset,u=D.length;else return}throw Error("Maximum directory depth exceeded")})}getZxy(e,t,o,l){return yi(this,null,function*(){try{return yield this.getZxyAttempt(e,t,o,l)}catch(c){if(c instanceof yu)return this.cache.invalidate(this.source,c.message),yield this.getZxyAttempt(e,t,o,l);throw c}})}getMetadataAttempt(){return yi(this,null,function*(){const e=yield this.cache.getHeader(this.source),t=yield this.source.getBytes(e.jsonMetadataOffset,e.jsonMetadataLength);if(e.etag&&e.etag!==t.etag)throw new yu(t.etag);const o=yield this.decompress(t.data,e.internalCompression),l=new TextDecoder("utf-8");return JSON.parse(l.decode(o))})}getMetadata(){return yi(this,null,function*(){try{return yield this.getMetadataAttempt()}catch(e){if(e instanceof yu)return this.cache.invalidate(this.source,e.message),yield this.getMetadataAttempt();throw e}})}};const nA="modulepreload",rA=function(e){return"/"+e},W1={},iA=function(t,o,l){let c=Promise.resolve();if(o&&o.length>0){const m=document.getElementsByTagName("link");c=Promise.all(o.map(x=>{if(x=rA(x),x in W1)return;W1[x]=!0;const u=x.endsWith(".css"),C=u?'[rel="stylesheet"]':"";if(!!l)for(let O=m.length-1;O>=0;O--){const U=m[O];if(U.href===x&&(!u||U.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${x}"]${C}`))return;const D=document.createElement("link");if(D.rel=u?"stylesheet":nA,u||(D.as="script",D.crossOrigin=""),D.href=x,document.head.appendChild(D),u)return new Promise((O,U)=>{D.addEventListener("load",O),D.addEventListener("error",()=>U(new Error(`Unable to preload CSS for ${x}`)))})}))}return c.then(()=>t()).catch(m=>{const x=new Event("vite:preloadError",{cancelable:!0});if(x.payload=m,window.dispatchEvent(x),!x.defaultPrevented)throw m})},AS=he.createContext(null);function oA(){var e;const t=(e=he.useContext(AS))===null||e===void 0?void 0:e.maps,o=he.useContext(dl);return he.useMemo(()=>({...t,current:o==null?void 0:o.map}),[t,o])}function aA(e,t){const o=Array.isArray(e)?e[0]:e?e.x:0,l=Array.isArray(e)?e[1]:e?e.y:0,c=Array.isArray(t)?t[0]:t?t.x:0,m=Array.isArray(t)?t[1]:t?t.y:0;return o===c&&l===m}function Hi(e,t){if(e===t)return!0;if(!e||!t)return!1;if(Array.isArray(e)){if(!Array.isArray(t)||e.length!==t.length)return!1;for(let o=0;o<e.length;o++)if(!Hi(e[o],t[o]))return!1;return!0}else if(Array.isArray(t))return!1;if(typeof e=="object"&&typeof t=="object"){const o=Object.keys(e),l=Object.keys(t);if(o.length!==l.length)return!1;for(const c of o)if(!t.hasOwnProperty(c)||!Hi(e[c],t[c]))return!1;return!0}return!1}function sA(e){const t=e.clone();return t.pixelsToGLUnits=e.pixelsToGLUnits,t}function K1(e,t){if(!e.getProjection)return;const o=e.getProjection(),l=t.getProjection();Hi(o,l)||t.setProjection(o)}function X1(e){return{longitude:e.center.lng,latitude:e.center.lat,zoom:e.zoom,pitch:e.pitch,bearing:e.bearing,padding:e.padding}}function Y1(e,t){const o=t.viewState||t;let l=!1;if("longitude"in o&&"latitude"in o){const c=e.center;e.center=new c.constructor(o.longitude,o.latitude),l=l||c!==e.center}if("zoom"in o){const c=e.zoom;e.zoom=o.zoom,l=l||c!==e.zoom}if("bearing"in o){const c=e.bearing;e.bearing=o.bearing,l=l||c!==e.bearing}if("pitch"in o){const c=e.pitch;e.pitch=o.pitch,l=l||c!==e.pitch}return o.padding&&!e.isPaddingEqual(o.padding)&&(l=!0,e.padding=o.padding),l}const lA=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function J1(e){if(!e)return null;if(typeof e=="string"||("toJS"in e&&(e=e.toJS()),!e.layers))return e;const t={};for(const l of e.layers)t[l.id]=l;const o=e.layers.map(l=>{let c=null;"interactive"in l&&(c=Object.assign({},l),delete c.interactive);const m=t[l.ref];if(m){c=c||Object.assign({},l),delete c.ref;for(const x of lA)x in m&&(c[x]=m[x])}return c||l});return{...e,layers:o}}var Q1={};const ew={version:8,sources:{},layers:[]},tw={mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",click:"onClick",dblclick:"onDblClick",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mouseout:"onMouseOut",contextmenu:"onContextMenu",touchstart:"onTouchStart",touchend:"onTouchEnd",touchmove:"onTouchMove",touchcancel:"onTouchCancel"},Yg={movestart:"onMoveStart",move:"onMove",moveend:"onMoveEnd",dragstart:"onDragStart",drag:"onDrag",dragend:"onDragEnd",zoomstart:"onZoomStart",zoom:"onZoom",zoomend:"onZoomEnd",rotatestart:"onRotateStart",rotate:"onRotate",rotateend:"onRotateEnd",pitchstart:"onPitchStart",pitch:"onPitch",pitchend:"onPitchEnd"},nw={wheel:"onWheel",boxzoomstart:"onBoxZoomStart",boxzoomend:"onBoxZoomEnd",boxzoomcancel:"onBoxZoomCancel",resize:"onResize",load:"onLoad",render:"onRender",idle:"onIdle",remove:"onRemove",data:"onData",styledata:"onStyleData",sourcedata:"onSourceData",error:"onError"},uA=["minZoom","maxZoom","minPitch","maxPitch","maxBounds","projection","renderWorldCopies"],cA=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate","touchPitch"];class Lu{constructor(t,o,l){this._map=null,this._internalUpdate=!1,this._inRender=!1,this._hoveredFeatures=null,this._deferredEvents={move:!1,zoom:!1,pitch:!1,rotate:!1},this._onEvent=c=>{const m=this.props[nw[c.type]];m?m(c):c.type==="error"&&console.error(c.error)},this._onPointerEvent=c=>{(c.type==="mousemove"||c.type==="mouseout")&&this._updateHover(c);const m=this.props[tw[c.type]];m&&(this.props.interactiveLayerIds&&c.type!=="mouseover"&&c.type!=="mouseout"&&(c.features=this._hoveredFeatures||this._queryRenderedFeatures(c.point)),m(c),delete c.features)},this._onCameraEvent=c=>{if(!this._internalUpdate){const m=this.props[Yg[c.type]];m&&m(c)}c.type in this._deferredEvents&&(this._deferredEvents[c.type]=!1)},this._MapClass=t,this.props=o,this._initialize(l)}get map(){return this._map}get transform(){return this._renderTransform}setProps(t){const o=this.props;this.props=t;const l=this._updateSettings(t,o);l&&this._createShadowTransform(this._map);const c=this._updateSize(t),m=this._updateViewState(t,!0);this._updateStyle(t,o),this._updateStyleComponents(t,o),this._updateHandlers(t,o),(l||c||m&&!this._map.isMoving())&&this.redraw()}static reuse(t,o){const l=Lu.savedMaps.pop();if(!l)return null;const c=l.map,m=c.getContainer();for(o.className=m.className;m.childNodes.length>0;)o.appendChild(m.childNodes[0]);c._container=o;const x=c._resizeObserver;x&&(x.disconnect(),x.observe(o)),l.setProps({...t,styleDiffing:!1}),c.resize();const{initialViewState:u}=t;return u&&(u.bounds?c.fitBounds(u.bounds,{...u.fitBoundsOptions,duration:0}):l._updateViewState(u,!1)),c.isStyleLoaded()?c.fire("load"):c.once("styledata",()=>c.fire("load")),c._update(),l}_initialize(t){const{props:o}=this,{mapStyle:l=ew}=o,c={...o,...o.initialViewState,accessToken:o.mapboxAccessToken||hA()||null,container:t,style:J1(l)},m=c.initialViewState||c.viewState||c;if(Object.assign(c,{center:[m.longitude||0,m.latitude||0],zoom:m.zoom||0,pitch:m.pitch||0,bearing:m.bearing||0}),o.gl){const D=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=()=>(HTMLCanvasElement.prototype.getContext=D,o.gl)}const x=new this._MapClass(c);m.padding&&x.setPadding(m.padding),o.cursor&&(x.getCanvas().style.cursor=o.cursor),this._createShadowTransform(x);const u=x._render;x._render=D=>{this._inRender=!0,u.call(x,D),this._inRender=!1};const C=x._renderTaskQueue.run;x._renderTaskQueue.run=D=>{C.call(x._renderTaskQueue,D),this._onBeforeRepaint()},x.on("render",()=>this._onAfterRepaint());const I=x.fire;x.fire=this._fireEvent.bind(this,I),x.on("resize",()=>{this._renderTransform.resize(x.transform.width,x.transform.height)}),x.on("styledata",()=>{this._updateStyleComponents(this.props,{}),K1(x.transform,this._renderTransform)}),x.on("sourcedata",()=>this._updateStyleComponents(this.props,{}));for(const D in tw)x.on(D,this._onPointerEvent);for(const D in Yg)x.on(D,this._onCameraEvent);for(const D in nw)x.on(D,this._onEvent);this._map=x}recycle(){const o=this.map.getContainer().querySelector("[mapboxgl-children]");o==null||o.remove(),Lu.savedMaps.push(this)}destroy(){this._map.remove()}redraw(){const t=this._map;!this._inRender&&t.style&&(t._frame&&(t._frame.cancel(),t._frame=null),t._render())}_createShadowTransform(t){const o=sA(t.transform);t.painter.transform=o,this._renderTransform=o}_updateSize(t){const{viewState:o}=t;if(o){const l=this._map;if(o.width!==l.transform.width||o.height!==l.transform.height)return l.resize(),!0}return!1}_updateViewState(t,o){if(this._internalUpdate)return!1;const l=this._map,c=this._renderTransform,{zoom:m,pitch:x,bearing:u}=c,C=l.isMoving();C&&(c.cameraElevationReference="sea");const I=Y1(c,{...X1(l.transform),...t});if(C&&(c.cameraElevationReference="ground"),I&&o){const D=this._deferredEvents;D.move=!0,D.zoom||(D.zoom=m!==c.zoom),D.rotate||(D.rotate=u!==c.bearing),D.pitch||(D.pitch=x!==c.pitch)}return C||Y1(l.transform,t),I}_updateSettings(t,o){const l=this._map;let c=!1;for(const m of uA)if(m in t&&!Hi(t[m],o[m])){c=!0;const x=l[`set${m[0].toUpperCase()}${m.slice(1)}`];x==null||x.call(l,t[m])}return c}_updateStyle(t,o){if(t.cursor!==o.cursor&&(this._map.getCanvas().style.cursor=t.cursor||""),t.mapStyle!==o.mapStyle){const{mapStyle:l=ew,styleDiffing:c=!0}=t,m={diff:c};return"localIdeographFontFamily"in t&&(m.localIdeographFontFamily=t.localIdeographFontFamily),this._map.setStyle(J1(l),m),!0}return!1}_updateStyleComponents(t,o){const l=this._map;let c=!1;return l.isStyleLoaded()&&("light"in t&&l.setLight&&!Hi(t.light,o.light)&&(c=!0,l.setLight(t.light)),"fog"in t&&l.setFog&&!Hi(t.fog,o.fog)&&(c=!0,l.setFog(t.fog)),"terrain"in t&&l.setTerrain&&!Hi(t.terrain,o.terrain)&&(!t.terrain||l.getSource(t.terrain.source))&&(c=!0,l.setTerrain(t.terrain))),c}_updateHandlers(t,o){var l,c;const m=this._map;let x=!1;for(const u of cA){const C=(l=t[u])!==null&&l!==void 0?l:!0,I=(c=o[u])!==null&&c!==void 0?c:!0;Hi(C,I)||(x=!0,C?m[u].enable(C):m[u].disable())}return x}_queryRenderedFeatures(t){const o=this._map,l=o.transform,{interactiveLayerIds:c=[]}=this.props;try{return o.transform=this._renderTransform,o.queryRenderedFeatures(t,{layers:c.filter(o.getLayer.bind(o))})}catch{return[]}finally{o.transform=l}}_updateHover(t){var o;const{props:l}=this;if(l.interactiveLayerIds&&(l.onMouseMove||l.onMouseEnter||l.onMouseLeave)){const m=t.type,x=((o=this._hoveredFeatures)===null||o===void 0?void 0:o.length)>0,u=this._queryRenderedFeatures(t.point),C=u.length>0;!C&&x&&(t.type="mouseleave",this._onPointerEvent(t)),this._hoveredFeatures=u,C&&!x&&(t.type="mouseenter",this._onPointerEvent(t)),t.type=m}else this._hoveredFeatures=null}_fireEvent(t,o,l){const c=this._map,m=c.transform,x=typeof o=="string"?o:o.type;return x==="move"&&this._updateViewState(this.props,!1),x in Yg&&(typeof o=="object"&&(o.viewState=X1(m)),this._map.isMoving())?(c.transform=this._renderTransform,t.call(c,o,l),c.transform=m,c):(t.call(c,o,l),c)}_onBeforeRepaint(){const t=this._map;this._internalUpdate=!0;for(const l in this._deferredEvents)this._deferredEvents[l]&&t.fire(l);this._internalUpdate=!1;const o=this._map.transform;t.transform=this._renderTransform,this._onAfterRepaint=()=>{K1(this._renderTransform,o),t.transform=o}}}Lu.savedMaps=[];function hA(){let e=null;if(typeof location<"u"){const t=/access_token=([^&\/]*)/.exec(location.search);e=t&&t[1]}try{e=e||Q1.MapboxAccessToken}catch{}try{e=e||Q1.REACT_APP_MAPBOX_ACCESS_TOKEN}catch{}return e}const dA=["setMaxBounds","setMinZoom","setMaxZoom","setMinPitch","setMaxPitch","setRenderWorldCopies","setProjection","setStyle","addSource","removeSource","addLayer","removeLayer","setLayerZoomRange","setFilter","setPaintProperty","setLayoutProperty","setLight","setTerrain","setFog","remove"];function pA(e){if(!e)return null;const t=e.map,o={getMap:()=>t,getCenter:()=>e.transform.center,getZoom:()=>e.transform.zoom,getBearing:()=>e.transform.bearing,getPitch:()=>e.transform.pitch,getPadding:()=>e.transform.padding,getBounds:()=>e.transform.getBounds(),project:l=>{const c=t.transform;t.transform=e.transform;const m=t.project(l);return t.transform=c,m},unproject:l=>{const c=t.transform;t.transform=e.transform;const m=t.unproject(l);return t.transform=c,m},queryTerrainElevation:(l,c)=>{const m=t.transform;t.transform=e.transform;const x=t.queryTerrainElevation(l,c);return t.transform=m,x},queryRenderedFeatures:(l,c)=>{const m=t.transform;t.transform=e.transform;const x=t.queryRenderedFeatures(l,c);return t.transform=m,x}};for(const l of fA(t))!(l in o)&&!dA.includes(l)&&(o[l]=t[l].bind(t));return o}function fA(e){const t=new Set;let o=e;for(;o;){for(const l of Object.getOwnPropertyNames(o))l[0]!=="_"&&typeof e[l]=="function"&&l!=="fire"&&l!=="setEventedParent"&&t.add(l);o=Object.getPrototypeOf(o)}return Array.from(t)}const mA=typeof document<"u"?he.useLayoutEffect:he.useEffect,gA=["baseApiUrl","maxParallelImageRequests","workerClass","workerCount","workerUrl"];function yA(e,t){for(const l of gA)l in t&&(e[l]=t[l]);const{RTLTextPlugin:o="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-rtl-text/v0.2.3/mapbox-gl-rtl-text.js"}=t;o&&e.getRTLTextPluginStatus&&e.getRTLTextPluginStatus()==="unavailable"&&e.setRTLTextPlugin(o,l=>{l&&console.error(l)},!0)}const dl=he.createContext(null);function _A(e,t,o){const l=he.useContext(AS),[c,m]=he.useState(null),x=he.useRef(),{current:u}=he.useRef({mapLib:null,map:null});he.useEffect(()=>{const D=e.mapLib;let O=!0,U;return Promise.resolve(D||o).then(le=>{if(!O)return;if(!le)throw new Error("Invalid mapLib");const ue="Map"in le?le:le.default;if(!ue.Map)throw new Error("Invalid mapLib");if(yA(ue,e),!ue.supported||ue.supported(e))e.reuseMaps&&(U=Lu.reuse(e,x.current)),U||(U=new Lu(ue.Map,e,x.current)),u.map=pA(U),u.mapLib=ue,m(U),l==null||l.onMapMount(u.map,e.id);else throw new Error("Map is not supported by this browser")}).catch(le=>{const{onError:ue}=e;ue?ue({type:"error",target:null,originalEvent:null,error:le}):console.error(le)}),()=>{O=!1,U&&(l==null||l.onMapUnmount(e.id),e.reuseMaps?U.recycle():U.destroy())}},[]),mA(()=>{c&&c.setProps(e)}),he.useImperativeHandle(t,()=>u.map,[c]);const C=he.useMemo(()=>({position:"relative",width:"100%",height:"100%",...e.style}),[e.style]),I={height:"100%"};return he.createElement("div",{id:e.id,ref:x,style:C},c&&he.createElement(dl.Provider,{value:u},he.createElement("div",{"mapboxgl-children":"",style:I},e.children)))}const vA=/box|flex|grid|column|lineHeight|fontWeight|opacity|order|tabSize|zIndex/;function pl(e,t){if(!e||!t)return;const o=e.style;for(const l in t){const c=t[l];Number.isFinite(c)&&!vA.test(l)?o[l]=`${c}px`:o[l]=c}}function xA(e,t){const{map:o,mapLib:l}=he.useContext(dl),c=he.useRef({props:e});c.current.props=e;const m=he.useMemo(()=>{let ae=!1;he.Children.forEach(e.children,G=>{G&&(ae=!0)});const oe={...e,element:ae?document.createElement("div"):null},$=new l.Marker(oe);return $.setLngLat([e.longitude,e.latitude]),$.getElement().addEventListener("click",G=>{var ee,_e;(_e=(ee=c.current.props).onClick)===null||_e===void 0||_e.call(ee,{type:"click",target:$,originalEvent:G})}),$.on("dragstart",G=>{var ee,_e;const Ce=G;Ce.lngLat=m.getLngLat(),(_e=(ee=c.current.props).onDragStart)===null||_e===void 0||_e.call(ee,Ce)}),$.on("drag",G=>{var ee,_e;const Ce=G;Ce.lngLat=m.getLngLat(),(_e=(ee=c.current.props).onDrag)===null||_e===void 0||_e.call(ee,Ce)}),$.on("dragend",G=>{var ee,_e;const Ce=G;Ce.lngLat=m.getLngLat(),(_e=(ee=c.current.props).onDragEnd)===null||_e===void 0||_e.call(ee,Ce)}),$},[]);he.useEffect(()=>(m.addTo(o.getMap()),()=>{m.remove()}),[]);const{longitude:x,latitude:u,offset:C,style:I,draggable:D=!1,popup:O=null,rotation:U=0,rotationAlignment:le="auto",pitchAlignment:ue="auto"}=e;return he.useEffect(()=>{pl(m.getElement(),I)},[I]),he.useImperativeHandle(t,()=>m,[]),(m.getLngLat().lng!==x||m.getLngLat().lat!==u)&&m.setLngLat([x,u]),C&&!aA(m.getOffset(),C)&&m.setOffset(C),m.isDraggable()!==D&&m.setDraggable(D),m.getRotation()!==U&&m.setRotation(U),m.getRotationAlignment()!==le&&m.setRotationAlignment(le),m.getPitchAlignment()!==ue&&m.setPitchAlignment(ue),m.getPopup()!==O&&m.setPopup(O),Nu.createPortal(e.children,m.getElement())}he.memo(he.forwardRef(xA));function rw(e){return new Set(e?e.trim().split(/\s+/):[])}function wA(e,t){const{map:o,mapLib:l}=he.useContext(dl),c=he.useMemo(()=>document.createElement("div"),[]),m=he.useRef({props:e});m.current.props=e;const x=he.useMemo(()=>{const u={...e},C=new l.Popup(u);return C.setLngLat([e.longitude,e.latitude]),C.once("open",I=>{var D,O;(O=(D=m.current.props).onOpen)===null||O===void 0||O.call(D,I)}),C},[]);if(he.useEffect(()=>{const u=C=>{var I,D;(D=(I=m.current.props).onClose)===null||D===void 0||D.call(I,C)};return x.on("close",u),x.setDOMContent(c).addTo(o.getMap()),()=>{x.off("close",u),x.isOpen()&&x.remove()}},[]),he.useEffect(()=>{pl(x.getElement(),e.style)},[e.style]),he.useImperativeHandle(t,()=>x,[]),x.isOpen()&&((x.getLngLat().lng!==e.longitude||x.getLngLat().lat!==e.latitude)&&x.setLngLat([e.longitude,e.latitude]),e.offset&&!Hi(x.options.offset,e.offset)&&x.setOffset(e.offset),(x.options.anchor!==e.anchor||x.options.maxWidth!==e.maxWidth)&&(x.options.anchor=e.anchor,x.setMaxWidth(e.maxWidth)),x.options.className!==e.className)){const u=rw(x.options.className),C=rw(e.className);for(const I of u)C.has(I)||x.removeClassName(I);for(const I of C)u.has(I)||x.addClassName(I);x.options.className=e.className}return Nu.createPortal(e.children,c)}he.memo(he.forwardRef(wA));function nd(e,t,o,l){const c=he.useContext(dl),m=he.useMemo(()=>e(c),[]);return he.useEffect(()=>{const x=l||o||t,u=typeof t=="function"&&typeof o=="function"?t:null,C=typeof o=="function"?o:typeof t=="function"?t:null,{map:I}=c;return I.hasControl(m)||(I.addControl(m,x==null?void 0:x.position),u&&u(c)),()=>{C&&C(c),I.hasControl(m)&&I.removeControl(m)}},[]),m}function bA(e){const t=nd(({mapLib:o})=>new o.AttributionControl(e),{position:e.position});return he.useEffect(()=>{pl(t._container,e.style)},[e.style]),null}const SA=he.memo(bA);function TA(e){const t=nd(({mapLib:o})=>new o.FullscreenControl({container:e.containerId&&document.getElementById(e.containerId)}),{position:e.position});return he.useEffect(()=>{pl(t._controlContainer,e.style)},[e.style]),null}const CA=he.memo(TA);function EA(e,t){const o=he.useRef({props:e}),l=nd(({mapLib:c})=>{const m=new c.GeolocateControl(e),x=m._setupUI;return m._setupUI=u=>{m._container.hasChildNodes()||x(u)},m.on("geolocate",u=>{var C,I;(I=(C=o.current.props).onGeolocate)===null||I===void 0||I.call(C,u)}),m.on("error",u=>{var C,I;(I=(C=o.current.props).onError)===null||I===void 0||I.call(C,u)}),m.on("outofmaxbounds",u=>{var C,I;(I=(C=o.current.props).onOutOfMaxBounds)===null||I===void 0||I.call(C,u)}),m.on("trackuserlocationstart",u=>{var C,I;(I=(C=o.current.props).onTrackUserLocationStart)===null||I===void 0||I.call(C,u)}),m.on("trackuserlocationend",u=>{var C,I;(I=(C=o.current.props).onTrackUserLocationEnd)===null||I===void 0||I.call(C,u)}),m},{position:e.position});return o.current.props=e,he.useImperativeHandle(t,()=>l,[]),he.useEffect(()=>{pl(l._container,e.style)},[e.style]),null}he.memo(he.forwardRef(EA));function IA(e){const t=nd(({mapLib:o})=>new o.NavigationControl(e),{position:e.position});return he.useEffect(()=>{pl(t._container,e.style)},[e.style]),null}const kA=he.memo(IA);function MA(e){const t=nd(({mapLib:m})=>new m.ScaleControl(e),{position:e.position}),o=he.useRef(e),l=o.current;o.current=e;const{style:c}=e;return e.maxWidth!==void 0&&e.maxWidth!==l.maxWidth&&(t.options.maxWidth=e.maxWidth),e.unit!==void 0&&e.unit!==l.unit&&t.setUnit(e.unit),he.useEffect(()=>{pl(t._container,c)},[c]),null}he.memo(MA);function bf(e,t){if(!e)throw new Error(t)}function PA(e,t,o,l){if(bf(o.id===l.id,"layer id changed"),bf(o.type===l.type,"layer type changed"),o.type==="custom"||l.type==="custom")return;const{layout:c={},paint:m={},filter:x,minzoom:u,maxzoom:C,beforeId:I}=o;if(I!==l.beforeId&&e.moveLayer(t,I),c!==l.layout){const D=l.layout||{};for(const O in c)Hi(c[O],D[O])||e.setLayoutProperty(t,O,c[O]);for(const O in D)c.hasOwnProperty(O)||e.setLayoutProperty(t,O,void 0)}if(m!==l.paint){const D=l.paint||{};for(const O in m)Hi(m[O],D[O])||e.setPaintProperty(t,O,m[O]);for(const O in D)m.hasOwnProperty(O)||e.setPaintProperty(t,O,void 0)}Hi(x,l.filter)||e.setFilter(t,x),(u!==l.minzoom||C!==l.maxzoom)&&e.setLayerZoomRange(t,u,C)}function AA(e,t,o){if(e.style&&e.style._loaded&&(!("source"in o)||e.getSource(o.source))){const l={...o,id:t};delete l.beforeId,e.addLayer(l,o.beforeId)}}let zA=0;function DA(e){const t=he.useContext(dl).map.getMap(),o=he.useRef(e),[,l]=he.useState(0),c=he.useMemo(()=>e.id||`jsx-layer-${zA++}`,[]);if(he.useEffect(()=>{if(t){const x=()=>l(u=>u+1);return t.on("styledata",x),x(),()=>{t.off("styledata",x),t.style&&t.style._loaded&&t.getLayer(c)&&t.removeLayer(c)}}},[t]),t&&t.style&&t.getLayer(c))try{PA(t,c,e,o.current)}catch(x){console.warn(x)}else AA(t,c,e);return o.current=e,null}let LA=0;function RA(e,t,o){if(e.style&&e.style._loaded){const l={...o};return delete l.id,delete l.children,e.addSource(t,l),e.getSource(t)}return null}function FA(e,t,o){bf(t.id===o.id,"source id changed"),bf(t.type===o.type,"source type changed");let l="",c=0;for(const x in t)x!=="children"&&x!=="id"&&!Hi(o[x],t[x])&&(l=x,c++);if(!c)return;const m=t.type;if(m==="geojson")e.setData(t.data);else if(m==="image")e.updateImage({url:t.url,coordinates:t.coordinates});else if("setCoordinates"in e&&c===1&&l==="coordinates")e.setCoordinates(t.coordinates);else if("setUrl"in e)switch(l){case"url":e.setUrl(t.url);break;case"tiles":e.setTiles(t.tiles);break}else console.warn(`Unable to update <Source> prop: ${l}`)}function OA(e){const t=he.useContext(dl).map.getMap(),o=he.useRef(e),[,l]=he.useState(0),c=he.useMemo(()=>e.id||`jsx-source-${LA++}`,[]);he.useEffect(()=>{if(t){const x=()=>setTimeout(()=>l(u=>u+1),0);return t.on("styledata",x),x(),()=>{var u;if(t.off("styledata",x),t.style&&t.style._loaded&&t.getSource(c)){const C=(u=t.getStyle())===null||u===void 0?void 0:u.layers;if(C)for(const I of C)I.source===c&&t.removeLayer(I.id);t.removeSource(c)}}}},[t]);let m=t&&t.style&&t.getSource(c);return m?FA(m,e,o.current):m=RA(t,c,e),o.current=e,m&&he.Children.map(e.children,x=>x&&he.cloneElement(x,{source:c}))||null}function zS(){return oA()}const BA=iA(()=>Promise.resolve().then(()=>yP),void 0),DS=he.forwardRef(function(t,o){return _A(t,o,BA)}),LS=SA,RS=CA,FS=kA,dn=DA,Ru=OA,OS=()=>Qe.jsxs(Qe.Fragment,{children:[Qe.jsx(dn,{id:"background",type:"background",paint:{"background-color":"#9cc0facc"}}),Qe.jsxs(Ru,{id:"world",type:"vector",url:"pmtiles:///world.pmtiles",children:[Qe.jsx(dn,{"source-layer":"land",type:"fill",paint:{"fill-color":"#f8f8f8"}}),Qe.jsx(dn,{"source-layer":"states",type:"line",paint:{"line-color":"#aaa","line-width":1,"line-opacity":1,"line-dasharray":[2,2]}}),Qe.jsx(dn,{"source-layer":"countries",type:"line",paint:{"line-color":"#ccc","line-width":1,"line-opacity":1}}),Qe.jsx(dn,{"source-layer":"lakes",type:"fill",paint:{"fill-color":"#9cc0facc"}})]})]}),c_=({game:e})=>Qe.jsxs(Ru,{id:e,type:"vector",url:`pmtiles:///${e}.pmtiles`,children:[Qe.jsx(dn,{id:e+"prefabs","source-layer":e,type:"fill",filter:["all",["==",["geometry-type"],"Polygon"],["==",["get","type"],"prefab"]],layout:{"fill-sort-key":["get","zIndex"]},paint:{"fill-color":$A}}),Qe.jsxs(Ru,{id:e+"footprints",type:"vector",url:`pmtiles:///${e}-footprints.pmtiles`,children:[Qe.jsx(dn,{id:e+"footprints","source-layer":"footprints",type:"fill",filter:["all",["==",["geometry-type"],"Polygon"],["==",["get","type"],"footprint"]],paint:{"fill-color":"#e9e9e8","fill-opacity":["step",["zoom"],1,9,.8]}}),Qe.jsx(dn,{id:e+"extrusions",minzoom:9,"source-layer":"footprints",type:"fill-extrusion",filter:["all",["==",["geometry-type"],"Polygon"],["==",["get","type"],"footprint"]],paint:{"fill-extrusion-color":"#e9e9e8","fill-extrusion-height":["interpolate",["exponential",1.5],["zoom"],9,["*",10,["get","height"]],13,["*",20,["get","height"]]],"fill-extrusion-opacity":.33}})]}),Qe.jsx(dn,{id:e+"hidden-roads","source-layer":e,type:"line",minzoom:9,filter:["all",["==",["geometry-type"],"LineString"],["==",["get","type"],"road"],["==",["get","hidden"],!0]],paint:{"line-color":"#e9e9e8","line-width":1,"line-opacity":.7}}),Qe.jsx(dn,{id:e+"visible-roads-case","source-layer":e,type:"line",filter:["all",["==",["geometry-type"],"LineString"],["==",["get","type"],"road"],["==",["get","hidden"],!1]],layout:iw,paint:{"line-color":UA,"line-gap-width":ow,"line-width":["interpolate",["exponential",1.5],["zoom"],10,1,14,2,16,3]}}),Qe.jsx(dn,{id:e+"visible-roads","source-layer":e,type:"line",filter:["all",["==",["geometry-type"],"LineString"],["==",["get","type"],"road"],["==",["get","hidden"],!1]],layout:iw,paint:{"line-color":NA,"line-width":ow}}),Qe.jsx(dn,{id:e+"ferries","source-layer":e,type:"line",filter:["all",["==",["geometry-type"],"LineString"],["==",["get","type"],"ferry"]],paint:{"line-color":"#6c90ff88","line-width":1,"line-opacity":.8,"line-dasharray":[2,2]}}),Qe.jsx(dn,{id:e+"trains-a","source-layer":e,type:"line",filter:["all",["==",["geometry-type"],"LineString"],["==",["get","type"],"train"]],paint:{"line-color":"#aaa","line-width":1,"line-opacity":.8,"line-offset":["interpolate",["exponential",1.5],["zoom"],4,0,10,-3.5]}}),Qe.jsx(dn,{id:e+"trains-b","source-layer":e,type:"line",filter:["all",["==",["geometry-type"],"LineString"],["==",["get","type"],"train"]],paint:{"line-color":"#aaa","line-width":1,"line-opacity":.8,"line-offset":["interpolate",["exponential",1.5],["zoom"],4,0,10,3.5]}}),Qe.jsx(dn,{id:e+"train-hatch","source-layer":e,type:"line",filter:["all",["==",["geometry-type"],"LineString"],["==",["get","type"],"train"]],paint:{"line-color":"#aaa","line-width":8,"line-opacity":.6,"line-dasharray":[.1,8]}}),Qe.jsx(dn,{id:e+"ferry-labels","source-layer":e,minzoom:7.5,type:"symbol",filter:["all",["==",["geometry-type"],"LineString"],["==",["get","type"],"ferry"]],layout:{...ls,"symbol-placement":"line-center","text-field":"{name}","text-size":12},paint:{"text-halo-width":2,"text-halo-color":"#eefc","text-color":"#6c80ff"}}),Qe.jsx(dn,{id:e+"train-labels","source-layer":e,minzoom:7.5,type:"symbol",filter:["all",["==",["geometry-type"],"LineString"],["==",["get","type"],"train"]],layout:{...ls,"symbol-placement":"line-center","text-field":"{name}","text-size":12},paint:{"text-halo-width":2,"text-halo-color":"#eefc","text-color":"#555c"}}),Qe.jsx(dn,{id:e+"company-icons","source-layer":e,type:"symbol",minzoom:8,filter:["all",["==",["geometry-type"],"Point"],["==",["get","type"],"poi"],["==",["get","poiType"],"company"]],layout:{"icon-image":"{sprite}","icon-size":["interpolate",["exponential",1.5],["zoom"],9,1.25,13,3.5]}}),e==="ets2"&&Qe.jsx(dn,{id:"euro-road-overlays","source-layer":e,minzoom:4.5,type:"symbol",filter:["all",["==",["geometry-type"],"Point"],["==",["get","type"],"poi"],["==",["get","poiType"],"road"]],layout:{"icon-image":"{sprite}","icon-padding":["literal",[10,30]],"icon-size":["interpolate",["exponential",1.5],["zoom"],4,.4*1.25,9,.75*1.25,13,1.25*1.25]}}),e==="ats"&&Qe.jsx(dn,{id:e+"road-interstate-overlays","source-layer":e,type:"symbol",filter:["all",["==",["geometry-type"],"Point"],["==",["get","type"],"poi"],["==",["get","poiType"],"road"],["==",["index-of","is",["get","sprite"]],0]],layout:{"icon-image":"{sprite}","icon-padding":["literal",[10,30]],"icon-size":["interpolate",["exponential",1.5],["zoom"],4,.4,9,.75,13,1.25]}}),e==="ats"&&Qe.jsx(dn,{id:e+"road-us-route-overlays","source-layer":e,type:"symbol",minzoom:5,filter:["all",["==",["geometry-type"],"Point"],["==",["get","type"],"poi"],["==",["get","poiType"],"road"],["==",["index-of","us",["get","sprite"]],0]],layout:{"icon-image":"{sprite}","icon-padding":["literal",[10,30]],"icon-size":["interpolate",["exponential",1.5],["zoom"],4,.4,9,.75,13,1.25]}}),e==="ats"&&Qe.jsx(dn,{id:e+"road-state-route-overlays","source-layer":e,type:"symbol",minzoom:6,filter:["all",["==",["geometry-type"],"Point"],["==",["get","type"],"poi"],["==",["get","poiType"],"road"],["!",["any",["==",["index-of","is",["get","sprite"]],0],["==",["index-of","us",["get","sprite"]],0]]]],layout:{"icon-image":"{sprite}","icon-padding":["literal",[10,30]],"icon-size":["interpolate",["exponential",1.5],["zoom"],4,.4,9,.75,13,1.25]}}),Qe.jsx(dn,{id:e+"city-labels-small","source-layer":e,type:"symbol",minzoom:6,filter:["all",["==",["geometry-type"],"Point"],["==",["get","type"],"city"],[">",["get","scaleRank"],6]],layout:{...ls,"text-field":"{name}","text-variable-anchor":_u,"text-size":12,"icon-image":Jg,"icon-size":.6},paint:vu}),Qe.jsx(dn,{id:e+"city-labels-medium","source-layer":e,type:"symbol",minzoom:5,filter:["all",["==",["geometry-type"],"Point"],["==",["get","type"],"city"],["<=",["get","scaleRank"],6],[">",["get","scaleRank"],3]],layout:{...ls,"text-field":"{name}","text-variable-anchor":_u,"text-size":13,"icon-image":Jg,"icon-size":.6},paint:vu}),Qe.jsx(dn,{id:e+"city-labels-big","source-layer":e,type:"symbol",minzoom:4,filter:["all",["==",["geometry-type"],"Point"],["==",["get","type"],"city"],["<=",["get","scaleRank"],3]],layout:{...ls,"text-field":"{name}","text-variable-anchor":_u,"text-size":14,"icon-image":Jg,"icon-size":.8},paint:vu}),e==="ets2"&&Qe.jsx(dn,{id:e+"country-labels","source-layer":e,type:"symbol",minzoom:4,maxzoom:6.5,filter:["all",["==",["geometry-type"],"Point"],["==",["get","type"],"country"]],layout:{...ls,"text-font":["Klokantech Noto Sans Bold"],"text-field":"{name}","text-variable-anchor":_u,"text-size":14},paint:vu}),Qe.jsx(dn,{id:e+"poi-icons","source-layer":e,type:"symbol",minzoom:7,filter:["all",["==",["geometry-type"],"Point"],["==",["get","type"],"poi"],["in",["get","poiType"],["literal",["landmark","viewpoint","facility","ferry","train"]]]],layout:{"icon-image":"{sprite}","icon-size":["interpolate",["exponential",1.5],["zoom"],4,.6,9,1.25,13,2.5]}})]}),Jg=["step",["zoom"],["case",["==",["get","capital"],2],"dotdot","dot"],8,""],_u=["step",["zoom"],["literal",["top","bottom","right","left"]],7,["literal",["center"]]],ls={"text-radial-offset":.5,"text-justify":"auto","text-font":["Klokantech Noto Sans Regular"]},vu={"text-color":"hsl(42, 10%, 14%)","text-halo-width":2,"text-halo-color":"hsl(42, 10%, 100%)"},iw={"line-cap":"round","line-join":"bevel"},ow=["interpolate",["exponential",1.5],["zoom"],3,.8,14,30,16,150],BS={freeway:["#fde293","#f8c248"],divided:["#ffffff","#dddddd"],no_vehicles:["#aaaaaa","#888888"],local:["#f1f3f4","#dddddd"],train:["#ff0000","#f8c248"],tram:["#00ff00","#f8c248"],unknown:["#f0f","#f0f"]},VA={0:"#eaeced",1:"#e6cc9f",2:"#d8a54e",3:"#b1ca9b"},NA=["match",["get","roadType"],...Object.entries(BS).flatMap(([e,[t]])=>[e,t]),"#f0f"],UA=["match",["get","roadType"],...Object.entries(BS).flatMap(([e,[t,o]])=>[e,o]),"#b0b"],$A=["match",["get","color"],...Object.entries(VA).flatMap(([e,t])=>[Number(e),t]),"#b0b"],jA=()=>(he.useState(!1),he.useState({type:"auto"}),Qe.jsx("div",{style:{position:"absolute",left:0,bottom:0,margin:10}}));function ul(e){"@babel/helpers - typeof";return ul=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ul(e)}function ZA(e,t){if(ul(e)!="object"||!e)return e;var o=e[Symbol.toPrimitive];if(o!==void 0){var l=o.call(e,t||"default");if(ul(l)!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function VS(e){var t=ZA(e,"string");return ul(t)=="symbol"?t:String(t)}function mh(e,t,o){return t=VS(t),t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function aw(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);t&&(l=l.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),o.push.apply(o,l)}return o}function St(e){for(var t=1;t<arguments.length;t++){var o=arguments[t]!=null?arguments[t]:{};t%2?aw(Object(o),!0).forEach(function(l){mh(e,l,o[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):aw(Object(o)).forEach(function(l){Object.defineProperty(e,l,Object.getOwnPropertyDescriptor(o,l))})}return e}function qA(e){if(Array.isArray(e))return e}function GA(e,t){var o=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(o!=null){var l,c,m,x,u=[],C=!0,I=!1;try{if(m=(o=o.call(e)).next,t===0){if(Object(o)!==o)return;C=!1}else for(;!(C=(l=m.call(o)).done)&&(u.push(l.value),u.length!==t);C=!0);}catch(D){I=!0,c=D}finally{try{if(!C&&o.return!=null&&(x=o.return(),Object(x)!==x))return}finally{if(I)throw c}}return u}}function h_(e,t){(t==null||t>e.length)&&(t=e.length);for(var o=0,l=new Array(t);o<t;o++)l[o]=e[o];return l}function NS(e,t){if(e){if(typeof e=="string")return h_(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);if(o==="Object"&&e.constructor&&(o=e.constructor.name),o==="Map"||o==="Set")return Array.from(e);if(o==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return h_(e,t)}}function HA(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Aa(e,t){return qA(e)||GA(e,t)||NS(e,t)||HA()}function WA(e,t){if(e==null)return{};var o={},l=Object.keys(e),c,m;for(m=0;m<l.length;m++)c=l[m],!(t.indexOf(c)>=0)&&(o[c]=e[c]);return o}function Ba(e,t){if(e==null)return{};var o=WA(e,t),l,c;if(Object.getOwnPropertySymbols){var m=Object.getOwnPropertySymbols(e);for(c=0;c<m.length;c++)l=m[c],!(t.indexOf(l)>=0)&&Object.prototype.propertyIsEnumerable.call(e,l)&&(o[l]=e[l])}return o}var KA=["defaultInputValue","defaultMenuIsOpen","defaultValue","inputValue","menuIsOpen","onChange","onInputChange","onMenuClose","onMenuOpen","value"];function XA(e){var t=e.defaultInputValue,o=t===void 0?"":t,l=e.defaultMenuIsOpen,c=l===void 0?!1:l,m=e.defaultValue,x=m===void 0?null:m,u=e.inputValue,C=e.menuIsOpen,I=e.onChange,D=e.onInputChange,O=e.onMenuClose,U=e.onMenuOpen,le=e.value,ue=Ba(e,KA),ae=he.useState(u!==void 0?u:o),oe=Aa(ae,2),$=oe[0],G=oe[1],ee=he.useState(C!==void 0?C:c),_e=Aa(ee,2),Ce=_e[0],de=_e[1],be=he.useState(le!==void 0?le:x),Me=Aa(be,2),Ze=Me[0],Oe=Me[1],ft=he.useCallback(function(Be,lt){typeof I=="function"&&I(Be,lt),Oe(Be)},[I]),bt=he.useCallback(function(Be,lt){var dt;typeof D=="function"&&(dt=D(Be,lt)),G(dt!==void 0?dt:Be)},[D]),Rt=he.useCallback(function(){typeof U=="function"&&U(),de(!0)},[U]),Ft=he.useCallback(function(){typeof O=="function"&&O(),de(!1)},[O]),It=u!==void 0?u:$,zt=C!==void 0?C:Ce,xt=le!==void 0?le:Ze;return St(St({},ue),{},{inputValue:It,menuIsOpen:zt,onChange:ft,onInputChange:bt,onMenuClose:Ft,onMenuOpen:Rt,value:xt})}function Et(){return Et=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])}return e},Et.apply(this,arguments)}function YA(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function sw(e,t){for(var o=0;o<t.length;o++){var l=t[o];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(e,VS(l.key),l)}}function JA(e,t,o){return t&&sw(e.prototype,t),o&&sw(e,o),Object.defineProperty(e,"prototype",{writable:!1}),e}function d_(e,t){return d_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(l,c){return l.__proto__=c,l},d_(e,t)}function QA(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&d_(e,t)}function Sf(e){return Sf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(o){return o.__proto__||Object.getPrototypeOf(o)},Sf(e)}function US(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(US=function(){return!!e})()}function ez(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function tz(e,t){if(t&&(ul(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ez(e)}function nz(e){var t=US();return function(){var l=Sf(e),c;if(t){var m=Sf(this).constructor;c=Reflect.construct(l,arguments,m)}else c=l.apply(this,arguments);return tz(this,c)}}function rz(e){if(Array.isArray(e))return h_(e)}function iz(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function oz(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function xv(e){return rz(e)||iz(e)||NS(e)||oz()}function az(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]}function sz(e){var t=document.createElement("style");return t.setAttribute("data-emotion",e.key),e.nonce!==void 0&&t.setAttribute("nonce",e.nonce),t.appendChild(document.createTextNode("")),t.setAttribute("data-s",""),t}var lz=function(){function e(o){var l=this;this._insertTag=function(c){var m;l.tags.length===0?l.insertionPoint?m=l.insertionPoint.nextSibling:l.prepend?m=l.container.firstChild:m=l.before:m=l.tags[l.tags.length-1].nextSibling,l.container.insertBefore(c,m),l.tags.push(c)},this.isSpeedy=o.speedy===void 0?!0:o.speedy,this.tags=[],this.ctr=0,this.nonce=o.nonce,this.key=o.key,this.container=o.container,this.prepend=o.prepend,this.insertionPoint=o.insertionPoint,this.before=null}var t=e.prototype;return t.hydrate=function(l){l.forEach(this._insertTag)},t.insert=function(l){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(sz(this));var c=this.tags[this.tags.length-1];if(this.isSpeedy){var m=az(c);try{m.insertRule(l,m.cssRules.length)}catch{}}else c.appendChild(document.createTextNode(l));this.ctr++},t.flush=function(){this.tags.forEach(function(l){return l.parentNode&&l.parentNode.removeChild(l)}),this.tags=[],this.ctr=0},e}(),ti="-ms-",Tf="-moz-",ln="-webkit-",$S="comm",wv="rule",bv="decl",uz="@import",jS="@keyframes",cz="@layer",hz=Math.abs,Qf=String.fromCharCode,dz=Object.assign;function pz(e,t){return Nr(e,0)^45?(((t<<2^Nr(e,0))<<2^Nr(e,1))<<2^Nr(e,2))<<2^Nr(e,3):0}function ZS(e){return e.trim()}function fz(e,t){return(e=t.exec(e))?e[0]:e}function un(e,t,o){return e.replace(t,o)}function p_(e,t){return e.indexOf(t)}function Nr(e,t){return e.charCodeAt(t)|0}function qh(e,t,o){return e.slice(t,o)}function ra(e){return e.length}function Sv(e){return e.length}function Ip(e,t){return t.push(e),e}function mz(e,t){return e.map(t).join("")}var em=1,Fu=1,qS=0,Oi=0,dr=0,Uu="";function tm(e,t,o,l,c,m,x){return{value:e,root:t,parent:o,type:l,props:c,children:m,line:em,column:Fu,length:x,return:""}}function uh(e,t){return dz(tm("",null,null,"",null,null,0),e,{length:-e.length},t)}function gz(){return dr}function yz(){return dr=Oi>0?Nr(Uu,--Oi):0,Fu--,dr===10&&(Fu=1,em--),dr}function Xi(){return dr=Oi<qS?Nr(Uu,Oi++):0,Fu++,dr===10&&(Fu=1,em++),dr}function la(){return Nr(Uu,Oi)}function Zp(){return Oi}function rd(e,t){return qh(Uu,e,t)}function Gh(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function GS(e){return em=Fu=1,qS=ra(Uu=e),Oi=0,[]}function HS(e){return Uu="",e}function qp(e){return ZS(rd(Oi-1,f_(e===91?e+2:e===40?e+1:e)))}function _z(e){for(;(dr=la())&&dr<33;)Xi();return Gh(e)>2||Gh(dr)>3?"":" "}function vz(e,t){for(;--t&&Xi()&&!(dr<48||dr>102||dr>57&&dr<65||dr>70&&dr<97););return rd(e,Zp()+(t<6&&la()==32&&Xi()==32))}function f_(e){for(;Xi();)switch(dr){case e:return Oi;case 34:case 39:e!==34&&e!==39&&f_(dr);break;case 40:e===41&&f_(e);break;case 92:Xi();break}return Oi}function xz(e,t){for(;Xi()&&e+dr!==57;)if(e+dr===84&&la()===47)break;return"/*"+rd(t,Oi-1)+"*"+Qf(e===47?e:Xi())}function wz(e){for(;!Gh(la());)Xi();return rd(e,Oi)}function bz(e){return HS(Gp("",null,null,null,[""],e=GS(e),0,[0],e))}function Gp(e,t,o,l,c,m,x,u,C){for(var I=0,D=0,O=x,U=0,le=0,ue=0,ae=1,oe=1,$=1,G=0,ee="",_e=c,Ce=m,de=l,be=ee;oe;)switch(ue=G,G=Xi()){case 40:if(ue!=108&&Nr(be,O-1)==58){p_(be+=un(qp(G),"&","&\f"),"&\f")!=-1&&($=-1);break}case 34:case 39:case 91:be+=qp(G);break;case 9:case 10:case 13:case 32:be+=_z(ue);break;case 92:be+=vz(Zp()-1,7);continue;case 47:switch(la()){case 42:case 47:Ip(Sz(xz(Xi(),Zp()),t,o),C);break;default:be+="/"}break;case 123*ae:u[I++]=ra(be)*$;case 125*ae:case 59:case 0:switch(G){case 0:case 125:oe=0;case 59+D:$==-1&&(be=un(be,/\f/g,"")),le>0&&ra(be)-O&&Ip(le>32?uw(be+";",l,o,O-1):uw(un(be," ","")+";",l,o,O-2),C);break;case 59:be+=";";default:if(Ip(de=lw(be,t,o,I,D,c,u,ee,_e=[],Ce=[],O),m),G===123)if(D===0)Gp(be,t,de,de,_e,m,O,u,Ce);else switch(U===99&&Nr(be,3)===110?100:U){case 100:case 108:case 109:case 115:Gp(e,de,de,l&&Ip(lw(e,de,de,0,0,c,u,ee,c,_e=[],O),Ce),c,Ce,O,u,l?_e:Ce);break;default:Gp(be,de,de,de,[""],Ce,0,u,Ce)}}I=D=le=0,ae=$=1,ee=be="",O=x;break;case 58:O=1+ra(be),le=ue;default:if(ae<1){if(G==123)--ae;else if(G==125&&ae++==0&&yz()==125)continue}switch(be+=Qf(G),G*ae){case 38:$=D>0?1:(be+="\f",-1);break;case 44:u[I++]=(ra(be)-1)*$,$=1;break;case 64:la()===45&&(be+=qp(Xi())),U=la(),D=O=ra(ee=be+=wz(Zp())),G++;break;case 45:ue===45&&ra(be)==2&&(ae=0)}}return m}function lw(e,t,o,l,c,m,x,u,C,I,D){for(var O=c-1,U=c===0?m:[""],le=Sv(U),ue=0,ae=0,oe=0;ue<l;++ue)for(var $=0,G=qh(e,O+1,O=hz(ae=x[ue])),ee=e;$<le;++$)(ee=ZS(ae>0?U[$]+" "+G:un(G,/&\f/g,U[$])))&&(C[oe++]=ee);return tm(e,t,o,c===0?wv:u,C,I,D)}function Sz(e,t,o){return tm(e,t,o,$S,Qf(gz()),qh(e,2,-2),0)}function uw(e,t,o,l){return tm(e,t,o,bv,qh(e,0,l),qh(e,l+1,-1),l)}function Eu(e,t){for(var o="",l=Sv(e),c=0;c<l;c++)o+=t(e[c],c,e,t)||"";return o}function Tz(e,t,o,l){switch(e.type){case cz:if(e.children.length)break;case uz:case bv:return e.return=e.return||e.value;case $S:return"";case jS:return e.return=e.value+"{"+Eu(e.children,l)+"}";case wv:e.value=e.props.join(",")}return ra(o=Eu(e.children,l))?e.return=e.value+"{"+o+"}":""}function Cz(e){var t=Sv(e);return function(o,l,c,m){for(var x="",u=0;u<t;u++)x+=e[u](o,l,c,m)||"";return x}}function Ez(e){return function(t){t.root||(t=t.return)&&e(t)}}function Iz(e){var t=Object.create(null);return function(o){return t[o]===void 0&&(t[o]=e(o)),t[o]}}var kz=function(t,o,l){for(var c=0,m=0;c=m,m=la(),c===38&&m===12&&(o[l]=1),!Gh(m);)Xi();return rd(t,Oi)},Mz=function(t,o){var l=-1,c=44;do switch(Gh(c)){case 0:c===38&&la()===12&&(o[l]=1),t[l]+=kz(Oi-1,o,l);break;case 2:t[l]+=qp(c);break;case 4:if(c===44){t[++l]=la()===58?"&\f":"",o[l]=t[l].length;break}default:t[l]+=Qf(c)}while(c=Xi());return t},Pz=function(t,o){return HS(Mz(GS(t),o))},cw=new WeakMap,Az=function(t){if(!(t.type!=="rule"||!t.parent||t.length<1)){for(var o=t.value,l=t.parent,c=t.column===l.column&&t.line===l.line;l.type!=="rule";)if(l=l.parent,!l)return;if(!(t.props.length===1&&o.charCodeAt(0)!==58&&!cw.get(l))&&!c){cw.set(t,!0);for(var m=[],x=Pz(o,m),u=l.props,C=0,I=0;C<x.length;C++)for(var D=0;D<u.length;D++,I++)t.props[I]=m[C]?x[C].replace(/&\f/g,u[D]):u[D]+" "+x[C]}}},zz=function(t){if(t.type==="decl"){var o=t.value;o.charCodeAt(0)===108&&o.charCodeAt(2)===98&&(t.return="",t.value="")}};function WS(e,t){switch(pz(e,t)){case 5103:return ln+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return ln+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return ln+e+Tf+e+ti+e+e;case 6828:case 4268:return ln+e+ti+e+e;case 6165:return ln+e+ti+"flex-"+e+e;case 5187:return ln+e+un(e,/(\w+).+(:[^]+)/,ln+"box-$1$2"+ti+"flex-$1$2")+e;case 5443:return ln+e+ti+"flex-item-"+un(e,/flex-|-self/,"")+e;case 4675:return ln+e+ti+"flex-line-pack"+un(e,/align-content|flex-|-self/,"")+e;case 5548:return ln+e+ti+un(e,"shrink","negative")+e;case 5292:return ln+e+ti+un(e,"basis","preferred-size")+e;case 6060:return ln+"box-"+un(e,"-grow","")+ln+e+ti+un(e,"grow","positive")+e;case 4554:return ln+un(e,/([^-])(transform)/g,"$1"+ln+"$2")+e;case 6187:return un(un(un(e,/(zoom-|grab)/,ln+"$1"),/(image-set)/,ln+"$1"),e,"")+e;case 5495:case 3959:return un(e,/(image-set\([^]*)/,ln+"$1$`$1");case 4968:return un(un(e,/(.+:)(flex-)?(.*)/,ln+"box-pack:$3"+ti+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+ln+e+e;case 4095:case 3583:case 4068:case 2532:return un(e,/(.+)-inline(.+)/,ln+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(ra(e)-1-t>6)switch(Nr(e,t+1)){case 109:if(Nr(e,t+4)!==45)break;case 102:return un(e,/(.+:)(.+)-([^]+)/,"$1"+ln+"$2-$3$1"+Tf+(Nr(e,t+3)==108?"$3":"$2-$3"))+e;case 115:return~p_(e,"stretch")?WS(un(e,"stretch","fill-available"),t)+e:e}break;case 4949:if(Nr(e,t+1)!==115)break;case 6444:switch(Nr(e,ra(e)-3-(~p_(e,"!important")&&10))){case 107:return un(e,":",":"+ln)+e;case 101:return un(e,/(.+:)([^;!]+)(;|!.+)?/,"$1"+ln+(Nr(e,14)===45?"inline-":"")+"box$3$1"+ln+"$2$3$1"+ti+"$2box$3")+e}break;case 5936:switch(Nr(e,t+11)){case 114:return ln+e+ti+un(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return ln+e+ti+un(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return ln+e+ti+un(e,/[svh]\w+-[tblr]{2}/,"lr")+e}return ln+e+ti+e+e}return e}var Dz=function(t,o,l,c){if(t.length>-1&&!t.return)switch(t.type){case bv:t.return=WS(t.value,t.length);break;case jS:return Eu([uh(t,{value:un(t.value,"@","@"+ln)})],c);case wv:if(t.length)return mz(t.props,function(m){switch(fz(m,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return Eu([uh(t,{props:[un(m,/:(read-\w+)/,":"+Tf+"$1")]})],c);case"::placeholder":return Eu([uh(t,{props:[un(m,/:(plac\w+)/,":"+ln+"input-$1")]}),uh(t,{props:[un(m,/:(plac\w+)/,":"+Tf+"$1")]}),uh(t,{props:[un(m,/:(plac\w+)/,ti+"input-$1")]})],c)}return""})}},Lz=[Dz],Rz=function(t){var o=t.key;if(o==="css"){var l=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(l,function(ae){var oe=ae.getAttribute("data-emotion");oe.indexOf(" ")!==-1&&(document.head.appendChild(ae),ae.setAttribute("data-s",""))})}var c=t.stylisPlugins||Lz,m={},x,u=[];x=t.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+o+' "]'),function(ae){for(var oe=ae.getAttribute("data-emotion").split(" "),$=1;$<oe.length;$++)m[oe[$]]=!0;u.push(ae)});var C,I=[Az,zz];{var D,O=[Tz,Ez(function(ae){D.insert(ae)})],U=Cz(I.concat(c,O)),le=function(oe){return Eu(bz(oe),U)};C=function(oe,$,G,ee){D=G,le(oe?oe+"{"+$.styles+"}":$.styles),ee&&(ue.inserted[$.name]=!0)}}var ue={key:o,sheet:new lz({key:o,container:x,nonce:t.nonce,speedy:t.speedy,prepend:t.prepend,insertionPoint:t.insertionPoint}),nonce:t.nonce,inserted:m,registered:{},insert:C};return ue.sheet.hydrate(u),ue},KS={exports:{}},mn={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Pr=typeof Symbol=="function"&&Symbol.for,Tv=Pr?Symbol.for("react.element"):60103,Cv=Pr?Symbol.for("react.portal"):60106,nm=Pr?Symbol.for("react.fragment"):60107,rm=Pr?Symbol.for("react.strict_mode"):60108,im=Pr?Symbol.for("react.profiler"):60114,om=Pr?Symbol.for("react.provider"):60109,am=Pr?Symbol.for("react.context"):60110,Ev=Pr?Symbol.for("react.async_mode"):60111,sm=Pr?Symbol.for("react.concurrent_mode"):60111,lm=Pr?Symbol.for("react.forward_ref"):60112,um=Pr?Symbol.for("react.suspense"):60113,Fz=Pr?Symbol.for("react.suspense_list"):60120,cm=Pr?Symbol.for("react.memo"):60115,hm=Pr?Symbol.for("react.lazy"):60116,Oz=Pr?Symbol.for("react.block"):60121,Bz=Pr?Symbol.for("react.fundamental"):60117,Vz=Pr?Symbol.for("react.responder"):60118,Nz=Pr?Symbol.for("react.scope"):60119;function eo(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case Tv:switch(e=e.type,e){case Ev:case sm:case nm:case im:case rm:case um:return e;default:switch(e=e&&e.$$typeof,e){case am:case lm:case hm:case cm:case om:return e;default:return t}}case Cv:return t}}}function XS(e){return eo(e)===sm}mn.AsyncMode=Ev;mn.ConcurrentMode=sm;mn.ContextConsumer=am;mn.ContextProvider=om;mn.Element=Tv;mn.ForwardRef=lm;mn.Fragment=nm;mn.Lazy=hm;mn.Memo=cm;mn.Portal=Cv;mn.Profiler=im;mn.StrictMode=rm;mn.Suspense=um;mn.isAsyncMode=function(e){return XS(e)||eo(e)===Ev};mn.isConcurrentMode=XS;mn.isContextConsumer=function(e){return eo(e)===am};mn.isContextProvider=function(e){return eo(e)===om};mn.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===Tv};mn.isForwardRef=function(e){return eo(e)===lm};mn.isFragment=function(e){return eo(e)===nm};mn.isLazy=function(e){return eo(e)===hm};mn.isMemo=function(e){return eo(e)===cm};mn.isPortal=function(e){return eo(e)===Cv};mn.isProfiler=function(e){return eo(e)===im};mn.isStrictMode=function(e){return eo(e)===rm};mn.isSuspense=function(e){return eo(e)===um};mn.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===nm||e===sm||e===im||e===rm||e===um||e===Fz||typeof e=="object"&&e!==null&&(e.$$typeof===hm||e.$$typeof===cm||e.$$typeof===om||e.$$typeof===am||e.$$typeof===lm||e.$$typeof===Bz||e.$$typeof===Vz||e.$$typeof===Nz||e.$$typeof===Oz)};mn.typeOf=eo;KS.exports=mn;var Uz=KS.exports,YS=Uz,$z={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},jz={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},JS={};JS[YS.ForwardRef]=$z;JS[YS.Memo]=jz;var Zz=!0;function qz(e,t,o){var l="";return o.split(" ").forEach(function(c){e[c]!==void 0?t.push(e[c]+";"):l+=c+" "}),l}var QS=function(t,o,l){var c=t.key+"-"+o.name;(l===!1||Zz===!1)&&t.registered[c]===void 0&&(t.registered[c]=o.styles)},Gz=function(t,o,l){QS(t,o,l);var c=t.key+"-"+o.name;if(t.inserted[o.name]===void 0){var m=o;do t.insert(o===m?"."+c:"",m,t.sheet,!0),m=m.next;while(m!==void 0)}};function Hz(e){for(var t=0,o,l=0,c=e.length;c>=4;++l,c-=4)o=e.charCodeAt(l)&255|(e.charCodeAt(++l)&255)<<8|(e.charCodeAt(++l)&255)<<16|(e.charCodeAt(++l)&255)<<24,o=(o&65535)*1540483477+((o>>>16)*59797<<16),o^=o>>>24,t=(o&65535)*1540483477+((o>>>16)*59797<<16)^(t&65535)*1540483477+((t>>>16)*59797<<16);switch(c){case 3:t^=(e.charCodeAt(l+2)&255)<<16;case 2:t^=(e.charCodeAt(l+1)&255)<<8;case 1:t^=e.charCodeAt(l)&255,t=(t&65535)*1540483477+((t>>>16)*59797<<16)}return t^=t>>>13,t=(t&65535)*1540483477+((t>>>16)*59797<<16),((t^t>>>15)>>>0).toString(36)}var Wz={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},Kz=/[A-Z]|^ms/g,Xz=/_EMO_([^_]+?)_([^]*?)_EMO_/g,eT=function(t){return t.charCodeAt(1)===45},hw=function(t){return t!=null&&typeof t!="boolean"},Qg=Iz(function(e){return eT(e)?e:e.replace(Kz,"-$&").toLowerCase()}),dw=function(t,o){switch(t){case"animation":case"animationName":if(typeof o=="string")return o.replace(Xz,function(l,c,m){return ia={name:c,styles:m,next:ia},c})}return Wz[t]!==1&&!eT(t)&&typeof o=="number"&&o!==0?o+"px":o};function Hh(e,t,o){if(o==null)return"";if(o.__emotion_styles!==void 0)return o;switch(typeof o){case"boolean":return"";case"object":{if(o.anim===1)return ia={name:o.name,styles:o.styles,next:ia},o.name;if(o.styles!==void 0){var l=o.next;if(l!==void 0)for(;l!==void 0;)ia={name:l.name,styles:l.styles,next:ia},l=l.next;var c=o.styles+";";return c}return Yz(e,t,o)}case"function":{if(e!==void 0){var m=ia,x=o(e);return ia=m,Hh(e,t,x)}break}}if(t==null)return o;var u=t[o];return u!==void 0?u:o}function Yz(e,t,o){var l="";if(Array.isArray(o))for(var c=0;c<o.length;c++)l+=Hh(e,t,o[c])+";";else for(var m in o){var x=o[m];if(typeof x!="object")t!=null&&t[x]!==void 0?l+=m+"{"+t[x]+"}":hw(x)&&(l+=Qg(m)+":"+dw(m,x)+";");else if(Array.isArray(x)&&typeof x[0]=="string"&&(t==null||t[x[0]]===void 0))for(var u=0;u<x.length;u++)hw(x[u])&&(l+=Qg(m)+":"+dw(m,x[u])+";");else{var C=Hh(e,t,x);switch(m){case"animation":case"animationName":{l+=Qg(m)+":"+C+";";break}default:l+=m+"{"+C+"}"}}}return l}var pw=/label:\s*([^\s;\n{]+)\s*(;|$)/g,ia,tT=function(t,o,l){if(t.length===1&&typeof t[0]=="object"&&t[0]!==null&&t[0].styles!==void 0)return t[0];var c=!0,m="";ia=void 0;var x=t[0];x==null||x.raw===void 0?(c=!1,m+=Hh(l,o,x)):m+=x[0];for(var u=1;u<t.length;u++)m+=Hh(l,o,t[u]),c&&(m+=x[u]);pw.lastIndex=0;for(var C="",I;(I=pw.exec(m))!==null;)C+="-"+I[1];var D=Hz(m)+C;return{name:D,styles:m,next:ia}},Jz=function(t){return t()},Qz=ly.useInsertionEffect?ly.useInsertionEffect:!1,eD=Qz||Jz,Iv={}.hasOwnProperty,nT=he.createContext(typeof HTMLElement<"u"?Rz({key:"css"}):null);nT.Provider;var tD=function(t){return he.forwardRef(function(o,l){var c=he.useContext(nT);return t(o,c,l)})},nD=he.createContext({}),m_="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",rD=function(t,o){var l={};for(var c in o)Iv.call(o,c)&&(l[c]=o[c]);return l[m_]=t,l},iD=function(t){var o=t.cache,l=t.serialized,c=t.isStringTag;return QS(o,l,c),eD(function(){return Gz(o,l,c)}),null},oD=tD(function(e,t,o){var l=e.css;typeof l=="string"&&t.registered[l]!==void 0&&(l=t.registered[l]);var c=e[m_],m=[l],x="";typeof e.className=="string"?x=qz(t.registered,m,e.className):e.className!=null&&(x=e.className+" ");var u=tT(m,void 0,he.useContext(nD));x+=t.key+"-"+u.name;var C={};for(var I in e)Iv.call(e,I)&&I!=="css"&&I!==m_&&(C[I]=e[I]);return C.ref=o,C.className=x,he.createElement(he.Fragment,null,he.createElement(iD,{cache:t,serialized:u,isStringTag:typeof c=="string"}),he.createElement(c,C))}),aD=oD,wt=function(t,o){var l=arguments;if(o==null||!Iv.call(o,"css"))return he.createElement.apply(void 0,l);var c=l.length,m=new Array(c);m[0]=aD,m[1]=rD(t,o);for(var x=2;x<c;x++)m[x]=l[x];return he.createElement.apply(null,m)};function kv(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];return tT(t)}var sD=function(){var t=kv.apply(void 0,arguments),o="animation-"+t.name;return{name:o,styles:"@keyframes "+o+"{"+t.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}};function lD(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}const uD=Math.min,cD=Math.max,Cf=Math.round,kp=Math.floor,Ef=e=>({x:e,y:e});function hD(e){return{...e,top:e.y,left:e.x,right:e.x+e.width,bottom:e.y+e.height}}function rT(e){return oT(e)?(e.nodeName||"").toLowerCase():"#document"}function jo(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function iT(e){var t;return(t=(oT(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function oT(e){return e instanceof Node||e instanceof jo(e).Node}function g_(e){return e instanceof Element||e instanceof jo(e).Element}function Mv(e){return e instanceof HTMLElement||e instanceof jo(e).HTMLElement}function fw(e){return typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof jo(e).ShadowRoot}function aT(e){const{overflow:t,overflowX:o,overflowY:l,display:c}=Pv(e);return/auto|scroll|overlay|hidden|clip/.test(t+l+o)&&!["inline","contents"].includes(c)}function dD(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function pD(e){return["html","body","#document"].includes(rT(e))}function Pv(e){return jo(e).getComputedStyle(e)}function fD(e){if(rT(e)==="html")return e;const t=e.assignedSlot||e.parentNode||fw(e)&&e.host||iT(e);return fw(t)?t.host:t}function sT(e){const t=fD(e);return pD(t)?e.ownerDocument?e.ownerDocument.body:e.body:Mv(t)&&aT(t)?t:sT(t)}function If(e,t,o){var l;t===void 0&&(t=[]),o===void 0&&(o=!0);const c=sT(e),m=c===((l=e.ownerDocument)==null?void 0:l.body),x=jo(c);return m?t.concat(x,x.visualViewport||[],aT(c)?c:[],x.frameElement&&o?If(x.frameElement):[]):t.concat(c,If(c,[],o))}function mD(e){const t=Pv(e);let o=parseFloat(t.width)||0,l=parseFloat(t.height)||0;const c=Mv(e),m=c?e.offsetWidth:o,x=c?e.offsetHeight:l,u=Cf(o)!==m||Cf(l)!==x;return u&&(o=m,l=x),{width:o,height:l,$:u}}function Av(e){return g_(e)?e:e.contextElement}function ey(e){const t=Av(e);if(!Mv(t))return Ef(1);const o=t.getBoundingClientRect(),{width:l,height:c,$:m}=mD(t);let x=(m?Cf(o.width):o.width)/l,u=(m?Cf(o.height):o.height)/c;return(!x||!Number.isFinite(x))&&(x=1),(!u||!Number.isFinite(u))&&(u=1),{x,y:u}}const gD=Ef(0);function yD(e){const t=jo(e);return!dD()||!t.visualViewport?gD:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function _D(e,t,o){return t===void 0&&(t=!1),!o||t&&o!==jo(e)?!1:t}function mw(e,t,o,l){t===void 0&&(t=!1),o===void 0&&(o=!1);const c=e.getBoundingClientRect(),m=Av(e);let x=Ef(1);t&&(l?g_(l)&&(x=ey(l)):x=ey(e));const u=_D(m,o,l)?yD(m):Ef(0);let C=(c.left+u.x)/x.x,I=(c.top+u.y)/x.y,D=c.width/x.x,O=c.height/x.y;if(m){const U=jo(m),le=l&&g_(l)?jo(l):l;let ue=U.frameElement;for(;ue&&l&&le!==U;){const ae=ey(ue),oe=ue.getBoundingClientRect(),$=Pv(ue),G=oe.left+(ue.clientLeft+parseFloat($.paddingLeft))*ae.x,ee=oe.top+(ue.clientTop+parseFloat($.paddingTop))*ae.y;C*=ae.x,I*=ae.y,D*=ae.x,O*=ae.y,C+=G,I+=ee,ue=jo(ue).frameElement}}return hD({width:D,height:O,x:C,y:I})}function vD(e,t){let o=null,l;const c=iT(e);function m(){clearTimeout(l),o&&o.disconnect(),o=null}function x(u,C){u===void 0&&(u=!1),C===void 0&&(C=1),m();const{left:I,top:D,width:O,height:U}=e.getBoundingClientRect();if(u||t(),!O||!U)return;const le=kp(D),ue=kp(c.clientWidth-(I+O)),ae=kp(c.clientHeight-(D+U)),oe=kp(I),G={rootMargin:-le+"px "+-ue+"px "+-ae+"px "+-oe+"px",threshold:cD(0,uD(1,C))||1};let ee=!0;function _e(Ce){const de=Ce[0].intersectionRatio;if(de!==C){if(!ee)return x();de?x(!1,de):l=setTimeout(()=>{x(!1,1e-7)},100)}ee=!1}try{o=new IntersectionObserver(_e,{...G,root:c.ownerDocument})}catch{o=new IntersectionObserver(_e,G)}o.observe(e)}return x(!0),m}function xD(e,t,o,l){l===void 0&&(l={});const{ancestorScroll:c=!0,ancestorResize:m=!0,elementResize:x=typeof ResizeObserver=="function",layoutShift:u=typeof IntersectionObserver=="function",animationFrame:C=!1}=l,I=Av(e),D=c||m?[...I?If(I):[],...If(t)]:[];D.forEach($=>{c&&$.addEventListener("scroll",o,{passive:!0}),m&&$.addEventListener("resize",o)});const O=I&&u?vD(I,o):null;let U=-1,le=null;x&&(le=new ResizeObserver($=>{let[G]=$;G&&G.target===I&&le&&(le.unobserve(t),cancelAnimationFrame(U),U=requestAnimationFrame(()=>{le&&le.observe(t)})),o()}),I&&!C&&le.observe(I),le.observe(t));let ue,ae=C?mw(e):null;C&&oe();function oe(){const $=mw(e);ae&&($.x!==ae.x||$.y!==ae.y||$.width!==ae.width||$.height!==ae.height)&&o(),ae=$,ue=requestAnimationFrame(oe)}return o(),()=>{D.forEach($=>{c&&$.removeEventListener("scroll",o),m&&$.removeEventListener("resize",o)}),O&&O(),le&&le.disconnect(),le=null,C&&cancelAnimationFrame(ue)}}var y_=he.useLayoutEffect,wD=["className","clearValue","cx","getStyles","getClassNames","getValue","hasValue","isMulti","isRtl","options","selectOption","selectProps","setValue","theme"],kf=function(){};function bD(e,t){return t?t[0]==="-"?e+t:e+"__"+t:e}function SD(e,t){for(var o=arguments.length,l=new Array(o>2?o-2:0),c=2;c<o;c++)l[c-2]=arguments[c];var m=[].concat(l);if(t&&e)for(var x in t)t.hasOwnProperty(x)&&t[x]&&m.push("".concat(bD(e,x)));return m.filter(function(u){return u}).map(function(u){return String(u).trim()}).join(" ")}var gw=function(t){return zD(t)?t.filter(Boolean):ul(t)==="object"&&t!==null?[t]:[]},lT=function(t){t.className,t.clearValue,t.cx,t.getStyles,t.getClassNames,t.getValue,t.hasValue,t.isMulti,t.isRtl,t.options,t.selectOption,t.selectProps,t.setValue,t.theme;var o=Ba(t,wD);return St({},o)},er=function(t,o,l){var c=t.cx,m=t.getStyles,x=t.getClassNames,u=t.className;return{css:m(o,t),className:c(l??{},x(o,t),u)}};function dm(e){return[document.documentElement,document.body,window].indexOf(e)>-1}function TD(e){return dm(e)?window.innerHeight:e.clientHeight}function uT(e){return dm(e)?window.pageYOffset:e.scrollTop}function Mf(e,t){if(dm(e)){window.scrollTo(0,t);return}e.scrollTop=t}function CD(e){var t=getComputedStyle(e),o=t.position==="absolute",l=/(auto|scroll)/;if(t.position==="fixed")return document.documentElement;for(var c=e;c=c.parentElement;)if(t=getComputedStyle(c),!(o&&t.position==="static")&&l.test(t.overflow+t.overflowY+t.overflowX))return c;return document.documentElement}function ED(e,t,o,l){return o*((e=e/l-1)*e*e+1)+t}function Mp(e,t){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:200,l=arguments.length>3&&arguments[3]!==void 0?arguments[3]:kf,c=uT(e),m=t-c,x=10,u=0;function C(){u+=x;var I=ED(u,c,m,o);Mf(e,I),u<o?window.requestAnimationFrame(C):l(e)}C()}function yw(e,t){var o=e.getBoundingClientRect(),l=t.getBoundingClientRect(),c=t.offsetHeight/3;l.bottom+c>o.bottom?Mf(e,Math.min(t.offsetTop+t.clientHeight-e.offsetHeight+c,e.scrollHeight)):l.top-c<o.top&&Mf(e,Math.max(t.offsetTop-c,0))}function ID(e){var t=e.getBoundingClientRect();return{bottom:t.bottom,height:t.height,left:t.left,right:t.right,top:t.top,width:t.width}}function _w(){try{return document.createEvent("TouchEvent"),!0}catch{return!1}}function kD(){try{return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}catch{return!1}}var cT=!1,MD={get passive(){return cT=!0}},Pp=typeof window<"u"?window:{};Pp.addEventListener&&Pp.removeEventListener&&(Pp.addEventListener("p",kf,MD),Pp.removeEventListener("p",kf,!1));var PD=cT;function AD(e){return e!=null}function zD(e){return Array.isArray(e)}function Ap(e,t,o){return e?t:o}var DD=function(t){for(var o=arguments.length,l=new Array(o>1?o-1:0),c=1;c<o;c++)l[c-1]=arguments[c];var m=Object.entries(t).filter(function(x){var u=Aa(x,1),C=u[0];return!l.includes(C)});return m.reduce(function(x,u){var C=Aa(u,2),I=C[0],D=C[1];return x[I]=D,x},{})},LD=["children","innerProps"],RD=["children","innerProps"];function FD(e){var t=e.maxHeight,o=e.menuEl,l=e.minHeight,c=e.placement,m=e.shouldScroll,x=e.isFixedPosition,u=e.controlHeight,C=CD(o),I={placement:"bottom",maxHeight:t};if(!o||!o.offsetParent)return I;var D=C.getBoundingClientRect(),O=D.height,U=o.getBoundingClientRect(),le=U.bottom,ue=U.height,ae=U.top,oe=o.offsetParent.getBoundingClientRect(),$=oe.top,G=x?window.innerHeight:TD(C),ee=uT(C),_e=parseInt(getComputedStyle(o).marginBottom,10),Ce=parseInt(getComputedStyle(o).marginTop,10),de=$-Ce,be=G-ae,Me=de+ee,Ze=O-ee-ae,Oe=le-G+ee+_e,ft=ee+ae-Ce,bt=160;switch(c){case"auto":case"bottom":if(be>=ue)return{placement:"bottom",maxHeight:t};if(Ze>=ue&&!x)return m&&Mp(C,Oe,bt),{placement:"bottom",maxHeight:t};if(!x&&Ze>=l||x&&be>=l){m&&Mp(C,Oe,bt);var Rt=x?be-_e:Ze-_e;return{placement:"bottom",maxHeight:Rt}}if(c==="auto"||x){var Ft=t,It=x?de:Me;return It>=l&&(Ft=Math.min(It-_e-u,t)),{placement:"top",maxHeight:Ft}}if(c==="bottom")return m&&Mf(C,Oe),{placement:"bottom",maxHeight:t};break;case"top":if(de>=ue)return{placement:"top",maxHeight:t};if(Me>=ue&&!x)return m&&Mp(C,ft,bt),{placement:"top",maxHeight:t};if(!x&&Me>=l||x&&de>=l){var zt=t;return(!x&&Me>=l||x&&de>=l)&&(zt=x?de-Ce:Me-Ce),m&&Mp(C,ft,bt),{placement:"top",maxHeight:zt}}return{placement:"bottom",maxHeight:t};default:throw new Error('Invalid placement provided "'.concat(c,'".'))}return I}function OD(e){var t={bottom:"top",top:"bottom"};return e?t[e]:"bottom"}var hT=function(t){return t==="auto"?"bottom":t},BD=function(t,o){var l,c=t.placement,m=t.theme,x=m.borderRadius,u=m.spacing,C=m.colors;return St((l={label:"menu"},mh(l,OD(c),"100%"),mh(l,"position","absolute"),mh(l,"width","100%"),mh(l,"zIndex",1),l),o?{}:{backgroundColor:C.neutral0,borderRadius:x,boxShadow:"0 0 0 1px hsla(0, 0%, 0%, 0.1), 0 4px 11px hsla(0, 0%, 0%, 0.1)",marginBottom:u.menuGutter,marginTop:u.menuGutter})},dT=he.createContext(null),VD=function(t){var o=t.children,l=t.minMenuHeight,c=t.maxMenuHeight,m=t.menuPlacement,x=t.menuPosition,u=t.menuShouldScrollIntoView,C=t.theme,I=he.useContext(dT)||{},D=I.setPortalPlacement,O=he.useRef(null),U=he.useState(c),le=Aa(U,2),ue=le[0],ae=le[1],oe=he.useState(null),$=Aa(oe,2),G=$[0],ee=$[1],_e=C.spacing.controlHeight;return y_(function(){var Ce=O.current;if(Ce){var de=x==="fixed",be=u&&!de,Me=FD({maxHeight:c,menuEl:Ce,minHeight:l,placement:m,shouldScroll:be,isFixedPosition:de,controlHeight:_e});ae(Me.maxHeight),ee(Me.placement),D==null||D(Me.placement)}},[c,m,x,u,l,D,_e]),o({ref:O,placerProps:St(St({},t),{},{placement:G||hT(m),maxHeight:ue})})},ND=function(t){var o=t.children,l=t.innerRef,c=t.innerProps;return wt("div",Et({},er(t,"menu",{menu:!0}),{ref:l},c),o)},UD=ND,$D=function(t,o){var l=t.maxHeight,c=t.theme.spacing.baseUnit;return St({maxHeight:l,overflowY:"auto",position:"relative",WebkitOverflowScrolling:"touch"},o?{}:{paddingBottom:c,paddingTop:c})},jD=function(t){var o=t.children,l=t.innerProps,c=t.innerRef,m=t.isMulti;return wt("div",Et({},er(t,"menuList",{"menu-list":!0,"menu-list--is-multi":m}),{ref:c},l),o)},pT=function(t,o){var l=t.theme,c=l.spacing.baseUnit,m=l.colors;return St({textAlign:"center"},o?{}:{color:m.neutral40,padding:"".concat(c*2,"px ").concat(c*3,"px")})},ZD=pT,qD=pT,GD=function(t){var o=t.children,l=o===void 0?"No options":o,c=t.innerProps,m=Ba(t,LD);return wt("div",Et({},er(St(St({},m),{},{children:l,innerProps:c}),"noOptionsMessage",{"menu-notice":!0,"menu-notice--no-options":!0}),c),l)},HD=function(t){var o=t.children,l=o===void 0?"Loading...":o,c=t.innerProps,m=Ba(t,RD);return wt("div",Et({},er(St(St({},m),{},{children:l,innerProps:c}),"loadingMessage",{"menu-notice":!0,"menu-notice--loading":!0}),c),l)},WD=function(t){var o=t.rect,l=t.offset,c=t.position;return{left:o.left,position:c,top:l,width:o.width,zIndex:1}},KD=function(t){var o=t.appendTo,l=t.children,c=t.controlElement,m=t.innerProps,x=t.menuPlacement,u=t.menuPosition,C=he.useRef(null),I=he.useRef(null),D=he.useState(hT(x)),O=Aa(D,2),U=O[0],le=O[1],ue=he.useMemo(function(){return{setPortalPlacement:le}},[]),ae=he.useState(null),oe=Aa(ae,2),$=oe[0],G=oe[1],ee=he.useCallback(function(){if(c){var be=ID(c),Me=u==="fixed"?0:window.pageYOffset,Ze=be[U]+Me;(Ze!==($==null?void 0:$.offset)||be.left!==($==null?void 0:$.rect.left)||be.width!==($==null?void 0:$.rect.width))&&G({offset:Ze,rect:be})}},[c,u,U,$==null?void 0:$.offset,$==null?void 0:$.rect.left,$==null?void 0:$.rect.width]);y_(function(){ee()},[ee]);var _e=he.useCallback(function(){typeof I.current=="function"&&(I.current(),I.current=null),c&&C.current&&(I.current=xD(c,C.current,ee,{elementResize:"ResizeObserver"in window}))},[c,ee]);y_(function(){_e()},[_e]);var Ce=he.useCallback(function(be){C.current=be,_e()},[_e]);if(!o&&u!=="fixed"||!$)return null;var de=wt("div",Et({ref:Ce},er(St(St({},t),{},{offset:$.offset,position:u,rect:$.rect}),"menuPortal",{"menu-portal":!0}),m),l);return wt(dT.Provider,{value:ue},o?Nu.createPortal(de,o):de)},XD=function(t){var o=t.isDisabled,l=t.isRtl;return{label:"container",direction:l?"rtl":void 0,pointerEvents:o?"none":void 0,position:"relative"}},YD=function(t){var o=t.children,l=t.innerProps,c=t.isDisabled,m=t.isRtl;return wt("div",Et({},er(t,"container",{"--is-disabled":c,"--is-rtl":m}),l),o)},JD=function(t,o){var l=t.theme.spacing,c=t.isMulti,m=t.hasValue,x=t.selectProps.controlShouldRenderValue;return St({alignItems:"center",display:c&&m&&x?"flex":"grid",flex:1,flexWrap:"wrap",WebkitOverflowScrolling:"touch",position:"relative",overflow:"hidden"},o?{}:{padding:"".concat(l.baseUnit/2,"px ").concat(l.baseUnit*2,"px")})},QD=function(t){var o=t.children,l=t.innerProps,c=t.isMulti,m=t.hasValue;return wt("div",Et({},er(t,"valueContainer",{"value-container":!0,"value-container--is-multi":c,"value-container--has-value":m}),l),o)},eL=function(){return{alignItems:"center",alignSelf:"stretch",display:"flex",flexShrink:0}},tL=function(t){var o=t.children,l=t.innerProps;return wt("div",Et({},er(t,"indicatorsContainer",{indicators:!0}),l),o)},vw,nL=["size"],rL=["innerProps","isRtl","size"],iL={name:"8mmkcg",styles:"display:inline-block;fill:currentColor;line-height:1;stroke:currentColor;stroke-width:0"},fT=function(t){var o=t.size,l=Ba(t,nL);return wt("svg",Et({height:o,width:o,viewBox:"0 0 20 20","aria-hidden":"true",focusable:"false",css:iL},l))},zv=function(t){return wt(fT,Et({size:20},t),wt("path",{d:"M14.348 14.849c-0.469 0.469-1.229 0.469-1.697 0l-2.651-3.030-2.651 3.029c-0.469 0.469-1.229 0.469-1.697 0-0.469-0.469-0.469-1.229 0-1.697l2.758-3.15-2.759-3.152c-0.469-0.469-0.469-1.228 0-1.697s1.228-0.469 1.697 0l2.652 3.031 2.651-3.031c0.469-0.469 1.228-0.469 1.697 0s0.469 1.229 0 1.697l-2.758 3.152 2.758 3.15c0.469 0.469 0.469 1.229 0 1.698z"}))},mT=function(t){return wt(fT,Et({size:20},t),wt("path",{d:"M4.516 7.548c0.436-0.446 1.043-0.481 1.576 0l3.908 3.747 3.908-3.747c0.533-0.481 1.141-0.446 1.574 0 0.436 0.445 0.408 1.197 0 1.615-0.406 0.418-4.695 4.502-4.695 4.502-0.217 0.223-0.502 0.335-0.787 0.335s-0.57-0.112-0.789-0.335c0 0-4.287-4.084-4.695-4.502s-0.436-1.17 0-1.615z"}))},gT=function(t,o){var l=t.isFocused,c=t.theme,m=c.spacing.baseUnit,x=c.colors;return St({label:"indicatorContainer",display:"flex",transition:"color 150ms"},o?{}:{color:l?x.neutral60:x.neutral20,padding:m*2,":hover":{color:l?x.neutral80:x.neutral40}})},oL=gT,aL=function(t){var o=t.children,l=t.innerProps;return wt("div",Et({},er(t,"dropdownIndicator",{indicator:!0,"dropdown-indicator":!0}),l),o||wt(mT,null))},sL=gT,lL=function(t){var o=t.children,l=t.innerProps;return wt("div",Et({},er(t,"clearIndicator",{indicator:!0,"clear-indicator":!0}),l),o||wt(zv,null))},uL=function(t,o){var l=t.isDisabled,c=t.theme,m=c.spacing.baseUnit,x=c.colors;return St({label:"indicatorSeparator",alignSelf:"stretch",width:1},o?{}:{backgroundColor:l?x.neutral10:x.neutral20,marginBottom:m*2,marginTop:m*2})},cL=function(t){var o=t.innerProps;return wt("span",Et({},o,er(t,"indicatorSeparator",{"indicator-separator":!0})))},hL=sD(vw||(vw=lD([`
  0%, 80%, 100% { opacity: 0; }
  40% { opacity: 1; }
`]))),dL=function(t,o){var l=t.isFocused,c=t.size,m=t.theme,x=m.colors,u=m.spacing.baseUnit;return St({label:"loadingIndicator",display:"flex",transition:"color 150ms",alignSelf:"center",fontSize:c,lineHeight:1,marginRight:c,textAlign:"center",verticalAlign:"middle"},o?{}:{color:l?x.neutral60:x.neutral20,padding:u*2})},ty=function(t){var o=t.delay,l=t.offset;return wt("span",{css:kv({animation:"".concat(hL," 1s ease-in-out ").concat(o,"ms infinite;"),backgroundColor:"currentColor",borderRadius:"1em",display:"inline-block",marginLeft:l?"1em":void 0,height:"1em",verticalAlign:"top",width:"1em"},"","")})},pL=function(t){var o=t.innerProps,l=t.isRtl,c=t.size,m=c===void 0?4:c,x=Ba(t,rL);return wt("div",Et({},er(St(St({},x),{},{innerProps:o,isRtl:l,size:m}),"loadingIndicator",{indicator:!0,"loading-indicator":!0}),o),wt(ty,{delay:0,offset:l}),wt(ty,{delay:160,offset:!0}),wt(ty,{delay:320,offset:!l}))},fL=function(t,o){var l=t.isDisabled,c=t.isFocused,m=t.theme,x=m.colors,u=m.borderRadius,C=m.spacing;return St({label:"control",alignItems:"center",cursor:"default",display:"flex",flexWrap:"wrap",justifyContent:"space-between",minHeight:C.controlHeight,outline:"0 !important",position:"relative",transition:"all 100ms"},o?{}:{backgroundColor:l?x.neutral5:x.neutral0,borderColor:l?x.neutral10:c?x.primary:x.neutral20,borderRadius:u,borderStyle:"solid",borderWidth:1,boxShadow:c?"0 0 0 1px ".concat(x.primary):void 0,"&:hover":{borderColor:c?x.primary:x.neutral30}})},mL=function(t){var o=t.children,l=t.isDisabled,c=t.isFocused,m=t.innerRef,x=t.innerProps,u=t.menuIsOpen;return wt("div",Et({ref:m},er(t,"control",{control:!0,"control--is-disabled":l,"control--is-focused":c,"control--menu-is-open":u}),x,{"aria-disabled":l||void 0}),o)},gL=mL,yL=["data"],_L=function(t,o){var l=t.theme.spacing;return o?{}:{paddingBottom:l.baseUnit*2,paddingTop:l.baseUnit*2}},vL=function(t){var o=t.children,l=t.cx,c=t.getStyles,m=t.getClassNames,x=t.Heading,u=t.headingProps,C=t.innerProps,I=t.label,D=t.theme,O=t.selectProps;return wt("div",Et({},er(t,"group",{group:!0}),C),wt(x,Et({},u,{selectProps:O,theme:D,getStyles:c,getClassNames:m,cx:l}),I),wt("div",null,o))},xL=function(t,o){var l=t.theme,c=l.colors,m=l.spacing;return St({label:"group",cursor:"default",display:"block"},o?{}:{color:c.neutral40,fontSize:"75%",fontWeight:500,marginBottom:"0.25em",paddingLeft:m.baseUnit*3,paddingRight:m.baseUnit*3,textTransform:"uppercase"})},wL=function(t){var o=lT(t);o.data;var l=Ba(o,yL);return wt("div",Et({},er(t,"groupHeading",{"group-heading":!0}),l))},bL=vL,SL=["innerRef","isDisabled","isHidden","inputClassName"],TL=function(t,o){var l=t.isDisabled,c=t.value,m=t.theme,x=m.spacing,u=m.colors;return St(St({visibility:l?"hidden":"visible",transform:c?"translateZ(0)":""},CL),o?{}:{margin:x.baseUnit/2,paddingBottom:x.baseUnit/2,paddingTop:x.baseUnit/2,color:u.neutral80})},yT={gridArea:"1 / 2",font:"inherit",minWidth:"2px",border:0,margin:0,outline:0,padding:0},CL={flex:"1 1 auto",display:"inline-grid",gridArea:"1 / 1 / 2 / 3",gridTemplateColumns:"0 min-content","&:after":St({content:'attr(data-value) " "',visibility:"hidden",whiteSpace:"pre"},yT)},EL=function(t){return St({label:"input",color:"inherit",background:0,opacity:t?0:1,width:"100%"},yT)},IL=function(t){var o=t.cx,l=t.value,c=lT(t),m=c.innerRef,x=c.isDisabled,u=c.isHidden,C=c.inputClassName,I=Ba(c,SL);return wt("div",Et({},er(t,"input",{"input-container":!0}),{"data-value":l||""}),wt("input",Et({className:o({input:!0},C),ref:m,style:EL(u),disabled:x},I)))},kL=IL,ML=function(t,o){var l=t.theme,c=l.spacing,m=l.borderRadius,x=l.colors;return St({label:"multiValue",display:"flex",minWidth:0},o?{}:{backgroundColor:x.neutral10,borderRadius:m/2,margin:c.baseUnit/2})},PL=function(t,o){var l=t.theme,c=l.borderRadius,m=l.colors,x=t.cropWithEllipsis;return St({overflow:"hidden",textOverflow:x||x===void 0?"ellipsis":void 0,whiteSpace:"nowrap"},o?{}:{borderRadius:c/2,color:m.neutral80,fontSize:"85%",padding:3,paddingLeft:6})},AL=function(t,o){var l=t.theme,c=l.spacing,m=l.borderRadius,x=l.colors,u=t.isFocused;return St({alignItems:"center",display:"flex"},o?{}:{borderRadius:m/2,backgroundColor:u?x.dangerLight:void 0,paddingLeft:c.baseUnit,paddingRight:c.baseUnit,":hover":{backgroundColor:x.dangerLight,color:x.danger}})},_T=function(t){var o=t.children,l=t.innerProps;return wt("div",l,o)},zL=_T,DL=_T;function LL(e){var t=e.children,o=e.innerProps;return wt("div",Et({role:"button"},o),t||wt(zv,{size:14}))}var RL=function(t){var o=t.children,l=t.components,c=t.data,m=t.innerProps,x=t.isDisabled,u=t.removeProps,C=t.selectProps,I=l.Container,D=l.Label,O=l.Remove;return wt(I,{data:c,innerProps:St(St({},er(t,"multiValue",{"multi-value":!0,"multi-value--is-disabled":x})),m),selectProps:C},wt(D,{data:c,innerProps:St({},er(t,"multiValueLabel",{"multi-value__label":!0})),selectProps:C},o),wt(O,{data:c,innerProps:St(St({},er(t,"multiValueRemove",{"multi-value__remove":!0})),{},{"aria-label":"Remove ".concat(o||"option")},u),selectProps:C}))},FL=RL,OL=function(t,o){var l=t.isDisabled,c=t.isFocused,m=t.isSelected,x=t.theme,u=x.spacing,C=x.colors;return St({label:"option",cursor:"default",display:"block",fontSize:"inherit",width:"100%",userSelect:"none",WebkitTapHighlightColor:"rgba(0, 0, 0, 0)"},o?{}:{backgroundColor:m?C.primary:c?C.primary25:"transparent",color:l?C.neutral20:m?C.neutral0:"inherit",padding:"".concat(u.baseUnit*2,"px ").concat(u.baseUnit*3,"px"),":active":{backgroundColor:l?void 0:m?C.primary:C.primary50}})},BL=function(t){var o=t.children,l=t.isDisabled,c=t.isFocused,m=t.isSelected,x=t.innerRef,u=t.innerProps;return wt("div",Et({},er(t,"option",{option:!0,"option--is-disabled":l,"option--is-focused":c,"option--is-selected":m}),{ref:x,"aria-disabled":l},u),o)},VL=BL,NL=function(t,o){var l=t.theme,c=l.spacing,m=l.colors;return St({label:"placeholder",gridArea:"1 / 1 / 2 / 3"},o?{}:{color:m.neutral50,marginLeft:c.baseUnit/2,marginRight:c.baseUnit/2})},UL=function(t){var o=t.children,l=t.innerProps;return wt("div",Et({},er(t,"placeholder",{placeholder:!0}),l),o)},$L=UL,jL=function(t,o){var l=t.isDisabled,c=t.theme,m=c.spacing,x=c.colors;return St({label:"singleValue",gridArea:"1 / 1 / 2 / 3",maxWidth:"100%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},o?{}:{color:l?x.neutral40:x.neutral80,marginLeft:m.baseUnit/2,marginRight:m.baseUnit/2})},ZL=function(t){var o=t.children,l=t.isDisabled,c=t.innerProps;return wt("div",Et({},er(t,"singleValue",{"single-value":!0,"single-value--is-disabled":l}),c),o)},qL=ZL,GL={ClearIndicator:lL,Control:gL,DropdownIndicator:aL,DownChevron:mT,CrossIcon:zv,Group:bL,GroupHeading:wL,IndicatorsContainer:tL,IndicatorSeparator:cL,Input:kL,LoadingIndicator:pL,Menu:UD,MenuList:jD,MenuPortal:KD,LoadingMessage:HD,NoOptionsMessage:GD,MultiValue:FL,MultiValueContainer:zL,MultiValueLabel:DL,MultiValueRemove:LL,Option:VL,Placeholder:$L,SelectContainer:YD,SingleValue:qL,ValueContainer:QD},HL=function(t){return St(St({},GL),t.components)},xw=Number.isNaN||function(t){return typeof t=="number"&&t!==t};function WL(e,t){return!!(e===t||xw(e)&&xw(t))}function KL(e,t){if(e.length!==t.length)return!1;for(var o=0;o<e.length;o++)if(!WL(e[o],t[o]))return!1;return!0}function XL(e,t){t===void 0&&(t=KL);var o=null;function l(){for(var c=[],m=0;m<arguments.length;m++)c[m]=arguments[m];if(o&&o.lastThis===this&&t(c,o.lastArgs))return o.lastResult;var x=e.apply(this,c);return o={lastResult:x,lastArgs:c,lastThis:this},x}return l.clear=function(){o=null},l}var YL={name:"7pg0cj-a11yText",styles:"label:a11yText;z-index:9999;border:0;clip:rect(1px, 1px, 1px, 1px);height:1px;width:1px;position:absolute;overflow:hidden;padding:0;white-space:nowrap"},JL=function(t){return wt("span",Et({css:YL},t))},ww=JL,QL={guidance:function(t){var o=t.isSearchable,l=t.isMulti,c=t.tabSelectsValue,m=t.context,x=t.isInitialFocus;switch(m){case"menu":return"Use Up and Down to choose options, press Enter to select the currently focused option, press Escape to exit the menu".concat(c?", press Tab to select the option and exit the menu":"",".");case"input":return x?"".concat(t["aria-label"]||"Select"," is focused ").concat(o?",type to refine list":"",", press Down to open the menu, ").concat(l?" press left to focus selected values":""):"";case"value":return"Use left and right to toggle between focused values, press Backspace to remove the currently focused value";default:return""}},onChange:function(t){var o=t.action,l=t.label,c=l===void 0?"":l,m=t.labels,x=t.isDisabled;switch(o){case"deselect-option":case"pop-value":case"remove-value":return"option ".concat(c,", deselected.");case"clear":return"All selected options have been cleared.";case"initial-input-focus":return"option".concat(m.length>1?"s":""," ").concat(m.join(","),", selected.");case"select-option":return x?"option ".concat(c," is disabled. Select another option."):"option ".concat(c,", selected.");default:return""}},onFocus:function(t){var o=t.context,l=t.focused,c=t.options,m=t.label,x=m===void 0?"":m,u=t.selectValue,C=t.isDisabled,I=t.isSelected,D=t.isAppleDevice,O=function(ae,oe){return ae&&ae.length?"".concat(ae.indexOf(oe)+1," of ").concat(ae.length):""};if(o==="value"&&u)return"value ".concat(x," focused, ").concat(O(u,l),".");if(o==="menu"&&D){var U=C?" disabled":"",le="".concat(I?" selected":"").concat(U);return"".concat(x).concat(le,", ").concat(O(c,l),".")}return""},onFilter:function(t){var o=t.inputValue,l=t.resultsMessage;return"".concat(l).concat(o?" for search term "+o:"",".")}},eR=function(t){var o=t.ariaSelection,l=t.focusedOption,c=t.focusedValue,m=t.focusableOptions,x=t.isFocused,u=t.selectValue,C=t.selectProps,I=t.id,D=t.isAppleDevice,O=C.ariaLiveMessages,U=C.getOptionLabel,le=C.inputValue,ue=C.isMulti,ae=C.isOptionDisabled,oe=C.isSearchable,$=C.menuIsOpen,G=C.options,ee=C.screenReaderStatus,_e=C.tabSelectsValue,Ce=C.isLoading,de=C["aria-label"],be=C["aria-live"],Me=he.useMemo(function(){return St(St({},QL),O||{})},[O]),Ze=he.useMemo(function(){var It="";if(o&&Me.onChange){var zt=o.option,xt=o.options,Be=o.removedValue,lt=o.removedValues,dt=o.value,kt=function(Mn){return Array.isArray(Mn)?null:Mn},ht=Be||zt||kt(dt),_t=ht?U(ht):"",Tt=xt||lt||void 0,tn=Tt?Tt.map(U):[],Zt=St({isDisabled:ht&&ae(ht,u),label:_t,labels:tn},o);It=Me.onChange(Zt)}return It},[o,Me,ae,u,U]),Oe=he.useMemo(function(){var It="",zt=l||c,xt=!!(l&&u&&u.includes(l));if(zt&&Me.onFocus){var Be={focused:zt,label:U(zt),isDisabled:ae(zt,u),isSelected:xt,options:m,context:zt===l?"menu":"value",selectValue:u,isAppleDevice:D};It=Me.onFocus(Be)}return It},[l,c,U,ae,Me,m,u,D]),ft=he.useMemo(function(){var It="";if($&&G.length&&!Ce&&Me.onFilter){var zt=ee({count:m.length});It=Me.onFilter({inputValue:le,resultsMessage:zt})}return It},[m,le,$,Me,G,ee,Ce]),bt=(o==null?void 0:o.action)==="initial-input-focus",Rt=he.useMemo(function(){var It="";if(Me.guidance){var zt=c?"value":$?"menu":"input";It=Me.guidance({"aria-label":de,context:zt,isDisabled:l&&ae(l,u),isMulti:ue,isSearchable:oe,tabSelectsValue:_e,isInitialFocus:bt})}return It},[de,l,c,ue,ae,oe,$,Me,u,_e,bt]),Ft=wt(he.Fragment,null,wt("span",{id:"aria-selection"},Ze),wt("span",{id:"aria-focused"},Oe),wt("span",{id:"aria-results"},ft),wt("span",{id:"aria-guidance"},Rt));return wt(he.Fragment,null,wt(ww,{id:I},bt&&Ft),wt(ww,{"aria-live":be,"aria-atomic":"false","aria-relevant":"additions text",role:"log"},x&&!bt&&Ft))},tR=eR,__=[{base:"A",letters:"AⒶＡÀÁÂẦẤẪẨÃĀĂẰẮẴẲȦǠÄǞẢÅǺǍȀȂẠẬẶḀĄȺⱯ"},{base:"AA",letters:"Ꜳ"},{base:"AE",letters:"ÆǼǢ"},{base:"AO",letters:"Ꜵ"},{base:"AU",letters:"Ꜷ"},{base:"AV",letters:"ꜸꜺ"},{base:"AY",letters:"Ꜽ"},{base:"B",letters:"BⒷＢḂḄḆɃƂƁ"},{base:"C",letters:"CⒸＣĆĈĊČÇḈƇȻꜾ"},{base:"D",letters:"DⒹＤḊĎḌḐḒḎĐƋƊƉꝹ"},{base:"DZ",letters:"ǱǄ"},{base:"Dz",letters:"ǲǅ"},{base:"E",letters:"EⒺＥÈÉÊỀẾỄỂẼĒḔḖĔĖËẺĚȄȆẸỆȨḜĘḘḚƐƎ"},{base:"F",letters:"FⒻＦḞƑꝻ"},{base:"G",letters:"GⒼＧǴĜḠĞĠǦĢǤƓꞠꝽꝾ"},{base:"H",letters:"HⒽＨĤḢḦȞḤḨḪĦⱧⱵꞍ"},{base:"I",letters:"IⒾＩÌÍÎĨĪĬİÏḮỈǏȈȊỊĮḬƗ"},{base:"J",letters:"JⒿＪĴɈ"},{base:"K",letters:"KⓀＫḰǨḲĶḴƘⱩꝀꝂꝄꞢ"},{base:"L",letters:"LⓁＬĿĹĽḶḸĻḼḺŁȽⱢⱠꝈꝆꞀ"},{base:"LJ",letters:"Ǉ"},{base:"Lj",letters:"ǈ"},{base:"M",letters:"MⓂＭḾṀṂⱮƜ"},{base:"N",letters:"NⓃＮǸŃÑṄŇṆŅṊṈȠƝꞐꞤ"},{base:"NJ",letters:"Ǌ"},{base:"Nj",letters:"ǋ"},{base:"O",letters:"OⓄＯÒÓÔỒỐỖỔÕṌȬṎŌṐṒŎȮȰÖȪỎŐǑȌȎƠỜỚỠỞỢỌỘǪǬØǾƆƟꝊꝌ"},{base:"OI",letters:"Ƣ"},{base:"OO",letters:"Ꝏ"},{base:"OU",letters:"Ȣ"},{base:"P",letters:"PⓅＰṔṖƤⱣꝐꝒꝔ"},{base:"Q",letters:"QⓆＱꝖꝘɊ"},{base:"R",letters:"RⓇＲŔṘŘȐȒṚṜŖṞɌⱤꝚꞦꞂ"},{base:"S",letters:"SⓈＳẞŚṤŜṠŠṦṢṨȘŞⱾꞨꞄ"},{base:"T",letters:"TⓉＴṪŤṬȚŢṰṮŦƬƮȾꞆ"},{base:"TZ",letters:"Ꜩ"},{base:"U",letters:"UⓊＵÙÚÛŨṸŪṺŬÜǛǗǕǙỦŮŰǓȔȖƯỪỨỮỬỰỤṲŲṶṴɄ"},{base:"V",letters:"VⓋＶṼṾƲꝞɅ"},{base:"VY",letters:"Ꝡ"},{base:"W",letters:"WⓌＷẀẂŴẆẄẈⱲ"},{base:"X",letters:"XⓍＸẊẌ"},{base:"Y",letters:"YⓎＹỲÝŶỸȲẎŸỶỴƳɎỾ"},{base:"Z",letters:"ZⓏＺŹẐŻŽẒẔƵȤⱿⱫꝢ"},{base:"a",letters:"aⓐａẚàáâầấẫẩãāăằắẵẳȧǡäǟảåǻǎȁȃạậặḁąⱥɐ"},{base:"aa",letters:"ꜳ"},{base:"ae",letters:"æǽǣ"},{base:"ao",letters:"ꜵ"},{base:"au",letters:"ꜷ"},{base:"av",letters:"ꜹꜻ"},{base:"ay",letters:"ꜽ"},{base:"b",letters:"bⓑｂḃḅḇƀƃɓ"},{base:"c",letters:"cⓒｃćĉċčçḉƈȼꜿↄ"},{base:"d",letters:"dⓓｄḋďḍḑḓḏđƌɖɗꝺ"},{base:"dz",letters:"ǳǆ"},{base:"e",letters:"eⓔｅèéêềếễểẽēḕḗĕėëẻěȅȇẹệȩḝęḙḛɇɛǝ"},{base:"f",letters:"fⓕｆḟƒꝼ"},{base:"g",letters:"gⓖｇǵĝḡğġǧģǥɠꞡᵹꝿ"},{base:"h",letters:"hⓗｈĥḣḧȟḥḩḫẖħⱨⱶɥ"},{base:"hv",letters:"ƕ"},{base:"i",letters:"iⓘｉìíîĩīĭïḯỉǐȉȋịįḭɨı"},{base:"j",letters:"jⓙｊĵǰɉ"},{base:"k",letters:"kⓚｋḱǩḳķḵƙⱪꝁꝃꝅꞣ"},{base:"l",letters:"lⓛｌŀĺľḷḹļḽḻſłƚɫⱡꝉꞁꝇ"},{base:"lj",letters:"ǉ"},{base:"m",letters:"mⓜｍḿṁṃɱɯ"},{base:"n",letters:"nⓝｎǹńñṅňṇņṋṉƞɲŉꞑꞥ"},{base:"nj",letters:"ǌ"},{base:"o",letters:"oⓞｏòóôồốỗổõṍȭṏōṑṓŏȯȱöȫỏőǒȍȏơờớỡởợọộǫǭøǿɔꝋꝍɵ"},{base:"oi",letters:"ƣ"},{base:"ou",letters:"ȣ"},{base:"oo",letters:"ꝏ"},{base:"p",letters:"pⓟｐṕṗƥᵽꝑꝓꝕ"},{base:"q",letters:"qⓠｑɋꝗꝙ"},{base:"r",letters:"rⓡｒŕṙřȑȓṛṝŗṟɍɽꝛꞧꞃ"},{base:"s",letters:"sⓢｓßśṥŝṡšṧṣṩșşȿꞩꞅẛ"},{base:"t",letters:"tⓣｔṫẗťṭțţṱṯŧƭʈⱦꞇ"},{base:"tz",letters:"ꜩ"},{base:"u",letters:"uⓤｕùúûũṹūṻŭüǜǘǖǚủůűǔȕȗưừứữửựụṳųṷṵʉ"},{base:"v",letters:"vⓥｖṽṿʋꝟʌ"},{base:"vy",letters:"ꝡ"},{base:"w",letters:"wⓦｗẁẃŵẇẅẘẉⱳ"},{base:"x",letters:"xⓧｘẋẍ"},{base:"y",letters:"yⓨｙỳýŷỹȳẏÿỷẙỵƴɏỿ"},{base:"z",letters:"zⓩｚźẑżžẓẕƶȥɀⱬꝣ"}],nR=new RegExp("["+__.map(function(e){return e.letters}).join("")+"]","g"),vT={};for(var ny=0;ny<__.length;ny++)for(var ry=__[ny],iy=0;iy<ry.letters.length;iy++)vT[ry.letters[iy]]=ry.base;var xT=function(t){return t.replace(nR,function(o){return vT[o]})},rR=XL(xT),bw=function(t){return t.replace(/^\s+|\s+$/g,"")},iR=function(t){return"".concat(t.label," ").concat(t.value)},oR=function(t){return function(o,l){if(o.data.__isNew__)return!0;var c=St({ignoreCase:!0,ignoreAccents:!0,stringify:iR,trim:!0,matchFrom:"any"},t),m=c.ignoreCase,x=c.ignoreAccents,u=c.stringify,C=c.trim,I=c.matchFrom,D=C?bw(l):l,O=C?bw(u(o)):u(o);return m&&(D=D.toLowerCase(),O=O.toLowerCase()),x&&(D=rR(D),O=xT(O)),I==="start"?O.substr(0,D.length)===D:O.indexOf(D)>-1}},aR=["innerRef"];function sR(e){var t=e.innerRef,o=Ba(e,aR),l=DD(o,"onExited","in","enter","exit","appear");return wt("input",Et({ref:t},l,{css:kv({label:"dummyInput",background:0,border:0,caretColor:"transparent",fontSize:"inherit",gridArea:"1 / 1 / 2 / 3",outline:0,padding:0,width:1,color:"transparent",left:-100,opacity:0,position:"relative",transform:"scale(.01)"},"","")}))}var lR=function(t){t.cancelable&&t.preventDefault(),t.stopPropagation()};function uR(e){var t=e.isEnabled,o=e.onBottomArrive,l=e.onBottomLeave,c=e.onTopArrive,m=e.onTopLeave,x=he.useRef(!1),u=he.useRef(!1),C=he.useRef(0),I=he.useRef(null),D=he.useCallback(function(oe,$){if(I.current!==null){var G=I.current,ee=G.scrollTop,_e=G.scrollHeight,Ce=G.clientHeight,de=I.current,be=$>0,Me=_e-Ce-ee,Ze=!1;Me>$&&x.current&&(l&&l(oe),x.current=!1),be&&u.current&&(m&&m(oe),u.current=!1),be&&$>Me?(o&&!x.current&&o(oe),de.scrollTop=_e,Ze=!0,x.current=!0):!be&&-$>ee&&(c&&!u.current&&c(oe),de.scrollTop=0,Ze=!0,u.current=!0),Ze&&lR(oe)}},[o,l,c,m]),O=he.useCallback(function(oe){D(oe,oe.deltaY)},[D]),U=he.useCallback(function(oe){C.current=oe.changedTouches[0].clientY},[]),le=he.useCallback(function(oe){var $=C.current-oe.changedTouches[0].clientY;D(oe,$)},[D]),ue=he.useCallback(function(oe){if(oe){var $=PD?{passive:!1}:!1;oe.addEventListener("wheel",O,$),oe.addEventListener("touchstart",U,$),oe.addEventListener("touchmove",le,$)}},[le,U,O]),ae=he.useCallback(function(oe){oe&&(oe.removeEventListener("wheel",O,!1),oe.removeEventListener("touchstart",U,!1),oe.removeEventListener("touchmove",le,!1))},[le,U,O]);return he.useEffect(function(){if(t){var oe=I.current;return ue(oe),function(){ae(oe)}}},[t,ue,ae]),function(oe){I.current=oe}}var Sw=["boxSizing","height","overflow","paddingRight","position"],Tw={boxSizing:"border-box",overflow:"hidden",position:"relative",height:"100%"};function Cw(e){e.preventDefault()}function Ew(e){e.stopPropagation()}function Iw(){var e=this.scrollTop,t=this.scrollHeight,o=e+this.offsetHeight;e===0?this.scrollTop=1:o===t&&(this.scrollTop=e-1)}function kw(){return"ontouchstart"in window||navigator.maxTouchPoints}var Mw=!!(typeof window<"u"&&window.document&&window.document.createElement),ch=0,tu={capture:!1,passive:!1};function cR(e){var t=e.isEnabled,o=e.accountForScrollbars,l=o===void 0?!0:o,c=he.useRef({}),m=he.useRef(null),x=he.useCallback(function(C){if(Mw){var I=document.body,D=I&&I.style;if(l&&Sw.forEach(function(ue){var ae=D&&D[ue];c.current[ue]=ae}),l&&ch<1){var O=parseInt(c.current.paddingRight,10)||0,U=document.body?document.body.clientWidth:0,le=window.innerWidth-U+O||0;Object.keys(Tw).forEach(function(ue){var ae=Tw[ue];D&&(D[ue]=ae)}),D&&(D.paddingRight="".concat(le,"px"))}I&&kw()&&(I.addEventListener("touchmove",Cw,tu),C&&(C.addEventListener("touchstart",Iw,tu),C.addEventListener("touchmove",Ew,tu))),ch+=1}},[l]),u=he.useCallback(function(C){if(Mw){var I=document.body,D=I&&I.style;ch=Math.max(ch-1,0),l&&ch<1&&Sw.forEach(function(O){var U=c.current[O];D&&(D[O]=U)}),I&&kw()&&(I.removeEventListener("touchmove",Cw,tu),C&&(C.removeEventListener("touchstart",Iw,tu),C.removeEventListener("touchmove",Ew,tu)))}},[l]);return he.useEffect(function(){if(t){var C=m.current;return x(C),function(){u(C)}}},[t,x,u]),function(C){m.current=C}}var hR=function(t){var o=t.target;return o.ownerDocument.activeElement&&o.ownerDocument.activeElement.blur()},dR={name:"1kfdb0e",styles:"position:fixed;left:0;bottom:0;right:0;top:0"};function pR(e){var t=e.children,o=e.lockEnabled,l=e.captureEnabled,c=l===void 0?!0:l,m=e.onBottomArrive,x=e.onBottomLeave,u=e.onTopArrive,C=e.onTopLeave,I=uR({isEnabled:c,onBottomArrive:m,onBottomLeave:x,onTopArrive:u,onTopLeave:C}),D=cR({isEnabled:o}),O=function(le){I(le),D(le)};return wt(he.Fragment,null,o&&wt("div",{onClick:hR,css:dR}),t(O))}var fR={name:"1a0ro4n-requiredInput",styles:"label:requiredInput;opacity:0;pointer-events:none;position:absolute;bottom:0;left:0;right:0;width:100%"},mR=function(t){var o=t.name,l=t.onFocus;return wt("input",{required:!0,name:o,tabIndex:-1,"aria-hidden":"true",onFocus:l,css:fR,value:"",onChange:function(){}})},gR=mR;function Dv(e){var t;return typeof window<"u"&&window.navigator!=null?e.test(((t=window.navigator.userAgentData)===null||t===void 0?void 0:t.platform)||window.navigator.platform):!1}function yR(){return Dv(/^iPhone/i)}function wT(){return Dv(/^Mac/i)}function _R(){return Dv(/^iPad/i)||wT()&&navigator.maxTouchPoints>1}function vR(){return yR()||_R()}function xR(){return wT()||vR()}var wR=function(t){return t.label},bR=function(t){return t.label},SR=function(t){return t.value},TR=function(t){return!!t.isDisabled},CR={clearIndicator:sL,container:XD,control:fL,dropdownIndicator:oL,group:_L,groupHeading:xL,indicatorsContainer:eL,indicatorSeparator:uL,input:TL,loadingIndicator:dL,loadingMessage:qD,menu:BD,menuList:$D,menuPortal:WD,multiValue:ML,multiValueLabel:PL,multiValueRemove:AL,noOptionsMessage:ZD,option:OL,placeholder:NL,singleValue:jL,valueContainer:JD},ER={primary:"#2684FF",primary75:"#4C9AFF",primary50:"#B2D4FF",primary25:"#DEEBFF",danger:"#DE350B",dangerLight:"#FFBDAD",neutral0:"hsl(0, 0%, 100%)",neutral5:"hsl(0, 0%, 95%)",neutral10:"hsl(0, 0%, 90%)",neutral20:"hsl(0, 0%, 80%)",neutral30:"hsl(0, 0%, 70%)",neutral40:"hsl(0, 0%, 60%)",neutral50:"hsl(0, 0%, 50%)",neutral60:"hsl(0, 0%, 40%)",neutral70:"hsl(0, 0%, 30%)",neutral80:"hsl(0, 0%, 20%)",neutral90:"hsl(0, 0%, 10%)"},IR=4,bT=4,kR=38,MR=bT*2,PR={baseUnit:bT,controlHeight:kR,menuGutter:MR},oy={borderRadius:IR,colors:ER,spacing:PR},AR={"aria-live":"polite",backspaceRemovesValue:!0,blurInputOnSelect:_w(),captureMenuScroll:!_w(),classNames:{},closeMenuOnSelect:!0,closeMenuOnScroll:!1,components:{},controlShouldRenderValue:!0,escapeClearsValue:!1,filterOption:oR(),formatGroupLabel:wR,getOptionLabel:bR,getOptionValue:SR,isDisabled:!1,isLoading:!1,isMulti:!1,isRtl:!1,isSearchable:!0,isOptionDisabled:TR,loadingMessage:function(){return"Loading..."},maxMenuHeight:300,minMenuHeight:140,menuIsOpen:!1,menuPlacement:"bottom",menuPosition:"absolute",menuShouldBlockScroll:!1,menuShouldScrollIntoView:!kD(),noOptionsMessage:function(){return"No options"},openMenuOnFocus:!1,openMenuOnClick:!0,options:[],pageSize:5,placeholder:"Select...",screenReaderStatus:function(t){var o=t.count;return"".concat(o," result").concat(o!==1?"s":""," available")},styles:{},tabIndex:0,tabSelectsValue:!0,unstyled:!1};function Pw(e,t,o,l){var c=CT(e,t,o),m=ET(e,t,o),x=TT(e,t),u=Pf(e,t);return{type:"option",data:t,isDisabled:c,isSelected:m,label:x,value:u,index:l}}function Hp(e,t){return e.options.map(function(o,l){if("options"in o){var c=o.options.map(function(x,u){return Pw(e,x,t,u)}).filter(function(x){return zw(e,x)});return c.length>0?{type:"group",data:o,options:c,index:l}:void 0}var m=Pw(e,o,t,l);return zw(e,m)?m:void 0}).filter(AD)}function ST(e){return e.reduce(function(t,o){return o.type==="group"?t.push.apply(t,xv(o.options.map(function(l){return l.data}))):t.push(o.data),t},[])}function Aw(e,t){return e.reduce(function(o,l){return l.type==="group"?o.push.apply(o,xv(l.options.map(function(c){return{data:c.data,id:"".concat(t,"-").concat(l.index,"-").concat(c.index)}}))):o.push({data:l.data,id:"".concat(t,"-").concat(l.index)}),o},[])}function zR(e,t){return ST(Hp(e,t))}function zw(e,t){var o=e.inputValue,l=o===void 0?"":o,c=t.data,m=t.isSelected,x=t.label,u=t.value;return(!kT(e)||!m)&&IT(e,{label:x,value:u,data:c},l)}function DR(e,t){var o=e.focusedValue,l=e.selectValue,c=l.indexOf(o);if(c>-1){var m=t.indexOf(o);if(m>-1)return o;if(c<t.length)return t[c]}return null}function LR(e,t){var o=e.focusedOption;return o&&t.indexOf(o)>-1?o:t[0]}var ay=function(t,o){var l,c=(l=t.find(function(m){return m.data===o}))===null||l===void 0?void 0:l.id;return c||null},TT=function(t,o){return t.getOptionLabel(o)},Pf=function(t,o){return t.getOptionValue(o)};function CT(e,t,o){return typeof e.isOptionDisabled=="function"?e.isOptionDisabled(t,o):!1}function ET(e,t,o){if(o.indexOf(t)>-1)return!0;if(typeof e.isOptionSelected=="function")return e.isOptionSelected(t,o);var l=Pf(e,t);return o.some(function(c){return Pf(e,c)===l})}function IT(e,t,o){return e.filterOption?e.filterOption(t,o):!0}var kT=function(t){var o=t.hideSelectedOptions,l=t.isMulti;return o===void 0?l:o},RR=1,MT=function(e){QA(o,e);var t=nz(o);function o(l){var c;if(YA(this,o),c=t.call(this,l),c.state={ariaSelection:null,focusedOption:null,focusedOptionId:null,focusableOptionsWithIds:[],focusedValue:null,inputIsHidden:!1,isFocused:!1,selectValue:[],clearFocusValueOnUpdate:!1,prevWasFocused:!1,inputIsHiddenAfterUpdate:void 0,prevProps:void 0,instancePrefix:""},c.blockOptionHover=!1,c.isComposing=!1,c.commonProps=void 0,c.initialTouchX=0,c.initialTouchY=0,c.openAfterFocus=!1,c.scrollToFocusedOptionOnUpdate=!1,c.userIsDragging=void 0,c.isAppleDevice=xR(),c.controlRef=null,c.getControlRef=function(C){c.controlRef=C},c.focusedOptionRef=null,c.getFocusedOptionRef=function(C){c.focusedOptionRef=C},c.menuListRef=null,c.getMenuListRef=function(C){c.menuListRef=C},c.inputRef=null,c.getInputRef=function(C){c.inputRef=C},c.focus=c.focusInput,c.blur=c.blurInput,c.onChange=function(C,I){var D=c.props,O=D.onChange,U=D.name;I.name=U,c.ariaOnChange(C,I),O(C,I)},c.setValue=function(C,I,D){var O=c.props,U=O.closeMenuOnSelect,le=O.isMulti,ue=O.inputValue;c.onInputChange("",{action:"set-value",prevInputValue:ue}),U&&(c.setState({inputIsHiddenAfterUpdate:!le}),c.onMenuClose()),c.setState({clearFocusValueOnUpdate:!0}),c.onChange(C,{action:I,option:D})},c.selectOption=function(C){var I=c.props,D=I.blurInputOnSelect,O=I.isMulti,U=I.name,le=c.state.selectValue,ue=O&&c.isOptionSelected(C,le),ae=c.isOptionDisabled(C,le);if(ue){var oe=c.getOptionValue(C);c.setValue(le.filter(function($){return c.getOptionValue($)!==oe}),"deselect-option",C)}else if(!ae)O?c.setValue([].concat(xv(le),[C]),"select-option",C):c.setValue(C,"select-option");else{c.ariaOnChange(C,{action:"select-option",option:C,name:U});return}D&&c.blurInput()},c.removeValue=function(C){var I=c.props.isMulti,D=c.state.selectValue,O=c.getOptionValue(C),U=D.filter(function(ue){return c.getOptionValue(ue)!==O}),le=Ap(I,U,U[0]||null);c.onChange(le,{action:"remove-value",removedValue:C}),c.focusInput()},c.clearValue=function(){var C=c.state.selectValue;c.onChange(Ap(c.props.isMulti,[],null),{action:"clear",removedValues:C})},c.popValue=function(){var C=c.props.isMulti,I=c.state.selectValue,D=I[I.length-1],O=I.slice(0,I.length-1),U=Ap(C,O,O[0]||null);c.onChange(U,{action:"pop-value",removedValue:D})},c.getFocusedOptionId=function(C){return ay(c.state.focusableOptionsWithIds,C)},c.getFocusableOptionsWithIds=function(){return Aw(Hp(c.props,c.state.selectValue),c.getElementId("option"))},c.getValue=function(){return c.state.selectValue},c.cx=function(){for(var C=arguments.length,I=new Array(C),D=0;D<C;D++)I[D]=arguments[D];return SD.apply(void 0,[c.props.classNamePrefix].concat(I))},c.getOptionLabel=function(C){return TT(c.props,C)},c.getOptionValue=function(C){return Pf(c.props,C)},c.getStyles=function(C,I){var D=c.props.unstyled,O=CR[C](I,D);O.boxSizing="border-box";var U=c.props.styles[C];return U?U(O,I):O},c.getClassNames=function(C,I){var D,O;return(D=(O=c.props.classNames)[C])===null||D===void 0?void 0:D.call(O,I)},c.getElementId=function(C){return"".concat(c.state.instancePrefix,"-").concat(C)},c.getComponents=function(){return HL(c.props)},c.buildCategorizedOptions=function(){return Hp(c.props,c.state.selectValue)},c.getCategorizedOptions=function(){return c.props.menuIsOpen?c.buildCategorizedOptions():[]},c.buildFocusableOptions=function(){return ST(c.buildCategorizedOptions())},c.getFocusableOptions=function(){return c.props.menuIsOpen?c.buildFocusableOptions():[]},c.ariaOnChange=function(C,I){c.setState({ariaSelection:St({value:C},I)})},c.onMenuMouseDown=function(C){C.button===0&&(C.stopPropagation(),C.preventDefault(),c.focusInput())},c.onMenuMouseMove=function(C){c.blockOptionHover=!1},c.onControlMouseDown=function(C){if(!C.defaultPrevented){var I=c.props.openMenuOnClick;c.state.isFocused?c.props.menuIsOpen?C.target.tagName!=="INPUT"&&C.target.tagName!=="TEXTAREA"&&c.onMenuClose():I&&c.openMenu("first"):(I&&(c.openAfterFocus=!0),c.focusInput()),C.target.tagName!=="INPUT"&&C.target.tagName!=="TEXTAREA"&&C.preventDefault()}},c.onDropdownIndicatorMouseDown=function(C){if(!(C&&C.type==="mousedown"&&C.button!==0)&&!c.props.isDisabled){var I=c.props,D=I.isMulti,O=I.menuIsOpen;c.focusInput(),O?(c.setState({inputIsHiddenAfterUpdate:!D}),c.onMenuClose()):c.openMenu("first"),C.preventDefault()}},c.onClearIndicatorMouseDown=function(C){C&&C.type==="mousedown"&&C.button!==0||(c.clearValue(),C.preventDefault(),c.openAfterFocus=!1,C.type==="touchend"?c.focusInput():setTimeout(function(){return c.focusInput()}))},c.onScroll=function(C){typeof c.props.closeMenuOnScroll=="boolean"?C.target instanceof HTMLElement&&dm(C.target)&&c.props.onMenuClose():typeof c.props.closeMenuOnScroll=="function"&&c.props.closeMenuOnScroll(C)&&c.props.onMenuClose()},c.onCompositionStart=function(){c.isComposing=!0},c.onCompositionEnd=function(){c.isComposing=!1},c.onTouchStart=function(C){var I=C.touches,D=I&&I.item(0);D&&(c.initialTouchX=D.clientX,c.initialTouchY=D.clientY,c.userIsDragging=!1)},c.onTouchMove=function(C){var I=C.touches,D=I&&I.item(0);if(D){var O=Math.abs(D.clientX-c.initialTouchX),U=Math.abs(D.clientY-c.initialTouchY),le=5;c.userIsDragging=O>le||U>le}},c.onTouchEnd=function(C){c.userIsDragging||(c.controlRef&&!c.controlRef.contains(C.target)&&c.menuListRef&&!c.menuListRef.contains(C.target)&&c.blurInput(),c.initialTouchX=0,c.initialTouchY=0)},c.onControlTouchEnd=function(C){c.userIsDragging||c.onControlMouseDown(C)},c.onClearIndicatorTouchEnd=function(C){c.userIsDragging||c.onClearIndicatorMouseDown(C)},c.onDropdownIndicatorTouchEnd=function(C){c.userIsDragging||c.onDropdownIndicatorMouseDown(C)},c.handleInputChange=function(C){var I=c.props.inputValue,D=C.currentTarget.value;c.setState({inputIsHiddenAfterUpdate:!1}),c.onInputChange(D,{action:"input-change",prevInputValue:I}),c.props.menuIsOpen||c.onMenuOpen()},c.onInputFocus=function(C){c.props.onFocus&&c.props.onFocus(C),c.setState({inputIsHiddenAfterUpdate:!1,isFocused:!0}),(c.openAfterFocus||c.props.openMenuOnFocus)&&c.openMenu("first"),c.openAfterFocus=!1},c.onInputBlur=function(C){var I=c.props.inputValue;if(c.menuListRef&&c.menuListRef.contains(document.activeElement)){c.inputRef.focus();return}c.props.onBlur&&c.props.onBlur(C),c.onInputChange("",{action:"input-blur",prevInputValue:I}),c.onMenuClose(),c.setState({focusedValue:null,isFocused:!1})},c.onOptionHover=function(C){if(!(c.blockOptionHover||c.state.focusedOption===C)){var I=c.getFocusableOptions(),D=I.indexOf(C);c.setState({focusedOption:C,focusedOptionId:D>-1?c.getFocusedOptionId(C):null})}},c.shouldHideSelectedOptions=function(){return kT(c.props)},c.onValueInputFocus=function(C){C.preventDefault(),C.stopPropagation(),c.focus()},c.onKeyDown=function(C){var I=c.props,D=I.isMulti,O=I.backspaceRemovesValue,U=I.escapeClearsValue,le=I.inputValue,ue=I.isClearable,ae=I.isDisabled,oe=I.menuIsOpen,$=I.onKeyDown,G=I.tabSelectsValue,ee=I.openMenuOnFocus,_e=c.state,Ce=_e.focusedOption,de=_e.focusedValue,be=_e.selectValue;if(!ae&&!(typeof $=="function"&&($(C),C.defaultPrevented))){switch(c.blockOptionHover=!0,C.key){case"ArrowLeft":if(!D||le)return;c.focusValue("previous");break;case"ArrowRight":if(!D||le)return;c.focusValue("next");break;case"Delete":case"Backspace":if(le)return;if(de)c.removeValue(de);else{if(!O)return;D?c.popValue():ue&&c.clearValue()}break;case"Tab":if(c.isComposing||C.shiftKey||!oe||!G||!Ce||ee&&c.isOptionSelected(Ce,be))return;c.selectOption(Ce);break;case"Enter":if(C.keyCode===229)break;if(oe){if(!Ce||c.isComposing)return;c.selectOption(Ce);break}return;case"Escape":oe?(c.setState({inputIsHiddenAfterUpdate:!1}),c.onInputChange("",{action:"menu-close",prevInputValue:le}),c.onMenuClose()):ue&&U&&c.clearValue();break;case" ":if(le)return;if(!oe){c.openMenu("first");break}if(!Ce)return;c.selectOption(Ce);break;case"ArrowUp":oe?c.focusOption("up"):c.openMenu("last");break;case"ArrowDown":oe?c.focusOption("down"):c.openMenu("first");break;case"PageUp":if(!oe)return;c.focusOption("pageup");break;case"PageDown":if(!oe)return;c.focusOption("pagedown");break;case"Home":if(!oe)return;c.focusOption("first");break;case"End":if(!oe)return;c.focusOption("last");break;default:return}C.preventDefault()}},c.state.instancePrefix="react-select-"+(c.props.instanceId||++RR),c.state.selectValue=gw(l.value),l.menuIsOpen&&c.state.selectValue.length){var m=c.getFocusableOptionsWithIds(),x=c.buildFocusableOptions(),u=x.indexOf(c.state.selectValue[0]);c.state.focusableOptionsWithIds=m,c.state.focusedOption=x[u],c.state.focusedOptionId=ay(m,x[u])}return c}return JA(o,[{key:"componentDidMount",value:function(){this.startListeningComposition(),this.startListeningToTouch(),this.props.closeMenuOnScroll&&document&&document.addEventListener&&document.addEventListener("scroll",this.onScroll,!0),this.props.autoFocus&&this.focusInput(),this.props.menuIsOpen&&this.state.focusedOption&&this.menuListRef&&this.focusedOptionRef&&yw(this.menuListRef,this.focusedOptionRef)}},{key:"componentDidUpdate",value:function(c){var m=this.props,x=m.isDisabled,u=m.menuIsOpen,C=this.state.isFocused;(C&&!x&&c.isDisabled||C&&u&&!c.menuIsOpen)&&this.focusInput(),C&&x&&!c.isDisabled?this.setState({isFocused:!1},this.onMenuClose):!C&&!x&&c.isDisabled&&this.inputRef===document.activeElement&&this.setState({isFocused:!0}),this.menuListRef&&this.focusedOptionRef&&this.scrollToFocusedOptionOnUpdate&&(yw(this.menuListRef,this.focusedOptionRef),this.scrollToFocusedOptionOnUpdate=!1)}},{key:"componentWillUnmount",value:function(){this.stopListeningComposition(),this.stopListeningToTouch(),document.removeEventListener("scroll",this.onScroll,!0)}},{key:"onMenuOpen",value:function(){this.props.onMenuOpen()}},{key:"onMenuClose",value:function(){this.onInputChange("",{action:"menu-close",prevInputValue:this.props.inputValue}),this.props.onMenuClose()}},{key:"onInputChange",value:function(c,m){this.props.onInputChange(c,m)}},{key:"focusInput",value:function(){this.inputRef&&this.inputRef.focus()}},{key:"blurInput",value:function(){this.inputRef&&this.inputRef.blur()}},{key:"openMenu",value:function(c){var m=this,x=this.state,u=x.selectValue,C=x.isFocused,I=this.buildFocusableOptions(),D=c==="first"?0:I.length-1;if(!this.props.isMulti){var O=I.indexOf(u[0]);O>-1&&(D=O)}this.scrollToFocusedOptionOnUpdate=!(C&&this.menuListRef),this.setState({inputIsHiddenAfterUpdate:!1,focusedValue:null,focusedOption:I[D],focusedOptionId:this.getFocusedOptionId(I[D])},function(){return m.onMenuOpen()})}},{key:"focusValue",value:function(c){var m=this.state,x=m.selectValue,u=m.focusedValue;if(this.props.isMulti){this.setState({focusedOption:null});var C=x.indexOf(u);u||(C=-1);var I=x.length-1,D=-1;if(x.length){switch(c){case"previous":C===0?D=0:C===-1?D=I:D=C-1;break;case"next":C>-1&&C<I&&(D=C+1);break}this.setState({inputIsHidden:D!==-1,focusedValue:x[D]})}}}},{key:"focusOption",value:function(){var c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"first",m=this.props.pageSize,x=this.state.focusedOption,u=this.getFocusableOptions();if(u.length){var C=0,I=u.indexOf(x);x||(I=-1),c==="up"?C=I>0?I-1:u.length-1:c==="down"?C=(I+1)%u.length:c==="pageup"?(C=I-m,C<0&&(C=0)):c==="pagedown"?(C=I+m,C>u.length-1&&(C=u.length-1)):c==="last"&&(C=u.length-1),this.scrollToFocusedOptionOnUpdate=!0,this.setState({focusedOption:u[C],focusedValue:null,focusedOptionId:this.getFocusedOptionId(u[C])})}}},{key:"getTheme",value:function(){return this.props.theme?typeof this.props.theme=="function"?this.props.theme(oy):St(St({},oy),this.props.theme):oy}},{key:"getCommonProps",value:function(){var c=this.clearValue,m=this.cx,x=this.getStyles,u=this.getClassNames,C=this.getValue,I=this.selectOption,D=this.setValue,O=this.props,U=O.isMulti,le=O.isRtl,ue=O.options,ae=this.hasValue();return{clearValue:c,cx:m,getStyles:x,getClassNames:u,getValue:C,hasValue:ae,isMulti:U,isRtl:le,options:ue,selectOption:I,selectProps:O,setValue:D,theme:this.getTheme()}}},{key:"hasValue",value:function(){var c=this.state.selectValue;return c.length>0}},{key:"hasOptions",value:function(){return!!this.getFocusableOptions().length}},{key:"isClearable",value:function(){var c=this.props,m=c.isClearable,x=c.isMulti;return m===void 0?x:m}},{key:"isOptionDisabled",value:function(c,m){return CT(this.props,c,m)}},{key:"isOptionSelected",value:function(c,m){return ET(this.props,c,m)}},{key:"filterOption",value:function(c,m){return IT(this.props,c,m)}},{key:"formatOptionLabel",value:function(c,m){if(typeof this.props.formatOptionLabel=="function"){var x=this.props.inputValue,u=this.state.selectValue;return this.props.formatOptionLabel(c,{context:m,inputValue:x,selectValue:u})}else return this.getOptionLabel(c)}},{key:"formatGroupLabel",value:function(c){return this.props.formatGroupLabel(c)}},{key:"startListeningComposition",value:function(){document&&document.addEventListener&&(document.addEventListener("compositionstart",this.onCompositionStart,!1),document.addEventListener("compositionend",this.onCompositionEnd,!1))}},{key:"stopListeningComposition",value:function(){document&&document.removeEventListener&&(document.removeEventListener("compositionstart",this.onCompositionStart),document.removeEventListener("compositionend",this.onCompositionEnd))}},{key:"startListeningToTouch",value:function(){document&&document.addEventListener&&(document.addEventListener("touchstart",this.onTouchStart,!1),document.addEventListener("touchmove",this.onTouchMove,!1),document.addEventListener("touchend",this.onTouchEnd,!1))}},{key:"stopListeningToTouch",value:function(){document&&document.removeEventListener&&(document.removeEventListener("touchstart",this.onTouchStart),document.removeEventListener("touchmove",this.onTouchMove),document.removeEventListener("touchend",this.onTouchEnd))}},{key:"renderInput",value:function(){var c=this.props,m=c.isDisabled,x=c.isSearchable,u=c.inputId,C=c.inputValue,I=c.tabIndex,D=c.form,O=c.menuIsOpen,U=c.required,le=this.getComponents(),ue=le.Input,ae=this.state,oe=ae.inputIsHidden,$=ae.ariaSelection,G=this.commonProps,ee=u||this.getElementId("input"),_e=St(St(St({"aria-autocomplete":"list","aria-expanded":O,"aria-haspopup":!0,"aria-errormessage":this.props["aria-errormessage"],"aria-invalid":this.props["aria-invalid"],"aria-label":this.props["aria-label"],"aria-labelledby":this.props["aria-labelledby"],"aria-required":U,role:"combobox","aria-activedescendant":this.isAppleDevice?void 0:this.state.focusedOptionId||""},O&&{"aria-controls":this.getElementId("listbox")}),!x&&{"aria-readonly":!0}),this.hasValue()?($==null?void 0:$.action)==="initial-input-focus"&&{"aria-describedby":this.getElementId("live-region")}:{"aria-describedby":this.getElementId("placeholder")});return x?he.createElement(ue,Et({},G,{autoCapitalize:"none",autoComplete:"off",autoCorrect:"off",id:ee,innerRef:this.getInputRef,isDisabled:m,isHidden:oe,onBlur:this.onInputBlur,onChange:this.handleInputChange,onFocus:this.onInputFocus,spellCheck:"false",tabIndex:I,form:D,type:"text",value:C},_e)):he.createElement(sR,Et({id:ee,innerRef:this.getInputRef,onBlur:this.onInputBlur,onChange:kf,onFocus:this.onInputFocus,disabled:m,tabIndex:I,inputMode:"none",form:D,value:""},_e))}},{key:"renderPlaceholderOrValue",value:function(){var c=this,m=this.getComponents(),x=m.MultiValue,u=m.MultiValueContainer,C=m.MultiValueLabel,I=m.MultiValueRemove,D=m.SingleValue,O=m.Placeholder,U=this.commonProps,le=this.props,ue=le.controlShouldRenderValue,ae=le.isDisabled,oe=le.isMulti,$=le.inputValue,G=le.placeholder,ee=this.state,_e=ee.selectValue,Ce=ee.focusedValue,de=ee.isFocused;if(!this.hasValue()||!ue)return $?null:he.createElement(O,Et({},U,{key:"placeholder",isDisabled:ae,isFocused:de,innerProps:{id:this.getElementId("placeholder")}}),G);if(oe)return _e.map(function(Me,Ze){var Oe=Me===Ce,ft="".concat(c.getOptionLabel(Me),"-").concat(c.getOptionValue(Me));return he.createElement(x,Et({},U,{components:{Container:u,Label:C,Remove:I},isFocused:Oe,isDisabled:ae,key:ft,index:Ze,removeProps:{onClick:function(){return c.removeValue(Me)},onTouchEnd:function(){return c.removeValue(Me)},onMouseDown:function(Rt){Rt.preventDefault()}},data:Me}),c.formatOptionLabel(Me,"value"))});if($)return null;var be=_e[0];return he.createElement(D,Et({},U,{data:be,isDisabled:ae}),this.formatOptionLabel(be,"value"))}},{key:"renderClearIndicator",value:function(){var c=this.getComponents(),m=c.ClearIndicator,x=this.commonProps,u=this.props,C=u.isDisabled,I=u.isLoading,D=this.state.isFocused;if(!this.isClearable()||!m||C||!this.hasValue()||I)return null;var O={onMouseDown:this.onClearIndicatorMouseDown,onTouchEnd:this.onClearIndicatorTouchEnd,"aria-hidden":"true"};return he.createElement(m,Et({},x,{innerProps:O,isFocused:D}))}},{key:"renderLoadingIndicator",value:function(){var c=this.getComponents(),m=c.LoadingIndicator,x=this.commonProps,u=this.props,C=u.isDisabled,I=u.isLoading,D=this.state.isFocused;if(!m||!I)return null;var O={"aria-hidden":"true"};return he.createElement(m,Et({},x,{innerProps:O,isDisabled:C,isFocused:D}))}},{key:"renderIndicatorSeparator",value:function(){var c=this.getComponents(),m=c.DropdownIndicator,x=c.IndicatorSeparator;if(!m||!x)return null;var u=this.commonProps,C=this.props.isDisabled,I=this.state.isFocused;return he.createElement(x,Et({},u,{isDisabled:C,isFocused:I}))}},{key:"renderDropdownIndicator",value:function(){var c=this.getComponents(),m=c.DropdownIndicator;if(!m)return null;var x=this.commonProps,u=this.props.isDisabled,C=this.state.isFocused,I={onMouseDown:this.onDropdownIndicatorMouseDown,onTouchEnd:this.onDropdownIndicatorTouchEnd,"aria-hidden":"true"};return he.createElement(m,Et({},x,{innerProps:I,isDisabled:u,isFocused:C}))}},{key:"renderMenu",value:function(){var c=this,m=this.getComponents(),x=m.Group,u=m.GroupHeading,C=m.Menu,I=m.MenuList,D=m.MenuPortal,O=m.LoadingMessage,U=m.NoOptionsMessage,le=m.Option,ue=this.commonProps,ae=this.state.focusedOption,oe=this.props,$=oe.captureMenuScroll,G=oe.inputValue,ee=oe.isLoading,_e=oe.loadingMessage,Ce=oe.minMenuHeight,de=oe.maxMenuHeight,be=oe.menuIsOpen,Me=oe.menuPlacement,Ze=oe.menuPosition,Oe=oe.menuPortalTarget,ft=oe.menuShouldBlockScroll,bt=oe.menuShouldScrollIntoView,Rt=oe.noOptionsMessage,Ft=oe.onMenuScrollToTop,It=oe.onMenuScrollToBottom;if(!be)return null;var zt=function(_t,Tt){var tn=_t.type,Zt=_t.data,hn=_t.isDisabled,Mn=_t.isSelected,qn=_t.label,tr=_t.value,xn=ae===Zt,Gn=hn?void 0:function(){return c.onOptionHover(Zt)},to=hn?void 0:function(){return c.selectOption(Zt)},jr="".concat(c.getElementId("option"),"-").concat(Tt),wr={id:jr,onClick:to,onMouseMove:Gn,onMouseOver:Gn,tabIndex:-1,role:"option","aria-selected":c.isAppleDevice?void 0:Mn};return he.createElement(le,Et({},ue,{innerProps:wr,data:Zt,isDisabled:hn,isSelected:Mn,key:jr,label:qn,type:tn,value:tr,isFocused:xn,innerRef:xn?c.getFocusedOptionRef:void 0}),c.formatOptionLabel(_t.data,"menu"))},xt;if(this.hasOptions())xt=this.getCategorizedOptions().map(function(ht){if(ht.type==="group"){var _t=ht.data,Tt=ht.options,tn=ht.index,Zt="".concat(c.getElementId("group"),"-").concat(tn),hn="".concat(Zt,"-heading");return he.createElement(x,Et({},ue,{key:Zt,data:_t,options:Tt,Heading:u,headingProps:{id:hn,data:ht.data},label:c.formatGroupLabel(ht.data)}),ht.options.map(function(Mn){return zt(Mn,"".concat(tn,"-").concat(Mn.index))}))}else if(ht.type==="option")return zt(ht,"".concat(ht.index))});else if(ee){var Be=_e({inputValue:G});if(Be===null)return null;xt=he.createElement(O,ue,Be)}else{var lt=Rt({inputValue:G});if(lt===null)return null;xt=he.createElement(U,ue,lt)}var dt={minMenuHeight:Ce,maxMenuHeight:de,menuPlacement:Me,menuPosition:Ze,menuShouldScrollIntoView:bt},kt=he.createElement(VD,Et({},ue,dt),function(ht){var _t=ht.ref,Tt=ht.placerProps,tn=Tt.placement,Zt=Tt.maxHeight;return he.createElement(C,Et({},ue,dt,{innerRef:_t,innerProps:{onMouseDown:c.onMenuMouseDown,onMouseMove:c.onMenuMouseMove},isLoading:ee,placement:tn}),he.createElement(pR,{captureEnabled:$,onTopArrive:Ft,onBottomArrive:It,lockEnabled:ft},function(hn){return he.createElement(I,Et({},ue,{innerRef:function(qn){c.getMenuListRef(qn),hn(qn)},innerProps:{role:"listbox","aria-multiselectable":ue.isMulti,id:c.getElementId("listbox")},isLoading:ee,maxHeight:Zt,focusedOption:ae}),xt)}))});return Oe||Ze==="fixed"?he.createElement(D,Et({},ue,{appendTo:Oe,controlElement:this.controlRef,menuPlacement:Me,menuPosition:Ze}),kt):kt}},{key:"renderFormField",value:function(){var c=this,m=this.props,x=m.delimiter,u=m.isDisabled,C=m.isMulti,I=m.name,D=m.required,O=this.state.selectValue;if(D&&!this.hasValue()&&!u)return he.createElement(gR,{name:I,onFocus:this.onValueInputFocus});if(!(!I||u))if(C)if(x){var U=O.map(function(ae){return c.getOptionValue(ae)}).join(x);return he.createElement("input",{name:I,type:"hidden",value:U})}else{var le=O.length>0?O.map(function(ae,oe){return he.createElement("input",{key:"i-".concat(oe),name:I,type:"hidden",value:c.getOptionValue(ae)})}):he.createElement("input",{name:I,type:"hidden",value:""});return he.createElement("div",null,le)}else{var ue=O[0]?this.getOptionValue(O[0]):"";return he.createElement("input",{name:I,type:"hidden",value:ue})}}},{key:"renderLiveRegion",value:function(){var c=this.commonProps,m=this.state,x=m.ariaSelection,u=m.focusedOption,C=m.focusedValue,I=m.isFocused,D=m.selectValue,O=this.getFocusableOptions();return he.createElement(tR,Et({},c,{id:this.getElementId("live-region"),ariaSelection:x,focusedOption:u,focusedValue:C,isFocused:I,selectValue:D,focusableOptions:O,isAppleDevice:this.isAppleDevice}))}},{key:"render",value:function(){var c=this.getComponents(),m=c.Control,x=c.IndicatorsContainer,u=c.SelectContainer,C=c.ValueContainer,I=this.props,D=I.className,O=I.id,U=I.isDisabled,le=I.menuIsOpen,ue=this.state.isFocused,ae=this.commonProps=this.getCommonProps();return he.createElement(u,Et({},ae,{className:D,innerProps:{id:O,onKeyDown:this.onKeyDown},isDisabled:U,isFocused:ue}),this.renderLiveRegion(),he.createElement(m,Et({},ae,{innerRef:this.getControlRef,innerProps:{onMouseDown:this.onControlMouseDown,onTouchEnd:this.onControlTouchEnd},isDisabled:U,isFocused:ue,menuIsOpen:le}),he.createElement(C,Et({},ae,{isDisabled:U}),this.renderPlaceholderOrValue(),this.renderInput()),he.createElement(x,Et({},ae,{isDisabled:U}),this.renderClearIndicator(),this.renderLoadingIndicator(),this.renderIndicatorSeparator(),this.renderDropdownIndicator())),this.renderMenu(),this.renderFormField())}}],[{key:"getDerivedStateFromProps",value:function(c,m){var x=m.prevProps,u=m.clearFocusValueOnUpdate,C=m.inputIsHiddenAfterUpdate,I=m.ariaSelection,D=m.isFocused,O=m.prevWasFocused,U=m.instancePrefix,le=c.options,ue=c.value,ae=c.menuIsOpen,oe=c.inputValue,$=c.isMulti,G=gw(ue),ee={};if(x&&(ue!==x.value||le!==x.options||ae!==x.menuIsOpen||oe!==x.inputValue)){var _e=ae?zR(c,G):[],Ce=ae?Aw(Hp(c,G),"".concat(U,"-option")):[],de=u?DR(m,G):null,be=LR(m,_e),Me=ay(Ce,be);ee={selectValue:G,focusedOption:be,focusedOptionId:Me,focusableOptionsWithIds:Ce,focusedValue:de,clearFocusValueOnUpdate:!1}}var Ze=C!=null&&c!==x?{inputIsHidden:C,inputIsHiddenAfterUpdate:void 0}:{},Oe=I,ft=D&&O;return D&&!ft&&(Oe={value:Ap($,G,G[0]||null),options:G,action:"initial-input-focus"},ft=!O),(I==null?void 0:I.action)==="initial-input-focus"&&(Oe=null),St(St(St({},ee),Ze),{},{prevProps:c,ariaSelection:Oe,prevWasFocused:ft})}}]),o}(he.Component);MT.defaultProps=AR;var FR=he.forwardRef(function(e,t){var o=XA(e);return he.createElement(MT,Et({ref:t},o))}),Af=FR;const Dw=[{label:"ATS",value:"usa"},{label:"ETS2",value:"europe"}],OR=({map:e,onSelect:t})=>Qe.jsx("div",{style:{width:90,margin:10,display:"inline-block"},children:Qe.jsx(Af,{options:Dw,isSearchable:!1,value:Dw.find(o=>o.value===e),onChange:t})});function Ai(e,t){if(e==null)throw new Error(t);return e}function BR(e,t){if(!e)throw new Error(`assertion failed: ${t}`);return e}function zf(e,t,o){let l=o.get(e);return l==null&&(l=t,o.set(e,l)),l}const VR={display:"flex",alignItems:"center",justifyContent:"space-between"},NR={backgroundColor:"#EBECF0",borderRadius:"2em",color:"#172B4D",display:"inline-block",fontSize:12,fontWeight:"normal",lineHeight:"1",minWidth:1,padding:"0.166em 0.5em",textAlign:"center"},Lv="https://raw.githubusercontent.com/nautofon/ats-towns/kansas/all-towns.geojson",UR=({map:e,onSelect:t})=>{const[o,l]=he.useState([]);he.useEffect(()=>{Promise.all([fetch("cities.geojson").then(x=>x.json()),fetch(Lv).then(x=>x.json())]).then(([x,u])=>{l(jR(x,u))},()=>console.error("could not load cities/towns geojson."))},[]);const c=x=>x.normalize("NFD").replace(new RegExp("\\p{Diacritic}","gu"),"").toLowerCase(),m=({label:x,data:u},C)=>{if(u.map!==e)return!1;if(x=c(x),C=c(C),x.split(" ").some(D=>D.startsWith(C)))return!0;const I=o.filter(D=>c(D.label).split(" ").some(O=>O.startsWith(C)));for(const D of I)if(D.options.find(U=>U.state===u.state))return!0;return!1};return Qe.jsx("div",{style:{width:250,margin:10,marginLeft:0,display:"inline-block"},children:Qe.jsx(Af,{options:o,formatGroupLabel:$R,onChange:t,filterOption:m,placeholder:"Fly to a city..."},e)})};function $R(e){return Qe.jsxs("div",{style:VR,children:[Qe.jsx("span",{children:e.label}),Qe.jsx("span",{style:NR,children:e.options.length})]})}function jR(e,t){const o=new Map,l=[];for(const m of e.features)if(m.properties.type==="city")zf(m.properties.countryCode,[],o).push(m);else if(m.properties.type==="country")l.push(m.properties);else throw new Error;for(const m of t.features)zf(m.properties.state,[],o).push({type:"Feature",geometry:m.geometry,properties:{type:"city",map:"usa",countryCode:m.properties.state,name:m.properties.name}});return l.sort((m,x)=>m.name.localeCompare(x.name)).filter(m=>o.has(m.code)).map(m=>{const x=Ai(o.get(m.code)).sort(({properties:u},{properties:C})=>u.name.localeCompare(C.name)).map(u=>({map:m.map,state:m.name,label:u.properties.name,value:u.geometry.coordinates}));return BR(x.every(u=>u.map===m.map)),{map:m.map,label:m.name,options:x}})}const ZR=()=>{const{current:e}=zS(),t=localStorage.getItem("tm-map")==="europe"?{label:"ETS2",value:"europe"}:{label:"ATS",value:"usa"},[o,l]=he.useState(t),c=sy.useCallback(x=>{x!=null&&(l(x),localStorage.setItem("tm-map",x.value),e&&(x.value==="europe"?e.flyTo({curve:1,zoom:9,center:[8,50]}):e.flyTo({curve:1,zoom:9,center:[-108,40]})))},[e]),m=sy.useCallback(x=>{e==null||x==null||(e.flyTo({curve:1,zoom:9,center:x.value.map(u=>Number(u.toFixed(3)))}),e.once("moveend",u=>{const{lat:C,lng:I}=u.target.getCenter(),D=u.target.getZoom(),O=Number(u.target.getBearing().toFixed(1)),U=Math.round(u.target.getPitch());U?window.location.hash=`${D}/${C.toFixed(3)}/${I.toFixed(3)}/${O}/${U}`:O?window.location.hash=`${D}/${C.toFixed(3)}/${I.toFixed(3)}/${O}`:window.location.hash=`${D}/${C.toFixed(3)}/${I.toFixed(3)}`}))},[e]);return Qe.jsxs(Qe.Fragment,{children:[Qe.jsx(OR,{map:o.value,onSelect:c}),Qe.jsx(UR,{map:o.value,onSelect:m})]})},qR=new kS;_v.addProtocol("pmtiles",qR.tile);const GR=()=>Qe.jsxs(DS,{style:{width:"100vw",height:"100vh"},hash:!0,minZoom:4,maxZoom:15,mapStyle:{version:8,sprite:"https://truckermudgeon.github.io/sprites",glyphs:"https://fonts.openmaptiles.org/{fontstack}/{range}.pbf",sources:{},layers:[]},initialViewState:{longitude:-115,latitude:36,zoom:9},children:[Qe.jsx(OS,{}),Qe.jsx(c_,{game:"ats"}),Qe.jsx(c_,{game:"ets2"}),Qe.jsx(Ru,{id:"scenery-towns",type:"geojson",data:Lv,children:Qe.jsx(dn,{id:"scenery-towns",type:"symbol",minzoom:7,layout:{...ls,"text-field":"{name}","text-variable-anchor":_u,"text-size":10.5},paint:vu})}),Qe.jsx(FS,{visualizePitch:!0}),Qe.jsx(RS,{}),Qe.jsx(LS,{compact:!0,customAttribution:"© Trucker Mudgeon. scenery town data by <a href='https://github.com/nautofon/ats-towns'>nautofon</a>."}),Qe.jsx(ZR,{}),Qe.jsx(jA,{})]});class HR extends Error{constructor(t){super("unreachable value "+JSON.stringify(t))}}class Df{static checkArgument(t,o){if(!t)throw new Error(o)}static checkState(t,o){if(!t)throw new Error(o)}static checkExists(t,o){return Ai(t,o)}}function WR(e,t){return XR(e,t,(o,l,c,m)=>Math.sqrt(Math.pow(c-o,2)+Math.pow(m-l,2)))}function KR(e){let t=Number.POSITIVE_INFINITY,o=Number.POSITIVE_INFINITY,l=Number.NEGATIVE_INFINITY,c=Number.NEGATIVE_INFINITY;for(const m of e)Array.isArray(m)?(t=Math.min(t,m[0]),l=Math.max(l,m[0]),o=Math.min(o,m[1]),c=Math.max(c,m[1])):(t=Math.min(t,m.x),l=Math.max(l,m.x),o=Math.min(o,m.y),c=Math.max(c,m.y));return[t,o,l,c]}function XR(e,t,o){let l,c;Array.isArray(e)?(Df.checkArgument(e.length>=2),l=e[0],c=e[1]):(l=e.x,c=e.y);let m,x;return Array.isArray(t)?(Df.checkArgument(t.length>=2),m=t[0],x=t[1]):(m=t.x,x=t.y),o(l,c,m,x)}var YR=Object.defineProperty,JR=(e,t,o)=>t in e?YR(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,QR=(e,t,o)=>(JR(e,typeof t!="symbol"?t+"":t,o),o);class e3{constructor(t){QR(this,"_kind"),this._kind=t}}function t3(e,t){const o=e.toString(),l=t.toString();return o>l?1:o<l?-1:0}const n3=t3;var r3=Object.defineProperty,i3=(e,t,o)=>t in e?r3(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,Lw=(e,t,o)=>(i3(e,typeof t!="symbol"?t+"":t,o),o);function o3(e,t,o){const l=t*2,c=t*2+1;let m=t;return l<e.length&&o(e[m],e[l])<0&&(m=l),c<e.length&&o(e[m],e[c])<0&&(m=c),m}function Rv(e,t,o){const l=o3(e,t,o);if(l!==t){const c=e[t];e[t]=e[l],e[l]=c,Rv(e,l,o)}}function Rw(e){for(let t=Math.floor(e.collection.length/2)-1;t>=0;--t)Rv(e.collection,t,e.comparator)}class Lf extends e3{constructor({comparator:t=n3}={}){super("BinaryHeap"),Lw(this,"comparator"),Lw(this,"collection",[]),this.comparator=t}static from(t,o={}){const l=new Lf(o);return l.collection=Array.from(t),Rw(l),l}clear(){this.collection.length=0}toArray(){return[...this.collection].sort(this.comparator)}get length(){return this.collection.length}top(){if(this.length===0)throw new Error("invalid operation: top() called for empty BinaryHeap");return this.collection[0]}pop(){if(this.length===0)throw new Error("invalid operation: pop() called for empty BinaryHeap");const t=this.collection[0];return this.collection.length>1?(this.collection[0]=this.collection.pop(),Rv(this.collection,0,this.comparator)):this.collection.pop(),t}push(t){this.collection.push(t);const o=this.collection;for(let l=o.length-1,c=Math.floor(l/2);l>0&&this.comparator(o[c],o[l])<0;l=c,c=Math.floor(c/2)){const m=o[l];o[l]=o[c],o[c]=m}}merge(t){t instanceof Lf?this.collection=this.collection.concat(t.collection):this.collection=this.collection.concat(t.toArray()),Rw(this),t.clear()}isEmpty(){return!this.collection.length}}function a3(e,t,o,l,c){const{nodeLUT:m,graph:x}=c,u=Ai(m.get(e)),C=Ai(m.get(t)),I=new l3({comparator:($,G)=>{const ee=ae.get($)??1/0;return(ae.get(G)??1/0)-ee}}),D={nodeId:e,distance:0,direction:o};I.push(D);const O=new Map,U=new Map;U.set(D,0);const le=$=>WR($,C),ue=($,G)=>{switch(l){case"shortest":return G.distance;case"smallRoads":return G.isOneLaneRoad?G.distance:G.distance*10;default:throw new HR(l)}},ae=new Map;ae.set(D,le(u));let oe=0;for(;!I.isEmpty();){oe++;const $=I.pop();if($.nodeId===t)return s3(O,$);const G=x.get($.nodeId);if(!G)continue;const ee=$.direction==="forward"?G.forward:G.backward;for(const _e of ee){const Ce=(U.get($)??1/0)+ue($,_e);Ce<(U.get(_e)??1/0)&&(O.set(_e,$),U.set(_e,Ce),ae.set(_e,Ce+le(Ai(m.get(_e.nodeId)))),I.has(_e)||I.push(_e))}}console.warn(`no ${o} route found from`,u,"and",C,`(${oe} iterations)`)}function s3(e,t){let o=0;const l=[t];for(;e.has(t);)t=e.get(t),l.unshift(t),o+=t.distance;return l.length===1&&l.push(l[0]),{route:l,distance:o}}class l3 extends Lf{constructor(o){super(o);gx(this,"items",new Set)}has(o){return this.items.has(o)}push(o){Df.checkState(!this.items.has(o)),super.push(o),this.items.add(o)}pop(){const o=super.pop();return Df.checkState(this.items.has(o)),this.items.delete(o),o}clear(){super.clear(),this.items.clear()}merge(o){super.merge(o);for(const l of this.collection)this.items.add(l)}}const u3=new kS;_v.addProtocol("pmtiles",u3.tile);const c3=()=>Qe.jsxs(DS,{style:{width:"100vw",height:"100vh"},minZoom:4,maxZoom:15,maxBounds:[[-135,21],[-84,54]],mapStyle:{version:8,sprite:"https://truckermudgeon.github.io/sprites",glyphs:"https://fonts.openmaptiles.org/{fontstack}/{range}.pbf",sources:{},layers:[]},initialViewState:{longitude:-115,latitude:36,zoom:9},children:[Qe.jsx(OS,{}),Qe.jsx(c_,{game:"ats"}),Qe.jsx(Ru,{id:"scenery-towns",type:"geojson",data:Lv,children:Qe.jsx(dn,{id:"scenery-towns",type:"symbol",minzoom:7,layout:{...ls,"text-field":"{name}","text-variable-anchor":_u,"text-size":10.5},paint:vu})}),Qe.jsx(Ru,{id:"route1",type:"geojson",data:{type:"FeatureCollection",features:[]},children:Qe.jsx(dn,{type:"line",paint:{"line-color":["match",["get","mode"],"shortest","#f00","smallRoads","#0f0","#f0f"],"line-width":3,"line-opacity":.7}})}),Qe.jsx(FS,{visualizePitch:!0}),Qe.jsx(RS,{}),Qe.jsx(LS,{compact:!0,customAttribution:"© Trucker Mudgeon. scenery town data by <a href='https://github.com/nautofon/ats-towns'>nautofon</a>."}),Qe.jsx(h3,{})]}),h3=()=>{const{current:e}=zS(),[t,o]=he.useState(void 0),[l,c]=he.useState(void 0),[m,x]=he.useState([]),[u,C]=he.useState([]);he.useEffect(()=>{fetch("usa-graph-demo.json").then(oe=>oe.json()).then(oe=>{const $=new Map;for(const G of oe.demoCompanies)zf(G.c,[],$).push(Ow(G));x(Bw($)),c(d3(oe)),o(oe)},()=>console.error("could not load usa-graph-demo.json"))},[]);const[I,D]=he.useState(void 0),[O,U]=he.useState(void 0),le=he.useCallback(oe=>{oe=Ai(oe),D(oe.value);let $;if(t!=null){$=Ai(t.demoCompanies.find(Ce=>Ce.n===oe.value));const G=Ai(t.demoCompanyDefs.find(Ce=>Ce.t===$.t)),ee=new Set(G.d),_e=new Map;for(const Ce of t.demoCompanies)ee.has(Ce.t)&&zf(Ce.c,[],_e).push(Ow(Ce));C(Bw(_e))}if(!(e==null||l==null)&&(O!=null&&(Ai(e.getSource("route1")).setData({type:"FeatureCollection",features:[]}),U(void 0)),$)){const G=Ai(l.nodeLUT.get($.n));e.flyTo({curve:1,zoom:9,center:[G.x,G.y]})}},[e,O,l,t]),ue=he.useCallback(oe=>{oe=Ai(oe),U(oe.value),!(e==null||l==null)&&ae(Ai(I),oe.value,e,l)},[e,I,l]),ae=(oe,$,G,ee)=>{Promise.all([Vw(oe,$,"shortest",ee),Vw(oe,$,"smallRoads",ee)]).then(_e=>{if(_e.some(be=>be==null))return;const Ce=_e;Ai(G.getSource("route1")).setData({type:"FeatureCollection",features:Ce}),G.fitBounds(KR(Ce.flatMap(be=>be.geometry.coordinates)),{padding:150,curve:1,duration:2500})},_e=>{console.error("error finding route",_e)})};return Qe.jsxs("div",{style:{width:300,margin:20,display:"grid",position:"relative",gridTemplateColumns:"100px auto",alignItems:"center"},children:[Qe.jsx("h2",{children:"Start"}),Qe.jsx(Af,{options:m,onChange:le}),Qe.jsx("h2",{children:"End"}),Qe.jsx(Af,{options:u,onChange:ue,isDisabled:I==null},I)]})};function d3(e){const t=new Map,o=new Map;for(const[l,c]of e.demoGraph)t.set(l,{forward:(c.f??[]).map(Fw),backward:(c.b??[]).map(Fw)});for(const[l,c]of e.demoNodes)o.set(l,{x:c[0],y:c[1]});return{graph:t,nodeLUT:o}}function Fw(e){return{nodeId:e.n,distance:e.l,isOneLaneRoad:e.o,direction:e.d==="f"?"forward":"backward"}}function Ow(e){return{label:e.t,city:e.c,value:e.n}}function Bw(e){return[...e.entries()].sort((t,o)=>t[0].localeCompare(o[0])).map(([t,o])=>({label:t,options:o}))}function Vw(e,t,o,l){return new Promise(c=>{const m=a3(e,t,"forward",o,l);if(!m){c(void 0);return}c({type:"Feature",geometry:{type:"LineString",coordinates:m.route.map(x=>{const u=Ai(l.nodeLUT.get(x.nodeId));return[u.x,u.y]})},properties:{distance:m.distance,mode:o}})})}const p3=aP(s_([Qe.jsx(a_,{path:"/",element:Qe.jsx(GR,{})}),Qe.jsx(a_,{path:"routes",element:Qe.jsx(c3,{})})])),f3=document.getElementById("root"),m3=Q2(f3);m3.render(Qe.jsx(he.StrictMode,{children:Qe.jsx(mP,{router:p3})}));
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
